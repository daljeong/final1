/*! For license information please see main.f8f9d399.js.LICENSE.txt */
(()=>{var e={43:(e,t,i)=>{"use strict";e.exports=i(202)},76:(e,t,i)=>{"use strict";i.d(t,{Mz:()=>o,OB:()=>s,yx:()=>r});var n=i(775);function r(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[i,r]=e.split("x"),s=i,o=r?parseInt(r):1,a=(0,n.vE)(s),l={type:s,components:o,byteLength:a.byteLength*o,integer:a.integer,signed:a.signed,normalized:a.normalized};return t&&(l.webglOnly=!0),l}function s(e,t,i){if(!t||t>4)throw new Error("size ".concat(t));const r=t;return function(e,t,i){const r=i?(0,n.K7)(e):e;switch(r){case"unorm8":return 1===t?"unorm8":3===t?"unorm8x3-webgl":"".concat(r,"x").concat(t);case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(1===t||3===t)throw new Error("size: ".concat(t));return"".concat(r,"x").concat(t);default:return 1===t?r:"".concat(r,"x").concat(t)}}((0,n.h1)(e),r,i)}function o(e){let t;switch(e.primitiveType){case"f32":t="float32";break;case"i32":t="sint32";break;case"u32":t="uint32";break;case"f16":return e.components<=2?"float16x2":"float16x4"}return 1===e.components?t:"".concat(t,"x").concat(e.components)}},96:(e,t,i)=>{"use strict";i.d(t,{R:()=>n});const n=new(i(795).t)({id:"luma.gl"})},153:(e,t,i)=>{"use strict";var n=i(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,i){var n,s={},c=null,u=null;for(n in void 0!==i&&(c=""+i),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,n)&&!l.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.jsx=c,t.jsxs=c},173:(e,t,i)=>{e.exports=i(497)()},184:(e,t,i)=>{"use strict";i.d(t,{M:()=>a,P:()=>o});var n=i(96),r=i(242),s=i(76);function o(e,t){const i={};for(const n of e.attributes){const r=l(e,t,n.name);r&&(i[n.name]=r)}return i}function a(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;const n=o(e,t),r=new Array(i).fill(null);for(const s of Object.values(n))r[s.location]=s;return r}function l(e,t,i){const o=function(e,t){const i=e.attributes.find(e=>e.name===t);i||n.R.warn('shader layout attribute "'.concat(t,'" not present in shader'));return i||null}(e,i),a=function(e,t){c(e);let i=function(e,t){for(const i of e)if(i.format&&i.name===t)return{attributeName:i.name,bufferName:t,stepMode:i.stepMode,vertexFormat:i.format,byteOffset:0,byteStride:i.byteStride||0};return null}(e,t);if(i)return i;if(i=function(e,t){for(const n of e){var i;let e=n.byteStride;if("number"!==typeof n.byteStride)for(const t of n.attributes||[]){e+=(0,s.yx)(t.format).byteLength}const r=null===(i=n.attributes)||void 0===i?void 0:i.find(e=>e.attribute===t);if(r)return{attributeName:r.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:e}}return null}(e,t),i)return i;return n.R.warn('layout for attribute "'.concat(t,'" not present in buffer layout')),null}(t,i);if(!o)return null;const l=(0,r.wH)(o.type),u=(0,s.Mz)(l),h=(null===a||void 0===a?void 0:a.vertexFormat)||u,d=(0,s.yx)(h);return{attributeName:(null===a||void 0===a?void 0:a.attributeName)||o.name,bufferName:(null===a||void 0===a?void 0:a.bufferName)||o.name,location:o.location,shaderType:o.type,primitiveType:l.primitiveType,shaderComponents:l.components,vertexFormat:h,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:l.integer,stepMode:(null===a||void 0===a?void 0:a.stepMode)||o.stepMode||"vertex",byteOffset:(null===a||void 0===a?void 0:a.byteOffset)||0,byteStride:(null===a||void 0===a?void 0:a.byteStride)||0}}function c(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&n.R.warn("BufferLayout ".concat(name," must have either 'attributes' or 'format' field"))}},191:(e,t)=>{"use strict";var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),f=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case r:case o:case s:case u:case h:case m:return e;default:switch(e=e&&e.$$typeof){case l:case c:case p:case d:case a:return e;default:return t}}case n:return t}}}t.Hy=function(e){return"string"===typeof e||"function"===typeof e||e===r||e===o||e===s||e===u||e===h||"object"===typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===d||e.$$typeof===l||e.$$typeof===a||e.$$typeof===c||e.$$typeof===f||void 0!==e.getModuleId)}},199:(e,t,i)=>{"use strict";let n;function r(e){return(!n||n.byteLength<e)&&(n=new ArrayBuffer(e)),n}function s(e,t){return new e(r(e.BYTES_PER_ELEMENT*t),0,t)}i.d(t,{X:()=>s,o:()=>r})},202:(e,t)=>{"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function _(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||m}function v(){}function y(e,t,i){this.props=e,this.context=t,this.refs=g,this.updater=i||m}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var b=y.prototype=new v;b.constructor=y,f(b,_.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,E={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,n){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&!A.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:i,type:e,key:o,ref:a,props:s,_owner:E.current}}function D(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var S=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case n:l=!0}}if(l)return o=o(l=e),e=""===s?"."+C(l,0):s,x(o)?(r="",null!=e&&(r=e.replace(S,"$&/")+"/"),P(o,t,r,"",function(e){return e})):null!=o&&(D(o)&&(o=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+C(a=e[c],c);l+=P(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,r,u=s+C(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,i){if(null==e)return e;var n=[],r=0;return P(e,n,"","",function(e){return t.call(i,e,r++)}),n}function k(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},R={transition:null},F={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:R,ReactCurrentOwner:E};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,i){I(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!D(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=r,t.Profiler=o,t.PureComponent=y,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!A.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:i,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=D,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,i){return M.current.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,i){return M.current.useReducer(e,t,i)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,i){return M.current.useSyncExternalStore(e,t,i)},t.useTransition=function(){return M.current.useTransition()},t.version="18.3.1"},204:(e,t,i)=>{"use strict";i.d(t,{L:()=>r});const n={};function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";n[e]=n[e]||1;const t=n[e]++;return"".concat(e,"-").concat(t)}},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},228:(e,t,i)=>{"use strict";i.d(t,{B:()=>r});var n=i(544);function r(){var e;return!("object"===typeof process&&"[object process]"===String(process)&&!(null!==(e=process)&&void 0!==e&&e.browser))||(0,n.b)()}},234:(e,t)=>{"use strict";function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<s(r,t)))break e;e[n]=t,e[i]=r,i=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,o=r>>>1;n<o;){var a=2*(n+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,i))c<r&&0>s(u,l)?(e[n]=u,e[c]=i,n=c):(e[n]=l,e[a]=i,n=a);else{if(!(c<r&&0>s(u,i)))break e;e[n]=u,e[c]=i,n=c}}}return t}function s(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,m=!1,f=!1,g=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,i(c,t)}t=n(u)}}function x(e){if(g=!1,b(e),!f)if(null!==n(c))f=!0,R(w);else{var t=n(u);null!==t&&F(x,t.startTime-e)}}function w(e,i){f=!1,g&&(g=!1,v(D),D=-1),m=!0;var s=p;try{for(b(i),d=n(c);null!==d&&(!(d.expirationTime>i)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=i);i=t.unstable_now(),"function"===typeof a?d.callback=a:d===n(c)&&r(c),b(i)}else r(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&F(x,h.startTime-i),l=!1}return l}finally{d=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,A=!1,T=null,D=-1,S=5,C=-1;function P(){return!(t.unstable_now()-C<S)}function I(){if(null!==T){var e=t.unstable_now();C=e;var i=!0;try{i=T(!0,e)}finally{i?E():(A=!1,T=null)}}else A=!1}if("function"===typeof y)E=function(){y(I)};else if("undefined"!==typeof MessageChannel){var k=new MessageChannel,M=k.port2;k.port1.onmessage=I,E=function(){M.postMessage(null)}}else E=function(){_(I,0)};function R(e){T=e,A||(A=!0,E())}function F(e,i){D=_(function(){e(t.unstable_now())},i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,R(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var i=p;p=t;try{return e()}finally{p=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=p;p=e;try{return t()}finally{p=i}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,i(u,e),null===n(c)&&e===n(u)&&(g?(v(D),D=-1):g=!0,F(x,s-o))):(e.sortIndex=a,i(c,e),f||m||(f=!0,R(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var i=p;p=t;try{return e.apply(this,arguments)}finally{p=i}}}},242:(e,t,i)=>{"use strict";i.d(t,{k0:()=>r,wH:()=>s});var n=i(379);function r(e){return l[e]}function s(e){const[t,i]=a[e],n="i32"===t||"u32"===t,r="u32"!==t;return{primitiveType:t,components:i,byteLength:o[t]*i,integer:n,signed:r}}const o={f32:4,f16:2,i32:4,u32:4},a={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},l={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}},c={vec2i:"vec2<i32>",vec3i:"vec3<i32>",vec4i:"vec4<i32>",vec2u:"vec2<u32>",vec3u:"vec3<u32>",vec4u:"vec4<u32>",vec2f:"vec2<f32>",vec3f:"vec3<f32>",vec4f:"vec4<f32>",vec2h:"vec2<f16>",vec3h:"vec3<f16>",vec4h:"vec4<f16>"};(0,n.A)((0,n.A)({},c),{},{mat2x2f:"mat2x2<f32>",mat2x3f:"mat2x3<f32>",mat2x4f:"mat2x4<f32>",mat3x2f:"mat3x2<f32>",mat3x3f:"mat3x3<f32>",mat3x4f:"mat3x4<f32>",mat4x2f:"mat4x2<f32>",mat4x3f:"mat4x3<f32>",mat4x4f:"mat4x4<f32>",mat2x2i:"mat2x2<i32>",mat2x3i:"mat2x3<i32>",mat2x4i:"mat2x4<i32>",mat3x2i:"mat3x2<i32>",mat3x3i:"mat3x3<i32>",mat3x4i:"mat3x4<i32>",mat4x2i:"mat4x2<i32>",mat4x3i:"mat4x3<i32>",mat4x4i:"mat4x4<i32>",mat2x2u:"mat2x2<u32>",mat2x3u:"mat2x3<u32>",mat2x4u:"mat2x4<u32>",mat3x2u:"mat3x2<u32>",mat3x3u:"mat3x3<u32>",mat3x4u:"mat3x4<u32>",mat4x2u:"mat4x2<u32>",mat4x3u:"mat4x3<u32>",mat4x4u:"mat4x4<u32>",mat2x2h:"mat2x2<f16>",mat2x3h:"mat2x3<f16>",mat2x4h:"mat2x4<f16>",mat3x2h:"mat3x2<f16>",mat3x3h:"mat3x3<f16>",mat3x4h:"mat3x4<f16>",mat4x2h:"mat4x2<f16>",mat4x3h:"mat4x3<f16>",mat4x4h:"mat4x4<f16>"})},263:(e,t,i)=>{"use strict";i.d(t,{d:()=>s});var n=i(467),r=i(453);const s=new class{constructor(){(0,n.A)(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new r.A({id:e})),this.stats.get(e)}}},284:(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}i.d(t,{A:()=>n})},354:(e,t,i)=>{"use strict";i.d(t,{_G:()=>u,ic:()=>c,k2:()=>h});var n=i(379),r=i(96),s=i(788);const o=1;let a=null,l=!1;const c={debugSpectorJS:r.R.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function u(e){if(!globalThis.SPECTOR)try{await(0,s.k)(e.debugSpectorJSUrl||c.debugSpectorJSUrl)}catch(t){r.R.warn(String(t))}}function h(e){var t,i,s;if(!(e=(0,n.A)((0,n.A)({},c),e)).debugSpectorJS)return null;if(!a&&globalThis.SPECTOR&&(null===(t=globalThis.luma)||void 0===t||!t.spector)){r.R.probe(o,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;a=new e,globalThis.luma&&(globalThis.luma.spector=a)}if(!a)return null;l||(l=!0,a.spyCanvases(),null===(i=a)||void 0===i||i.onCaptureStarted.add(e=>r.R.info("Spector capture started:",e)()),null===(s=a)||void 0===s||s.onCapture.add(e=>{var t,i,n;r.R.info("Spector capture complete:",e)(),null===(t=a)||void 0===t||t.getResultUI(),null===(i=a)||void 0===i||i.resultView.display(),null===(n=a)||void 0===n||n.resultView.addCapture(e)}));if(e.gl){var u;const t=e.gl,i=t.device;null===(u=a)||void 0===u||u.startCapture(e.gl,500),t.device=i,new Promise(e=>setTimeout(e,2e3)).then(e=>{var t;r.R.info("Spector capture stopped after 2 seconds")(),null===(t=a)||void 0===t||t.stopCapture()})}return a}},379:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var n=i(467);function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}},382:(e,t,i)=>{"use strict";i.d(t,{pF:()=>p,I7:()=>d,PI:()=>h});var n=i(379),r=i(467),s=i(263),o=i(96),a=i(204),l=i(794),c=i(76),u=i(752);class h{}class d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;(0,r.A)(this,"features",void 0),(0,r.A)(this,"disabledFeatures",void 0),this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){var t;return!(null!==(t=this.disabledFeatures)&&void 0!==t&&t[e])&&this.features.has(e)}}class p{get[Symbol.toStringTag](){return"Device"}toString(){return"Device(".concat(this.id,")")}constructor(e){(0,r.A)(this,"id",void 0),(0,r.A)(this,"props",void 0),(0,r.A)(this,"userData",{}),(0,r.A)(this,"statsManager",s.d),(0,r.A)(this,"timestamp",0),(0,r.A)(this,"_reused",!1),(0,r.A)(this,"_lumaData",{}),(0,r.A)(this,"_textureCaps",{}),this.props=(0,n.A)((0,n.A)({},p.defaultProps),e),this.id=this.props.id||(0,a.L)(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return(0,c.yx)(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return u.v.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const i=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(i),this._textureCaps[e]=t}return t}getMipLevelCount(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=Math.max(e,t,i);return 1+Math.floor(Math.log2(n))}isExternalImage(e){return function(e){return"undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas}(e)}getExternalImageSize(e){return function(e){if("undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!==typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return u.v.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){var e;null===(e=this.commandEncoder)||void 0===e||e.popDebugGroup()}insertDebugMarker(e){var t;null===(t=this.commandEncoder)||void 0===t||t.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t){if(!this.props.onError(e,t)){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return o.R.error(e.message,t,...n)}return()=>{}}debug(){if(this.props.debug);else{const e="'Type luma.log.set({debug: true}) in console to enable debug breakpoints',\nor create a device with the 'debug: true' prop.";o.R.once(0,e)()}}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=u.v.getCapabilities(e),i=e=>{var t;return null===(t="string"===typeof e?this.features.has(e):e)||void 0===t||t},n=i(t.create);return{format:e,create:n,render:n&&i(t.render),filter:n&&i(t.filter),blend:n&&i(t.blend),store:n&&i(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=(0,n.A)({},e);if((e.usage||0)&l.h.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array&&(t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}}(0,r.A)(p,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[i,n]=e.getDevicePixelSize();o.R.log(1,"".concat(e," resized => ").concat(i,"x").concat(n,"px"))()},onPositionChange:(e,t)=>{const[i,n]=e.getPosition();o.R.log(1,"".concat(e," repositioned => ").concat(i,",").concat(n))()},onVisibilityChange:e=>o.R.log(1,"".concat(e," Visibility changed ").concat(e.isVisible))(),onDevicePixelRatioChange:(e,t)=>o.R.log(1,"".concat(e," DPR changed ").concat(t.oldRatio," => ").concat(e.devicePixelRatio))(),debug:o.R.get("debug")||void 0,debugShaders:o.R.get("debug-shaders")||void 0,debugFramebuffers:Boolean(o.R.get("debug-framebuffers")),debugFactories:Boolean(o.R.get("debug-factories")),debugWebGL:Boolean(o.R.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0})},391:(e,t,i)=>{"use strict";var n=i(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},404:(e,t,i)=>{"use strict";i.d(t,{M:()=>c});var n=i(379),r=i(467),s=i(804),o=i(204);function a(e,t,i,n){if(null!==n&&void 0!==n&&n.inlineSource){const n=function(e,t,i){let n="";for(let r=t-2;r<=t;r++){const s=e[r-1];void 0!==s&&(n+=l(s,t,i))}return n}(t,i),r=e.linePos>0?"".concat(" ".repeat(e.linePos+5),"^^^\n"):"";return"\n".concat(n).concat(r).concat(e.type.toUpperCase(),": ").concat(e.message,"\n\n")}const r="error"===e.type?"red":"#8B4000";return null!==n&&void 0!==n&&n.html?"<div class='luma-compiler-log-error' style=\"color:".concat(r,';"><b> ').concat(e.type.toUpperCase(),": ").concat(e.message,"</b></div>"):"".concat(e.type.toUpperCase(),": ").concat(e.message)}function l(e,t,i){const n=null!==i&&void 0!==i&&i.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return"".concat(function(e,t){let i="";for(let n=e.length;n<t;++n)i+=" ";return i+e}(String(t),4),": ").concat(n).concat(null!==i&&void 0!==i&&i.html?"<br/>":"\n")}class c extends s.F{get[Symbol.toStringTag](){return"Shader"}constructor(e,t){t=(0,n.A)((0,n.A)({},t),{},{debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),super(e,(0,n.A)({id:u(t)},t),c.defaultProps),(0,r.A)(this,"stage",void 0),(0,r.A)(this,"source",void 0),(0,r.A)(this,"compilationStatus","pending"),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===(null===t||void 0===t?void 0:t.length)||this._displayShaderLog(t,this.id)}_displayShaderLog(e,t){var i,r;if("undefined"===typeof document||null===(i=document)||void 0===i||!i.createElement)return;const s=t,o="".concat(this.stage,' shader "').concat(s,'"');let c=function(e,t,i){let r="";const s=t.split(/\r?\n/),o=e.slice().sort((e,t)=>e.lineNum-t.lineNum);switch((null===i||void 0===i?void 0:i.showSourceCode)||"no"){case"all":let t=0;for(let e=1;e<=s.length;e++)for(r+=l(s[e-1],e,i);o.length>t&&o[t].lineNum===e;){const e=o[t++];r+=a(e,s,e.lineNum,(0,n.A)((0,n.A)({},i),{},{inlineSource:!1}))}for(;o.length>t;)r+=a(o[t++],[],0,(0,n.A)((0,n.A)({},i),{},{inlineSource:!1}));return r;case"issues":case"no":for(const n of e)r+=a(n,s,n.lineNum,{inlineSource:"no"!==(null===i||void 0===i?void 0:i.showSourceCode)});return r}}(e,this.source,{showSourceCode:"all",html:!0});const u=this.getTranslatedSource();u&&(c+='<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>'.concat(u,"</pre></code>"));const h=document.createElement("Button");h.innerHTML="\n<h1>Compilation error in ".concat(o,'</h1><br /><br />\n<code style="user-select:text;"><pre>\n').concat(c,"\n</pre></code>"),h.style.top="10px",h.style.left="10px",h.style.position="absolute",h.style.zIndex="9999",h.style.width="100%",h.style.textAlign="left",document.body.appendChild(h);null===(r=document.getElementsByClassName("luma-compiler-log-error")[0])||void 0===r||r.scrollIntoView(),h.onclick=()=>{const e="data:text/plain,".concat(encodeURIComponent(this.source));navigator.clipboard.writeText(e)}}}function u(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return i?i[1]:t}(e.source)||e.id||(0,o.L)("unnamed ".concat(e.stage,"-shader"))}(0,r.A)(c,"defaultProps",(0,n.A)((0,n.A)({},s.F.defaultProps),{},{language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}))},453:(e,t,i)=>{"use strict";function n(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}i.d(t,{A:()=>s});class r{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=n(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(n()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class s{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(e){const{name:t,type:i}=e;let n=this.stats[t];return n||(n=e instanceof r?e:new r(t,i),this.stats[t]=n),n}}},467:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var n=i(816);function r(e,t,i){return(t=(0,n.A)(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},497:(e,t,i)=>{"use strict";var n=i(218);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,i,r,s,o){if(o!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return i.PropTypes=i,i}},501:(e,t,i)=>{"use strict";i.d(t,{g:()=>u});var n,r=i(379),s=i(467),o=i(804),a=i(698),l=i(96);const c={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class u extends o.F{get[Symbol.toStringTag](){return"Texture"}toString(){return"Texture(".concat(this.id,",").concat(this.format,",").concat(this.width,"x").concat(this.height,")")}constructor(e,t){if(super(e,t=u.normalizeProps(e,t),u.defaultProps),(0,s.A)(this,"dimension",void 0),(0,s.A)(this,"baseDimension",void 0),(0,s.A)(this,"format",void 0),(0,s.A)(this,"width",void 0),(0,s.A)(this,"height",void 0),(0,s.A)(this,"depth",void 0),(0,s.A)(this,"mipLevels",void 0),(0,s.A)(this,"updateTimestamp",void 0),this.dimension=this.props.dimension,this.baseDimension=c[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,void 0===this.props.width||void 0===this.props.height)if(e.isExternalImage(t.data)){const i=e.getExternalImageSize(t.data);this.width=(null===i||void 0===i?void 0:i.width)||1,this.height=(null===i||void 0===i?void 0:i.height)||1}else this.width=1,this.height=1,void 0!==this.props.width&&void 0!==this.props.height||l.R.warn("".concat(this," created with undefined width or height. This is deprecated. Use AsyncTexture instead."))();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof a.L?e:this.device.createSampler(e)}clone(e){return this.device.createTexture((0,r.A)((0,r.A)({},this.props),e))}static normalizeProps(e,t){const i=(0,r.A)({},t),{width:n,height:s}=i;return"number"===typeof n&&(i.width=Math.max(1,Math.ceil(n))),"number"===typeof s&&(i.height=Math.max(1,Math.ceil(s))),i}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:t,height:i,depth:n}=this,s=(0,r.A)((0,r.A)({},u.defaultCopyDataOptions),{},{width:t,height:i,depth:n},e),o=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!o.bytesPerPixel)throw new Error("bytesPerRow must be provided for texture format ".concat(this.format));return s.bytesPerRow=e.bytesPerRow||t*(o.bytesPerPixel||4),s.rowsPerImage=e.rowsPerImage||i,s}_normalizeCopyExternalImageOptions(e){const t=this.device.getExternalImageSize(e.image),i=(0,r.A)((0,r.A)((0,r.A)({},u.defaultCopyExternalImageOptions),t),e);return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}}n=u,(0,s.A)(u,"SAMPLE",4),(0,s.A)(u,"STORAGE",8),(0,s.A)(u,"RENDER",16),(0,s.A)(u,"COPY_SRC",1),(0,s.A)(u,"COPY_DST",2),(0,s.A)(u,"TEXTURE",4),(0,s.A)(u,"RENDER_ATTACHMENT",16),(0,s.A)(u,"defaultProps",(0,r.A)((0,r.A)({},o.F.defaultProps),{},{data:null,dimension:"2d",format:"rgba8unorm",usage:n.TEXTURE|n.RENDER_ATTACHMENT|n.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0})),(0,s.A)(u,"defaultCopyDataOptions",{data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"}),(0,s.A)(u,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1})},513:(e,t,i)=>{"use strict";i.d(t,{$:()=>u,l:()=>h});var n,r=i(379),s=i(96);!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(n||(n={}));var o=i(228),a=i(788);const l="https://unpkg.com/webgl-debug@2.0.1/index.js";function c(e){return e.luma=e.luma||{},e.luma}async function u(){(0,o.B)()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await(0,a.k)(l))}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return s.R.warn("webgl-debug not loaded")(),e;const i=c(e);if(i.debugContext)return i.debugContext;globalThis.WebGLDebugUtils.init((0,r.A)((0,r.A)({},n),e));const o=globalThis.WebGLDebugUtils.makeDebugContext(e,p.bind(null,t),m.bind(null,t));for(const r in n)r in o||"number"!==typeof n[r]||(o[r]=n[r]);class a{}Object.setPrototypeOf(o,Object.getPrototypeOf(e)),Object.setPrototypeOf(a,o);const l=Object.create(a);return i.realContext=e,i.debugContext=l,l.debug=!0,l}(e,t):function(e){const t=c(e);return t.realContext?t.realContext:e}(e)}function d(e,t){t=Array.from(t).map(e=>void 0===e?"undefined":e);let i=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return i="".concat(i.slice(0,100)).concat(i.length>100?"...":""),"gl.".concat(e,"(").concat(i,")")}function p(e,t,i,n){n=Array.from(n).map(e=>void 0===e?"undefined":e);const r=globalThis.WebGLDebugUtils.glEnumToString(t),o=globalThis.WebGLDebugUtils.glFunctionArgsToString(i,n),a="".concat(r," in gl.").concat(i,"(").concat(o,")");s.R.error(a)()}function m(e,t,i){let n="";s.R.level>=1&&(n=d(t,i),e.traceWebGL&&s.R.log(1,n)());for(const r of i)void 0===r&&(n=n||d(t,i))}},544:(e,t,i)=>{"use strict";function n(e){var t,i;if("undefined"!==typeof window&&"renderer"===(null===(t=window.process)||void 0===t?void 0:t.type))return!0;if("undefined"!==typeof process&&Boolean(null===(i=process.versions)||void 0===i?void 0:i.electron))return!0;const n="undefined"!==typeof navigator&&navigator.userAgent,r=e||n;return Boolean(r&&r.indexOf("Electron")>=0)}i.d(t,{b:()=>n})},579:(e,t,i)=>{"use strict";e.exports=i(153)},671:(e,t,i)=>{"use strict";i.d(t,{r:()=>o});var n=i(379),r=i(467),s=i(804);class o extends s.F{get[Symbol.toStringTag](){return"RenderPipeline"}constructor(e,t){super(e,t,o.defaultProps),(0,r.A)(this,"shaderLayout",void 0),(0,r.A)(this,"bufferLayout",void 0),(0,r.A)(this,"linkStatus","pending"),(0,r.A)(this,"hash",""),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}}(0,r.A)(o,"defaultProps",(0,n.A)((0,n.A)({},s.F.defaultProps),{},{vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}))},698:(e,t,i)=>{"use strict";i.d(t,{L:()=>o});var n=i(379),r=i(467),s=i(804);class o extends s.F{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=o.normalizeProps(e,t),o.defaultProps)}static normalizeProps(e,t){return t}}(0,r.A)(o,"defaultProps",(0,n.A)((0,n.A)({},s.F.defaultProps),{},{type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1}))},705:(e,t,i)=>{"use strict";i.d(t,{eh:()=>r,gM:()=>s,x:()=>n});const n=globalThis,r=(globalThis.document,globalThis.process||{}),s=(globalThis.console,globalThis.navigator||{})},730:(e,t,i)=>{"use strict";var n=i(43),r=i(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,i,n,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,i,n){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!h.call(m,e)||!h.call(p,e)&&(d.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_,v);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var O,B=Object.assign;function z(e){if(void 0===O)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var N=!1;function U(e,t){if(!e||N)return"";N=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=n.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{N=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?z(e):""}function j(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case w:return"Portal";case T:return"Profiler";case A:return"StrictMode";case P:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case D:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return V(e(t))}catch(i){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=H(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var i=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function K(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=W(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function $(e,t){J(e,t);var i=W(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,i):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function ee(e,t,i){"number"===t&&Z(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ie(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+W(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(s(92));if(te(i)){if(1<i.length)throw Error(s(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:W(i)}}function se(e,t){var i=W(t.value),n=W(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=fe(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var _e=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(_e[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ee=null,Ae=null;function Te(e){if(e=yr(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=xr(t),we(e.stateNode,e.type,t))}}function De(e){Ee?Ae?Ae.push(e):Ae=[e]:Ee=e}function Se(){if(Ee){var e=Ee,t=Ae;if(Ae=Ee=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ce(e,t){return e(t)}function Pe(){}var Ie=!1;function ke(e,t,i){if(Ie)return e(t,i);Ie=!0;try{return Ce(e,t,i)}finally{Ie=!1,(null!==Ee||null!==Ae)&&(Pe(),Se())}}function Me(e,t){var i=e.stateNode;if(null===i)return null;var n=xr(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(s(231,t,typeof i));return i}var Re=!1;if(u)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(ue){Re=!1}function Le(e,t,i,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(u){this.onError(u)}}var Oe=!1,Be=null,ze=!1,Ne=null,Ue={onError:function(e){Oe=!0,Be=e}};function je(e,t,i,n,r,s,o,a,l){Oe=!1,Be=null,Le.apply(Ue,arguments)}function Ve(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(n=r.return)){i=n;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===i)return We(r),e;if(o===n)return We(r),t;o=o.sibling}throw Error(s(188))}if(i.return!==n.return)i=r,n=o;else{for(var a=!1,l=r.child;l;){if(l===i){a=!0,i=r,n=o;break}if(l===n){a=!0,n=r,i=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===i){a=!0,i=o,n=r;break}if(l===n){a=!0,n=o,i=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(i.alternate!==n)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?e:t}(e))?Xe(e):null}function Xe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Xe(e);if(null!==t)return t;e=e.sibling}return null}var qe=r.unstable_scheduleCallback,Ze=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Ke=r.unstable_requestPaint,Je=r.unstable_now,$e=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,it=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&i;if(0!==o){var a=o&~r;0!==a?n=ht(a):0!==(s&=o)&&(n=ht(s))}else 0!==(o=i&~r)?n=ht(o):0!==s&&(n=ht(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-ot(t)),n|=e[i],t&=~r;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function _t(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=i}function vt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-ot(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,Et,At,Tt,Dt=!1,St=[],Ct=null,Pt=null,It=null,kt=new Map,Mt=new Map,Rt=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":kt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Ot(e,t,i,n,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=yr(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Bt(e){var t=vr(e.target);if(null!==t){var i=Ve(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Ge(i)))return e.blockedOn=t,void Tt(e.priority,function(){Et(i)})}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=yr(i))&&wt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);be=n,i.target.dispatchEvent(n),be=null,t.shift()}return!0}function Nt(e,t,i){zt(e)&&i.delete(t)}function Ut(){Dt=!1,null!==Ct&&zt(Ct)&&(Ct=null),null!==Pt&&zt(Pt)&&(Pt=null),null!==It&&zt(It)&&(It=null),kt.forEach(Nt),Mt.forEach(Nt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Dt||(Dt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return jt(t,e)}if(0<St.length){jt(St[0],e);for(var i=1;i<St.length;i++){var n=St[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ct&&jt(Ct,e),null!==Pt&&jt(Pt,e),null!==It&&jt(It,e),kt.forEach(t),Mt.forEach(t),i=0;i<Rt.length;i++)(n=Rt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<Rt.length&&null===(i=Rt[0]).blockedOn;)Bt(i),null===i.blockedOn&&Rt.shift()}var Gt=b.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,i,n){var r=yt,s=Gt.transition;Gt.transition=null;try{yt=1,qt(e,t,i,n)}finally{yt=r,Gt.transition=s}}function Xt(e,t,i,n){var r=yt,s=Gt.transition;Gt.transition=null;try{yt=4,qt(e,t,i,n)}finally{yt=r,Gt.transition=s}}function qt(e,t,i,n){if(Wt){var r=Yt(e,t,i,n);if(null===r)Wn(e,t,n,Zt,i),Lt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return Ct=Ot(Ct,e,t,i,n,r),!0;case"dragenter":return Pt=Ot(Pt,e,t,i,n,r),!0;case"mouseover":return It=Ot(It,e,t,i,n,r),!0;case"pointerover":var s=r.pointerId;return kt.set(s,Ot(kt.get(s)||null,e,t,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Mt.set(s,Ot(Mt.get(s)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Ft.indexOf(e)){for(;null!==r;){var s=yr(r);if(null!==s&&xt(s),null===(s=Yt(e,t,i,n))&&Wn(e,t,n,Zt,i),s===r)break;r=s}null!==r&&n.stopPropagation()}else Wn(e,t,n,null,i)}}var Zt=null;function Yt(e,t,i,n){if(Zt=null,null!==(e=vr(e=xe(n))))if(null===(t=Ve(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Qe:return 1;case et:return 4;case tt:case it:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,$t=null,Qt=null;function ei(){if(Qt)return Qt;var e,t,i=$t,n=i.length,r="value"in Jt?Jt.value:Jt.textContent,s=r.length;for(e=0;e<n&&i[e]===r[e];e++);var o=n-e;for(t=1;t<=o&&i[n-t]===r[s-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function ti(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ii(){return!0}function ni(){return!1}function ri(e){function t(t,i,n,r,s){for(var o in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),t}var si,oi,ai,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ci=ri(li),ui=B({},li,{view:0,detail:0}),hi=ri(ui),di=B({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ai,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ai&&(ai&&"mousemove"===e.type?(si=e.screenX-ai.screenX,oi=e.screenY-ai.screenY):oi=si=0,ai=e),si)},movementY:function(e){return"movementY"in e?e.movementY:oi}}),pi=ri(di),mi=ri(B({},di,{dataTransfer:0})),fi=ri(B({},ui,{relatedTarget:0})),gi=ri(B({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),_i=B({},li,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vi=ri(_i),yi=ri(B({},li,{data:0})),bi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ei(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wi[e])&&!!t[e]}function Ai(){return Ei}var Ti=B({},ui,{key:function(e){if(e.key){var t=bi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ti(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ai,charCode:function(e){return"keypress"===e.type?ti(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ti(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Di=ri(Ti),Si=ri(B({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ci=ri(B({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ai})),Pi=ri(B({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ii=B({},di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ki=ri(Ii),Mi=[9,13,27,32],Ri=u&&"CompositionEvent"in window,Fi=null;u&&"documentMode"in document&&(Fi=document.documentMode);var Li=u&&"TextEvent"in window&&!Fi,Oi=u&&(!Ri||Fi&&8<Fi&&11>=Fi),Bi=String.fromCharCode(32),zi=!1;function Ni(e,t){switch(e){case"keyup":return-1!==Mi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ui(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var ji=!1;var Vi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vi[e.type]:"textarea"===t}function Wi(e,t,i,n){De(n),0<(t=Xn(t,"onChange")).length&&(i=new ci("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Hi=null,Xi=null;function qi(e){zn(e,0)}function Zi(e){if(q(br(e)))return e}function Yi(e,t){if("change"===e)return t}var Ki=!1;if(u){var Ji;if(u){var $i="oninput"in document;if(!$i){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),$i="function"===typeof Qi.oninput}Ji=$i}else Ji=!1;Ki=Ji&&(!document.documentMode||9<document.documentMode)}function en(){Hi&&(Hi.detachEvent("onpropertychange",tn),Xi=Hi=null)}function tn(e){if("value"===e.propertyName&&Zi(Xi)){var t=[];Wi(t,Xi,e,xe(e)),ke(qi,t)}}function nn(e,t,i){"focusin"===e?(en(),Xi=i,(Hi=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zi(Xi)}function sn(e,t){if("click"===e)return Zi(t)}function on(e,t){if("input"===e||"change"===e)return Zi(t)}var an="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(an(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!h.call(t,r)||!an(e[r],t[r]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var i,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=Z((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=dn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&hn(i.ownerDocument.documentElement,i)){if(null!==n&&pn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=void 0===n.end?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=un(i,s);var o=un(i,n);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,_n=null,vn=null,yn=!1;function bn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;yn||null==gn||gn!==Z(n)||("selectionStart"in(n=gn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=Xn(_n,"onSelect")).length&&(t=new ci("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=gn)))}function xn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var wn={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionend:xn("Transition","TransitionEnd")},En={},An={};function Tn(e){if(En[e])return En[e];if(!wn[e])return e;var t,i=wn[e];for(t in i)if(i.hasOwnProperty(t)&&t in An)return En[e]=i[t];return e}u&&(An=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Dn=Tn("animationend"),Sn=Tn("animationiteration"),Cn=Tn("animationstart"),Pn=Tn("transitionend"),In=new Map,kn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mn(e,t){In.set(e,t),l(t,[e])}for(var Rn=0;Rn<kn.length;Rn++){var Fn=kn[Rn];Mn(Fn.toLowerCase(),"on"+(Fn[0].toUpperCase()+Fn.slice(1)))}Mn(Dn,"onAnimationEnd"),Mn(Sn,"onAnimationIteration"),Mn(Cn,"onAnimationStart"),Mn("dblclick","onDoubleClick"),Mn("focusin","onFocus"),Mn("focusout","onBlur"),Mn(Pn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),On=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function Bn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,o,a,l,c){if(je.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=Be;Oe=!1,Be=null,ze||(ze=!0,Ne=u)}}(n,t,void 0,e),e.currentTarget=null}function zn(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Bn(r,a,c),s=l}else for(o=0;o<n.length;o++){if(l=(a=n[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Bn(r,a,c),s=l}}}if(ze)throw e=Ne,ze=!1,Ne=null,e}function Nn(e,t){var i=t[fr];void 0===i&&(i=t[fr]=new Set);var n=e+"__bubble";i.has(n)||(Gn(t,e,2,!1),i.add(n))}function Un(e,t,i){var n=0;t&&(n|=4),Gn(i,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[jn]){e[jn]=!0,o.forEach(function(t){"selectionchange"!==t&&(On.has(t)||Un(t,!1,e),Un(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Un("selectionchange",!1,t))}}function Gn(e,t,i,n){switch(Kt(t)){case 1:var r=Ht;break;case 4:r=Xt;break;default:r=qt}i=r.bind(null,t,i,e),r=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Wn(e,t,i,n,r){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var a=n.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=n.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=vr(a)))return;if(5===(l=o.tag)||6===l){n=s=o;continue e}a=a.parentNode}}n=n.return}ke(function(){var n=s,r=xe(i),o=[];e:{var a=In.get(e);if(void 0!==a){var l=ci,c=e;switch(e){case"keypress":if(0===ti(i))break e;case"keydown":case"keyup":l=Di;break;case"focusin":c="focus",l=fi;break;case"focusout":c="blur",l=fi;break;case"beforeblur":case"afterblur":l=fi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ci;break;case Dn:case Sn:case Cn:l=gi;break;case Pn:l=Pi;break;case"scroll":l=hi;break;case"wheel":l=ki;break;case"copy":case"cut":case"paste":l=vi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Si}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,m=n;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==d&&(null!=(f=Me(m,d))&&u.push(Hn(m,f,p)))),h)break;m=m.return}0<u.length&&(a=new l(a,c,null,i,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||i===be||!(c=i.relatedTarget||i.fromElement)||!vr(c)&&!c[mr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(c=(c=i.relatedTarget||i.toElement)?vr(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=pi,f="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=Si,f="onPointerLeave",d="onPointerEnter",m="pointer"),h=null==l?a:br(l),p=null==c?a:br(c),(a=new u(f,m+"leave",l,i,r)).target=h,a.relatedTarget=p,f=null,vr(r)===n&&((u=new u(d,m+"enter",c,i,r)).target=p,u.relatedTarget=h,f=u),h=f,l&&c)e:{for(d=c,m=0,p=u=l;p;p=qn(p))m++;for(p=0,f=d;f;f=qn(f))p++;for(;0<m-p;)u=qn(u),m--;for(;0<p-m;)d=qn(d),p--;for(;m--;){if(u===d||null!==d&&u===d.alternate)break e;u=qn(u),d=qn(d)}u=null}else u=null;null!==l&&Zn(o,a,l,u,!1),null!==c&&null!==h&&Zn(o,h,c,u,!0)}if("select"===(l=(a=n?br(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yi;else if(Gi(a))if(Ki)g=on;else{g=rn;var _=nn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sn);switch(g&&(g=g(e,n))?Wi(o,g,i,r):(_&&_(e,a,n),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&ee(a,"number",a.value)),_=n?br(n):window,e){case"focusin":(Gi(_)||"true"===_.contentEditable)&&(gn=_,_n=n,vn=null);break;case"focusout":vn=_n=gn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,bn(o,i,r);break;case"selectionchange":if(fn)break;case"keydown":case"keyup":bn(o,i,r)}var v;if(Ri)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ji?Ni(e,i)&&(y="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(y="onCompositionStart");y&&(Oi&&"ko"!==i.locale&&(ji||"onCompositionStart"!==y?"onCompositionEnd"===y&&ji&&(v=ei()):($t="value"in(Jt=r)?Jt.value:Jt.textContent,ji=!0)),0<(_=Xn(n,y)).length&&(y=new yi(y,e,null,i,r),o.push({event:y,listeners:_}),v?y.data=v:null!==(v=Ui(i))&&(y.data=v))),(v=Li?function(e,t){switch(e){case"compositionend":return Ui(t);case"keypress":return 32!==t.which?null:(zi=!0,Bi);case"textInput":return(e=t.data)===Bi&&zi?null:e;default:return null}}(e,i):function(e,t){if(ji)return"compositionend"===e||!Ri&&Ni(e,t)?(e=ei(),Qt=$t=Jt=null,ji=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Oi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Xn(n,"onBeforeInput")).length&&(r=new yi("onBeforeInput","beforeinput",null,i,r),o.push({event:r,listeners:n}),r.data=v))}zn(o,t)})}function Hn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Xn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Me(e,i))&&n.unshift(Hn(e,s,r)),null!=(s=Me(e,t))&&n.push(Hn(e,s,r))),e=e.return}return n}function qn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zn(e,t,i,n,r){for(var s=t._reactName,o=[];null!==i&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Me(i,s))&&o.unshift(Hn(i,l,a)):r||null!=(l=Me(i,s))&&o.push(Hn(i,l,a))),i=i.return}0!==o.length&&e.push({event:t,listeners:o})}var Yn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Kn,"")}function $n(e,t,i){if(t=Jn(t),Jn(e)!==t&&i)throw Error(s(425))}function Qn(){}var er=null,tr=null;function ir(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:nr;function ar(e){setTimeout(function(){throw e})}function lr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Vt(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Vt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,mr="__reactContainer$"+hr,fr="__reactEvents$"+hr,gr="__reactListeners$"+hr,_r="__reactHandles$"+hr;function vr(e){var t=e[dr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[mr]||i[dr]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=ur(e);null!==e;){if(i=e[dr])return i;e=ur(e)}return t}i=(e=i).parentNode}return null}function yr(e){return!(e=e[dr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xr(e){return e[pr]||null}var wr=[],Er=-1;function Ar(e){return{current:e}}function Tr(e){0>Er||(e.current=wr[Er],wr[Er]=null,Er--)}function Dr(e,t){Er++,wr[Er]=e.current,e.current=t}var Sr={},Cr=Ar(Sr),Pr=Ar(!1),Ir=Sr;function kr(e,t){var i=e.type.contextTypes;if(!i)return Sr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in i)s[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Mr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rr(){Tr(Pr),Tr(Cr)}function Fr(e,t,i){if(Cr.current!==Sr)throw Error(s(168));Dr(Cr,t),Dr(Pr,i)}function Lr(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(s(108,G(e)||"Unknown",r));return B({},i,n)}function Or(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sr,Ir=Cr.current,Dr(Cr,e),Dr(Pr,Pr.current),!0}function Br(e,t,i){var n=e.stateNode;if(!n)throw Error(s(169));i?(e=Lr(e,t,Ir),n.__reactInternalMemoizedMergedChildContext=e,Tr(Pr),Tr(Cr),Dr(Cr,e)):Tr(Pr),Dr(Pr,i)}var zr=null,Nr=!1,Ur=!1;function jr(e){null===zr?zr=[e]:zr.push(e)}function Vr(){if(!Ur&&null!==zr){Ur=!0;var e=0,t=yt;try{var i=zr;for(yt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}zr=null,Nr=!1}catch(r){throw null!==zr&&(zr=zr.slice(e+1)),qe(Qe,Vr),r}finally{yt=t,Ur=!1}}return null}var Gr=[],Wr=0,Hr=null,Xr=0,qr=[],Zr=0,Yr=null,Kr=1,Jr="";function $r(e,t){Gr[Wr++]=Xr,Gr[Wr++]=Hr,Hr=e,Xr=t}function Qr(e,t,i){qr[Zr++]=Kr,qr[Zr++]=Jr,qr[Zr++]=Yr,Yr=e;var n=Kr;e=Jr;var r=32-ot(n)-1;n&=~(1<<r),i+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Kr=1<<32-ot(t)+r|i<<r|n,Jr=s+e}else Kr=1<<s|i<<r|n,Jr=e}function es(e){null!==e.return&&($r(e,1),Qr(e,1,0))}function ts(e){for(;e===Hr;)Hr=Gr[--Wr],Gr[Wr]=null,Xr=Gr[--Wr],Gr[Wr]=null;for(;e===Yr;)Yr=qr[--Zr],qr[Zr]=null,Jr=qr[--Zr],qr[Zr]=null,Kr=qr[--Zr],qr[Zr]=null}var is=null,ns=null,rs=!1,ss=null;function os(e,t){var i=kc(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function as(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,is=e,ns=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,is=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==Yr?{id:Kr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=kc(18,null,null,0)).stateNode=t,i.return=e,e.child=i,is=e,ns=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=ns;if(t){var i=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(i.nextSibling);var n=is;t&&as(e,t)?os(n,i):(e.flags=-4097&e.flags|2,rs=!1,is=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,is=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;is=e}function hs(e){if(e!==is)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ir(e.type,e.memoizedProps)),t&&(t=ns)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){ns=cr(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}ns=null}}else ns=is?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=ns;e;)e=cr(e.nextSibling)}function ps(){ns=is=null,rs=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var fs=b.ReactCurrentBatchConfig;function gs(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(s(309));var n=i.stateNode}if(!n)throw Error(s(147,e));var r=n,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!i._owner)throw Error(s(290,e))}return e}function _s(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,i,n){return null===t||6!==t.tag?((t=Bc(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function c(e,t,i,n){var s=i.type;return s===E?h(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===M&&vs(s)===t.type)?((n=r(t,i.props)).ref=gs(e,t,i),n.return=e,n):((n=Fc(i.type,i.key,i.props,null,e.mode,n)).ref=gs(e,t,i),n.return=e,n)}function u(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=zc(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function h(e,t,i,n,s){return null===t||7!==t.tag?((t=Lc(i,e.mode,n,s)).return=e,t):((t=r(t,i)).return=e,t)}function d(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(i=Fc(t.type,t.key,t.props,null,e.mode,i)).ref=gs(e,null,t),i.return=e,i;case w:return(t=zc(t,e.mode,i)).return=e,t;case M:return d(e,(0,t._init)(t._payload),i)}if(te(t)||L(t))return(t=Lc(t,e.mode,i,null)).return=e,t;_s(e,t)}return null}function p(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==r?null:l(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return i.key===r?c(e,t,i,n):null;case w:return i.key===r?u(e,t,i,n):null;case M:return p(e,t,(r=i._init)(i._payload),n)}if(te(i)||L(i))return null!==r?null:h(e,t,i,n,null);_s(e,i)}return null}function m(e,t,i,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case w:return u(t,e=e.get(null===n.key?i:n.key)||null,n,r);case M:return m(e,t,i,(0,n._init)(n._payload),r)}if(te(n)||L(n))return h(t,e=e.get(i)||null,n,r,null);_s(t,n)}return null}function f(r,s,a,l){for(var c=null,u=null,h=s,f=s=0,g=null;null!==h&&f<a.length;f++){h.index>f?(g=h,h=null):g=h.sibling;var _=p(r,h,a[f],l);if(null===_){null===h&&(h=g);break}e&&h&&null===_.alternate&&t(r,h),s=o(_,s,f),null===u?c=_:u.sibling=_,u=_,h=g}if(f===a.length)return i(r,h),rs&&$r(r,f),c;if(null===h){for(;f<a.length;f++)null!==(h=d(r,a[f],l))&&(s=o(h,s,f),null===u?c=h:u.sibling=h,u=h);return rs&&$r(r,f),c}for(h=n(r,h);f<a.length;f++)null!==(g=m(h,r,f,a[f],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?f:g.key),s=o(g,s,f),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(r,e)}),rs&&$r(r,f),c}function g(r,a,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,f=a,g=a=0,_=null,v=l.next();null!==f&&!v.done;g++,v=l.next()){f.index>g?(_=f,f=null):_=f.sibling;var y=p(r,f,v.value,c);if(null===y){null===f&&(f=_);break}e&&f&&null===y.alternate&&t(r,f),a=o(y,a,g),null===h?u=y:h.sibling=y,h=y,f=_}if(v.done)return i(r,f),rs&&$r(r,g),u;if(null===f){for(;!v.done;g++,v=l.next())null!==(v=d(r,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return rs&&$r(r,g),u}for(f=n(r,f);!v.done;g++,v=l.next())null!==(v=m(f,r,g,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&f.forEach(function(e){return t(r,e)}),rs&&$r(r,g),u}return function e(n,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===E){if(7===u.tag){i(n,u.sibling),(s=r(u,o.props.children)).return=n,n=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===M&&vs(c)===u.type){i(n,u.sibling),(s=r(u,o.props)).ref=gs(n,u,o),s.return=n,n=s;break e}i(n,u);break}t(n,u),u=u.sibling}o.type===E?((s=Lc(o.props.children,n.mode,l,o.key)).return=n,n=s):((l=Fc(o.type,o.key,o.props,null,n.mode,l)).ref=gs(n,s,o),l.return=n,n=l)}return a(n);case w:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){i(n,s.sibling),(s=r(s,o.children||[])).return=n,n=s;break e}i(n,s);break}t(n,s),s=s.sibling}(s=zc(o,n.mode,l)).return=n,n=s}return a(n);case M:return e(n,s,(u=o._init)(o._payload),l)}if(te(o))return f(n,s,o,l);if(L(o))return g(n,s,o,l);_s(n,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(i(n,s.sibling),(s=r(s,o)).return=n,n=s):(i(n,s),(s=Bc(o,n.mode,l)).return=n,n=s),a(n)):i(n,s)}}var bs=ys(!0),xs=ys(!1),ws=Ar(null),Es=null,As=null,Ts=null;function Ds(){Ts=As=Es=null}function Ss(e){var t=ws.current;Tr(ws),e._currentValue=t}function Cs(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Ps(e,t){Es=e,Ts=As=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ya=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(Ts!==e)if(e={context:e,memoizedValue:t,next:null},null===As){if(null===Es)throw Error(s(308));As=e,Es.dependencies={lanes:0,firstContext:e}}else As=As.next=e;return t}var ks=null;function Ms(e){null===ks?ks=[e]:ks.push(e)}function Rs(e,t,i,n){var r=t.interleaved;return null===r?(i.next=i,Ms(t)):(i.next=r.next,r.next=i),t.interleaved=i,Fs(e,n)}function Fs(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Ls=!1;function Os(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,i){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Cl)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Fs(e,i)}return null===(r=n.interleaved)?(t.next=t,Ms(n)):(t.next=r.next,r.next=t),n.interleaved=t,Fs(e,i)}function Us(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,vt(e,i)}}function js(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,s=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===s?r=s=o:s=s.next=o,i=i.next}while(null!==i);null===s?r=s=t:s=s.next=t}else r=s=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Vs(e,t,i,n){var r=e.updateQueue;Ls=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=e,f=a;switch(d=t,p=i,f.tag){case 1:if("function"===typeof(m=f.payload)){h=m.call(p,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=f.payload)?m.call(p,h,d):m)||void 0===d)break e;h=B({},h,d);break e;case 2:Ls=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Ol|=o,e.lanes=o,e.memoizedState=h}}function Gs(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(s(191,r));r.call(n)}}}var Ws={},Hs=Ar(Ws),Xs=Ar(Ws),qs=Ar(Ws);function Zs(e){if(e===Ws)throw Error(s(174));return e}function Ys(e,t){switch(Dr(qs,t),Dr(Xs,e),Dr(Hs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Tr(Hs),Dr(Hs,t)}function Ks(){Tr(Hs),Tr(Xs),Tr(qs)}function Js(e){Zs(qs.current);var t=Zs(Hs.current),i=le(t,e.type);t!==i&&(Dr(Xs,e),Dr(Hs,i))}function $s(e){Xs.current===e&&(Tr(Hs),Tr(Xs))}var Qs=Ar(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function io(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var no=b.ReactCurrentDispatcher,ro=b.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,po=0;function mo(){throw Error(s(321))}function fo(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!an(e[i],t[i]))return!1;return!0}function go(e,t,i,n,r,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=null===e||null===e.memoizedState?Qo:ea,e=i(n,r),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,no.current=ta,e=i(n,r)}while(uo)}if(no.current=$o,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function _o(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function yo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function bo(e,t){return"function"===typeof t?t(e):t}function xo(e){var t=yo(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=ao,r=n.baseQueue,o=i.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}n.baseQueue=r=o,i.pending=null}if(null!==r){o=r.next,n=n.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((so&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=n):c=c.next=d,oo.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==o);null===c?a=n:c.next=l,an(n,t.memoizedState)||(ya=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,Ol|=o,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function wo(e){var t=yo(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,o=t.memoizedState;if(null!==r){i.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);an(o,t.memoizedState)||(ya=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,n]}function Eo(){}function Ao(e,t){var i=oo,n=yo(),r=t(),o=!an(n.memoizedState,r);if(o&&(n.memoizedState=r,ya=!0),n=n.queue,Oo(So.bind(null,i,n,e),[e]),n.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(i.flags|=2048,ko(9,Do.bind(null,i,n,r,t),void 0,null),null===Pl)throw Error(s(349));0!==(30&so)||To(i,t,r)}return r}function To(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Do(e,t,i,n){t.value=i,t.getSnapshot=n,Co(t)&&Po(e)}function So(e,t,i){return i(function(){Co(t)&&Po(e)})}function Co(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!an(e,i)}catch(n){return!0}}function Po(e){var t=Fs(e,1);null!==t&&ic(t,e,1,-1)}function Io(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Zo.bind(null,oo,e),[t.memoizedState,e]}function ko(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function Mo(){return yo().memoizedState}function Ro(e,t,i,n){var r=vo();oo.flags|=e,r.memoizedState=ko(1|t,i,void 0,void 0===n?null:n)}function Fo(e,t,i,n){var r=yo();n=void 0===n?null:n;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==n&&fo(n,o.deps))return void(r.memoizedState=ko(t,i,s,n))}oo.flags|=e,r.memoizedState=ko(1|t,i,s,n)}function Lo(e,t){return Ro(8390656,8,e,t)}function Oo(e,t){return Fo(2048,8,e,t)}function Bo(e,t){return Fo(4,2,e,t)}function zo(e,t){return Fo(4,4,e,t)}function No(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Fo(4,4,No.bind(null,t,e),i)}function jo(){}function Vo(e,t){var i=yo();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&fo(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Go(e,t){var i=yo();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&fo(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Wo(e,t,i){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ya=!0),e.memoizedState=i):(an(i,t)||(i=ft(),oo.lanes|=i,Ol|=i,e.baseState=!0),t)}function Ho(e,t){var i=yt;yt=0!==i&&4>i?i:4,e(!0);var n=ro.transition;ro.transition={};try{e(!1),t()}finally{yt=i,ro.transition=n}}function Xo(){return yo().memoizedState}function qo(e,t,i){var n=tc(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Yo(e))Ko(t,i);else if(null!==(i=Rs(e,t,i,n))){ic(i,e,n,ec()),Jo(i,t,n)}}function Zo(e,t,i){var n=tc(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))Ko(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,i);if(r.hasEagerState=!0,r.eagerState=a,an(a,o)){var l=t.interleaved;return null===l?(r.next=r,Ms(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(i=Rs(e,t,r,n))&&(ic(i,e,n,r=ec()),Jo(i,t,n))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Ko(e,t){uo=co=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Jo(e,t,i){if(0!==(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,vt(e,i)}}var $o={readContext:Is,useCallback:mo,useContext:mo,useEffect:mo,useImperativeHandle:mo,useInsertionEffect:mo,useLayoutEffect:mo,useMemo:mo,useReducer:mo,useRef:mo,useState:mo,useDebugValue:mo,useDeferredValue:mo,useTransition:mo,useMutableSource:mo,useSyncExternalStore:mo,useId:mo,unstable_isNewReconciler:!1},Qo={readContext:Is,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Lo,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Ro(4194308,4,No.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Ro(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ro(4,2,e,t)},useMemo:function(e,t){var i=vo();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=vo();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=qo.bind(null,oo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Io,useDebugValue:jo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=Ho.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=oo,r=vo();if(rs){if(void 0===i)throw Error(s(407));i=i()}else{if(i=t(),null===Pl)throw Error(s(349));0!==(30&so)||To(n,t,i)}r.memoizedState=i;var o={value:i,getSnapshot:t};return r.queue=o,Lo(So.bind(null,n,o,e),[e]),n.flags|=2048,ko(9,Do.bind(null,n,o,i,t),void 0,null),i},useId:function(){var e=vo(),t=Pl.identifierPrefix;if(rs){var i=Jr;t=":"+t+"R"+(i=(Kr&~(1<<32-ot(Kr)-1)).toString(32)+i),0<(i=ho++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Is,useCallback:Vo,useContext:Is,useEffect:Oo,useImperativeHandle:Uo,useInsertionEffect:Bo,useLayoutEffect:zo,useMemo:Go,useReducer:xo,useRef:Mo,useState:function(){return xo(bo)},useDebugValue:jo,useDeferredValue:function(e){return Wo(yo(),ao.memoizedState,e)},useTransition:function(){return[xo(bo)[0],yo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Ao,useId:Xo,unstable_isNewReconciler:!1},ta={readContext:Is,useCallback:Vo,useContext:Is,useEffect:Oo,useImperativeHandle:Uo,useInsertionEffect:Bo,useLayoutEffect:zo,useMemo:Go,useReducer:wo,useRef:Mo,useState:function(){return wo(bo)},useDebugValue:jo,useDeferredValue:function(e){var t=yo();return null===ao?t.memoizedState=e:Wo(t,ao.memoizedState,e)},useTransition:function(){return[wo(bo)[0],yo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Ao,useId:Xo,unstable_isNewReconciler:!1};function ia(e,t){if(e&&e.defaultProps){for(var i in t=B({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}function na(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:B({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=ec(),r=tc(e),s=zs(n,r);s.payload=t,void 0!==i&&null!==i&&(s.callback=i),null!==(t=Ns(e,s,r))&&(ic(t,e,r,n),Us(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=ec(),r=tc(e),s=zs(n,r);s.tag=1,s.payload=t,void 0!==i&&null!==i&&(s.callback=i),null!==(t=Ns(e,s,r))&&(ic(t,e,r,n),Us(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ec(),n=tc(e),r=zs(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ns(e,r,n))&&(ic(t,e,n,i),Us(t,e,n))}};function sa(e,t,i,n,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!ln(i,n)||!ln(r,s))}function oa(e,t,i){var n=!1,r=Sr,s=t.contextType;return"object"===typeof s&&null!==s?s=Is(s):(r=Mr(t)?Ir:Cr.current,s=(n=null!==(n=t.contextTypes)&&void 0!==n)?kr(e,r):Sr),t=new t(i,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function la(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs={},Os(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Is(s):(s=Mr(t)?Ir:Cr.current,r.context=kr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(na(e,t,s,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),Vs(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var i="",n=t;do{i+=j(n),n=n.return}while(n);var r=i}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var da="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,i){(i=zs(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Wl||(Wl=!0,Hl=n),ha(0,t)},i}function ma(e,t,i){(i=zs(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(i.callback=function(){ha(0,t),"function"!==typeof n&&(null===Xl?Xl=new Set([this]):Xl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function fa(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new da;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=Tc.bind(null,e,t,i),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _a(e,t,i,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=zs(-1,1)).tag=2,Ns(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var va=b.ReactCurrentOwner,ya=!1;function ba(e,t,i,n){t.child=null===e?xs(t,null,i,n):bs(t,e.child,i,n)}function xa(e,t,i,n,r){i=i.render;var s=t.ref;return Ps(t,r),n=go(e,t,i,n,s,r),i=_o(),null===e||ya?(rs&&i&&es(t),t.flags|=1,ba(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function wa(e,t,i,n,r){if(null===e){var s=i.type;return"function"!==typeof s||Mc(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Fc(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ea(e,t,s,n,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(o,n)&&e.ref===t.ref)return Wa(e,t,r)}return t.flags|=1,(e=Rc(s,n)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,i,n,r){if(null!==e){var s=e.memoizedProps;if(ln(s,n)&&e.ref===t.ref){if(ya=!1,t.pendingProps=n=s,0===(e.lanes&r))return t.lanes=e.lanes,Wa(e,t,r);0!==(131072&e.flags)&&(ya=!0)}}return Da(e,t,i,n,r)}function Aa(e,t,i){var n=t.pendingProps,r=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(Rl,Ml),Ml|=i;else{if(0===(1073741824&i))return e=null!==s?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(Rl,Ml),Ml|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:i,Dr(Rl,Ml),Ml|=n}else null!==s?(n=s.baseLanes|i,t.memoizedState=null):n=i,Dr(Rl,Ml),Ml|=n;return ba(e,t,r,i),t.child}function Ta(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Da(e,t,i,n,r){var s=Mr(i)?Ir:Cr.current;return s=kr(t,s),Ps(t,r),i=go(e,t,i,n,s,r),n=_o(),null===e||ya?(rs&&n&&es(t),t.flags|=1,ba(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wa(e,t,r))}function Sa(e,t,i,n,r){if(Mr(i)){var s=!0;Or(t)}else s=!1;if(Ps(t,r),null===t.stateNode)Ga(e,t),oa(t,i,n),la(t,i,n,r),n=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=i.contextType;"object"===typeof c&&null!==c?c=Is(c):c=kr(t,c=Mr(i)?Ir:Cr.current);var u=i.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==n||l!==c)&&aa(t,o,n,c),Ls=!1;var d=t.memoizedState;o.state=d,Vs(t,n,o,r),l=t.memoizedState,a!==n||d!==l||Pr.current||Ls?("function"===typeof u&&(na(t,i,u,n),l=t.memoizedState),(a=Ls||sa(t,i,a,n,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Bs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ia(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=i.contextType)&&null!==l?l=Is(l):l=kr(t,l=Mr(i)?Ir:Cr.current);var p=i.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,n,l),Ls=!1,d=t.memoizedState,o.state=d,Vs(t,n,o,r);var m=t.memoizedState;a!==h||d!==m||Pr.current||Ls?("function"===typeof p&&(na(t,i,p,n),m=t.memoizedState),(c=Ls||sa(t,i,c,n,d,m,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,m,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,m,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=l,n=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Ca(e,t,i,n,s,r)}function Ca(e,t,i,n,r,s){Ta(e,t);var o=0!==(128&t.flags);if(!n&&!o)return r&&Br(t,i,!1),Wa(e,t,s);n=t.stateNode,va.current=t;var a=o&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,a,s)):ba(e,t,a,s),t.memoizedState=n.state,r&&Br(t,i,!0),t.child}function Pa(e){var t=e.stateNode;t.pendingContext?Fr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fr(0,t.context,!1),Ys(e,t.containerInfo)}function Ia(e,t,i,n,r){return ps(),ms(r),t.flags|=256,ba(e,t,i,n),t.child}var ka,Ma,Ra,Fa,La={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,i){var n,r=t.pendingProps,o=Qs.current,a=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Dr(Qs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Oc(l,r,0,null),e=Lc(e,r,i,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Oa(i),t.memoizedState=La,e):za(t,l));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return function(e,t,i,n,r,o,a){if(i)return 256&t.flags?(t.flags&=-257,Na(e,t,a,n=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,r=t.mode,n=Oc({mode:"visible",children:n.children},r,0,null),(o=Lc(o,r,a,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,0!==(1&t.mode)&&bs(t,e.child,null,a),t.child.memoizedState=Oa(a),t.memoizedState=La,o);if(0===(1&t.mode))return Na(e,t,a,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Na(e,t,a,n=ua(o=Error(s(419)),n,void 0))}if(l=0!==(a&e.childLanes),ya||l){if(null!==(n=Pl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Fs(e,r),ic(n,e,r,-1))}return fc(),Na(e,t,a,n=ua(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,ns=cr(r.nextSibling),is=t,rs=!0,ss=null,null!==e&&(qr[Zr++]=Kr,qr[Zr++]=Jr,qr[Zr++]=Yr,Kr=e.id,Jr=e.overflow,Yr=t),t=za(t,n.children),t.flags|=4096,t)}(e,t,l,r,n,o,i);if(a){a=r.fallback,l=t.mode,n=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==n?a=Rc(n,a):(a=Lc(a,l,i,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Oa(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~i,t.memoizedState=La,r}return e=(a=e.child).sibling,r=Rc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=i),r.return=t,r.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r}function za(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Na(e,t,i,n){return null!==n&&ms(n),bs(t,e.child,null,i),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Cs(e.return,t,i)}function ja(e,t,i,n,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function Va(e,t,i){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(ba(e,t,n.children,i),0!==(2&(n=Qs.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,i,t);else if(19===e.tag)Ua(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Dr(Qs,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===eo(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),ja(t,!1,r,i,s);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}ja(t,!0,i,null,s);break;case"together":ja(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ga(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(i=Rc(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Rc(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ha(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function qa(e,t,i){var n=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(t),null;case 1:case 17:return Mr(t.type)&&Rr(),Xa(t),null;case 3:return n=t.stateNode,Ks(),Tr(Pr),Tr(Cr),io(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ma(e,t),Xa(t),null;case 5:$s(t);var r=Zs(qs.current);if(i=t.type,null!==e&&null!=t.stateNode)Ra(e,t,i,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(s(166));return Xa(t),null}if(e=Zs(Hs.current),hs(t)){n=t.stateNode,i=t.type;var o=t.memoizedProps;switch(n[dr]=t,n[pr]=o,e=0!==(1&t.mode),i){case"dialog":Nn("cancel",n),Nn("close",n);break;case"iframe":case"object":case"embed":Nn("load",n);break;case"video":case"audio":for(r=0;r<Ln.length;r++)Nn(Ln[r],n);break;case"source":Nn("error",n);break;case"img":case"image":case"link":Nn("error",n),Nn("load",n);break;case"details":Nn("toggle",n);break;case"input":K(n,o),Nn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Nn("invalid",n);break;case"textarea":re(n,o),Nn("invalid",n)}for(var l in ve(i,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==o.suppressHydrationWarning&&$n(n.textContent,c,e),r=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&$n(n.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Nn("scroll",n)}switch(i){case"input":X(n),Q(n,o,!0);break;case"textarea":X(n),oe(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Qn)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(i,{is:n.is}):(e=l.createElement(i),"select"===i&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,i),e[dr]=t,e[pr]=n,ka(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(i,n),i){case"dialog":Nn("cancel",e),Nn("close",e),r=n;break;case"iframe":case"object":case"embed":Nn("load",e),r=n;break;case"video":case"audio":for(r=0;r<Ln.length;r++)Nn(Ln[r],e);r=n;break;case"source":Nn("error",e),r=n;break;case"img":case"image":case"link":Nn("error",e),Nn("load",e),r=n;break;case"details":Nn("toggle",e),r=n;break;case"input":K(e,n),r=Y(e,n),Nn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=B({},n,{value:void 0}),Nn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),Nn("invalid",e)}for(o in ve(i,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==i||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Nn("scroll",e):null!=u&&y(e,o,u,l))}switch(i){case"input":X(e),Q(e,n,!1);break;case"textarea":X(e),oe(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?ie(e,!!n.multiple,o,!1):null!=n.defaultValue&&ie(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xa(t),null;case 6:if(e&&null!=t.stateNode)Fa(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));if(i=Zs(qs.current),Zs(Hs.current),hs(t)){if(n=t.stateNode,i=t.memoizedProps,n[dr]=t,(o=n.nodeValue!==i)&&null!==(e=is))switch(e.tag){case 3:$n(n.nodeValue,i,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$n(n.nodeValue,i,0!==(1&e.mode))}o&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[dr]=t,t.stateNode=n}return Xa(t),null;case 13:if(Tr(Qs),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,o=!1;else if(o=hs(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xa(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=i,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qs.current)?0===Fl&&(Fl=3):fc())),null!==t.updateQueue&&(t.flags|=4),Xa(t),null);case 4:return Ks(),Ma(e,t),null===e&&Vn(t.stateNode.containerInfo),Xa(t),null;case 10:return Ss(t.type._context),Xa(t),null;case 19:if(Tr(Qs),null===(o=t.memoizedState))return Xa(t),null;if(n=0!==(128&t.flags),null===(l=o.rendering))if(n)Ha(o,!1);else{if(0!==Fl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ha(o,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(o=i).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Dr(Qs,1&Qs.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Vl&&(t.flags|=128,n=!0,Ha(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=eo(l))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Ha(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Xa(t),null}else 2*Je()-o.renderingStartTime>Vl&&1073741824!==i&&(t.flags|=128,n=!0,Ha(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=o.last)?i.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,i=Qs.current,Dr(Qs,n?1&i|2:1&i),t):(Xa(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ml)&&(Xa(t),6&t.subtreeFlags&&(t.flags|=8192)):Xa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Za(e,t){switch(ts(t),t.tag){case 1:return Mr(t.type)&&Rr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ks(),Tr(Pr),Tr(Cr),io(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $s(t),null;case 13:if(Tr(Qs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Tr(Qs),null;case 4:return Ks(),null;case 10:return Ss(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}ka=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Ma=function(){},Ra=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Zs(Hs.current);var s,o=null;switch(i){case"input":r=Y(e,r),n=Y(e,n),o=[];break;case"select":r=B({},r,{value:void 0}),n=B({},n,{value:void 0}),o=[];break;case"textarea":r=ne(e,r),n=ne(e,n),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=Qn)}for(u in ve(i,n),i=null,r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=r?r[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(i||(i={}),i[s]=c[s])}else i||(o||(o=[]),o.push(u,i)),i=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Nn("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}i&&(o=o||[]).push("style",i);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Fa=function(e,t,i,n){i!==n&&(t.flags|=4)};var Ya=!1,Ka=!1,Ja="function"===typeof WeakSet?WeakSet:Set,$a=null;function Qa(e,t){var i=e.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Ac(e,t,n)}else i.current=null}function el(e,t,i){try{i()}catch(n){Ac(e,t,n)}}var tl=!1;function il(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,i,s)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[fr],delete t[gr],delete t[_r])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Qn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,i),e=e.sibling;null!==e;)ll(e,t,i),e=e.sibling}function cl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,i),e=e.sibling;null!==e;)cl(e,t,i),e=e.sibling}var ul=null,hl=!1;function dl(e,t,i){for(i=i.child;null!==i;)pl(e,t,i),i=i.sibling}function pl(e,t,i){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,i)}catch(a){}switch(i.tag){case 5:Ka||Qa(i,t);case 6:var n=ul,r=hl;ul=null,dl(e,t,i),hl=r,null!==(ul=n)&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?e.parentNode.removeChild(i):e.removeChild(i)):ul.removeChild(i.stateNode));break;case 18:null!==ul&&(hl?(e=ul,i=i.stateNode,8===e.nodeType?lr(e.parentNode,i):1===e.nodeType&&lr(e,i),Vt(e)):lr(ul,i.stateNode));break;case 4:n=ul,r=hl,ul=i.stateNode.containerInfo,hl=!0,dl(e,t,i),ul=n,hl=r;break;case 0:case 11:case 14:case 15:if(!Ka&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(i,t,o),r=r.next}while(r!==n)}dl(e,t,i);break;case 1:if(!Ka&&(Qa(i,t),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){Ac(i,t,a)}dl(e,t,i);break;case 21:dl(e,t,i);break;case 22:1&i.mode?(Ka=(n=Ka)||null!==i.memoizedState,dl(e,t,i),Ka=n):dl(e,t,i);break;default:dl(e,t,i)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Ja),t.forEach(function(t){var n=Cc.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))})}}function fl(e,t){var i=t.deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));pl(o,a,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Ac(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),_l(e),4&n){try{il(3,e,e.return),nl(3,e)}catch(g){Ac(e,e.return,g)}try{il(5,e,e.return)}catch(g){Ac(e,e.return,g)}}break;case 1:fl(t,e),_l(e),512&n&&null!==i&&Qa(i,i.return);break;case 5:if(fl(t,e),_l(e),512&n&&null!==i&&Qa(i,i.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Ac(e,e.return,g)}}if(4&n&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==i?i.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(r,o),ye(l,a);var u=ye(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):y(r,h,d,u)}switch(l){case"input":$(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var m=o.value;null!=m?ie(r,!!o.multiple,m,!1):p!==!!o.multiple&&(null!=o.defaultValue?ie(r,!!o.multiple,o.defaultValue,!0):ie(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(g){Ac(e,e.return,g)}}break;case 6:if(fl(t,e),_l(e),4&n){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Ac(e,e.return,g)}}break;case 3:if(fl(t,e),_l(e),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Ac(e,e.return,g)}break;case 4:default:fl(t,e),_l(e);break;case 13:fl(t,e),_l(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(jl=Je())),4&n&&ml(e);break;case 22:if(h=null!==i&&null!==i.memoizedState,1&e.mode?(Ka=(u=Ka)||h,fl(t,e),Ka=u):fl(t,e),_l(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for($a=e,h=e.child;null!==h;){for(d=$a=h;null!==$a;){switch(m=(p=$a).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:Qa(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){n=p,i=p.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Ac(n,i,g)}}break;case 5:Qa(p,p.return);break;case 22:if(null!==p.memoizedState){xl(d);continue}}null!==m?(m.return=p,$a=m):xl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",a))}catch(g){Ac(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Ac(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:fl(t,e),_l(e),4&n&&ml(e);case 21:}}function _l(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(ol(i)){var n=i;break e}i=i.return}throw Error(s(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(de(r,""),n.flags&=-33),cl(e,al(e),r);break;case 3:case 4:var o=n.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Ac(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,i){$a=e,yl(e,t,i)}function yl(e,t,i){for(var n=0!==(1&e.mode);null!==$a;){var r=$a,s=r.child;if(22===r.tag&&n){var o=null!==r.memoizedState||Ya;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ka;a=Ya;var c=Ka;if(Ya=o,(Ka=l)&&!c)for($a=r;null!==$a;)l=(o=$a).child,22===o.tag&&null!==o.memoizedState?wl(r):null!==l?(l.return=o,$a=l):wl(r);for(;null!==s;)$a=s,yl(s,t,i),s=s.sibling;$a=r,Ya=a,Ka=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,$a=s):bl(e)}}function bl(e){for(;null!==$a;){var t=$a;if(0!==(8772&t.flags)){var i=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ka||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ka)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:ia(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Gs(t,o,n);break;case 3:var a=t.updateQueue;if(null!==a){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}Gs(t,a,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&i.focus();break;case"img":c.src&&(i.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(s(163))}Ka||512&t.flags&&rl(t)}catch(p){Ac(t,t.return,p)}}if(t===e){$a=null;break}if(null!==(i=t.sibling)){i.return=t.return,$a=i;break}$a=t.return}}function xl(e){for(;null!==$a;){var t=$a;if(t===e){$a=null;break}var i=t.sibling;if(null!==i){i.return=t.return,$a=i;break}$a=t.return}}function wl(e){for(;null!==$a;){var t=$a;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{nl(4,t)}catch(l){Ac(t,i,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(l){Ac(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Ac(t,s,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Ac(t,o,l)}}}catch(l){Ac(t,t.return,l)}if(t===e){$a=null;break}var a=t.sibling;if(null!==a){a.return=t.return,$a=a;break}$a=t.return}}var El,Al=Math.ceil,Tl=b.ReactCurrentDispatcher,Dl=b.ReactCurrentOwner,Sl=b.ReactCurrentBatchConfig,Cl=0,Pl=null,Il=null,kl=0,Ml=0,Rl=Ar(0),Fl=0,Ll=null,Ol=0,Bl=0,zl=0,Nl=null,Ul=null,jl=0,Vl=1/0,Gl=null,Wl=!1,Hl=null,Xl=null,ql=!1,Zl=null,Yl=0,Kl=0,Jl=null,$l=-1,Ql=0;function ec(){return 0!==(6&Cl)?Je():-1!==$l?$l:$l=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==kl?kl&-kl:null!==fs.transition?(0===Ql&&(Ql=ft()),Ql):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function ic(e,t,i,n){if(50<Kl)throw Kl=0,Jl=null,Error(s(185));_t(e,i,n),0!==(2&Cl)&&e===Pl||(e===Pl&&(0===(2&Cl)&&(Bl|=i),4===Fl&&ac(e,kl)),nc(e,n),1===i&&0===Cl&&0===(1&t.mode)&&(Vl=Je()+500,Nr&&Vr()))}function nc(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&i)&&0===(a&n)||(r[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var n=dt(e,e===Pl?kl:0);if(0===n)null!==i&&Ze(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=i&&Ze(i),1===t)0===e.tag?function(e){Nr=!0,jr(e)}(lc.bind(null,e)):jr(lc.bind(null,e)),or(function(){0===(6&Cl)&&Vr()}),i=null;else{switch(bt(n)){case 1:i=Qe;break;case 4:i=et;break;case 16:default:i=tt;break;case 536870912:i=nt}i=Pc(i,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function rc(e,t){if($l=-1,Ql=0,0!==(6&Cl))throw Error(s(327));var i=e.callbackNode;if(wc()&&e.callbackNode!==i)return null;var n=dt(e,e===Pl?kl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var r=Cl;Cl|=2;var o=mc();for(Pl===e&&kl===t||(Gl=null,Vl=Je()+500,dc(e,t));;)try{vc();break}catch(l){pc(e,l)}Ds(),Tl.current=o,Cl=r,null!==Il?t=0:(Pl=null,kl=0,t=Fl)}if(0!==t){if(2===t&&(0!==(r=mt(e))&&(n=r,t=sc(e,r))),1===t)throw i=Ll,dc(e,0),ac(e,n),nc(e,Je()),i;if(6===t)ac(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!an(s(),r))return!1}catch(a){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,n))&&(0!==(o=mt(e))&&(n=o,t=sc(e,o))),1===t))throw i=Ll,dc(e,0),ac(e,n),nc(e,Je()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Ul,Gl);break;case 3:if(ac(e,n),(130023424&n)===n&&10<(t=jl+500-Je())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(xc.bind(null,e,Ul,Gl),t);break}xc(e,Ul,Gl);break;case 4:if(ac(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var a=31-ot(n);o=1<<a,(a=t[a])>r&&(r=a),n&=~o}if(n=r,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Al(n/1960))-n)){e.timeoutHandle=nr(xc.bind(null,e,Ul,Gl),n);break}xc(e,Ul,Gl);break;default:throw Error(s(329))}}}return nc(e,Je()),e.callbackNode===i?rc.bind(null,e):null}function sc(e,t){var i=Nl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=i,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function ac(e,t){for(t&=~zl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-ot(t),n=1<<i;e[i]=-1,t&=~n}}function lc(e){if(0!==(6&Cl))throw Error(s(327));wc();var t=dt(e,0);if(0===(1&t))return nc(e,Je()),null;var i=gc(e,t);if(0!==e.tag&&2===i){var n=mt(e);0!==n&&(t=n,i=sc(e,n))}if(1===i)throw i=Ll,dc(e,0),ac(e,t),nc(e,Je()),i;if(6===i)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Ul,Gl),nc(e,Je()),null}function cc(e,t){var i=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=i)&&(Vl=Je()+500,Nr&&Vr())}}function uc(e){null!==Zl&&0===Zl.tag&&0===(6&Cl)&&wc();var t=Cl;Cl|=1;var i=Sl.transition,n=yt;try{if(Sl.transition=null,yt=1,e)return e()}finally{yt=n,Sl.transition=i,0===(6&(Cl=t))&&Vr()}}function hc(){Ml=Rl.current,Tr(Rl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,rr(i)),null!==Il)for(i=Il.return;null!==i;){var n=i;switch(ts(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Rr();break;case 3:Ks(),Tr(Pr),Tr(Cr),io();break;case 5:$s(n);break;case 4:Ks();break;case 13:case 19:Tr(Qs);break;case 10:Ss(n.type._context);break;case 22:case 23:hc()}i=i.return}if(Pl=e,Il=e=Rc(e.current,null),kl=Ml=t,Fl=0,Ll=null,zl=Bl=Ol=0,Ul=Nl=null,null!==ks){for(t=0;t<ks.length;t++)if(null!==(n=(i=ks[t]).interleaved)){i.interleaved=null;var r=n.next,s=i.pending;if(null!==s){var o=s.next;s.next=r,n.next=o}i.pending=n}ks=null}return e}function pc(e,t){for(;;){var i=Il;try{if(Ds(),no.current=$o,co){for(var n=oo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,Dl.current=null,null===i||null===i.return){Fl=1,Ll=t,Il=null;break}e:{var o=e,a=i.return,l=i,c=t;if(t=kl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=ga(a);if(null!==m){m.flags&=-257,_a(m,a,l,0,t),1&m.mode&&fa(o,u,t),c=u;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fa(o,u,t),fc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var _=ga(a);if(null!==_){0===(65536&_.flags)&&(_.flags|=256),_a(_,a,l,0,t),ms(ca(c,l));break e}}o=c=ca(c,l),4!==Fl&&(Fl=2),null===Nl?Nl=[o]:Nl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,js(o,pa(0,c,t));break e;case 1:l=c;var v=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Xl||!Xl.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,js(o,ma(o,l,t));break e}}o=o.return}while(null!==o)}bc(i)}catch(b){t=b,Il===i&&null!==i&&(Il=i=i.return);continue}break}}function mc(){var e=Tl.current;return Tl.current=$o,null===e?$o:e}function fc(){0!==Fl&&3!==Fl&&2!==Fl||(Fl=4),null===Pl||0===(268435455&Ol)&&0===(268435455&Bl)||ac(Pl,kl)}function gc(e,t){var i=Cl;Cl|=2;var n=mc();for(Pl===e&&kl===t||(Gl=null,dc(e,t));;)try{_c();break}catch(r){pc(e,r)}if(Ds(),Cl=i,Tl.current=n,null!==Il)throw Error(s(261));return Pl=null,kl=0,Fl}function _c(){for(;null!==Il;)yc(Il)}function vc(){for(;null!==Il&&!Ye();)yc(Il)}function yc(e){var t=El(e.alternate,e,Ml);e.memoizedProps=e.pendingProps,null===t?bc(e):Il=t,Dl.current=null}function bc(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(i=qa(i,t,Ml)))return void(Il=i)}else{if(null!==(i=Za(i,t)))return i.flags&=32767,void(Il=i);if(null===e)return Fl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Fl&&(Fl=5)}function xc(e,t,i){var n=yt,r=Sl.transition;try{Sl.transition=null,yt=1,function(e,t,i,n){do{wc()}while(null!==Zl);if(0!==(6&Cl))throw Error(s(327));i=e.finishedWork;var r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-ot(i),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~s}}(e,o),e===Pl&&(Il=Pl=null,kl=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||ql||(ql=!0,Pc(tt,function(){return wc(),null})),o=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||o){o=Sl.transition,Sl.transition=null;var a=yt;yt=1;var l=Cl;Cl|=4,Dl.current=null,function(e,t){if(er=Wt,pn(e=dn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{i.nodeType,o.nodeType}catch(x){i=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var m;d!==i||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==n&&3!==d.nodeType||(c=a+n),3===d.nodeType&&(a+=d.nodeValue.length),null!==(m=d.firstChild);)p=d,d=m;for(;;){if(d===e)break t;if(p===i&&++u===r&&(l=a),p===o&&++h===n&&(c=a),null!==(m=d.nextSibling))break;p=(d=p).parentNode}d=m}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:e,selectionRange:i},Wt=!1,$a=t;null!==$a;)if(e=(t=$a).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$a=e;else for(;null!==$a;){t=$a;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,_=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ia(t.type,g),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(x){Ac(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,$a=e;break}$a=t.return}f=tl,tl=!1}(e,i),gl(i,e),mn(tr),Wt=!!er,tr=er=null,e.current=i,vl(i,e,r),Ke(),Cl=l,yt=a,Sl.transition=o}else e.current=i;if(ql&&(ql=!1,Zl=e,Yl=r),o=e.pendingLanes,0===o&&(Xl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),nc(e,Je()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)r=t[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Hl,Hl=null,e;0!==(1&Yl)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===Jl?Kl++:(Kl=0,Jl=e):Kl=0,Vr()}(e,t,i,n)}finally{Sl.transition=r,yt=n}return null}function wc(){if(null!==Zl){var e=bt(Yl),t=Sl.transition,i=yt;try{if(Sl.transition=null,yt=16>e?16:e,null===Zl)var n=!1;else{if(e=Zl,Zl=null,Yl=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,$a=e.current;null!==$a;){var o=$a,a=o.child;if(0!==(16&$a.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($a=u;null!==$a;){var h=$a;switch(h.tag){case 0:case 11:case 15:il(8,h,o)}var d=h.child;if(null!==d)d.return=h,$a=d;else for(;null!==$a;){var p=(h=$a).sibling,m=h.return;if(sl(h),h===u){$a=null;break}if(null!==p){p.return=m,$a=p;break}$a=m}}}var f=o.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}$a=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,$a=a;else e:for(;null!==$a;){if(0!==(2048&(o=$a).flags))switch(o.tag){case 0:case 11:case 15:il(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,$a=v;break e}$a=o.return}}var y=e.current;for($a=y;null!==$a;){var b=(a=$a).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,$a=b;else e:for(a=y;null!==$a;){if(0!==(2048&(l=$a).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){Ac(l,l.return,w)}if(l===a){$a=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,$a=x;break e}$a=l.return}}if(Cl=r,Vr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(w){}n=!0}return n}finally{yt=i,Sl.transition=t}}return!1}function Ec(e,t,i){e=Ns(e,t=pa(0,t=ca(i,t),1),1),t=ec(),null!==e&&(_t(e,1,t),nc(e,t))}function Ac(e,t,i){if(3===e.tag)Ec(e,e,i);else for(;null!==t;){if(3===t.tag){Ec(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Xl||!Xl.has(n))){t=Ns(t,e=ma(t,e=ca(i,e),1),1),e=ec(),null!==t&&(_t(t,1,e),nc(t,e));break}}t=t.return}}function Tc(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&i,Pl===e&&(kl&i)===i&&(4===Fl||3===Fl&&(130023424&kl)===kl&&500>Je()-jl?dc(e,0):zl|=i),nc(e,t)}function Dc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var i=ec();null!==(e=Fs(e,t))&&(_t(e,t,i),nc(e,i))}function Sc(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),Dc(e,i)}function Cc(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(s(314))}null!==n&&n.delete(t),Dc(e,i)}function Pc(e,t){return qe(e,t)}function Ic(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kc(e,t,i,n){return new Ic(e,t,i,n)}function Mc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var i=e.alternate;return null===i?((i=kc(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Fc(e,t,i,n,r,o){var a=2;if(n=e,"function"===typeof e)Mc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Lc(i.children,r,o,t);case A:a=8,r|=8;break;case T:return(e=kc(12,i,t,2|r)).elementType=T,e.lanes=o,e;case P:return(e=kc(13,i,t,r)).elementType=P,e.lanes=o,e;case I:return(e=kc(19,i,t,r)).elementType=I,e.lanes=o,e;case R:return Oc(i,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case D:a=10;break e;case S:a=9;break e;case C:a=11;break e;case k:a=14;break e;case M:a=16,n=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=kc(a,i,t,r)).elementType=e,t.type=n,t.lanes=o,t}function Lc(e,t,i,n){return(e=kc(7,e,n,t)).lanes=i,e}function Oc(e,t,i,n){return(e=kc(22,e,n,t)).elementType=R,e.lanes=i,e.stateNode={isHidden:!1},e}function Bc(e,t,i){return(e=kc(6,e,null,t)).lanes=i,e}function zc(e,t,i){return(t=kc(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nc(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uc(e,t,i,n,r,s,o,a,l){return e=new Nc(e,t,i,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=kc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Os(s),e}function jc(e){if(!e)return Sr;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var i=e.type;if(Mr(i))return Lr(e,i,t)}return t}function Vc(e,t,i,n,r,s,o,a,l){return(e=Uc(i,n,!0,e,0,s,0,a,l)).context=jc(null),i=e.current,(s=zs(n=ec(),r=tc(i))).callback=void 0!==t&&null!==t?t:null,Ns(i,s,r),e.current.lanes=r,_t(e,r,n),nc(e,n),e}function Gc(e,t,i,n){var r=t.current,s=ec(),o=tc(r);return i=jc(i),null===t.context?t.context=i:t.pendingContext=i,(t=zs(s,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Ns(r,t,o))&&(ic(e,r,o,s),Us(e,r,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Xc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}El=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pr.current)ya=!0;else{if(0===(e.lanes&i)&&0===(128&t.flags))return ya=!1,function(e,t,i){switch(t.tag){case 3:Pa(t),ps();break;case 5:Js(t);break;case 1:Mr(t.type)&&Or(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Dr(ws,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Dr(Qs,1&Qs.current),t.flags|=128,null):0!==(i&t.child.childLanes)?Ba(e,t,i):(Dr(Qs,1&Qs.current),null!==(e=Wa(e,t,i))?e.sibling:null);Dr(Qs,1&Qs.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(128&e.flags)){if(n)return Va(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dr(Qs,Qs.current),n)break;return null;case 22:case 23:return t.lanes=0,Aa(e,t,i)}return Wa(e,t,i)}(e,t,i);ya=0!==(131072&e.flags)}else ya=!1,rs&&0!==(1048576&t.flags)&&Qr(t,Xr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ga(e,t),e=t.pendingProps;var r=kr(t,Cr.current);Ps(t,i),r=go(null,t,n,e,r,i);var o=_o();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mr(n)?(o=!0,Or(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Os(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,la(t,n,e,i),t=Ca(null,t,n,!0,o,i)):(t.tag=0,rs&&o&&es(t),ba(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Ga(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return Mc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===k)return 14}return 2}(n),e=ia(n,e),r){case 0:t=Da(null,t,n,e,i);break e;case 1:t=Sa(null,t,n,e,i);break e;case 11:t=xa(null,t,n,e,i);break e;case 14:t=wa(null,t,n,ia(n.type,e),i);break e}throw Error(s(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Da(e,t,n,r=t.elementType===n?r:ia(n,r),i);case 1:return n=t.type,r=t.pendingProps,Sa(e,t,n,r=t.elementType===n?r:ia(n,r),i);case 3:e:{if(Pa(t),null===e)throw Error(s(387));n=t.pendingProps,r=(o=t.memoizedState).element,Bs(e,t),Vs(t,n,null,i);var a=t.memoizedState;if(n=a.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ia(e,t,n,i,r=ca(Error(s(423)),t));break e}if(n!==r){t=Ia(e,t,n,i,r=ca(Error(s(424)),t));break e}for(ns=cr(t.stateNode.containerInfo.firstChild),is=t,rs=!0,ss=null,i=xs(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(ps(),n===r){t=Wa(e,t,i);break e}ba(e,t,n,i)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),n=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,ir(n,r)?a=null:null!==o&&ir(n,o)&&(t.flags|=32),Ta(e,t),ba(e,t,a,i),t.child;case 6:return null===e&&cs(t),null;case 13:return Ba(e,t,i);case 4:return Ys(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=bs(t,null,n,i):ba(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,xa(e,t,n,r=t.elementType===n?r:ia(n,r),i);case 7:return ba(e,t,t.pendingProps,i),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Dr(ws,n._currentValue),n._currentValue=a,null!==o)if(an(o.value,a)){if(o.children===r.children&&!Pr.current){t=Wa(e,t,i);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===o.tag){(c=zs(-1,i&-i)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=i,null!==(c=o.alternate)&&(c.lanes|=i),Cs(o.return,i,t),l.lanes|=i;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),Cs(a,i,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ba(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Ps(t,i),n=n(r=Is(r)),t.flags|=1,ba(e,t,n,i),t.child;case 14:return r=ia(n=t.type,t.pendingProps),wa(e,t,n,r=ia(n.type,r),i);case 15:return Ea(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:ia(n,r),Ga(e,t),t.tag=1,Mr(n)?(e=!0,Or(t)):e=!1,Ps(t,i),oa(t,n,r),la(t,n,r,i),Ca(null,t,n,!0,e,i);case 19:return Va(e,t,i);case 22:return Aa(e,t,i)}throw Error(s(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Qc(e,t,i,n,r){var s=i._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Wc(o);a.call(e)}}Gc(t,o,e,r)}else o=function(e,t,i,n,r){if(r){if("function"===typeof n){var s=n;n=function(){var e=Wc(o);s.call(e)}}var o=Vc(t,n,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[mr]=o.current,Vn(8===e.nodeType?e.parentNode:e),uc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var a=n;n=function(){var e=Wc(l);a.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[mr]=l.current,Vn(8===e.nodeType?e.parentNode:e),uc(function(){Gc(t,l,i,n)}),l}(i,t,e,r,n);return Wc(o)}Yc.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gc(e,t,null,null)},Yc.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Gc(null,e,null,null)}),t[mr]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=At();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Rt.length&&0!==t&&t<Rt[i].priority;i++);Rt.splice(i,0,e),0===i&&Bt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=ht(t.pendingLanes);0!==i&&(vt(t,1|i),nc(t,Je()),0===(6&Cl)&&(Vl=Je()+500,Vr()))}break;case 13:uc(function(){var t=Fs(e,1);if(null!==t){var i=ec();ic(t,e,1,i)}}),Xc(e,1)}},wt=function(e){if(13===e.tag){var t=Fs(e,134217728);if(null!==t)ic(t,e,134217728,ec());Xc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),i=Fs(e,t);if(null!==i)ic(i,e,t,ec());Xc(e,t)}},At=function(){return yt},Tt=function(e,t){var i=yt;try{return yt=e,t()}finally{yt=i}},we=function(e,t,i){switch(t){case"input":if($(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=xr(n);if(!r)throw Error(s(90));q(n),$(n,r)}}}break;case"textarea":se(e,i);break;case"select":null!=(t=i.value)&&ie(e,!!i.multiple,t,!1)}},Ce=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[yr,br,xr,De,Se,cc]},tu={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{rt=nu.inject(iu),st=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(s(200));return function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.createRoot=function(e,t){if(!Kc(e))throw Error(s(299));var i=!1,n="",r=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Uc(e,1,!1,null,0,i,0,n,r),e[mr]=t.current,Vn(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,i){if(!Jc(t))throw Error(s(200));return Qc(null,e,t,!0,i)},t.hydrateRoot=function(e,t,i){if(!Kc(e))throw Error(s(405));var n=null!=i&&i.hydratedSources||null,r=!1,o="",a=qc;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(o=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),t=Vc(t,null,e,1,null!=i?i:null,r,0,o,a),e[mr]=t.current,Vn(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Yc(t)},t.render=function(e,t,i){if(!Jc(t))throw Error(s(200));return Qc(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Qc(null,null,e,!1,function(){e._reactRootContainer=null,e[mr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Jc(i))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Qc(e,t,i,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},752:(e,t,i)=>{"use strict";i.d(t,{v:()=>E});var n=i(379),r=i(775);const s="texture-compression-bc",o="texture-compression-astc",a="texture-compression-etc2",l="texture-compression-pvrtc-webgl",c="texture-compression-atc-webgl",u="float32-renderable-webgl",h="float16-renderable-webgl",d="snorm8-renderable-webgl",p="norm16-renderable-webgl",m="snorm16-renderable-webgl",f="float32-filterable",g="float16-filterable-webgl";function _(e){const t=b[e];if(!t)throw new Error("Unsupported texture format ".concat(e));return t}const v={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:d},rg8snorm:{render:d},"rgb8snorm-webgl":{},rgba8snorm:{render:d},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:p},rg16unorm:{render:p},"rgb16unorm-webgl":{f:p},rgba16unorm:{render:p},r16snorm:{f:m},rg16snorm:{render:m},"rgb16snorm-webgl":{f:p},rgba16snorm:{render:m},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:h,filter:"float16-filterable-webgl"},rg16float:{render:h,filter:g},rgba16float:{render:h,filter:g},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:u,filter:f},rg32float:{render:!1,filter:f},"rgb32float-webgl":{render:u,filter:f},rgba32float:{render:u,filter:f},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:u},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},y={"bc1-rgb-unorm-webgl":{f:s},"bc1-rgb-unorm-srgb-webgl":{f:s},"bc1-rgba-unorm":{f:s},"bc1-rgba-unorm-srgb":{f:s},"bc2-rgba-unorm":{f:s},"bc2-rgba-unorm-srgb":{f:s},"bc3-rgba-unorm":{f:s},"bc3-rgba-unorm-srgb":{f:s},"bc4-r-unorm":{f:s},"bc4-r-snorm":{f:s},"bc5-rg-unorm":{f:s},"bc5-rg-snorm":{f:s},"bc6h-rgb-ufloat":{f:s},"bc6h-rgb-float":{f:s},"bc7-rgba-unorm":{f:s},"bc7-rgba-unorm-srgb":{f:s},"etc2-rgb8unorm":{f:a},"etc2-rgb8unorm-srgb":{f:a},"etc2-rgb8a1unorm":{f:a},"etc2-rgb8a1unorm-srgb":{f:a},"etc2-rgba8unorm":{f:a},"etc2-rgba8unorm-srgb":{f:a},"eac-r11unorm":{f:a},"eac-r11snorm":{f:a},"eac-rg11unorm":{f:a},"eac-rg11snorm":{f:a},"astc-4x4-unorm":{f:o},"astc-4x4-unorm-srgb":{f:o},"astc-5x4-unorm":{f:o},"astc-5x4-unorm-srgb":{f:o},"astc-5x5-unorm":{f:o},"astc-5x5-unorm-srgb":{f:o},"astc-6x5-unorm":{f:o},"astc-6x5-unorm-srgb":{f:o},"astc-6x6-unorm":{f:o},"astc-6x6-unorm-srgb":{f:o},"astc-8x5-unorm":{f:o},"astc-8x5-unorm-srgb":{f:o},"astc-8x6-unorm":{f:o},"astc-8x6-unorm-srgb":{f:o},"astc-8x8-unorm":{f:o},"astc-8x8-unorm-srgb":{f:o},"astc-10x5-unorm":{f:o},"astc-10x5-unorm-srgb":{f:o},"astc-10x6-unorm":{f:o},"astc-10x6-unorm-srgb":{f:o},"astc-10x8-unorm":{f:o},"astc-10x8-unorm-srgb":{f:o},"astc-10x10-unorm":{f:o},"astc-10x10-unorm-srgb":{f:o},"astc-12x10-unorm":{f:o},"astc-12x10-unorm-srgb":{f:o},"astc-12x12-unorm":{f:o},"astc-12x12-unorm-srgb":{f:o},"pvrtc-rgb4unorm-webgl":{f:l},"pvrtc-rgba4unorm-webgl":{f:l},"pvrtc-rbg2unorm-webgl":{f:l},"pvrtc-rgba2unorm-webgl":{f:l},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:c},"atc-rgba-unorm-webgl":{f:c},"atc-rgbai-unorm-webgl":{f:c}},b=(0,n.A)((0,n.A)({},v),y),x=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],w=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;const E=new class{getInfo(e){return A(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return x.some(t=>e.startsWith(t))}getCapabilities(e){var t,i,n,r,s;const o=_(e),a={format:e,create:null===(t=o.f)||void 0===t||t,render:null===(i=o.render)||void 0===i||i,filter:null===(n=o.filter)||void 0===n||n,blend:null===(r=o.blend)||void 0===r||r,store:null===(s=o.store)||void 0===s||s},l=A(e),c=e.startsWith("depth")||e.startsWith("stencil"),u=null===l||void 0===l?void 0:l.signed,h=null===l||void 0===l?void 0:l.integer,d=null===l||void 0===l?void 0:l.webgl;return a.render&&(a.render=!u),a.filter&&(a.filter=!c&&!u&&!h&&!d),a}};function A(e){let t=function(e){var t,i,r,s,o,a,l,c;const u=_(e),h=u.bytesPerPixel||1,d=u.bitsPerChannel||[8,8,8,8];delete u.bitsPerChannel,delete u.bytesPerPixel,delete u.f,delete u.render,delete u.filter,delete u.blend,delete u.store;const p=(0,n.A)((0,n.A)({},u),{},{format:e,attachment:u.attachment||"color",channels:u.channels||"r",components:u.components||(null===(t=u.channels)||void 0===t?void 0:t.length)||1,bytesPerPixel:h,bitsPerChannel:d,dataType:u.dataType||"uint8",srgb:null!==(i=u.srgb)&&void 0!==i&&i,packed:null!==(r=u.packed)&&void 0!==r&&r,webgl:null!==(s=u.webgl)&&void 0!==s&&s,integer:null!==(o=u.integer)&&void 0!==o&&o,signed:null!==(a=u.signed)&&void 0!==a&&a,normalized:null!==(l=u.normalized)&&void 0!==l&&l,compressed:null!==(c=u.compressed)&&void 0!==c&&c});return p}(e);if(E.isCompressed(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const i=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,i]=t;return{blockWidth:Number(e),blockHeight:Number(i)}}return null}(e);i&&(t.blockWidth=i.blockWidth,t.blockHeight=i.blockHeight)}const i=w.exec(e);if(i){const[,n,s,o,a,l]=i,c="".concat(o).concat(s),u=(0,r.vE)(c),h=8*u.byteLength,d=n.length,p=[h,d>=2?h:0,d>=3?h:0,d>=4?h:0];t={format:e,attachment:t.attachment,dataType:u.signedType,components:d,channels:n,integer:u.integer,signed:u.signed,normalized:u.normalized,bitsPerChannel:p,bytesPerPixel:u.byteLength*n.length,packed:t.packed,srgb:t.srgb},"-webgl"===l&&(t.webgl=!0),"-srgb"===a&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}},775:(e,t,i)=>{"use strict";function n(e){const[t,i,n]=l[e],r=e.includes("norm");return{signedType:t,primitiveType:i,byteLength:n,normalized:r,integer:!r&&!e.startsWith("float"),signed:e.startsWith("s")}}function r(e){const t=e;switch(t){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return t}}function s(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}function o(e){const t=ArrayBuffer.isView(e)?e.constructor:e;if(t===Uint8ClampedArray)return"uint8";const i=Object.values(l).find(e=>t===e[4]);if(!i)throw new Error(t.name);return i[0]}function a(e){const[,,,,t]=l[e];return t}i.d(t,{Ak:()=>a,JP:()=>s,K7:()=>r,h1:()=>o,vE:()=>n});const l={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]}},788:(e,t,i)=>{"use strict";async function n(e,t){const i=document.getElementsByTagName("head")[0];if(!i)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",e),t&&(n.id=t),new Promise((t,r)=>{n.onload=t,n.onerror=t=>r(new Error("Unable to load script '".concat(e,"': ").concat(t))),i.appendChild(n)})}i.d(t,{k:()=>n})},794:(e,t,i)=>{"use strict";i.d(t,{h:()=>o});var n=i(379),r=i(467),s=i(804);class o extends s.F{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t){const i=(0,n.A)({},t);(t.usage||0)&o.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?i.indexType="uint32":t.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data,super(e,i,o.defaultProps),(0,r.A)(this,"usage",void 0),(0,r.A)(this,"indexType",void 0),(0,r.A)(this,"updateTimestamp",void 0),(0,r.A)(this,"debugData",new ArrayBuffer(0)),this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer((0,n.A)((0,n.A)({},this.props),e))}_setDebugData(e,t,i){const n=ArrayBuffer.isView(e)?e.buffer:e,r=Math.min(e?e.byteLength:i,o.DEBUG_DATA_MAX_LENGTH);null===n?this.debugData=new ArrayBuffer(r):0===t&&i===n.byteLength?this.debugData=n.slice(0,r):this.debugData=n.slice(t,t+r)}}(0,r.A)(o,"INDEX",16),(0,r.A)(o,"VERTEX",32),(0,r.A)(o,"UNIFORM",64),(0,r.A)(o,"STORAGE",128),(0,r.A)(o,"INDIRECT",256),(0,r.A)(o,"QUERY_RESOLVE",512),(0,r.A)(o,"MAP_READ",1),(0,r.A)(o,"MAP_WRITE",2),(0,r.A)(o,"COPY_SRC",4),(0,r.A)(o,"COPY_DST",8),(0,r.A)(o,"DEBUG_DATA_MAX_LENGTH",32),(0,r.A)(o,"defaultProps",(0,n.A)((0,n.A)({},s.F.defaultProps),{},{usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}))},795:(e,t,i)=>{"use strict";i.d(t,{t:()=>g});var n=i(228);const r="4.1.0";class s{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=function(e){try{const t=window[e],i="__storage_test__";return t.setItem(i,i),t.removeItem(i),t}catch(t){return null}}(i),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var o;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(o||(o={}));function a(e){return"string"!==typeof e?e:(e=e.toUpperCase(),o[e]||o.WHITE)}function l(e,t){if(!e)throw new Error(t||"Assertion failed")}var c=i(705);function u(){let e;var t,i;if((0,n.B)()&&c.x.performance)e=null===c.x||void 0===c.x||null===(t=c.x.performance)||void 0===t||null===(i=t.now)||void 0===i?void 0:i.call(t);else if("hrtime"in c.eh){var r;const t=null===c.eh||void 0===c.eh||null===(r=c.eh.hrtime)||void 0===r?void 0:r.call(c.eh);e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const h={debug:(0,n.B)()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},d={enabled:!0,level:0};function p(){}const m={},f={once:!0};class g{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.VERSION=r,this._startTs=u(),this._deltaTs=u(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new s("__probe-".concat(this.id,"__"),d),this.timeStamp("".concat(this.id," started")),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const i=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(i),r=e;for(const s of n){const i=r[s];"function"===typeof i&&(t.find(e=>s===e)||(r[s]=i.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((u()-this._startTs).toPrecision(10))}getDelta(){return Number((u()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,h.warn,arguments,f)}error(e){return this._getLogFunction(0,e,h.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,h.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,h.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,h.debug||h.info,arguments,f)}table(e,t,i){return t?this._getLogFunction(e,t,console.table||p,i&&[i],{tag:y(t)}):p}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||p)}group(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const n=v({logLevel:e,message:t,opts:i}),{collapsed:r}=i;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||p)}withGroup(e,t,i){this.group(e,t)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=_(e)}_getLogFunction(e,t,i,r,s){if(this._shouldLog(e)){s=v({logLevel:e,message:t,args:r,opts:s}),l(i=i||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=u();const o=s.tag||s.message;if(s.once&&o){if(m[o])return p;m[o]=u()}return t=function(e,t,i){if("string"===typeof t){const r=i.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const i=Math.max(t-e.length,0);return"".concat(" ".repeat(i)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(i.total)):"";t=function(e,t,i){if(!n.B&&"string"===typeof e){if(t){const i=a(t);e="\x1b[".concat(i,"m").concat(e,"\x1b[39m")}if(i){const t=a(i);e="\x1b[".concat(t+10,"m").concat(e,"\x1b[49m")}}return e}(t=i.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),i.color,i.background)}return t}(this.id,s.message,s),i.bind(console,t,...s.args)}return p}}function _(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return l(Number.isFinite(t)&&t>=0),t}function v(e){const{logLevel:t,message:i}=e;e.logLevel=_(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==i;);switch(typeof t){case"string":case"function":void 0!==i&&n.unshift(i),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const r=typeof e.message;return l("string"===r||"object"===r),Object.assign(e,{args:n},e.opts)}function y(e){for(const t in e)for(const i in e[t])return i||"untitled";return"empty"}g.VERSION=r},804:(e,t,i)=>{"use strict";i.d(t,{F:()=>o});var n=i(379),r=i(467),s=i(204);class o{toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,':"').concat(this.id,'"')}constructor(e,t,i){if((0,r.A)(this,"id",void 0),(0,r.A)(this,"props",void 0),(0,r.A)(this,"userData",{}),(0,r.A)(this,"_device",void 0),(0,r.A)(this,"destroyed",!1),(0,r.A)(this,"allocatedBytes",0),(0,r.A)(this,"_attachedResources",new Set),!e)throw new Error("no device");this._device=e,this.props=function(e,t){const i=(0,n.A)({},t);for(const n in e)void 0!==e[n]&&(i[n]=e[n]);return i}(t,i);const o="undefined"!==this.props.id?this.props.id:(0,s.L)(this[Symbol.toStringTag]);this.props.id=o,this.id=o,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("".concat(t,"s Active")).decrementCount()}trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(e),i.get("".concat(t," Memory")).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get("".concat(e," Memory")).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}}(0,r.A)(o,"defaultProps",{id:"undefined",handle:void 0,userData:void 0})},816:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var n=i(284);function r(e){var t=function(e,t){if("object"!=(0,n.A)(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=(0,n.A)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,n.A)(t)?t:t+""}},841:(e,t,i)=>{"use strict";i.d(t,{WebGLDevice:()=>gt});var n=i(379),r=i(467),s=i(382),o=i(96);const a={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},l=(e,t,i)=>t?e.enable(i):e.disable(i),c=(e,t,i)=>e.hint(i,t),u=(e,t,i)=>e.pixelStorei(i,t),h=(e,t,i)=>{const n=36006===i?36009:36008;return e.bindFramebuffer(n,t)},d=(e,t,i)=>{const n={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[i];e.bindBuffer(n,t)};function p(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const m={3042:l,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:l,2885:(e,t)=>e.cullFace(t),2929:l,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:l,35723:c,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>{var i;return null===(i=e.bindTransformFeedback)||void 0===i?void 0:i.call(e,36386,t)},34229:(e,t)=>e.bindVertexArray(t),36006:h,36010:h,34964:d,36662:d,36663:d,35053:d,35055:d,2886:(e,t)=>e.frontFace(t),33170:c,2849:(e,t)=>e.lineWidth(t),32823:l,32824:"polygonOffset",10752:"polygonOffset",35977:l,32926:l,32928:l,32938:"sampleCoverage",32939:"sampleCoverage",3089:l,3088:(e,t)=>e.scissor(...t),2960:l,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:l,10754:l,12288:l,12289:l,12290:l,12291:l,12292:l,12293:l,12294:l,12295:l,3333:u,3317:u,37440:u,37441:u,37443:u,3330:u,3332:u,3331:u,3314:u,32878:u,3316:u,3315:u,32877:u,framebuffer:(e,t)=>{const i=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,i)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const i="number"===typeof t?[t,t]:t;e.blendEquationSeparate(...i)},blendFunc:(e,t)=>{const i=2===(null===t||void 0===t?void 0:t.length)?[...t,...t]:t;e.blendFuncSeparate(...i)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=p(t)?t:[t,t];const[i,n]=t;e.stencilMaskSeparate(1028,i),e.stencilMaskSeparate(1029,n)},stencilFunc:(e,t)=>{t=p(t)&&3===t.length?[...t,...t]:t;const[i,n,r,s,o,a]=t;e.stencilFuncSeparate(1028,i,n,r),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=p(t)&&3===t.length?[...t,...t]:t;const[i,n,r,s,o,a]=t;e.stencilOpSeparate(1028,i,n,r),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function f(e,t,i){return void 0!==t[e]?t[e]:i[e]}const g={blendEquation:(e,t,i)=>e.blendEquationSeparate(f(32777,t,i),f(34877,t,i)),blendFunc:(e,t,i)=>e.blendFuncSeparate(f(32969,t,i),f(32968,t,i),f(32971,t,i),f(32970,t,i)),polygonOffset:(e,t,i)=>e.polygonOffset(f(32824,t,i),f(10752,t,i)),sampleCoverage:(e,t,i)=>e.sampleCoverage(f(32938,t,i),f(32939,t,i)),stencilFuncFront:(e,t,i)=>e.stencilFuncSeparate(1028,f(2962,t,i),f(2967,t,i),f(2963,t,i)),stencilFuncBack:(e,t,i)=>e.stencilFuncSeparate(1029,f(34816,t,i),f(36003,t,i),f(36004,t,i)),stencilOpFront:(e,t,i)=>e.stencilOpSeparate(1028,f(2964,t,i),f(2965,t,i),f(2966,t,i)),stencilOpBack:(e,t,i)=>e.stencilOpSeparate(1029,f(34817,t,i),f(34818,t,i),f(34819,t,i))},_={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,i)=>e({[t]:i}),hint:(e,t,i)=>e({[t]:i}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,i)=>e({36007:i}),bindTransformFeedback:(e,t,i)=>e({36389:i}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,i)=>{switch(t){case 36160:return e({36006:i,36010:i});case 36009:return e({36006:i});case 36008:return e({36010:i});default:return null}},bindBuffer:(e,t,i)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return n?e({[n]:i}):{valueChanged:!0}},blendColor:(e,t,i,n,r)=>e({32773:new Float32Array([t,i,n,r])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,i)=>e({32777:t,34877:i}),blendFunc:(e,t,i)=>e({32969:t,32968:i,32971:t,32970:i}),blendFuncSeparate:(e,t,i,n,r)=>e({32969:t,32968:i,32971:n,32970:r}),clearColor:(e,t,i,n,r)=>e({3106:new Float32Array([t,i,n,r])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,i,n,r)=>e({3107:[t,i,n,r]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,i)=>e({2928:new Float32Array([t,i])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,i)=>e({32824:t,10752:i}),sampleCoverage:(e,t,i)=>e({32938:t,32939:i}),scissor:(e,t,i,n,r)=>e({3088:new Int32Array([t,i,n,r])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,i)=>e({[1028===t?2968:36005]:i}),stencilFunc:(e,t,i,n)=>e({2962:t,2967:i,2963:n,34816:t,36003:i,36004:n}),stencilFuncSeparate:(e,t,i,n,r)=>e({[1028===t?2962:34816]:i,[1028===t?2967:36003]:n,[1028===t?2963:36004]:r}),stencilOp:(e,t,i,n)=>e({2964:t,2965:i,2966:n,34817:t,34818:i,34819:n}),stencilOpSeparate:(e,t,i,n,r)=>e({[1028===t?2964:34817]:i,[1028===t?2965:34818]:n,[1028===t?2966:34819]:r}),viewport:(e,t,i,n,r)=>e({2978:[t,i,n,r]})},v=(e,t)=>e.isEnabled(t),y={3042:v,2884:v,2929:v,3024:v,32823:v,32926:v,32928:v,3089:v,2960:v,35977:v},b=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function x(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const i={};for(const r in t){const n=Number(r),s=m[r];s&&("string"===typeof s?i[s]=!0:s(e,t[r],n))}const n=e.state&&e.state.cache;if(n)for(const r in i){(0,g[r])(e,t,n)}}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if("number"===typeof t){const i=t,n=y[i];return n?n(e,i):e.getParameter(i)}const i=Array.isArray(t)?t:Object.keys(t),n={};for(const r of i){const t=y[r];n[r]=t?t(e,Number(r)):e.getParameter(Number(r))}return n}function E(e,t){if(e===t)return!0;if(A(e)&&A(t)&&e.length===t.length){for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}return!1}function A(e){return Array.isArray(e)||ArrayBuffer.isView(e)}class T{static get(e){return e.state}constructor(e,t){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"program",null),(0,r.A)(this,"stateStack",[]),(0,r.A)(this,"enable",!0),(0,r.A)(this,"cache",null),(0,r.A)(this,"log",void 0),(0,r.A)(this,"initialized",!1),this.gl=e,this.log=(null===t||void 0===t?void 0:t.log)||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];x(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=null!==t&&void 0!==t&&t.copyState?w(e):Object.assign({},a),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(i){const n=T.get(e);n.program!==i&&(t(i),n.program=i)}}(e);for(const i in _){S(e,i,_[i])}D(e,"getParameter"),D(e,"isEnabled")}_updateCache(e){let t,i=!1;const n=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const r in e){const s=e[r],o=this.cache[r];E(s,o)||(i=!0,t=o,n&&!(r in n)&&(n[r]=o),this.cache[r]=s)}return{valueChanged:i,oldValue:t}}}function D(e,t){const i=e[t].bind(e);e[t]=function(t){if(void 0===t||b.has(t))return i(t);const n=T.get(e);return t in n.cache||(n.cache[t]=i(t)),n.enable?n.cache[t]:i(t)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function S(e,t,i){if(!e[t])return;const n=e[t].bind(e);e[t]=function(){const t=T.get(e);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const{valueChanged:a,oldValue:l}=i(t._updateCache,...s);return a&&n(...s),l},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function C(e,t,i){return void 0===i[t]&&(i[t]=e.getExtension(t)||null),i[t]}function P(e,t){const i=e.getParameter(7936),n=e.getParameter(7937);C(e,"WEBGL_debug_renderer_info",t);const r=t.WEBGL_debug_renderer_info,s=e.getParameter(r?r.UNMASKED_VENDOR_WEBGL:7936)||i,o=e.getParameter(r?r.UNMASKED_RENDERER_WEBGL:7937)||n,a=e.getParameter(7938),l=I(s,o),c=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(s,o),u=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(I(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(s,o);return{type:"webgl",gpu:l,gpuType:u,gpuBackend:c,vendor:s,renderer:o,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function I(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}var k=i(752);function M(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const R="WEBGL_compressed_texture_s3tc",F="WEBGL_compressed_texture_s3tc_srgb",L="EXT_texture_compression_rgtc",O="EXT_texture_compression_bptc",B="EXT_texture_norm16",z="EXT_render_snorm",N={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[z],"norm16-renderable-webgl":[B],"snorm16-renderable-webgl":[B,z],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[R,F,L,O],"texture-compression-bc5-webgl":[L],"texture-compression-bc7-webgl":[O],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const U={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:R},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:F},"bc1-rgba-unorm":{gl:33777,x:R},"bc1-rgba-unorm-srgb":{gl:35916,x:F},"bc2-rgba-unorm":{gl:33778,x:R},"bc2-rgba-unorm-srgb":{gl:35918,x:F},"bc3-rgba-unorm":{gl:33779,x:R},"bc3-rgba-unorm-srgb":{gl:35919,x:F},"bc4-r-unorm":{gl:36283,x:L},"bc4-r-snorm":{gl:36284,x:L},"bc5-rg-unorm":{gl:36285,x:L},"bc5-rg-snorm":{gl:36286,x:L},"bc6h-rgb-ufloat":{gl:36495,x:O},"bc6h-rgb-float":{gl:36494,x:O},"bc7-rgba-unorm":{gl:36492,x:O},"bc7-rgba-unorm-srgb":{gl:36493,x:O},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function j(e){var t;const i=U[e],n=function(e){const t=U[e],i=null===t||void 0===t?void 0:t.gl;if(void 0===i)throw new Error("Unsupported texture format ".concat(e));return i}(e),r=k.v.getInfo(e);return r.compressed&&(i.dataFormat=n),{internalFormat:n,format:(null===i||void 0===i?void 0:i.dataFormat)||V(r.channels,r.integer,r.normalized,n),type:r.dataType?M(r.dataType):(null===i||void 0===i||null===(t=i.types)||void 0===t?void 0:t[0])||5121,compressed:r.compressed||!1}}function V(e,t,i,n){if(6408===n||6407===n)return n;switch(e){case"r":return t&&!i?36244:6403;case"rg":return t&&!i?33320:33319;case"rgb":return t&&!i?36248:6407;case"rgba":return t&&!i?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}const G={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class W extends s.I7{constructor(e,t,i){super([],i),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"extensions",void 0),(0,r.A)(this,"testedFeatures",new Set),this.gl=e,this.extensions=t,C(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){var t;return(null===(t=this.disabledFeatures)||void 0===t||!t[e])&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in N}(e)&&function(e,t,i){return(N[t]||[]).every(t=>C(e,t,i))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(e=>"polygon-mode-webgl"!==e);for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(G),...Object.keys(N)]}getWebGLFeature(e){const t=G[e];return"string"===typeof t?Boolean(C(this.gl,t,this.extensions)):Boolean(t)}}class H extends s.PI{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}constructor(e){super(),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"limits",{}),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}var X=i(228),q=i(204);class Z{static isHTMLCanvas(e){return"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas}toString(){return"".concat(this[Symbol.toStringTag],"(").concat(this.id,")")}constructor(e){var t,i;if((0,r.A)(this,"id",void 0),(0,r.A)(this,"props",void 0),(0,r.A)(this,"canvas",void 0),(0,r.A)(this,"htmlCanvas",void 0),(0,r.A)(this,"offscreenCanvas",void 0),(0,r.A)(this,"type",void 0),(0,r.A)(this,"initialized",void 0),(0,r.A)(this,"isInitialized",!1),(0,r.A)(this,"isVisible",!0),(0,r.A)(this,"cssWidth",void 0),(0,r.A)(this,"cssHeight",void 0),(0,r.A)(this,"devicePixelRatio",void 0),(0,r.A)(this,"devicePixelWidth",void 0),(0,r.A)(this,"devicePixelHeight",void 0),(0,r.A)(this,"drawingBufferWidth",void 0),(0,r.A)(this,"drawingBufferHeight",void 0),(0,r.A)(this,"_initializedResolvers",function(){let e,t;return{promise:new Promise((i,n)=>{e=i,t=n}),resolve:e,reject:t}}()),(0,r.A)(this,"_resizeObserver",void 0),(0,r.A)(this,"_intersectionObserver",void 0),(0,r.A)(this,"_position",void 0),(0,r.A)(this,"destroyed",!1),this.props=(0,n.A)((0,n.A)({},Z.defaultProps),e),e=this.props,this.initialized=this._initializedResolvers.promise,(0,X.B)()?e.canvas?"string"===typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!Z.isHTMLCanvas(t))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas:this.canvas=function(e){const{width:t,height:i}=e,n=document.createElement("canvas");n.id=(0,q.L)("lumagl-auto-created-canvas"),n.width=t||1,n.height=i||1,n.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",n.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",null!==e&&void 0!==e&&e.visible||(n.style.visibility="hidden");const r=function(e){if("string"===typeof e){const t=document.getElementById(e);if(!t)throw new Error("".concat(e," is not an HTML element"));return t}if(e)return e;return document.body}((null===e||void 0===e?void 0:e.container)||null);return r.insertBefore(n,r.firstChild),n}(e):this.canvas={width:e.width||1,height:e.height||1},Z.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Z.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=(null===(t=this.htmlCanvas)||void 0===t?void 0:t.clientWidth)||this.canvas.width,this.cssHeight=(null===(i=this.htmlCanvas)||void 0===i?void 0:i.clientHeight)||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Z.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(e=>this._handleIntersection(e)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(e=>this._handleResize(e));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch(s){this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t}getDevicePixelRatio(){return"undefined"!==typeof window&&window.devicePixelRatio||1}cssToDevicePixels(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this.cssToDeviceRatio(),[n,r]=this.getDrawingBufferSize();return function(e,t,i,n,r){const s=e,o=Y(s[0],t,i);let a=K(s[1],t,n,r),l=Y(s[0]+1,t,i);const c=l===i-1?l:l-1;let u;l=K(s[1]+1,t,n,r),r?(l=0===l?l:l+1,u=a,a=l):u=l===n-1?l:l-1;return{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}(e,i,n,r,t)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,t]=this.getDevicePixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[t]=this.getCSSSize();return t?e/t:1}catch(e){return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){var t;"lumagl-auto-created-canvas"===(null===(t=this.htmlCanvas)||void 0===t?void 0:t.id)&&(this.htmlCanvas.id=e)}_handleIntersection(e){const t=e.find(e=>e.target===this.canvas);if(!t)return;const i=t.isIntersecting;this.isVisible!==i&&(this.isVisible=i,this.device.props.onVisibilityChange(this))}_handleResize(e){var t,i;const n=e.find(e=>e.target===this.canvas);if(!n)return;this.cssWidth=n.contentBoxSize[0].inlineSize,this.cssHeight=n.contentBoxSize[0].blockSize;const r=this.getDevicePixelSize(),s=(null===(t=n.devicePixelContentBoxSize)||void 0===t?void 0:t[0].inlineSize)||n.contentBoxSize[0].inlineSize*devicePixelRatio,o=(null===(i=n.devicePixelContentBoxSize)||void 0===i?void 0:i[0].blockSize)||n.contentBoxSize[0].blockSize*devicePixelRatio,[a,l]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(s,a)),this.devicePixelHeight=Math.max(1,Math.min(o,l)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:r})}_updateDrawingBufferSize(){if(this.props.autoResize){if("number"===typeof this.props.useDevicePixels){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia("(resolution: ".concat(this.devicePixelRatio,"dppx)")).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(){const e=setInterval(()=>{this.destroyed?clearInterval(e):this.updatePosition()},arguments.length>0&&void 0!==arguments[0]?arguments[0]:100)}updatePosition(){var e;const t=null===(e=this.htmlCanvas)||void 0===e?void 0:e.getBoundingClientRect();if(t){var i;const e=[t.left,t.top];null!==(i=this._position)&&void 0!==i||(this._position=e);if(e[0]!==this._position[0]||e[1]!==this._position[1]){var n,r;const t=this._position;this._position=e,null===(n=(r=this.device.props).onPositionChange)||void 0===n||n.call(r,this,{oldPosition:t})}}}}function Y(e,t,i){return Math.min(Math.round(e*t),i-1)}function K(e,t,i,n){return n?Math.max(0,i-1-Math.round(e*t)):Math.min(Math.round(e*t),i-1)}(0,r.A)(Z,"defaultProps",{id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1});var J=i(804),$=i(501);class Q extends J.F{get[Symbol.toStringTag](){return"Framebuffer"}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},Q.defaultProps),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(t=>t.texture.clone(e)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer((0,n.A)((0,n.A)({},this.props),{},{colorAttachments:t,depthStencilAttachment:i}))}resize(e){let t=!e;if(e){const[i,n]=Array.isArray(e)?e:[e.width,e.height];t=t||n!==this.height||i!==this.width,this.width=i,this.height=n}t&&(o.R.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(this.width,"x").concat(this.height))(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((e,t)=>{if("string"===typeof e){const i=this.createColorTexture(e,t);return this.attachResource(i),i.view}return e instanceof $.g?e.view:e});const e=this.props.depthStencilAttachment;if(e)if("string"===typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof $.g?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:"".concat(this.id,"-color-attachment-").concat(t),usage:$.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:"".concat(this.id,"-depth-stencil-attachment"),usage:$.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,t){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const n=this.colorAttachments[i].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=n.view,this.attachResource(n.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}}(0,r.A)(Q,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{width:1,height:1,colorAttachments:[],depthStencilAttachment:null}));class ee extends Q{constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"colorAttachments",[]),(0,r.A)(this,"depthStencilAttachment",null);const i=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const i=36064+t;this._attachTextureView(i,e)}}if(this.depthStencilAttachment){const e=function(e){switch(k.v.getInfo(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error("Not a depth stencil format: ".concat(e))}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error("Framebuffer ".concat(function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return"".concat(e)}}(e)))}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:i}=this.device,{texture:n}=t,r=t.props.baseMipLevel,s=t.props.baseArrayLayer;switch(i.bindTexture(n.glTarget,n.handle),n.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,e,n.handle,r,s);break;case 34067:const t=function(e){return e<34069?e+34069:e}(s);i.framebufferTexture2D(36160,e,t,n.handle,r);break;case 3553:i.framebufferTexture2D(36160,e,3553,n.handle,r);break;default:throw new Error("Illegal texture type")}i.bindTexture(n.glTarget,null)}}class te extends Z{get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",null),(0,r.A)(this,"_framebuffer",null),this.device=e,this._setAutoCreatedCanvasId("".concat(this.device.id,"-canvas")),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new ee(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}var ie=i(354),ne=i(513);const re={};function se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";re[e]=re[e]||1;const t=re[e]++;return"".concat(e,"-").concat(t)}var oe=i(794);class ae extends oe.h{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"glTarget",void 0),(0,r.A)(this,"glUsage",void 0),(0,r.A)(this,"glIndexType",5123),(0,r.A)(this,"byteLength",0),(0,r.A)(this,"bytesUsed",0),this.device=e,this.gl=this.device.gl;const i="object"===typeof t?t.handle:void 0;this.handle=i||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:(0,n.A)((0,n.A)({},this.props),{},{data:typeof this.props.data})}),this.glTarget=function(e){if(e&oe.h.INDEX)return 34963;if(e&oe.h.VERTEX)return 34962;if(e&oe.h.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&oe.h.INDEX)return 35044;if(e&oe.h.VERTEX)return 35044;if(e&oe.h.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;const n=this.glTarget;this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,i,this.glUsage),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(e,t,i),this.trackAllocatedMemory(i)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,t,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,i),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)}async mapAndWriteAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.byteLength-t;const n=new ArrayBuffer(i);await e(n,"copied"),this.write(n,t)}async readAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.readSyncWebGL(e,t)}async mapAndReadAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;const n=await this.readAsync(t,i);return await e(n.buffer,"copied")}readSyncWebGL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;t=null!==t&&void 0!==t?t:this.byteLength-e;const i=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,i,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(i,e,t),i}}var le=i(404);function ce(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}class ue extends le.M{constructor(e,t){switch(super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",void 0),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),i=[];for(const n of t){if(n.length<=1)continue;const e=n.split(":");if(2===e.length){const[t,n]=e;i.push({message:n.trim(),type:ce(t),lineNum:0,linePos:0});continue}const[t,r,s,...o]=e;let a=parseInt(s,10);isNaN(a)&&(a=0);let l=parseInt(r,10);isNaN(l)&&(l=0),i.push({message:o.join(":").trim(),type:ce(t),lineNum:a,linePos:l})}return i}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return(null===e||void 0===e?void 0:e.getTranslatedShaderSource(this.handle))||null}async _compile(e){e=e.startsWith("#version ")?e:"#version 300 es\n".concat(e);const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))o.R.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),o.R.info(2,"Shader ".concat(this.id," - async compilation complete: ").concat(this.compilationStatus))(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error("GLSL compilation errors in ".concat(this.props.stage," shader ").concat(this.props.id))}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}var he=i(698);function de(e,t){const i=e,{gl:n}=i;if(t.cullMode)switch(t.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029)}if(t.frontFace&&n.frontFace(_e("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&n.enable(34383),void 0!==t.depthBias&&(n.enable(32823),n.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=i.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,n=_e("provokingVertex",t.provokingVertex,{first:36429,last:36430});null===e||void 0===e||e.provokingVertexWEBGL(n)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=i.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,n=_e("polygonMode",t.polygonMode,{fill:6914,line:6913});null===e||void 0===e||e.polygonModeWEBGL(1028,n),null===e||void 0===e||e.polygonModeWEBGL(1029,n)}t.polygonOffsetLine&&n.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&n.enable(12288),t.clipDistance1&&n.enable(12289),t.clipDistance2&&n.enable(12290),t.clipDistance3&&n.enable(12291),t.clipDistance4&&n.enable(12292),t.clipDistance5&&n.enable(12293),t.clipDistance6&&n.enable(12294),t.clipDistance7&&n.enable(12295)),void 0!==t.depthWriteEnabled&&n.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?n.enable(2929):n.disable(2929),n.depthFunc(pe("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;n.stencilMaskSeparate(1028,e),n.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&o.R.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,i=pe("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,i,0,e),n.stencilFuncSeparate(1029,i,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=me("stencilPassOperation",t.stencilPassOperation),i=me("stencilFailOperation",t.stencilFailOperation),r=me("stencilDepthFailOperation",t.stencilDepthFailOperation);n.stencilOpSeparate(1028,i,r,e),n.stencilOpSeparate(1029,i,r,e)}switch(t.blend){case!0:n.enable(3042);break;case!1:n.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=fe("blendColorOperation",t.blendColorOperation||"add"),i=fe("blendAlphaOperation",t.blendAlphaOperation||"add");n.blendEquationSeparate(e,i);const r=ge("blendColorSrcFactor",t.blendColorSrcFactor||"one"),s=ge("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=ge("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=ge("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");n.blendFuncSeparate(r,s,o,a)}}function pe(e,t){return _e(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function me(e,t){return _e(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function fe(e,t){return _e(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function ge(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"color";return _e(e,t,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:"color"===i?32769:32771,"one-minus-constant":"color"===i?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function _e(e,t,i){if(!(t in i))throw new Error(function(e,t){return"Illegal parameter ".concat(t," for ").concat(e)}(e,t));return i[t]}function ve(e){let t=!0;for(const i in e){t=!1;break}return t}function ye(e){const t={};return e.addressModeU&&(t[10242]=be(e.addressModeU)),e.addressModeV&&(t[10243]=be(e.addressModeV)),e.addressModeW&&(t[32882]=be(e.addressModeW)),e.magFilter&&(t[10240]=xe(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";if(!t)return xe(e);switch(t){case"none":return xe(e);case"nearest":switch(e){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(e){case"nearest":return 9986;case"linear":return 9987}}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=pe("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function be(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function xe(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}class we extends he.L{constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"parameters",void 0),this.device=e,this.parameters=ye(t),this.handle=t.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return"Sampler(".concat(this.id,",").concat(JSON.stringify(this.props),")")}_setSamplerParameters(e){for(const[t,i]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,i);break;default:this.device.gl.samplerParameteri(this.handle,e,i)}}}}function Ee(e,t,i){if(function(e){for(const t in e)return!1;return!0}(t))return i(e);const{nocatch:n=!0}=t,r=T.get(e);let s;if(r.push(),x(e,t),n)s=i(e),r.pop();else try{s=i(e)}finally{r.pop()}return s}var Ae=i(927);class Te extends Ae.X{constructor(e,t){super(e,(0,n.A)((0,n.A)({},$.g.defaultProps),t)),(0,r.A)(this,"device",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"texture",void 0),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}class De extends $.g{constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"sampler",void 0),(0,r.A)(this,"view",void 0),(0,r.A)(this,"glTarget",void 0),(0,r.A)(this,"glFormat",void 0),(0,r.A)(this,"glType",void 0),(0,r.A)(this,"glInternalFormat",void 0),(0,r.A)(this,"compressed",void 0),(0,r.A)(this,"_textureUnit",0),this.device=e,this.gl=this.device.gl;const i=j(this.props.format);this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension),this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:s,width:o,height:a,depth:l,mipLevels:c,glTarget:u,glInternalFormat:h}=this;switch(s){case"2d":case"cube":this.gl.texStorage2D(u,c,h,o,a);break;case"2d-array":case"3d":this.gl.texStorage3D(u,c,h,o,a,l);break;default:throw new Error(s)}this.gl.bindTexture(this.glTarget,null),this._initializeData(t.data),this.setSampler(this.props.sampler),this.view=new Te(this.device,(0,n.A)((0,n.A)({},this.props),{},{texture:this})),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Te(this.device,(0,n.A)((0,n.A)({},e),{},{texture:this}))}setSampler(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super.setSampler(e);const t=ye(this.sampler.props);this._setSamplerParameters(t)}copyImageData(e){const t=this._normalizeCopyImageDataOptions(e),i=t.data,{width:r,height:s,depth:o}=this,{mipLevel:a=0,byteOffset:l=0,x:c=0,y:u=0,z:h=0}=t,{glFormat:d,glType:p,compressed:m}=this,f=Se(this.glTarget,this.dimension,h);let g;if(!this.compressed){const{bytesPerPixel:e}=this.device.getTextureFormatInfo(this.format);if(e){if(t.bytesPerRow%e!==0)throw new Error("bytesPerRow (".concat(t.bytesPerRow,") must be a multiple of bytesPerPixel (").concat(e,") for ").concat(this.format));g=t.bytesPerRow/e}}const _=this.compressed?{}:(0,n.A)((0,n.A)({},void 0!==g?{3314:g}:{}),{},{32878:t.rowsPerImage});this.gl.bindTexture(f,this.handle),Ee(this.gl,_,()=>{switch(this.dimension){case"2d":case"cube":m?this.gl.compressedTexSubImage2D(f,a,c,u,r,s,d,i,l):this.gl.texSubImage2D(f,a,c,u,r,s,d,p,i,l);break;case"2d-array":case"3d":m?this.gl.compressedTexSubImage3D(f,a,c,u,h,r,s,o,d,i,l):this.gl.texSubImage3D(f,a,c,u,h,r,s,o,d,p,i,l)}}),this.gl.bindTexture(f,null)}copyExternalImage(e){const t=this._normalizeCopyExternalImageOptions(e);if(t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:i,glType:n}=this,{image:r,depth:s,mipLevel:o,x:a,y:l,z:c,width:u,height:h}=t,d=Se(this.glTarget,this.dimension,s),p=t.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),Ee(this.gl,p,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(d,o,a,l,u,h,i,n,r);break;case"2d-array":case"3d":this.gl.texSubImage3D(d,o,a,l,c,u,h,s,i,n,r)}}),this.gl.bindTexture(this.glTarget,null),{width:t.width,height:t.height}}generateMipmapsWebGL(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(o.R.warn("".concat(this," is not renderable or filterable, may not be able to generate mipmaps"))(),null!==e&&void 0!==e&&e.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){o.R.warn("Error generating mipmap for ".concat(this,": ").concat(t.message))()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){o.R.log(2,"".concat(this.id," sampler parameters"),this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,i]of Object.entries(e)){const e=Number(t),n=i;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,n);break;case 10240:case 10241:case 10242:case 10243:case 32882:case 34892:case 34893:this.gl.texParameteri(this.glTarget,e,n);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,n)}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:t}=this;return void 0!==e&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:t}=this;return void 0!==e&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}function Se(e,t,i){return"cube"===t?34069+i:e}var Ce=i(671),Pe=i(242);function Ie(e){return Re[e]}function ke(e){return Boolean(Fe[e])}function Me(e){return Fe[e]}const Re={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},Fe={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},Le={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function Oe(e,t){const i={attributes:[],bindings:[]};i.attributes=function(e,t){const i=[],n=e.getProgramParameter(t,35721);for(let r=0;r<n;r++){const n=e.getActiveAttrib(t,r);if(!n)throw new Error("activeInfo");const{name:s,type:o}=n,a=e.getAttribLocation(t,s);if(a>=0){const e=Ie(o),t=/instance/i.test(s)?"instance":"vertex";i.push({name:s,location:a,stepMode:t,type:e})}}return i.sort((e,t)=>e.location-t.location),i}(e,t);const r=function(e,t){const i=(i,n)=>e.getActiveUniformBlockParameter(t,i,n),n=[],r=e.getProgramParameter(t,35382);for(let s=0;s<r;s++){const r={name:e.getActiveUniformBlockName(t,s)||"",location:i(s,35391),byteLength:i(s,35392),vertex:i(s,35396),fragment:i(s,35398),uniformCount:i(s,35394),uniforms:[]},o=i(s,35395)||[],a=e.getActiveUniforms(t,o,35383),l=e.getActiveUniforms(t,o,35384),c=e.getActiveUniforms(t,o,35387),u=e.getActiveUniforms(t,o,35388);for(let i=0;i<r.uniformCount;++i){const n=e.getActiveUniform(t,o[i]);if(!n)throw new Error("activeInfo");const s=Ie(a[i]);r.uniforms.push({name:n.name,format:s,type:a[i],arrayLength:l[i],byteOffset:c[i],byteStride:u[i]})}n.push(r)}return n.sort((e,t)=>e.location-t.location),n}(e,t);for(const n of r){const e=n.uniforms.map(e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength}));i.bindings.push({type:"uniform",name:n.name,group:0,location:n.location,visibility:(n.vertex?1:0)&(n.fragment?2:0),minBindingSize:n.byteLength,uniforms:e})}const s=function(e,t){const i=[],r=e.getProgramParameter(t,35718);for(let s=0;s<r;s++){const r=e.getActiveUniform(t,s);if(!r)throw new Error("activeInfo");const{name:o,size:a,type:l}=r,{name:c,isArray:u}=Be(o);let h=e.getUniformLocation(t,c);const d={location:h,name:c,size:a,type:l,isArray:u};if(i.push(d),d.size>1)for(let s=0;s<d.size;s++){const r="".concat(c,"[").concat(s,"]");h=e.getUniformLocation(t,r);const o=(0,n.A)((0,n.A)({},d),{},{name:r,location:h});i.push(o)}}return i}(e,t);let o=0;for(const n of s)if(ke(n.type)){const{viewDimension:e,sampleType:t}=Me(n.type);i.bindings.push({type:"texture",name:n.name,group:0,location:o,viewDimension:e,sampleType:t}),n.textureUnit=o,o+=1}s.length&&(i.uniforms=s);const a=function(e,t){const i=[],n=e.getProgramParameter(t,35971);for(let r=0;r<n;r++){const n=e.getTransformFeedbackVarying(t,r);if(!n)throw new Error("activeInfo");const{name:s,type:o,size:a}=n,l=Ie(o),{type:c,components:u}=(0,Pe.k0)(l);i.push({location:r,name:s,type:c,size:a*u})}return i.sort((e,t)=>e.location-t.location),i}(e,t);return null!==a&&void 0!==a&&a.length&&(i.varyings=a),i}function Be(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function ze(e,t,i,n){const r=e;let s=n;!0===s&&(s=1),!1===s&&(s=0);const o="number"===typeof s?[s]:s;switch(i){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!==typeof n)throw new Error("samplers must be set to integers");return e.uniform1i(t,n);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return r.uniform1uiv(t,o,1);case 36294:return r.uniform2uiv(t,o,2);case 36295:return r.uniform3uiv(t,o,3);case 36296:return r.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return r.uniformMatrix2x3fv(t,!1,o);case 35686:return r.uniformMatrix2x4fv(t,!1,o);case 35687:return r.uniformMatrix3x2fv(t,!1,o);case 35688:return r.uniformMatrix3x4fv(t,!1,o);case 35689:return r.uniformMatrix4x2fv(t,!1,o);case 35690:return r.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}class Ne extends Ce.r{get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"vs",void 0),(0,r.A)(this,"fs",void 0),(0,r.A)(this,"introspectedLayout",void 0),(0,r.A)(this,"uniforms",{}),(0,r.A)(this,"bindings",{}),(0,r.A)(this,"varyings",null),(0,r.A)(this,"_uniformCount",0),(0,r.A)(this,"_uniformSetters",{}),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=t.vs,this.fs=t.fs;const{varyings:i,bufferMode:s=35981}=t;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),o.R.time(3,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.introspectedLayout=Oe(this.device.gl,this.handle),o.R.timeEnd(3,"RenderPipeline ".concat(this.id," - shaderLayout introspection"))(),this.shaderLayout=t.shaderLayout?function(e,t){const i=(0,n.A)((0,n.A)({},e),{},{attributes:e.attributes.map(e=>(0,n.A)({},e))});for(const n of(null===t||void 0===t?void 0:t.attributes)||[]){const e=i.attributes.find(e=>e.name===n.name);e?(e.type=n.type||e.type,e.stepMode=n.stepMode||e.stepMode):o.R.warn("shader layout attribute ".concat(n.name," not present in shader"))}return i}(this.introspectedLayout,t.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,t){for(const[i,n]of Object.entries(e)){const e=this.shaderLayout.bindings.find(e=>e.name===i)||this.shaderLayout.bindings.find(e=>e.name==="".concat(i,"Uniforms"));if(!e){const e=this.shaderLayout.bindings.map(e=>'"'.concat(e.name,'"')).join(", ");null!==t&&void 0!==t&&t.disableWarnings||o.R.warn('No binding "'.concat(i,'" in render pipeline "').concat(this.id,'", expected one of ').concat(e),n)();continue}switch(n||o.R.warn('Unsetting binding "'.concat(i,'" in render pipeline "').concat(this.id,'"'))(),e.type){case"uniform":if(!(n instanceof ae)&&!(n.buffer instanceof ae))throw new Error("buffer value");break;case"texture":if(!(n instanceof Te||n instanceof De||n instanceof ee))throw new Error("".concat(this," Bad texture binding for ").concat(i));break;case"sampler":o.R.warn("Ignoring sampler ".concat(i))();break;default:throw new Error(e.type)}this.bindings[i]=n}}draw(e){var t;const{renderPass:i,parameters:n=this.props.parameters,topology:r=this.props.topology,vertexArray:s,vertexCount:a,instanceCount:l,isInstanced:c=!1,firstVertex:u=0,transformFeedback:h}=e,d=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}(r),p=Boolean(s.indexBuffer),m=null===(t=s.indexBuffer)||void 0===t?void 0:t.glIndexType;if("success"!==this.linkStatus)return o.R.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - waiting for shader linking"))(),!1;if(!this._areTexturesRenderable())return o.R.info(2,"RenderPipeline:".concat(this.id,".draw() aborted - textures not yet loaded"))(),!1;this.device.gl.useProgram(this.handle),s.bindBeforeRender(i),h&&h.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const f=i;return function(e,t,i,n){if(ve(t))return n(e);const r=e;r.pushState();try{return de(e,t),x(r.gl,i),n(e)}finally{r.popState()}}(this.device,n,f.glParameters,()=>{p&&c?this.device.gl.drawElementsInstanced(d,a||0,m,u,l||0):p?this.device.gl.drawElements(d,a||0,m,u):c?this.device.gl.drawArraysInstanced(d,u,a||0,l||0):this.device.gl.drawArrays(d,u,a||0),h&&h.end()}),s.unbindAfterRender(i),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),o.R.time(4,"linkProgram for ".concat(this.id))(),e.linkProgram(this.handle),o.R.timeEnd(4,"linkProgram for ".concat(this.id))(),o.R.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}o.R.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),o.R.info(2,"RenderPipeline ".concat(this.id," - async linking complete: ").concat(this.linkStatus))();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){var t;if("success"!==e){const i="link-error"===e?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error("".concat(this," ").concat(i," during compilation of ").concat(this.vs));case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader()}switch(null===(t=this.fs)||void 0===t?void 0:t.compilationStatus){case"error":throw this.fs.debugShader(),new Error("".concat(this," ").concat(i," during compilation of ").concat(this.fs));case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader()}const n=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error("".concat(i," during ").concat(e,": ").concat(n)),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","link-error";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")}async _waitForLinkComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(o.R.warn("Binding ".concat(t.name," not found in ").concat(this.id))(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,i=0;for(const n of this.shaderLayout.bindings){const r=this.bindings[n.name]||this.bindings[n.name.replace(/Uniforms$/,"")];if(!r)throw new Error("No value for binding ".concat(n.name," in ").concat(this.id));switch(n.type){case"uniform":const{name:s}=n,a=e.getUniformBlockIndex(this.handle,s);if(4294967295===a)throw new Error("Invalid uniform block name ".concat(s));e.uniformBlockBinding(this.handle,i,a),r instanceof ae?e.bindBufferBase(35345,i,r.handle):e.bindBufferRange(35345,i,r.buffer.handle,r.offset||0,r.size||r.buffer.byteLength-r.offset),i+=1;break;case"texture":if(!(r instanceof Te||r instanceof De||r instanceof ee))throw new Error("texture");let l;if(r instanceof Te)l=r.texture;else if(r instanceof De)l=r;else{if(!(r instanceof ee&&r.colorAttachments[0]instanceof Te))throw new Error("No texture");o.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),l=r.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(l.glTarget,l.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error("binding type '".concat(n.type,"' not supported in WebGL"))}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){var e;const{name:i,location:n,type:r,textureUnit:s}=t,o=null!==(e=this.uniforms[i])&&void 0!==e?e:s;void 0!==o&&ze(this.device.gl,n,r,o)}}}class Ue extends J.F{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Ue.defaultProps)}}(0,r.A)(Ue,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{measureExecutionTime:void 0}));class je extends J.F{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,je.defaultProps)}}(0,r.A)(je,"defaultProps",(0,n.A)({},J.F.defaultProps));class Ve extends je{constructor(e){super(e,{}),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",null),(0,r.A)(this,"commands",[]),this.device=e}_executeCommands(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.commands;for(const t of e)switch(t.name){case"copy-buffer-to-buffer":Ge(this.device,t.options);break;case"copy-buffer-to-texture":We(this.device,t.options);break;case"copy-texture-to-buffer":He(this.device,t.options);break;case"copy-texture-to-texture":Xe(this.device,t.options);break;default:throw new Error(t.name)}}}function Ge(e,t){var i,n;const r=t.sourceBuffer,s=t.destinationBuffer;e.gl.bindBuffer(36662,r.handle),e.gl.bindBuffer(36663,s.handle),e.gl.copyBufferSubData(36662,36663,null!==(i=t.sourceOffset)&&void 0!==i?i:0,null!==(n=t.destinationOffset)&&void 0!==n?n:0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function We(e,t){throw new Error("Not implemented")}function He(e,t){const{sourceTexture:i,mipLevel:n=0,aspect:r="all",width:s=t.sourceTexture.width,height:o=t.sourceTexture.height,depthOrArrayLayers:a=0,origin:l=[0,0],destinationBuffer:c,byteOffset:u=0,bytesPerRow:h,rowsPerImage:d}=t;if("all"!==r)throw new Error("aspect not supported in WebGL");if(0!==n||0!==a||h||d)throw new Error("not implemented");const{framebuffer:p,destroyFramebuffer:m}=qe(i);let f;try{const t=c,i=s||p.width,n=o||p.height,r=j(p.colorAttachments[0].texture.props.format),a=r.format,h=r.type;e.gl.bindBuffer(35051,t.handle),f=e.gl.bindFramebuffer(36160,p.handle),e.gl.readPixels(l[0],l[1],i,n,a,h,u)}finally{e.gl.bindBuffer(35051,null),void 0!==f&&e.gl.bindFramebuffer(36160,f),m&&p.destroy()}}function Xe(e,t){const{sourceTexture:i,destinationMipLevel:n=0,origin:r=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=t;let{width:a=t.destinationTexture.width,height:l=t.destinationTexture.height}=t;const{framebuffer:c,destroyFramebuffer:u}=qe(i),[h,d]=r,[p,m,f]=s,g=e.gl.bindFramebuffer(36160,c.handle);let _,v;if(!(o instanceof De))throw new Error("invalid destination");switch(_=o,a=Number.isFinite(a)?a:_.width,l=Number.isFinite(l)?l:_.height,_._bind(0),v=_.glTarget,v){case 3553:case 34067:e.gl.copyTexSubImage2D(v,n,p,m,h,d,a,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(v,n,p,m,f,h,d,a,l)}_&&_._unbind(),e.gl.bindFramebuffer(36160,g),u&&c.destroy()}function qe(e){if(e instanceof $.g){const{width:t,height:i,id:n}=e;return{framebuffer:e.device.createFramebuffer({id:"framebuffer-for-".concat(n),width:t,height:i,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}var Ze;class Ye extends J.F{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=Ye.normalizeProps(e,t),Ye.defaultProps)}static normalizeProps(e,t){return t}}Ze=Ye,(0,r.A)(Ye,"defaultClearColor",[0,0,0,1]),(0,r.A)(Ye,"defaultClearDepth",1),(0,r.A)(Ye,"defaultClearStencil",0),(0,r.A)(Ye,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{framebuffer:null,parameters:void 0,clearColor:Ze.defaultClearColor,clearColors:void 0,clearDepth:Ze.defaultClearDepth,clearStencil:Ze.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}));const Ke=[1,2,4,8];class Je extends Ye{constructor(e,t){var i;let s;if(super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",null),(0,r.A)(this,"glParameters",{}),this.device=e,null===t||void 0===t||null===(i=t.parameters)||void 0===i||!i.viewport)if(null!==t&&void 0!==t&&t.framebuffer){const{width:e,height:i}=t.framebuffer;s=[0,0,e,i]}else{const[t,i]=e.getDefaultCanvasContext().getDrawingBufferSize();s=[0,0,t,i]}this.device.pushState(),this.setParameters((0,n.A)({viewport:s},this.props.parameters));const o=this.props.framebuffer;if(this.props.framebuffer&&null!==o&&void 0!==o&&o.handle){const e=this.props.framebuffer.colorAttachments.map((e,t)=>36064+t);this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,n.A)({},this.glParameters);t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=e.stencilReference),"colorMask"in e&&(t.colorMask=Ke.map(t=>Boolean(t&e.colorMask))),this.glParameters=t,x(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;null===t||void 0===t||t.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;null===e||void 0===e||e.endOcclusionQuery()}clear(){const e=(0,n.A)({},this.glParameters);let t=0;this.props.clearColors&&this.props.clearColors.forEach((e,t)=>{e&&this.clearColorBuffer(t,e)}),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&Ee(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0];Ee(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class $e extends Ue{constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",null),(0,r.A)(this,"commandBuffer",void 0),this.device=e,this.commandBuffer=new Ve(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new Je(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,i){}}var Qe=i(184);class et extends J.F{get[Symbol.toStringTag](){return"VertexArray"}constructor(e,t){super(e,t,et.defaultProps),(0,r.A)(this,"maxVertexAttributes",void 0),(0,r.A)(this,"attributeInfos",void 0),(0,r.A)(this,"indexBuffer",null),(0,r.A)(this,"attributes",void 0),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=(0,Qe.M)(t.shaderLayout,t.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()}}(0,r.A)(et,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{shaderLayout:void 0,bufferLayout:[]}));var tt=i(199),it=i(544),nt=i(705);class rt extends et{get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(e){return"Chrome"===(t||(0,X.B)()?(0,it.b)(t)?"Electron":(t||nt.gM.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node");var t}constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"buffer",null),(0,r.A)(this,"bufferValue",null),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){var e;(super.destroy(),this.buffer)&&(null===(e=this.buffer)||void 0===e||e.destroy());this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const i=t;if(34963===i.glTarget)throw new Error("Use .setIndexBuffer()");const{size:n,type:r,stride:s,offset:o,normalized:a,integer:l,divisor:c}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),l?this.device.gl.vertexAttribIPointer(e,n,r,s,o):this.device.gl.vertexAttribPointer(e,n,r,a,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,c||0),this.attributes[e]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error("Unknown attribute location ".concat(e));const i=M(t.bufferDataType);return{size:t.bufferComponents,type:i,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=rt.isConstantAttributeZeroSupported(this.device);(t||(i||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const i=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),n=i.byteLength*e,r=i.length*e;if(this.buffer&&n!==this.buffer.byteLength)throw new Error("Buffer size is immutable, byte length ".concat(n," !== ").concat(this.buffer.byteLength,"."));let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:n}),s||(s=!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}(i,this.bufferValue)),s){const e=(0,tt.X)(t.constructor,r);!function(e){const{target:t,source:i,start:n=0,count:r=1}=e,s=i.length,o=r*s;let a=0;for(let l=n;a<s;a++)t[l++]=i[a];for(;a<o;)a<o-a?(t.copyWithin(n+a,n,n+a),a*=2):(t.copyWithin(n+a,n,n+o-a),a=o);e.target}({target:e,source:i,start:0,count:r}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class st extends J.F{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,st.defaultProps)}}(0,r.A)(st,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{layout:void 0,buffers:{}}));class ot extends st{constructor(e,t){super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"layout",void 0),(0,r.A)(this,"buffers",{}),(0,r.A)(this,"unusedBuffers",{}),(0,r.A)(this,"bindOnUse",!0),(0,r.A)(this,"_bound",!1),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"point-list";this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:n,byteLength:r,byteOffset:s}=this._getBufferRange(t);if(i<0)return this.unusedBuffers[e]=n,void o.R.warn("".concat(this.id," unusedBuffers varying buffer ").concat(e))();this.buffers[i]={buffer:n,byteLength:r,byteOffset:s},this.bindOnUse||this._bindBuffer(i,n,s,r)}getBuffer(e){if(at(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this.gl.bindTransformFeedback(36386,t),this):(this._bound?e=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,e=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),e)}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof ae)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:i=0,byteLength:n=e.buffer.byteLength}=e;return{buffer:t,byteOffset:i,byteLength:n}}_getVaryingIndex(e){if(at(e))return Number(e);for(const t of this.layout.varyings||[])if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:i,byteOffset:n}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,n,i)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;const r=t&&t.handle;r&&void 0!==n?this.gl.bindBufferRange(35982,e,r,i,n):this.gl.bindBufferBase(35982,e,r)}}function at(e){return"number"===typeof e?Number.isInteger(e):/^\d+$/.test(e)}class lt extends J.F{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,lt.defaultProps)}}(0,r.A)(lt,"defaultProps",(0,n.A)((0,n.A)({},J.F.defaultProps),{},{type:void 0,count:void 0}));class ct extends lt{get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),(0,r.A)(this,"device",void 0),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"target",null),(0,r.A)(this,"_queryPending",!1),(0,r.A)(this,"_pollingPromise",null),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");const i=this.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");this.handle=i,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(null!==e&&void 0!==e&&e.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,n)=>{const r=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)}),this._pollingPromise}}var ut=i(775);function ht(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}const dt={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function pt(e,t){var i;const{sourceX:n=0,sourceY:r=0,sourceAttachment:s=0}=t||{};let{target:o=null,sourceWidth:a,sourceHeight:l,sourceDepth:c,sourceFormat:u,sourceType:h}=t||{};const{framebuffer:d,deleteFramebuffer:p}=mt(e),{gl:m,handle:f}=d;a||(a=d.width),l||(l=d.height);const g=null===(i=d.colorAttachments[s])||void 0===i?void 0:i.texture;if(!g)throw new Error("Invalid framebuffer attachment ".concat(s));c=(null===g||void 0===g?void 0:g.depth)||1,u||(u=(null===g||void 0===g?void 0:g.glFormat)||6408),h||(h=(null===g||void 0===g?void 0:g.glType)||5121),o=function(e,t,i,n,r){if(e)return e;t||(t=5121);const s=(l=t,dt[l]),o=(0,ut.Ak)(s),a=ht(i);var l;return new o(n*r*a)}(o,h,u,a,l);const _=(0,ut.h1)(o);h=h||Le[_];const v=m.bindFramebuffer(36160,f);return m.readBuffer(36064+s),m.readPixels(n,r,a,l,u,h,o),m.readBuffer(36064),m.bindFramebuffer(36160,v||null),p&&d.destroy(),o}function mt(e){return e instanceof Q?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:ft(e),deleteFramebuffer:!0}}function ft(e,t){const{device:i,width:r,height:s,id:o}=e;return i.createFramebuffer((0,n.A)((0,n.A)({},t),{},{id:"framebuffer-for-".concat(o),width:r,height:s,colorAttachments:[e]}))}class gt extends s.pF{get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return"".concat(this[Symbol.toStringTag],"(").concat(this.id,")")}isVertexFormatSupported(e){return"unorm8x4-bgra"!==e}constructor(e){var t;super((0,n.A)((0,n.A)({},e),{},{id:e.id||se("webgl-device")})),(0,r.A)(this,"type","webgl"),(0,r.A)(this,"handle",void 0),(0,r.A)(this,"features",void 0),(0,r.A)(this,"limits",void 0),(0,r.A)(this,"info",void 0),(0,r.A)(this,"canvasContext",void 0),(0,r.A)(this,"preferredColorFormat","rgba8unorm"),(0,r.A)(this,"preferredDepthFormat","depth24plus"),(0,r.A)(this,"commandEncoder",void 0),(0,r.A)(this,"lost",void 0),(0,r.A)(this,"_resolveContextLost",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"_constants",void 0),(0,r.A)(this,"_extensions",{}),(0,r.A)(this,"_polyfilled",!1),(0,r.A)(this,"spectorJS",void 0);const i=s.pF._getCanvasContextProps(e);if(!i)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let a=null===(t=i.canvas)||void 0===t||null===(t=t.gl)||void 0===t?void 0:t.device;if(a)throw new Error("WebGL context already attached to device ".concat(a.id));this.canvasContext=new te(this,i),this.lost=new Promise(e=>{this._resolveContextLost=e});const l=(0,n.A)({},e.webgl);"premultiplied"===i.alphaMode&&(l.premultipliedAlpha=!0),void 0!==e.powerPreference&&(l.powerPreference=e.powerPreference);const c=this.props._handle||function(e,t,i){var r;let s="";const o=(0,n.A)({preserveDrawingBuffer:!0},i);let a=null;var l;if(a||(a=e.getContext("webgl2",o)),o.failIfMajorPerformanceCaveat&&(s||(s="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),a||i.failIfMajorPerformanceCaveat||(o.failIfMajorPerformanceCaveat=!1,a=e.getContext("webgl2",o),(l=a).luma||(l.luma={}),a.luma.softwareRenderer=!0),a||(a=e.getContext("webgl",{}),a&&(a=null,s||(s="Your browser only supports WebGL1"))),!a)throw s||(s="Your browser does not support WebGL"),new Error("Failed to create WebGL context: ".concat(s));const{onContextLost:c,onContextRestored:u}=t;return e.addEventListener("webglcontextlost",e=>c(e),!1),e.addEventListener("webglcontextrestored",e=>u(e),!1),(r=a).luma||(r.luma={}),a}(this.canvasContext.canvas,{onContextLost:e=>{var t;return null===(t=this._resolveContextLost)||void 0===t?void 0:t.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})},onContextRestored:e=>console.log("WebGL context restored")},l);if(!c)throw new Error("WebGL context creation failed");if(a=c.device,a){if(e._reuseDevices)return o.R.log(1,"Not creating a new Device, instead returning a reference to Device ".concat(a.id," already attached to WebGL context"),a)(),a._reused=!0,a;throw new Error("WebGL context already attached to device ".concat(a.id))}this.handle=c,this.gl=c,this.spectorJS=(0,ie.k2)((0,n.A)((0,n.A)({},this.props),{},{gl:this.handle})),this.gl.device=this,this.gl._version=2,this.info=P(this.gl,this._extensions),this.limits=new H(this.gl),this.features=new W(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures();const u=new T(this.gl,{log:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return o.R.log(1,...t)()}});u.trackState(this.gl,{copyState:!1});const h=e.debugWebGL||e.debug,d=e.debugWebGL;h&&(this.gl=(0,ne.l)(this.gl,{debugWebGL:h,traceWebGL:d}),o.R.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(o.R.level=Math.max(o.R.level,1))),this.commandEncoder=new $e(this,{id:"".concat(this,"-command-encoder")})}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new ae(this,t)}createTexture(e){return new De(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new we(this,e)}createShader(e){return new ue(this,e)}createFramebuffer(e){return new ee(this,e)}createVertexArray(e){return new rt(this,e)}createTransformFeedback(e){return new ot(this,e)}createQuerySet(e){return new ct(this,e)}createRenderPipeline(e){return new Ne(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(){return new $e(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:"".concat(this.id,"-default-encoder")})),e._executeCommands()}readPixelsToArrayWebGL(e,t){return pt(e,t)}readPixelsToBufferWebGL(e,t){return function(e,t){const{target:i,sourceX:n=0,sourceY:r=0,sourceFormat:s=6408,targetByteOffset:o=0}=t||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=t||{};const{framebuffer:u,deleteFramebuffer:h}=mt(e);a=a||u.width,l=l||u.height;const d=u;c=c||5121;let p=i;if(!p){const e=o+a*l*ht(s)*function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}(c);p=d.device.createBuffer({byteLength:e})}const m=e.device.createCommandEncoder();return m.copyTextureToBuffer({sourceTexture:e,width:a,height:l,origin:[n,r],destinationBuffer:p,byteOffset:o}),m.destroy(),h&&u.destroy(),p}(e,t)}setParametersWebGL(e){x(this.gl,e)}getParametersWebGL(e){return w(this.gl,e)}withParametersWebGL(e,t){return Ee(this.gl,e,t)}resetWebGL(){o.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),x(this.gl,a)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,i){let n=t.create;const r=U[t.format];return void 0===(null===r||void 0===r?void 0:r.gl)&&(n=!1),null!==r&&void 0!==r&&r.x&&(n=n&&Boolean(C(e,r.x,i))),{format:t.format,create:n&&t.create,render:n&&t.render,filter:n&&t.filter,blend:n&&t.blend,store:n&&t.store}}(this.gl,e,this._extensions)}loseDevice(){var e;let t=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(t=!0,i.loseContext()),null===(e=this._resolveContextLost)||void 0===e||e.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){T.get(this.gl).push()}popState(){T.get(this.gl).pop()}getGLKey(e,t){const i=Number(e);for(const n in this.gl)if(this.gl[n]===i)return"GL.".concat(n);return null!==t&&void 0!==t&&t.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((e,i)=>{let[n,r]=i;return e["".concat(n,":").concat(this.getGLKey(n,t))]="".concat(r,":").concat(this.getGLKey(r,t)),e},{})}setConstantAttributeWebGL(e,t){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const n=this._constants[e];switch(n&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}(n,t)&&o.R.info(1,"setConstantAttributeWebGL(".concat(e,") could have been skipped, value unchanged"))(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,i){switch(i.length){case 1:e.gl.vertexAttrib1fv(t,i);break;case 2:e.gl.vertexAttrib2fv(t,i);break;case 3:e.gl.vertexAttrib3fv(t,i);break;case 4:e.gl.vertexAttrib4fv(t,i)}}(this,e,t);break;case Int32Array:!function(e,t,i){e.gl.vertexAttribI4iv(t,i)}(this,e,t);break;case Uint32Array:!function(e,t,i){e.gl.vertexAttribI4uiv(t,i)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return C(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,t,i){e.luma=t;const n={props:i.spector,id:i.spector.id};e.__SPECTOR_Metadata=n}}},853:(e,t,i)=>{"use strict";e.exports=i(234)},879:function(e){e.exports=function(){"use strict";var e,t,i;function n(n,r){if(e)if(t){var s="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",o={};e(o),i=r(o),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"})))}else t=r;else e=r}return n(["exports"],function(e){var t="undefined"!=typeof self?self:{},i="2.15.0";let n;const r={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==n){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{n=null!={NODE_ENV:"production",PUBLIC_URL:"/final",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX?new RegExp({NODE_ENV:"production",PUBLIC_URL:"/final",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX):e}catch(t){n=e}}return n},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!r.API_URL)return null;try{const e=new URL(r.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},s={supported:!1,testSupport:function(e){!l&&a&&(c?u(e):o=e)}};let o,a,l=!1,c=!1;function u(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.isContextLost())return;s.supported=!0}catch(e){}e.deleteTexture(t),l=!0}t.document&&(a=t.document.createElement("img"),a.onload=function(){o&&u(o),o=null,c=!0},a.onerror=function(){l=!0,o=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const h="01";function d(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var p=m;function m(e,t,i,n){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=i,this.p2y=n}m.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var i=e,n=0;n<8;n++){var r=this.sampleCurveX(i)-e;if(Math.abs(r)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=r/s}var o=0,a=1;for(i=e,n=0;n<20&&(r=this.sampleCurveX(i),!(Math.abs(r-e)<t));n++)e>r?o=i:a=i,i=.5*(a-o)+o;return i},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var f=d(p),g=_;function _(e,t){this.x=e,this.y=t}_.prototype={clone:function(){return new _(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),n=Math.sin(e),r=t.y+n*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-n*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_.convert=function(e){return e instanceof _?e:Array.isArray(e)?new _(e[0],e[1]):e};var v=d(g);const y=Math.PI/180,b=180/Math.PI;function x(e){return e*y}function w(e){return e*b}const E=[[0,0],[1,0],[1,1],[0,1]];function A(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,i=t*e;return 4*(e<.5?i:3*(e-t)+i-.75)}function T(e,t,i,n){const r=new f(e,t,i,n);return function(e){return r.solve(e)}}const D=T(.25,.1,.25,1);function S(e,t,i){return Math.min(i,Math.max(t,e))}function C(e,t,i){return(i=S((i-e)/(t-e),0,1))*i*(3-2*i)}function P(e,t,i){const n=i-t,r=((e-t)%n+n)%n+t;return r===t?i:r}function I(e,t,i){if(!e.length)return i(null,[]);let n=e.length;const r=new Array(e.length);let s=null;e.forEach((e,o)=>{t(e,(e,t)=>{e&&(s=e),r[o]=t,0==--n&&i(s,r)})})}function k(e){const t=[];for(const i in e)t.push(e[i]);return t}function M(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)for(const t in r)e[t]=r[t];return e}let R=1;function F(){return R++}function L(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function O(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function B(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function z(e,t){e.forEach(e=>{t[e]&&(t[e]=t[e].bind(t))})}function N(e,t){return-1!==e.indexOf(t,e.length-t.length)}function U(e,t,i){const n={};for(const r in e)n[r]=t.call(i||this,e[r],r,e);return n}function j(e,t,i){const n={};for(const r in e)t.call(i||this,e[r],r,e)&&(n[r]=e[r]);return n}function V(e){return Array.isArray(e)?e.map(V):"object"==typeof e&&e?U(e,V):e}const G={};function W(e){G[e]||("undefined"!=typeof console&&console.warn(e),G[e]=!0)}function H(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function X(e){let t=0;for(let i,n,r=0,s=e.length,o=s-1;r<s;o=r++)i=e[r],n=e[o],t+=(n.x-i.x)*(i.y+n.y);return t}function q(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Z(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(e,i,n,r)=>{const s=n||r;return t[i]=!s||s.toLowerCase(),""}),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let Y=null;function K(e){if(null==Y){const t=e.navigator?e.navigator.userAgent:null;Y=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Y}function J(e){try{const i=t[e];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function $(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}const Q="mapbox-tiles";let ee,te,ie=500,ne=50;function re(){try{return t.caches}catch(e){}}function se(){re()&&!ee&&(ee=t.caches.open(Q))}function oe(e){const t=e.indexOf("?");if(t<0)return e;const i=function(e){const t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}(e),n=i.filter(e=>{const t=e.split("=");return"language"===t[0]||"worldview"===t[0]});return n.length?"".concat(e.slice(0,t),"?").concat(n.join("&")):e.slice(0,t)}let ae=1/0;const le={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(le);class ce extends Error{constructor(e,t,i){401===t&&be(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=i}toString(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}const ue=q()?()=>self.worker&&self.worker.referrer:()=>("blob:"===t.location.protocol?t.parent:t).location.href,he=function(e,i){if(!(/^file:/.test(n=e.url)||/^file:/.test(ue())&&!/^\w+:/.test(n))){if(t.fetch&&t.Request&&t.AbortController&&t.Request.prototype.hasOwnProperty("signal"))return function(e,i){const n=new t.AbortController,r=new t.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:ue(),referrerPolicy:e.referrerPolicy,signal:n.signal});let s=!1,o=!1;const a=(l=r.url).indexOf("sku=")>0&&be(l);var l;"json"===e.type&&r.headers.set("Accept","application/json");const c=(n,s,l)=>{if(o)return;if(n&&"SecurityError"!==n.message&&W(n.toString()),s&&l)return u(s);const c=Date.now();t.fetch(r).then(t=>{if(t.ok){const e=a?t.clone():null;return u(t,e,c)}return i(new ce(t.statusText,t.status,e.url))}).catch(t=>{"AbortError"!==t.name&&i(new Error("".concat(t.message," ").concat(e.url)))})},u=(n,a,l)=>{("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then(e=>{o||(a&&l&&function(e,i,n){if(se(),!ee)return;const r={status:i.status,statusText:i.statusText,headers:new t.Headers};i.headers.forEach((e,t)=>r.headers.set(t,e));const s=Z(i.headers.get("Cache-Control")||"");if(s["no-store"])return;s["max-age"]&&r.headers.set("Expires",new Date(n+1e3*s["max-age"]).toUTCString());const o=r.headers.get("Expires");o&&(new Date(o).getTime()-n<42e4||function(e,t){if(void 0===te)try{new Response(new ReadableStream),te=!0}catch(e){te=!1}te?t(e.body):e.blob().then(t)}(i,i=>{const n=new t.Response(i,r);se(),ee&&ee.then(t=>t.put(oe(e.url),n)).catch(e=>W(e.message))}))}(r,a,l),s=!0,i(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))}).catch(e=>{o||i(new Error(e.message))})};return a?function(e,t){if(se(),!ee)return t(null);const i=oe(e.url);ee.then(e=>{e.match(i).then(n=>{const r=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),i=Z(e.headers.get("Cache-Control")||"");return t>Date.now()&&!i["no-cache"]}(n);e.delete(i),r&&e.put(i,n.clone()),t(null,n,r)}).catch(t)}).catch(t)}(r,c):c(null,null),{cancel:()=>{o=!0,s||n.abort()}}}(e,i);if(q()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,i,void 0,!0)}var n;return function(e,i){const n=new t.XMLHttpRequest;n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer");for(const t in e.headers)n.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=()=>{i(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let t=n.response;if("json"===e.type)try{t=JSON.parse(n.response)}catch(e){return i(e)}i(null,t,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else i(new ce(n.statusText,n.status,e.url))},n.send(e.body),{cancel:()=>n.abort()}}(e,i)},de=function(e,t){return he(M(e,{type:"arrayBuffer"}),t)};function pe(e){const i=t.document.createElement("a");return i.href=e,i.protocol===t.document.location.protocol&&i.host===t.document.location.host}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fe,ge;fe=[],ge=0;const _e=function(e,i){if(s.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ge>=r.MAX_PARALLEL_IMAGE_REQUESTS){const t={requestParameters:e,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return fe.push(t),t}ge++;let n=!1;const o=()=>{if(!n)for(n=!0,ge--;fe.length&&ge<r.MAX_PARALLEL_IMAGE_REQUESTS;){const e=fe.shift(),{requestParameters:t,callback:i,cancelled:n}=e;n||(e.cancel=_e(t,i).cancel)}},a=de(e,(e,n,r,s)=>{o(),e?i(e):n&&(t.createImageBitmap?function(e,i){const n=new t.Blob([new Uint8Array(e)],{type:"image/png"});t.createImageBitmap(n).then(e=>{i(null,e)}).catch(e=>{i(new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}(n,(e,t)=>i(e,t,r,s)):function(e,i){const n=new t.Image,r=t.URL;n.onload=()=>{i(null,n),r.revokeObjectURL(n.src),n.onload=null,t.requestAnimationFrame(()=>{n.src=me})},n.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const s=new t.Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?r.createObjectURL(s):me}(n,(e,t)=>i(e,t,r,s)))});return{cancel:()=>{a.cancel(),o()}}},ve="NO_ACCESS_TOKEN";function ye(e){return 0===e.indexOf("mapbox:")}function be(e){return r.API_URL_REGEX.test(e)}function xe(e){return r.API_CDN_URL_REGEX.test(e)}function we(e){return r.API_STYLE_REGEX.test(e)&&!Ee(e)}function Ee(e){return r.API_SPRITE_REGEX.test(e)}const Ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Te(e){const t=e.match(Ae);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function De(e){const t=e.params.length?"?".concat(e.params.join("&")):"";return"".concat(e.protocol,"://").concat(e.authority).concat(e.path).concat(t)}const Se="mapbox.eventData";function Ce(e){if(!e)return null;const i=e.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(t.atob(i[1]).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(e){return null}}class Pe{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=Ce(r.ACCESS_TOKEN);let n="";return n=i&&i.u?t.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode(Number("0x"+t)))):r.ACCESS_TOKEN||"",e?"".concat(Se,".").concat(e,":").concat(n):"".concat(Se,":").concat(n)}fetchEventData(){const e=J("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const e=t.localStorage.getItem(i);e&&(this.eventData=JSON.parse(e));const r=t.localStorage.getItem(n);r&&(this.anonId=r)}catch(e){W("Unable to read from LocalStorage")}}saveEventData(){const e=J("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{t.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&t.localStorage.setItem(i,JSON.stringify(this.eventData))}catch(e){W("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,t,i,n){if(!r.EVENTS_URL)return;const s=Te(r.EVENTS_URL);s.params.push("access_token=".concat(n||r.ACCESS_TOKEN||""));const o={event:this.type,created:new Date(e).toISOString()},a=t?M(o,t):o,l={url:De(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(e,t){return he(M(e,{method:"POST"}),t)}(l,e=>{this.pendingRequest=null,i(e),this.saveEventData(),this.processRequests(n)})}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const Ie=new class extends Pe{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){r.EVENTS_URL&&r.ACCESS_TOKEN&&Array.isArray(e)&&e.some(e=>ye(e)||be(e))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Ce(r.ACCESS_TOKEN),n=t?t.u:r.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;B(this.anonId)||(this.anonId=L(),s=!0);const o=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(o),i=(o-this.eventData.lastSuccess)/864e5;s=s||i>=1||i<-1||e.getDate()!==t.getDate()}else s=!0;s?this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:i,skuId:h,"enabled.telemetry":!1,userId:this.anonId},e=>{e||(this.eventData.lastSuccess=o,this.eventData.tokenU=n)},e):this.processRequests()}},ke=Ie.postTurnstileEvent.bind(Ie),Me=new class extends Pe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,i,n){this.skuToken=t,this.errorCb=n,r.EVENTS_URL&&(i||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ve)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),B(this.anonId)||(this.anonId=L()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:i,skuId:h,skuToken:this.skuToken,userId:this.anonId},e=>{e?this.errorCb(e):t&&(this.success[t]=!0)},e))}},Re=Me.postMapLoadEvent.bind(Me),Fe=new class extends Pe{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){r.EVENTS_URL&&(e||r.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:n,performanceData:r}=this.queue.shift(),s=function(e){const n=t.performance.getEntriesByType("resource"),r=t.performance.getEntriesByType("mark"),s=function(e){const t={};if(e)for(const i in e)if("other"!==i)for(const n of e[i]){const e="".concat(i,"ResolveRangeMin"),r="".concat(i,"ResolveRangeMax"),s="".concat(i,"RequestCount"),o="".concat(i,"RequestCachedCount");t[e]=Math.min(t[e]||1/0,n.startTime),t[r]=Math.max(t[r]||-1/0,n.responseEnd);const a=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==n.transferSize&&0===n.transferSize&&a(o),a(s)}return t}(function(e,t){const i={};if(e)for(const n of e){const e=t(n);void 0===i[e]&&(i[e]=[]),i[e].push(n)}return i}(n,je)),o=t.devicePixelRatio,a=t.navigator.connection||t.navigator.mozConnection||t.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},c=(e,t,i)=>{null!=i&&e.push({name:t,value:i.toString()})};for(const t in s)c(l.counters,t,s[t]);if(e.interactionRange[0]!==1/0&&e.interactionRange[1]!==-1/0&&(c(l.counters,"interactionRangeMin",e.interactionRange[0]),c(l.counters,"interactionRangeMax",e.interactionRange[1])),r)for(const t of Object.keys(Ne)){const e=Ne[t],i=r.find(t=>t.name===e);i&&c(l.counters,e,i.startTime)}return c(l.counters,"visibilityHidden",e.visibilityHidden),c(l.attributes,"style",function(e){if(e)for(const t of e){const e=t.name.split("?")[0];if(we(e)){const t=e.split("/").slice(-2);if(2===t.length)return"mapbox://styles/".concat(t[0],"/").concat(t[1])}}}(n)),c(l.attributes,"terrainEnabled",e.terrainEnabled?"true":"false"),c(l.attributes,"fogEnabled",e.fogEnabled?"true":"false"),c(l.attributes,"projection",e.projection),c(l.attributes,"zoom",e.zoom),c(l.metadata,"devicePixelRatio",o),c(l.metadata,"connectionEffectiveType",a?a.effectiveType:void 0),c(l.metadata,"navigatorUserAgent",t.navigator.userAgent),c(l.metadata,"screenWidth",t.screen.width),c(l.metadata,"screenHeight",t.screen.height),c(l.metadata,"windowWidth",t.innerWidth),c(l.metadata,"windowHeight",t.innerHeight),c(l.metadata,"mapWidth",e.width/o),c(l.metadata,"mapHeight",e.height/o),c(l.metadata,"webglRenderer",e.renderer),c(l.metadata,"webglVendor",e.vendor),c(l.metadata,"sdkVersion",i),c(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(r);for(const t of s.metadata);for(const t of s.counters);for(const t of s.attributes);this.postEvent(n,s,()=>{},e)}},Le=Fe.postPerformanceEvent.bind(Fe),Oe=new class extends Pe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,i,n){if(!r.API_URL||!r.SESSION_PATH)return;const s=Te(r.API_URL+r.SESSION_PATH);s.params.push("sku=".concat(t||"")),s.params.push("access_token=".concat(n||r.ACCESS_TOKEN||""));const o={url:De(s),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(e,t){return he(M(e,{method:"GET"}),t)}(o,e=>{this.pendingRequest=null,i(e),this.saveEventData(),this.processRequests(n)})}getSessionAPI(e,t,i,n){this.skuToken=t,this.errorCb=n,r.SESSION_PATH&&r.API_URL&&(i||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},i):this.errorCb(new Error(ve)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,e=>{e?this.errorCb(e):t&&(this.success[t]=!0)},e)}},Be=Oe.getSessionAPI.bind(Oe),ze=new Set,Ne={create:"create",load:"load",fullLoad:"fullLoad"},Ue={mark(e){t.performance.mark(e)},measure(e,i,n){t.performance.measure(e,i,n)}};function je(e){const t=e.name.split("?")[0];return xe(t)&&t.includes("mapbox-gl.js")?"javascript":xe(t)&&t.includes("mapbox-gl.css")?"css":function(e){return r.API_FONTS_REGEX.test(e)}(t)?"fontRange":Ee(t)?"sprite":we(t)?"style":function(e){return r.API_TILEJSON_REGEX.test(e)}(t)?"tilejson":"other"}const Ve=t.performance;function Ge(e){const t=e?e.url.toString():void 0;return Ve.getEntriesByName(t)}let We,He,Xe,qe;const Ze={now:()=>void 0!==Xe?Xe:t.performance.now(),setNow(e){Xe=e},restoreNow(){Xe=void 0},frame(e){const i=t.requestAnimationFrame(e);return{cancel:()=>t.cancelAnimationFrame(i)}},getImageData(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r}=e;qe||(qe=t.document.createElement("canvas"));const s=qe.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return(n>qe.width||r>qe.height)&&(qe.width=n,qe.height=r),s.clearRect(-i,-i,n+2*i,r+2*i),s.drawImage(e,0,0,n,r),s.getImageData(-i,-i,n+2*i,r+2*i)},resolveURL:e=>(We||(We=t.document.createElement("a")),We.href=e,We.href),get devicePixelRatio(){return t.devicePixelRatio},get prefersReducedMotion(){return!!t.matchMedia&&(null==He&&(He=t.matchMedia("(prefers-reduced-motion: reduce)")),He.matches)}};function Ye(e,t,i){i[e]&&-1!==i[e].indexOf(t)||(i[e]=i[e]||[],i[e].push(t))}function Ke(e,t,i){if(i&&i[e]){const n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}class Je{constructor(e){M(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=e}}class $e extends Je{constructor(e){super("error",M({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class Qe{on(e,t){return this._listeners=this._listeners||{},Ye(e,t,this._listeners),this}off(e,t){return Ke(e,t,this._listeners),Ke(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Ye(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t))}fire(e,t){"string"==typeof e&&(e=new Je(e,t||{}));const i=e.type;if(this.listens(i)){e.target=this;const t=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of t)i.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const s of n)Ke(i,s,this._oneTimeListeners),s.call(this,e);const r=this._eventedParent;r&&(M(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(e))}else e instanceof $e&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function tt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)for(const t in r)e[t]=r[t];return e}function it(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nt(e){if(Array.isArray(e))return e.map(nt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const i in e)t[i]=nt(e[i]);return t}return it(e)}class rt extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}var st=rt;class ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[i,n]of t)this.bindings[i]=n}concat(e){return new ot(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var at=ot;const lt={kind:"null"},ct={kind:"number"},ut={kind:"string"},ht={kind:"boolean"},dt={kind:"color"},pt={kind:"object"},mt={kind:"value"},ft={kind:"collator"},gt={kind:"formatted"},_t={kind:"resolvedImage"};function vt(e,t){return{kind:"array",itemType:e,N:t}}function yt(e){if("array"===e.kind){const t=yt(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}const bt=[lt,ct,ut,ht,dt,gt,pt,vt(mt),_t];function xt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!xt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of bt)if(!xt(e,t))return null}return"Expected ".concat(yt(e)," but found ").concat(yt(t)," instead.")}function wt(e,t){return t.some(t=>t.kind===e.kind)}function Et(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}var At,Tt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Dt(e){return(e=Math.round(e))<0?0:e>255?255:e}function St(e){return Dt("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function Ct(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function Pt(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{At={}.parseCSSColor=function(e){var t,i=e.replace(/ /g,"").toLowerCase();if(i in Tt)return Tt[i].slice();if("#"===i[0])return 4===i.length?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===i.length&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=i.indexOf("("),r=i.indexOf(")");if(-1!==n&&r+1===i.length){var s=i.substr(0,n),o=i.substr(n+1,r-(n+1)).split(","),a=1;switch(s){case"rgba":if(4!==o.length)return null;a=Ct(o.pop());case"rgb":return 3!==o.length?null:[St(o[0]),St(o[1]),St(o[2]),a];case"hsla":if(4!==o.length)return null;a=Ct(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,c=Ct(o[1]),u=Ct(o[2]),h=u<=.5?u*(c+1):u+c-u*c,d=2*u-h;return[Dt(255*Pt(d,h,l+1/3)),Dt(255*Pt(d,h,l)),Dt(255*Pt(d,h,l-1/3)),a];default:return null}}return null}}catch(e){}class It{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=e,this.g=t,this.b=i,this.a=n}static parse(e){if(!e)return;if(e instanceof It)return e;if("string"!=typeof e)return;const t=At(e);return t?new It(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,i,n]=this.toArray();return"rgba(".concat(Math.round(e),",").concat(Math.round(t),",").concat(Math.round(i),",").concat(n,")")}toArray(){const{r:e,g:t,b:i,a:n}=this;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*i/n,n]}toArray01(){const{r:e,g:t,b:i,a:n}=this;return 0===n?[0,0,0,0]:[e/n,t/n,i/n,n]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:i,a:n}=this;return[e,t,i,n]}}It.black=new It(0,0,0,1),It.white=new It(1,1,1,1),It.transparent=new It(0,0,0,0),It.red=new It(1,0,0,1),It.blue=new It(0,0,1,1);var kt=It;class Mt{constructor(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rt{constructor(e,t,i,n,r){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=i,this.fontStack=n,this.textColor=r}}class Ft{constructor(e){this.sections=e}static fromString(e){return new Ft([new Rt(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ft?e:Ft.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const i={};t.fontStack&&(i["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(i["font-scale"]=t.scale),t.textColor&&(i["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(i)}return e}}class Lt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Lt({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ot(e,t,i,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value [".concat([e,t,i,n].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof n?[e,t,i,n]:[e,t,i]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function Bt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof kt)return!0;if(e instanceof Mt)return!0;if(e instanceof Ft)return!0;if(e instanceof Lt)return!0;if(Array.isArray(e)){for(const t of e)if(!Bt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Bt(e[t]))return!1;return!0}return!1}function zt(e){if(null===e)return lt;if("string"==typeof e)return ut;if("boolean"==typeof e)return ht;if("number"==typeof e)return ct;if(e instanceof kt)return dt;if(e instanceof Mt)return ft;if(e instanceof Ft)return gt;if(e instanceof Lt)return _t;if(Array.isArray(e)){const t=e.length;let i;for(const n of e){const e=zt(n);if(i){if(i===e)continue;i=mt;break}i=e}return vt(i||mt,t)}return pt}function Nt(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof kt||e instanceof Ft||e instanceof Lt?e.toString():JSON.stringify(e)}class Ut{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!Bt(e[1]))return t.error("invalid value");const i=e[1];let n=zt(i);const r=t.expectedType;return"array"!==n.kind||0!==n.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(n=r),new Ut(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof kt?["rgba"].concat(this.value.toArray()):this.value instanceof Ft?this.value.serialize():this.value}}var jt=Ut,Vt=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const Gt={string:ut,number:ct,boolean:ht,object:pt};class Wt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let i,n=1;const r=e[0];if("array"===r){let r,s;if(e.length>2){const i=e[1];if("string"!=typeof i||!(i in Gt)||"object"===i)return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=Gt[i],n++}else r=mt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);s=e[2],n++}i=vt(r,s)}else i=Gt[r];const s=[];for(;n<e.length;n++){const i=t.parse(e[n],n,mt);if(!i)return null;s.push(i)}return new Wt(i,s)}evaluate(e){for(let t=0;t<this.args.length;t++){const i=this.args[t].evaluate(e);if(!xt(this.type,zt(i)))return i;if(t===this.args.length-1)throw new Vt("Expected value to be of type ".concat(yt(this.type),", but found ").concat(yt(zt(i))," instead."))}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const i=e.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){t.push(i.kind);const n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map(e=>e.serialize()))}}var Ht=Wt;class Xt{constructor(e){this.type=gt,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&"object"==typeof i)return t.error("First argument must be an image or text section.");const n=[];let r=!1;for(let s=1;s<=e.length-1;++s){const i=e[s];if(r&&"object"==typeof i&&!Array.isArray(i)){r=!1;let e=null;if(i["font-scale"]&&(e=t.parse(i["font-scale"],1,ct),!e))return null;let s=null;if(i["text-font"]&&(s=t.parse(i["text-font"],1,vt(ut)),!s))return null;let o=null;if(i["text-color"]&&(o=t.parse(i["text-color"],1,dt),!o))return null;const a=n[n.length-1];a.scale=e,a.font=s,a.textColor=o}else{const i=t.parse(e[s],1,mt);if(!i)return null;const o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,n.push({content:i,scale:null,font:null,textColor:null})}}return new Xt(n)}evaluate(e){return new Ft(this.sections.map(t=>{const i=t.content.evaluate(e);return zt(i)===_t?new Rt("",i,null,null,null):new Rt(Nt(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const i={};t.scale&&(i["font-scale"]=t.scale.serialize()),t.font&&(i["text-font"]=t.font.serialize()),t.textColor&&(i["text-color"]=t.textColor.serialize()),e.push(i)}return e}}class qt{constructor(e){this.type=_t,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,ut);return i?new qt(i):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),i=Lt.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Zt={"to-boolean":ht,"to-color":dt,"to-number":ct,"to-string":ut};class Yt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const i=e[0];if(("to-boolean"===i||"to-string"===i)&&2!==e.length)return t.error("Expected one argument.");const n=Zt[i],r=[];for(let s=1;s<e.length;s++){const i=t.parse(e[s],s,mt);if(!i)return null;r.push(i)}return new Yt(n,r)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,i;for(const n of this.args){if(t=n.evaluate(e),i=null,t instanceof kt)return t;if("string"==typeof t){const i=e.parseColor(t);if(i)return i}else if(Array.isArray(t)&&(i=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):Ot(t[0],t[1],t[2],t[3]),!i))return new kt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Vt(i||"Could not parse color from value '".concat("string"==typeof t?t:String(JSON.stringify(t)),"'"))}if("number"===this.type.kind){let t=null;for(const i of this.args){if(t=i.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Vt("Could not convert ".concat(JSON.stringify(t)," to number."))}return"formatted"===this.type.kind?Ft.fromString(Nt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Lt.fromString(Nt(this.args[0].evaluate(e))):Nt(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Xt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new qt(this.args[0]).serialize();const e=["to-".concat(this.type.kind)];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Kt=Yt;const Jt=["Unknown","Point","LineString","Polygon"];var $t=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Jt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:n}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-e[0])+this.featureDistanceData.bearing[1]*(n*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=kt.parse(e)),t}};class Qt{constructor(e,t,i,n){this.name=e,this.type=t,this._evaluate=i,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,t){const i=e[0],n=Qt.definitions[i];if(!n)return t.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);const r=Array.isArray(n)?n[0]:n.type,s=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=s.filter(t=>{let[i]=t;return!Array.isArray(i)||i.length===e.length-1});let a=null;for(const[l,c]of o){a=new Di(t.registry,t.path,null,t.scope);const n=[];let s=!1;for(let t=1;t<e.length;t++){const i=e[t],r=Array.isArray(l)?l[t-1]:l.type,o=a.parse(i,1+n.length,r);if(!o){s=!0;break}n.push(o)}if(!s)if(Array.isArray(l)&&l.length!==n.length)a.error("Expected ".concat(l.length," arguments, but found ").concat(n.length," instead."));else{for(let e=0;e<n.length;e++){const t=Array.isArray(l)?l[e]:l.type,i=n[e];a.concat(e+1).checkSubtype(t,i.type)}if(0===a.errors.length)return new Qt(i,r,c,n)}}if(1===o.length)t.errors.push(...a.errors);else{const i=(o.length?o:s).map(e=>{let[t]=e;return i=t,Array.isArray(i)?"(".concat(i.map(yt).join(", "),")"):"(".concat(yt(i.type),"...)");var i}).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(yt(i.type))}t.error("Expected arguments of type ".concat(i,", but found (").concat(n.join(", "),") instead."))}return null}static register(e,t){Qt.definitions=t;for(const i in t)e[i]=Qt}}var ei=Qt;class ti{constructor(e,t,i){this.type=ft,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const i=e[1];if("object"!=typeof i||Array.isArray(i))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,ht);if(!n)return null;const r=t.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,ht);if(!r)return null;let s=null;return i.locale&&(s=t.parse(i.locale,1,ut),!s)?null:new ti(n,r,s)}evaluate(e){return new Mt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ii=8192;function ni(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ri(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function si(e,t){const i=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(i*r*ii),Math.round(n*r*ii)]}function oi(e,t,i){const n=e[0]-t[0],r=e[1]-t[1],s=e[0]-i[0],o=e[1]-i[1];return n*o-s*r==0&&n*s<=0&&r*o<=0}function ai(e,t){let i=!1;for(let o=0,a=t.length;o<a;o++){const a=t[o];for(let t=0,o=a.length;t<o-1;t++){if(oi(e,a[t],a[t+1]))return!1;(r=a[t])[1]>(n=e)[1]!=(s=a[t+1])[1]>n[1]&&n[0]<(s[0]-r[0])*(n[1]-r[1])/(s[1]-r[1])+r[0]&&(i=!i)}}var n,r,s;return i}function li(e,t){for(let i=0;i<t.length;i++)if(ai(e,t[i]))return!0;return!1}function ci(e,t,i,n){const r=n[0]-i[0],s=n[1]-i[1],o=(e[0]-i[0])*s-r*(e[1]-i[1]),a=(t[0]-i[0])*s-r*(t[1]-i[1]);return o>0&&a<0||o<0&&a>0}function ui(e,t,i){for(const c of i)for(let i=0;i<c.length-1;++i)if(0!=(a=[(o=c[i+1])[0]-(s=c[i])[0],o[1]-s[1]])[0]*(l=[(r=t)[0]-(n=e)[0],r[1]-n[1]])[1]-a[1]*l[0]&&ci(n,r,s,o)&&ci(s,o,n,r))return!0;var n,r,s,o,a,l;return!1}function hi(e,t){for(let i=0;i<e.length;++i)if(!ai(e[i],t))return!1;for(let i=0;i<e.length-1;++i)if(ui(e[i],e[i+1],t))return!1;return!0}function di(e,t){for(let i=0;i<t.length;i++)if(hi(e,t[i]))return!0;return!1}function pi(e,t,i){const n=[];for(let r=0;r<e.length;r++){const s=[];for(let n=0;n<e[r].length;n++){const o=si(e[r][n],i);ni(t,o),s.push(o)}n.push(s)}return n}function mi(e,t,i){const n=[];for(let r=0;r<e.length;r++){const s=pi(e[r],t,i);n.push(s)}return n}function fi(e,t,i,n){if(e[0]<i[0]||e[0]>i[2]){const t=.5*n;let r=e[0]-i[0]>t?-n:i[0]-e[0]>t?n:0;0===r&&(r=e[0]-i[2]>t?-n:i[2]-e[0]>t?n:0),e[0]+=r}ni(t,e)}function gi(e,t,i,n){const r=Math.pow(2,n.z)*ii,s=[n.x*ii,n.y*ii],o=[];if(!e)return o;for(const a of e)for(const e of a){const n=[e.x+s[0],e.y+s[1]];fi(n,t,i,r),o.push(n)}return o}function _i(e,t,i,n){const r=Math.pow(2,n.z)*ii,s=[n.x*ii,n.y*ii],o=[];if(!e)return o;for(const l of e){const e=[];for(const i of l){const n=[i.x+s[0],i.y+s[1]];ni(t,n),e.push(n)}o.push(e)}if(t[2]-t[0]<=r/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const e of o)for(const n of e)fi(n,t,i,r)}var a;return o}class vi{constructor(e,t){this.type=ht,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(Bt(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const i=t.features[e].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new vi(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new vi(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new vi(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const s=pi(t.coordinates,n,r),o=gi(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!ai(e,s))return!1}if("MultiPolygon"===t.type){const s=mi(t.coordinates,n,r),o=gi(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!li(e,s))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const s=pi(t.coordinates,n,r),o=_i(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!hi(e,s))return!1}if("MultiPolygon"===t.type){const s=mi(t.coordinates,n,r),o=_i(e.geometry(),i,n,r);if(!ri(i,n))return!1;for(const e of o)if(!di(e,s))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var yi=vi;function bi(e){if(e instanceof ei){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof yi)return!1;let t=!0;return e.eachChild(e=>{t&&!bi(e)&&(t=!1)}),t}function xi(e){if(e instanceof ei&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!xi(e)&&(t=!1)}),t}function wi(e,t){if(e instanceof ei&&t.indexOf(e.name)>=0)return!1;let i=!0;return e.eachChild(e=>{i&&!wi(e,t)&&(i=!1)}),i}class Ei{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const i=e[1];return t.scope.has(i)?new Ei(i,t.scope.get(i)):t.error('Unknown variable "'.concat(i,'". Make sure "').concat(i,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ai=Ei;class Ti{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new at,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.registry=e,this.path=t,this.key=t.map(e=>"[".concat(e,"]")).join(""),this.scope=n,this.errors=r,this.expectedType=i}parse(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,i,n)._parse(e,r):this._parse(e,r)}_parse(e,t){function i(e,t,i){return"assert"===i?new Ht(t,[e]):"coerce"===i?new Kt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found ".concat(typeof n,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;const r=this.registry[n];if(r){let n=r.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,r=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(e,r))return null}else n=i(n,e,t.typeAnnotation||"coerce");else n=i(n,e,t.typeAnnotation||"assert")}if(!(n instanceof jt)&&"resolvedImage"!==n.type.kind&&Si(n)){const t=new $t;try{n=new jt(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}concat(e,t,i){const n="number"==typeof e?this.path.concat(e):this.path,r=i?this.scope.concat(i):this.scope;return new Ti(this.registry,n,t||null,r,this.errors)}error(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];const r="".concat(this.key).concat(i.map(e=>"[".concat(e,"]")).join(""));this.errors.push(new st(r,e))}checkSubtype(e,t){const i=xt(e,t);return i&&this.error(i),i}}var Di=Ti;function Si(e){if(e instanceof Ai)return Si(e.boundExpression);if(e instanceof ei&&"error"===e.name)return!1;if(e instanceof ti)return!1;if(e instanceof yi)return!1;const t=e instanceof Kt||e instanceof Ht;let i=!0;return e.eachChild(e=>{i=t?i&&Si(e):i&&e instanceof jt}),!!i&&bi(e)&&wi(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ci(e,t){const i=e.length-1;let n,r,s=0,o=i,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),n=e[a],r=e[a+1],n<=t){if(a===i||t<r)return a;s=a+1}else{if(!(n>t))throw new Vt("Input is not a number.");o=a-1}return 0}class Pi{constructor(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,r]of i)this.labels.push(n),this.outputs.push(r)}static parse(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const i=t.parse(e[1],1,ct);if(!i)return null;const n=[];let r=null;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(let s=1;s<e.length;s+=2){const i=1===s?-1/0:e[s],o=e[s+1],a=s,l=s+1;if("number"!=typeof i)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=i)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=t.parse(o,l,r);if(!c)return null;r=r||c.type,n.push([i,c])}return new Pi(r,i,n)}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;return n>=t[r-1]?i[r-1].evaluate(e):i[Ci(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var Ii=Pi;function ki(e,t,i){return e*(1-i)+t*i}var Mi=Object.freeze({__proto__:null,array:function(e,t,i){return e.map((e,n)=>ki(e,t[n],i))},color:function(e,t,i){return new kt(ki(e.r,t.r,i),ki(e.g,t.g,i),ki(e.b,t.b,i),ki(e.a,t.a,i))},number:ki});const Ri=.95047,Fi=1.08883,Li=4/29,Oi=6/29,Bi=3*Oi*Oi,zi=Oi*Oi*Oi,Ni=Math.PI/180,Ui=180/Math.PI;function ji(e){return e>zi?Math.pow(e,1/3):e/Bi+Li}function Vi(e){return e>Oi?e*e*e:Bi*(e-Li)}function Gi(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Wi(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Hi(e){const t=Wi(e.r),i=Wi(e.g),n=Wi(e.b),r=ji((.4124564*t+.3575761*i+.1804375*n)/Ri),s=ji((.2126729*t+.7151522*i+.072175*n)/1);return{l:116*s-16,a:500*(r-s),b:200*(s-ji((.0193339*t+.119192*i+.9503041*n)/Fi)),alpha:e.a}}function Xi(e){let t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Vi(t),i=Ri*Vi(i),n=Fi*Vi(n),new kt(Gi(3.2404542*i-1.5371385*t-.4985314*n),Gi(-.969266*i+1.8760108*t+.041556*n),Gi(.0556434*i-.2040259*t+1.0572252*n),e.alpha)}function qi(e,t,i){const n=t-e;return e+i*(n>180||n<-180?n-360*Math.round(n/360):n)}const Zi={forward:Hi,reverse:Xi,interpolate:function(e,t,i){return{l:ki(e.l,t.l,i),a:ki(e.a,t.a,i),b:ki(e.b,t.b,i),alpha:ki(e.alpha,t.alpha,i)}}},Yi={forward:function(e){const{l:t,a:i,b:n}=Hi(e),r=Math.atan2(n,i)*Ui;return{h:r<0?r+360:r,c:Math.sqrt(i*i+n*n),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Ni,i=e.c;return Xi({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:qi(e.h,t.h,i),c:ki(e.c,t.c,i),l:ki(e.l,t.l,i),alpha:ki(e.alpha,t.alpha,i)}}};var Ki=Object.freeze({__proto__:null,hcl:Yi,lab:Zi});class Ji{constructor(e,t,i,n,r){this.type=e,this.operator=t,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[s,o]of r)this.labels.push(s),this.outputs.push(o)}static interpolationFactor(e,t,i,n){let r=0;if("exponential"===e.name)r=$i(t,e.base,i,n);else if("linear"===e.name)r=$i(t,1,i,n);else if("cubic-bezier"===e.name){const s=e.controlPoints;r=new f(s[0],s[1],s[2],s[3]).solve($i(t,1,i,n))}return r}static parse(e,t){let[i,n,r,...s]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error("Unknown interpolation type ".concat(String(n[0])),1,0);{const e=n.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(r=t.parse(r,2,ct),!r)return null;const o=[];let a=null;"interpolate-hcl"===i||"interpolate-lab"===i?a=dt:t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let l=0;l<s.length;l+=2){const e=s[l],i=s[l+1],n=l+3,r=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(o.length&&o[o.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=t.parse(i,r,a);if(!c)return null;a=a||c.type,o.push([e,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Ji(a,i,n,r,o):t.error("Type ".concat(yt(a)," is not interpolatable."))}evaluate(e){const t=this.labels,i=this.outputs;if(1===t.length)return i[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return i[0].evaluate(e);const r=t.length;if(n>=t[r-1])return i[r-1].evaluate(e);const s=Ci(t,n),o=Ji.interpolationFactor(this.interpolation,n,t[s],t[s+1]),a=i[s].evaluate(e),l=i[s+1].evaluate(e);return"interpolate"===this.operator?Mi[this.type.kind.toLowerCase()](a,l,o):"interpolate-hcl"===this.operator?Yi.reverse(Yi.interpolate(Yi.forward(a),Yi.forward(l),o)):Zi.reverse(Zi.interpolate(Zi.forward(a),Zi.forward(l),o))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t}}function $i(e,t,i,n){const r=n-i,s=e-i;return 0===r?0:1===t?s/r:(Math.pow(t,s)-1)/(Math.pow(t,r)-1)}var Qi=Ji;class en{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let i=null;const n=t.expectedType;n&&"value"!==n.kind&&(i=n);const r=[];for(const o of e.slice(1)){const e=t.parse(o,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!e)return null;i=i||e.type,r.push(e)}const s=n&&r.some(e=>xt(n,e.type));return new en(s?mt:i,r)}evaluate(e){let t,i=null,n=0;for(const r of this.args){if(n++,i=r.evaluate(e),i&&i instanceof Lt&&!i.available&&(t||(t=i),i=null,n===this.args.length))return t;if(null!==i)break}return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var tn=en;class nn{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));const i=[];for(let r=1;r<e.length-1;r+=2){const n=e[r];if("string"!=typeof n)return t.error("Expected string, but found ".concat(typeof n," instead."),r);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);const s=t.parse(e[r+1],r+1);if(!s)return null;i.push([n,s])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return n?new nn(i,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,i]of this.bindings)e.push(t,i.serialize());return e.push(this.result.serialize()),e}}var rn=nn;class sn{constructor(e,t,i){this.type=e,this.index=t,this.input=i}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const i=t.parse(e[1],1,ct),n=t.parse(e[2],2,vt(t.expectedType||mt));return i&&n?new sn(n.type.itemType,i,n):null}evaluate(e){const t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Vt("Array index out of bounds: ".concat(t," < 0."));if(t>=i.length)throw new Vt("Array index out of bounds: ".concat(t," > ").concat(i.length-1,"."));if(t!==Math.floor(t))throw new Vt("Array index must be an integer, but found ".concat(t," instead."));return i[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var on=sn;class an{constructor(e,t){this.type=ht,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,mt);return i&&n?wt(i.type,[ht,ut,ct,lt,mt])?new an(i,n):t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(yt(i.type)," instead")):null}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(null==i)return!1;if(!Et(t,["boolean","string","number","null"]))throw new Vt("Expected first argument to be of type boolean, string, number or null, but found ".concat(yt(zt(t))," instead."));if(!Et(i,["string","array"]))throw new Vt("Expected second argument to be of type array or string, but found ".concat(yt(zt(i))," instead."));return i.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var ln=an;class cn{constructor(e,t,i){this.type=ct,this.needle=e,this.haystack=t,this.fromIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,mt);if(!i||!n)return null;if(!wt(i.type,[ht,ut,ct,lt,mt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(yt(i.type)," instead"));if(4===e.length){const r=t.parse(e[3],3,ct);return r?new cn(i,n,r):null}return new cn(i,n)}evaluate(e){const t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!Et(t,["boolean","string","number","null"]))throw new Vt("Expected first argument to be of type boolean, string, number or null, but found ".concat(yt(zt(t))," instead."));if(!Et(i,["string","array"]))throw new Vt("Expected second argument to be of type array or string, but found ".concat(yt(zt(i))," instead."));if(this.fromIndex){const n=this.fromIndex.evaluate(e);return i.indexOf(t,n)}return i.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var un=cn;class hn{constructor(e,t,i,n,r,s){this.inputType=e,this.type=t,this.input=i,this.cases=n,this.outputs=r,this.otherwise=s}static parse(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=1)return t.error("Expected an even number of arguments.");let i,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const r={},s=[];for(let l=2;l<e.length-1;l+=2){let o=e[l];const a=e[l+1];Array.isArray(o)||(o=[o]);const c=t.concat(l);if(0===o.length)return c.error("Expected at least one branch label.");for(const e of o){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,zt(e)))return null}else i=zt(e);if(void 0!==r[String(e)])return c.error("Branch labels must be unique.");r[String(e)]=s.length}const u=t.parse(a,l,n);if(!u)return null;n=n||u.type,s.push(u)}const o=t.parse(e[1],1,mt);if(!o)return null;const a=t.parse(e[e.length-1],e.length-1,n);return a?"value"!==o.type.kind&&t.concat(1).checkSubtype(i,o.type)?null:new hn(i,n,o,r,s,a):null}evaluate(e){const t=this.input.evaluate(e);return(zt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),i=[],n={};for(const s of t){const e=n[this.cases[s]];void 0===e?(n[this.cases[s]]=i.length,i.push([this.cases[s],[s]])):i[e][1].push(s)}const r=e=>"number"===this.inputType.kind?Number(e):e;for(const[s,o]of i)e.push(1===o.length?r(o[0]):o.map(r)),e.push(this.outputs[s].serialize());return e.push(this.otherwise.serialize()),e}}var dn=hn;class pn{constructor(e,t,i){this.type=e,this.branches=t,this.otherwise=i}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const n=[];for(let s=1;s<e.length-1;s+=2){const r=t.parse(e[s],s,ht);if(!r)return null;const o=t.parse(e[s+1],s+1,i);if(!o)return null;n.push([r,o]),i=i||o.type}const r=t.parse(e[e.length-1],e.length-1,i);return r?new pn(i,n,r):null}evaluate(e){for(const[t,i]of this.branches)if(t.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,i]of this.branches)e(t),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(e=>{let[t,i]=e;return i.outputDefined()})&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var mn=pn;class fn{constructor(e,t,i,n){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const i=t.parse(e[1],1,mt),n=t.parse(e[2],2,ct);if(!i||!n)return null;if(!wt(i.type,[vt(mt),ut,mt]))return t.error("Expected first argument to be of type array or string, but found ".concat(yt(i.type)," instead"));if(4===e.length){const r=t.parse(e[3],3,ct);return r?new fn(i.type,i,n,r):null}return new fn(i.type,i,n)}evaluate(e){const t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!Et(t,["string","array"]))throw new Vt("Expected first argument to be of type array or string, but found ".concat(yt(zt(t))," instead."));if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(i,n)}return t.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var gn=fn;function _n(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function vn(e,t,i,n){return 0===n.compare(t,i)}function yn(e,t,i){const n="=="!==e&&"!="!==e;return class r{constructor(e,t,i){this.type=ht,this.lhs=e,this.rhs=t,this.collator=i,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const i=e[0];let s=t.parse(e[1],1,mt);if(!s)return null;if(!_n(i,s.type))return t.concat(1).error('"'.concat(i,"\" comparisons are not supported for type '").concat(yt(s.type),"'."));let o=t.parse(e[2],2,mt);if(!o)return null;if(!_n(i,o.type))return t.concat(2).error('"'.concat(i,"\" comparisons are not supported for type '").concat(yt(o.type),"'."));if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '".concat(yt(s.type),"' and '").concat(yt(o.type),"'."));n&&("value"===s.type.kind&&"value"!==o.type.kind?s=new Ht(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new Ht(s.type,[o])));let a=null;if(4===e.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(a=t.parse(e[3],3,ft),!a)return null}return new r(s,o,a)}evaluate(r){const s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){const t=zt(s),i=zt(o);if(t.kind!==i.kind||"string"!==t.kind&&"number"!==t.kind)throw new Vt('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(t.kind,", ").concat(i.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){const e=zt(s),i=zt(o);if("string"!==e.kind||"string"!==i.kind)return t(r,s,o)}return this.collator?i(r,s,o,this.collator.evaluate(r)):t(r,s,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild(e=>{t.push(e.serialize())}),t}}}const bn=yn("==",function(e,t,i){return t===i},vn),xn=yn("!=",function(e,t,i){return t!==i},function(e,t,i,n){return!vn(0,t,i,n)}),wn=yn("<",function(e,t,i){return t<i},function(e,t,i,n){return n.compare(t,i)<0}),En=yn(">",function(e,t,i){return t>i},function(e,t,i,n){return n.compare(t,i)>0}),An=yn("<=",function(e,t,i){return t<=i},function(e,t,i,n){return n.compare(t,i)<=0}),Tn=yn(">=",function(e,t,i){return t>=i},function(e,t,i,n){return n.compare(t,i)>=0});class Dn{constructor(e,t,i,n,r,s){this.type=ut,this.number=e,this.locale=t,this.currency=i,this.unit=n,this.minFractionDigits=r,this.maxFractionDigits=s}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const i=t.parse(e[1],1,ct);if(!i)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let r=null;if(n.locale&&(r=t.parse(n.locale,1,ut),!r))return null;let s=null;if(n.currency&&(s=t.parse(n.currency,1,ut),!s))return null;let o=null;if(n.unit&&(o=t.parse(n.unit,1,ut),!o))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,ct),!a))return null;let l=null;return n["max-fraction-digits"]&&(l=t.parse(n["max-fraction-digits"],1,ct),!l)?null:new Dn(i,r,s,o,a,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Sn{constructor(e){this.type=ct,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found ".concat(e.length-1," instead."));const i=t.parse(e[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?t.error("Expected argument of type string or array, but found ".concat(yt(i.type)," instead.")):new Sn(i):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Vt("Expected value to be of type string or array, but found ".concat(yt(zt(t))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(t=>{e.push(t.serialize())}),e}}const Cn={"==":bn,"!=":xn,">":En,"<":wn,">=":Tn,"<=":An,array:Ht,at:on,boolean:Ht,case:mn,coalesce:tn,collator:ti,format:Xt,image:qt,in:ln,"index-of":un,interpolate:Qi,"interpolate-hcl":Qi,"interpolate-lab":Qi,length:Sn,let:rn,literal:jt,match:dn,number:Ht,"number-format":Dn,object:Ht,slice:gn,step:Ii,string:Ht,"to-boolean":Kt,"to-color":Kt,"to-number":Kt,"to-string":Kt,var:Ai,within:yi};function Pn(e,t){let[i,n,r,s]=t;i=i.evaluate(e),n=n.evaluate(e),r=r.evaluate(e);const o=s?s.evaluate(e):1,a=Ot(i,n,r,o);if(a)throw new Vt(a);return new kt(i/255*o,n/255*o,r/255*o,o)}function In(e,t){return e in t}function kn(e,t){const i=t[e];return void 0===i?null:i}function Mn(e){return{type:e}}ei.register(Cn,{error:[{kind:"error"},[ut],(e,t)=>{let[i]=t;throw new Vt(i.evaluate(e))}],typeof:[ut,[mt],(e,t)=>{let[i]=t;return yt(zt(i.evaluate(e)))}],"to-rgba":[vt(ct,4),[dt],(e,t)=>{let[i]=t;return i.evaluate(e).toArray()}],rgb:[dt,[ct,ct,ct],Pn],rgba:[dt,[ct,ct,ct,ct],Pn],has:{type:ht,overloads:[[[ut],(e,t)=>{let[i]=t;return In(i.evaluate(e),e.properties())}],[[ut,pt],(e,t)=>{let[i,n]=t;return In(i.evaluate(e),n.evaluate(e))}]]},get:{type:mt,overloads:[[[ut],(e,t)=>{let[i]=t;return kn(i.evaluate(e),e.properties())}],[[ut,pt],(e,t)=>{let[i,n]=t;return kn(i.evaluate(e),n.evaluate(e))}]]},"feature-state":[mt,[ut],(e,t)=>{let[i]=t;return kn(i.evaluate(e),e.featureState||{})}],properties:[pt,[],e=>e.properties()],"geometry-type":[ut,[],e=>e.geometryType()],id:[mt,[],e=>e.id()],zoom:[ct,[],e=>e.globals.zoom],pitch:[ct,[],e=>e.globals.pitch||0],"distance-from-center":[ct,[],e=>e.distanceFromCenter()],"heatmap-density":[ct,[],e=>e.globals.heatmapDensity||0],"line-progress":[ct,[],e=>e.globals.lineProgress||0],"sky-radial-progress":[ct,[],e=>e.globals.skyRadialProgress||0],accumulated:[mt,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ct,Mn(ct),(e,t)=>{let i=0;for(const n of t)i+=n.evaluate(e);return i}],"*":[ct,Mn(ct),(e,t)=>{let i=1;for(const n of t)i*=n.evaluate(e);return i}],"-":{type:ct,overloads:[[[ct,ct],(e,t)=>{let[i,n]=t;return i.evaluate(e)-n.evaluate(e)}],[[ct],(e,t)=>{let[i]=t;return-i.evaluate(e)}]]},"/":[ct,[ct,ct],(e,t)=>{let[i,n]=t;return i.evaluate(e)/n.evaluate(e)}],"%":[ct,[ct,ct],(e,t)=>{let[i,n]=t;return i.evaluate(e)%n.evaluate(e)}],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(e,t)=>{let[i,n]=t;return Math.pow(i.evaluate(e),n.evaluate(e))}],sqrt:[ct,[ct],(e,t)=>{let[i]=t;return Math.sqrt(i.evaluate(e))}],log10:[ct,[ct],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN10}],ln:[ct,[ct],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))}],log2:[ct,[ct],(e,t)=>{let[i]=t;return Math.log(i.evaluate(e))/Math.LN2}],sin:[ct,[ct],(e,t)=>{let[i]=t;return Math.sin(i.evaluate(e))}],cos:[ct,[ct],(e,t)=>{let[i]=t;return Math.cos(i.evaluate(e))}],tan:[ct,[ct],(e,t)=>{let[i]=t;return Math.tan(i.evaluate(e))}],asin:[ct,[ct],(e,t)=>{let[i]=t;return Math.asin(i.evaluate(e))}],acos:[ct,[ct],(e,t)=>{let[i]=t;return Math.acos(i.evaluate(e))}],atan:[ct,[ct],(e,t)=>{let[i]=t;return Math.atan(i.evaluate(e))}],min:[ct,Mn(ct),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[ct,Mn(ct),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[ct,[ct],(e,t)=>{let[i]=t;return Math.abs(i.evaluate(e))}],round:[ct,[ct],(e,t)=>{let[i]=t;const n=i.evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[ct,[ct],(e,t)=>{let[i]=t;return Math.floor(i.evaluate(e))}],ceil:[ct,[ct],(e,t)=>{let[i]=t;return Math.ceil(i.evaluate(e))}],"filter-==":[ht,[ut,mt],(e,t)=>{let[i,n]=t;return e.properties()[i.value]===n.value}],"filter-id-==":[ht,[mt],(e,t)=>{let[i]=t;return e.id()===i.value}],"filter-type-==":[ht,[ut],(e,t)=>{let[i]=t;return e.geometryType()===i.value}],"filter-<":[ht,[ut,mt],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],s=n.value;return typeof r==typeof s&&r<s}],"filter-id-<":[ht,[mt],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n<r}],"filter->":[ht,[ut,mt],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],s=n.value;return typeof r==typeof s&&r>s}],"filter-id->":[ht,[mt],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n>r}],"filter-<=":[ht,[ut,mt],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],s=n.value;return typeof r==typeof s&&r<=s}],"filter-id-<=":[ht,[mt],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n<=r}],"filter->=":[ht,[ut,mt],(e,t)=>{let[i,n]=t;const r=e.properties()[i.value],s=n.value;return typeof r==typeof s&&r>=s}],"filter-id->=":[ht,[mt],(e,t)=>{let[i]=t;const n=e.id(),r=i.value;return typeof n==typeof r&&n>=r}],"filter-has":[ht,[mt],(e,t)=>{let[i]=t;return i.value in e.properties()}],"filter-has-id":[ht,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[ht,[vt(ut)],(e,t)=>{let[i]=t;return i.value.indexOf(e.geometryType())>=0}],"filter-id-in":[ht,[vt(mt)],(e,t)=>{let[i]=t;return i.value.indexOf(e.id())>=0}],"filter-in-small":[ht,[ut,vt(mt)],(e,t)=>{let[i,n]=t;return n.value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[ht,[ut,vt(mt)],(e,t)=>{let[i,n]=t;return function(e,t,i,n){for(;i<=n;){const r=i+n>>1;if(t[r]===e)return!0;t[r]>e?n=r-1:i=r+1}return!1}(e.properties()[i.value],n.value,0,n.value.length-1)}],all:{type:ht,overloads:[[[ht,ht],(e,t)=>{let[i,n]=t;return i.evaluate(e)&&n.evaluate(e)}],[Mn(ht),(e,t)=>{for(const i of t)if(!i.evaluate(e))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(e,t)=>{let[i,n]=t;return i.evaluate(e)||n.evaluate(e)}],[Mn(ht),(e,t)=>{for(const i of t)if(i.evaluate(e))return!0;return!1}]]},"!":[ht,[ht],(e,t)=>{let[i]=t;return!i.evaluate(e)}],"is-supported-script":[ht,[ut],(e,t)=>{let[i]=t;const n=e.globals&&e.globals.isSupportedScript;return!n||n(i.evaluate(e))}],upcase:[ut,[ut],(e,t)=>{let[i]=t;return i.evaluate(e).toUpperCase()}],downcase:[ut,[ut],(e,t)=>{let[i]=t;return i.evaluate(e).toLowerCase()}],concat:[ut,Mn(mt),(e,t)=>t.map(t=>Nt(t.evaluate(e))).join("")],"resolved-locale":[ut,[ft],(e,t)=>{let[i]=t;return i.evaluate(e).resolvedLocale()}]});var Rn=Cn;function Fn(e){return{result:"success",value:e}}function Ln(e){return{result:"error",value:e}}function On(e){return"data-driven"===e["property-type"]}function Bn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function zn(e){return!!e.expression&&e.expression.interpolated}function Nn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Un(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function jn(e){return e}function Vn(e,t){const i="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],r=n||!(n||void 0!==e.property),s=e.type||(zn(t)?"exponential":"interval");if(i&&((e=tt({},e)).stops&&(e.stops=e.stops.map(e=>[e[0],kt.parse(e[1])])),e.default=kt.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Ki[e.colorSpace])throw new Error("Unknown color space: ".concat(e.colorSpace));let o,a,l;if("exponential"===s)o=Xn;else if("interval"===s)o=Hn;else if("categorical"===s){o=Wn,a=Object.create(null);for(const t of e.stops)a[t[0]]=t[1];l=typeof e.stops[0][0]}else{if("identity"!==s)throw new Error('Unknown function type "'.concat(s,'"'));o=qn}if(n){const i={},n=[];for(let t=0;t<e.stops.length;t++){const r=e.stops[t],s=r[0].zoom;void 0===i[s]&&(i[s]={zoom:s,type:e.type,property:e.property,default:e.default,stops:[]},n.push(s)),i[s].stops.push([r[0].value,r[1]])}const r=[];for(const e of n)r.push([i[e].zoom,Vn(i[e],t)]);const s={name:"linear"};return{kind:"composite",interpolationType:s,interpolationFactor:Qi.interpolationFactor.bind(void 0,s),zoomStops:r.map(e=>e[0]),evaluate:(i,n)=>{let{zoom:s}=i;return Xn({stops:r,base:e.base},t,s).evaluate(s,n)}}}if(r){const i="exponential"===s?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:Qi.interpolationFactor.bind(void 0,i),zoomStops:e.stops.map(e=>e[0]),evaluate:i=>{let{zoom:n}=i;return o(e,t,n,a,l)}}}return{kind:"source",evaluate(i,n){const r=n&&n.properties?n.properties[e.property]:void 0;return void 0===r?Gn(e.default,t.default):o(e,t,r,a,l)}}}function Gn(e,t,i){return void 0!==e?e:void 0!==t?t:void 0!==i?i:void 0}function Wn(e,t,i,n,r){return Gn(typeof i===r?n[i]:void 0,e.default,t.default)}function Hn(e,t,i){if("number"!==Nn(i))return Gn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[n-1][0])return e.stops[n-1][1];const r=Ci(e.stops.map(e=>e[0]),i);return e.stops[r][1]}function Xn(e,t,i){const n=void 0!==e.base?e.base:1;if("number"!==Nn(i))return Gn(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[r-1][0])return e.stops[r-1][1];const s=Ci(e.stops.map(e=>e[0]),i),o=function(e,t,i,n){const r=n-i,s=e-i;return 0===r?0:1===t?s/r:(Math.pow(t,s)-1)/(Math.pow(t,r)-1)}(i,n,e.stops[s][0],e.stops[s+1][0]),a=e.stops[s][1],l=e.stops[s+1][1];let c=Mi[t.type]||jn;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Ki[e.colorSpace];c=(e,i)=>t.reverse(t.interpolate(t.forward(e),t.forward(i),o))}return"function"==typeof a.evaluate?{evaluate(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=a.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return c(n,r,o)}}:c(a,l,o)}function qn(e,t,i){return"color"===t.type?i=kt.parse(i):"formatted"===t.type?i=Ft.fromString(i.toString()):"resolvedImage"===t.type?i=Lt.fromString(i.toString()):Nn(i)===t.type||"enum"===t.type&&t.values[i]||(i=void 0),Gn(i,e.default,t.default)}class Zn{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new $t,this._defaultValue=t?function(e){return"color"===e.type&&(Un(e.default)||Array.isArray(e.default))?new kt(0,0,0,0):"color"===e.type?kt.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,i,n,r,s,o,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,i,n,r,s,o,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=s||null,this._evaluator.featureTileCoord=o||null,this._evaluator.featureDistanceData=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Vt("Expected value to be one of ".concat(Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", "),", but found ").concat(JSON.stringify(e)," instead."));return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Yn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Rn}function Kn(e,t){const i=new Di(Rn,[],t?function(e){const t={color:dt,string:ut,number:ct,enum:ut,boolean:ht,formatted:gt,resolvedImage:_t};return"array"===e.type?vt(t[e.value]||mt,e.length):t[e.type]}(t):void 0),n=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Fn(new Zn(n,t)):Ln(i.errors)}class Jn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!xi(t.expression)}evaluateWithoutErrorHandling(e,t,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,s)}evaluate(e,t,i,n,r,s){return this._styleExpression.evaluate(e,t,i,n,r,s)}}class $n{constructor(e,t,i,n){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent="camera"!==e&&!xi(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,i,n,r,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,n,r,s)}evaluate(e,t,i,n,r,s){return this._styleExpression.evaluate(e,t,i,n,r,s)}interpolationFactor(e,t,i){return this.interpolationType?Qi.interpolationFactor(this.interpolationType,e,t,i):0}}function Qn(e,t){if("error"===(e=Kn(e,t)).result)return e;const i=e.value.expression,n=bi(i);if(!n&&!On(t))return Ln([new st("","data expressions not supported")]);const r=wi(i,["zoom","pitch","distance-from-center"]);if(!r&&!Bn(t))return Ln([new st("","zoom expressions not supported")]);const s=tr(i);return s||r?s instanceof st?Ln([s]):s instanceof Qi&&!zn(t)?Ln([new st("",'"interpolate" expressions cannot be used with this property')]):Fn(s?new $n(n?"camera":"composite",e.value,s.labels,s instanceof Qi?s.interpolation:void 0):new Jn(n?"constant":"source",e.value)):Ln([new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class er{constructor(e,t){this._parameters=e,this._specification=t,tt(this,Vn(this._parameters,this._specification))}static deserialize(e){return new er(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function tr(e){let t=null;if(e instanceof rn)t=tr(e.result);else if(e instanceof tn){for(const i of e.args)if(t=tr(i),t)break}else(e instanceof Ii||e instanceof Qi)&&e.input instanceof ei&&"zoom"===e.input.name&&(t=e);return t instanceof st||e.eachChild(e=>{const i=tr(e);i instanceof st?t=i:!t&&i?t=new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new st("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class ir{constructor(e,t,i,n){this.message=(e?"".concat(e,": "):"")+i,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function nr(e){const t=e.key,i=e.value,n=e.valueSpec||{},r=e.objectElementValidators||{},s=e.style,o=e.styleSpec;let a=[];const l=Nn(i);if("object"!==l)return[new ir(t,i,"object expected, ".concat(l," found"))];for(const c in i){const e=c.split(".")[0];let l;r[e]?l=r[e]:n[e]?l=Br:r["*"]?l=r["*"]:n["*"]&&(l=Br),l?a=a.concat(l({key:(t?"".concat(t,"."):t)+c,value:i[c],valueSpec:n[e]||n["*"],style:s,styleSpec:o,object:i,objectKey:c},i)):a.push(new ir(t,i[c],'unknown property "'.concat(c,'"')))}for(const c in n)r[c]||n[c].required&&void 0===n[c].default&&void 0===i[c]&&a.push(new ir(t,i,'missing required property "'.concat(c,'"')));return a}function rr(e){const t=e.value,i=e.valueSpec,n=e.style,r=e.styleSpec,s=e.key,o=e.arrayElementValidator||Br;if("array"!==Nn(t))return[new ir(s,t,"array expected, ".concat(Nn(t)," found"))];if(i.length&&t.length!==i.length)return[new ir(s,t,"array length ".concat(i.length," expected, length ").concat(t.length," found"))];if(i["min-length"]&&t.length<i["min-length"])return[new ir(s,t,"array length at least ".concat(i["min-length"]," expected, length ").concat(t.length," found"))];let a={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};r.$version<7&&(a.function=i.function),"object"===Nn(i.value)&&(a=i.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(o({array:t,arrayIndex:c,value:t[c],valueSpec:a,style:n,styleSpec:r,key:"".concat(s,"[").concat(c,"]")}));return l}function sr(e){const t=e.key,i=e.value,n=e.valueSpec;let r=Nn(i);if("number"===r&&i!=i&&(r="NaN"),"number"!==r)return[new ir(t,i,"number expected, ".concat(r," found"))];if("minimum"in n){let r=n.minimum;if("array"===Nn(n.minimum)&&(r=n.minimum[e.arrayIndex]),i<r)return[new ir(t,i,"".concat(i," is less than the minimum value ").concat(r))]}if("maximum"in n){let r=n.maximum;if("array"===Nn(n.maximum)&&(r=n.maximum[e.arrayIndex]),i>r)return[new ir(t,i,"".concat(i," is greater than the maximum value ").concat(r))]}return[]}function or(e){const t=e.valueSpec,i=it(e.value.type);let n,r,s,o={};const a="categorical"!==i&&void 0===e.value.property,l=!a,c="array"===Nn(e.value.stops)&&"array"===Nn(e.value.stops[0])&&"object"===Nn(e.value.stops[0][0]),u=nr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===i)return[new ir(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(rr({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===Nn(n)&&0===n.length&&t.push(new ir(e.key,n,"array must have at least one stop")),t},default:function(e){return Br({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===i&&a&&u.push(new ir(e.key,e.value,'missing required property "property"')),"identity"===i||e.value.stops||u.push(new ir(e.key,e.value,'missing required property "stops"')),"exponential"===i&&e.valueSpec.expression&&!zn(e.valueSpec)&&u.push(new ir(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!On(e.valueSpec)?u.push(new ir(e.key,e.value,"property functions not supported")):a&&!Bn(e.valueSpec)&&u.push(new ir(e.key,e.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==e.value.property||u.push(new ir(e.key,e.value,'"property" property is required')),u;function h(e){let i=[];const n=e.value,a=e.key;if("array"!==Nn(n))return[new ir(a,n,"array expected, ".concat(Nn(n)," found"))];if(2!==n.length)return[new ir(a,n,"array length 2 expected, length ".concat(n.length," found"))];if(c){if("object"!==Nn(n[0]))return[new ir(a,n,"object expected, ".concat(Nn(n[0])," found"))];if(void 0===n[0].zoom)return[new ir(a,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new ir(a,n,"object stop key must have value")];const t=it(n[0].zoom);if("number"!=typeof t)return[new ir(a,n[0].zoom,"stop zoom values must be numbers")];if(s&&s>t)return[new ir(a,n[0].zoom,"stop zoom values must appear in ascending order")];t!==s&&(s=t,r=void 0,o={}),i=i.concat(nr({key:"".concat(a,"[0]"),value:n[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:sr,value:d}}))}else i=i.concat(d({key:"".concat(a,"[0]"),value:n[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},n));return Yn(nt(n[1]))?i.concat([new ir("".concat(a,"[1]"),n[1],"expressions are not allowed in function stops.")]):i.concat(Br({key:"".concat(a,"[1]"),value:n[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function d(e,s){const a=Nn(e.value),l=it(e.value),c=null!==e.value?e.value:s;if(n){if(a!==n)return[new ir(e.key,c,"".concat(a," stop domain type must match previous stop domain type ").concat(n))]}else n=a;if("number"!==a&&"string"!==a&&"boolean"!==a&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new ir(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){let n="number expected, ".concat(a," found");return On(t)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ir(e.key,c,n)]}return"categorical"!==i||"number"!==a||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===a&&"number"==typeof l&&"number"==typeof r&&void 0!==r&&l<r?[new ir(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in o?[new ir(e.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new ir(e.key,c,"integer expected, found ".concat(String(l)))]}}function ar(e){const t=("property"===e.expressionContext?Qn:Kn)(nt(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new ir("".concat(e.key).concat(t.key),e.value,t.message));const i=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!i.outputDefined())return[new ir(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!xi(i))return[new ir(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return lr(i,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!wi(i,["zoom","feature-state"]))return[new ir(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!bi(i))return[new ir(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function lr(e,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const r of t.valueSpec.expression.parameters)i.delete(r);if(0===i.size)return[];const n=[];return e instanceof ei&&i.has(e.name)?[new ir(t.key,t.value,'["'.concat(e.name,'"] expression is not supported in a filter for a ').concat(t.object.type," layer with id: ").concat(t.object.id))]:(e.eachChild(e=>{n.push(...lr(e,t))}),n)}function cr(e){const t=e.key,i=e.value,n=e.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(it(i))&&r.push(new ir(t,i,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(i)," found"))):-1===Object.keys(n.values).indexOf(it(i))&&r.push(new ir(t,i,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(i)," found"))),r}function ur(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!ur(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function hr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill";if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ur(e)||(e=vr(e));const i=e;let n=!0;try{n=function(e){if(!mr(e))return e;let t=nt(e);return pr(t),t=dr(t),t}(i)}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(i,null,2),"\n        "))}const r=et["filter_".concat(t)],s=Kn(n,r);let o=null;if("error"===s.result)throw new Error(s.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));o=(e,t,i)=>s.value.evaluate(e,t,{},i);let a=null,l=null;if(n!==i){const e=Kn(i,r);if("error"===e.result)throw new Error(e.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));a=(t,i,n,r,s)=>e.value.evaluate(t,i,{},n,void 0,void 0,r,s),l=!bi(e.value.expression)}return{filter:o,dynamicFilter:a||void 0,needGeometry:_r(n),needFeature:!!l}}function dr(e){if(!Array.isArray(e))return e;const t=function(e){if(fr.has(e[0]))for(let t=1;t<e.length;t++)if(mr(e[t]))return!0;return e}(e);return!0===t?t:t.map(e=>dr(e))}function pr(e){let t=!1;const i=[];if("case"===e[0]){for(let n=1;n<e.length-1;n+=2)t=t||mr(e[n]),i.push(e[n+1]);i.push(e[e.length-1])}else if("match"===e[0]){t=t||mr(e[1]);for(let t=2;t<e.length-1;t+=2)i.push(e[t+1]);i.push(e[e.length-1])}else if("step"===e[0]){t=t||mr(e[1]);for(let t=1;t<e.length-1;t+=2)i.push(e[t+1])}t&&(e.length=0,e.push("any",...i));for(let n=1;n<e.length;n++)pr(e[n])}function mr(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let i=1;i<e.length;i++)if(mr(e[i]))return!0;return!1}const fr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function gr(e,t){return e<t?-1:e>t?1:0}function _r(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(_r(e[t]))return!0;return!1}function vr(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?yr(e[1],e[2],"=="):"!="===t?wr(yr(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?yr(e[1],e[2],t):"any"===t?(i=e.slice(1),["any"].concat(i.map(vr))):"all"===t?["all"].concat(e.slice(1).map(vr)):"none"===t?["all"].concat(e.slice(1).map(vr).map(wr)):"in"===t?br(e[1],e.slice(2)):"!in"===t?wr(br(e[1],e.slice(2))):"has"===t?xr(e[1]):"!has"===t?wr(xr(e[1])):"within"!==t||e;var i}function yr(e,t,i){switch(e){case"$type":return["filter-type-".concat(i),t];case"$id":return["filter-id-".concat(i),t];default:return["filter-".concat(i),e,t]}}function br(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(gr)]]:["filter-in-small",e,["literal",t]]}}function xr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function wr(e){return["!",e]}function Er(e){return ur(nt(e.value))?ar(tt({},e,{expressionContext:"filter",valueSpec:e.styleSpec["filter_".concat(e.layerType||"fill")]})):Ar(e)}function Ar(e){const t=e.value,i=e.key;if("array"!==Nn(t))return[new ir(i,t,"array expected, ".concat(Nn(t)," found"))];const n=e.styleSpec;let r,s=[];if(t.length<1)return[new ir(i,t,"filter array must have at least 1 element")];switch(s=s.concat(cr({key:"".concat(i,"[0]"),value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),it(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===it(t[1])&&s.push(new ir(i,t,'"$type" cannot be use with operator "'.concat(t[0],'"')));case"==":case"!=":3!==t.length&&s.push(new ir(i,t,'filter array for operator "'.concat(t[0],'" must have 3 elements')));case"in":case"!in":t.length>=2&&(r=Nn(t[1]),"string"!==r&&s.push(new ir("".concat(i,"[1]"),t[1],"string expected, ".concat(r," found"))));for(let o=2;o<t.length;o++)r=Nn(t[o]),"$type"===it(t[1])?s=s.concat(cr({key:"".concat(i,"[").concat(o,"]"),value:t[o],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&s.push(new ir("".concat(i,"[").concat(o,"]"),t[o],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)s=s.concat(Ar({key:"".concat(i,"[").concat(n,"]"),value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=Nn(t[1]),2!==t.length?s.push(new ir(i,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"string"!==r&&s.push(new ir("".concat(i,"[1]"),t[1],"string expected, ".concat(r," found")));break;case"within":r=Nn(t[1]),2!==t.length?s.push(new ir(i,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"object"!==r&&s.push(new ir("".concat(i,"[1]"),t[1],"object expected, ".concat(r," found")))}return s}function Tr(e,t){const i=e.key,n=e.style,r=e.styleSpec,s=e.value,o=e.objectKey,a=r["".concat(t,"_").concat(e.layerType)];if(!a)return[];const l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&a[l[1]]&&a[l[1]].transition)return Br({key:i,value:s,valueSpec:r.transition,style:n,styleSpec:r});const c=e.valueSpec||a[o];if(!c)return[new ir(i,s,'unknown property "'.concat(o,'"'))];let u;if("string"===Nn(s)&&On(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(s))){const e='`{ "type": "identity", "property": '.concat(u?JSON.stringify(u[1]):'"_"'," }`");return[new ir(i,s,'"'.concat(o,'" does not support interpolation syntax\nUse an identity property function instead: ').concat(e,"."))]}const h=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&h.push(new ir(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Un(nt(s))&&"identity"===it(s.type)&&h.push(new ir(i,s,'"text-font" does not support identity functions'))),h.concat(Br({key:e.key,value:s,valueSpec:c,style:n,styleSpec:r,expressionContext:"property",propertyType:t,propertyKey:o}))}function Dr(e){return Tr(e,"paint")}function Sr(e){return Tr(e,"layout")}function Cr(e){let t=[];const i=e.value,n=e.key,r=e.style,s=e.styleSpec;i.type||i.ref||t.push(new ir(n,i,'either "type" or "ref" is required'));let o=it(i.type);const a=it(i.ref);if(i.id){const s=it(i.id);for(let o=0;o<e.arrayIndex;o++){const e=r.layers[o];it(e.id)===s&&t.push(new ir(n,i.id,'duplicate layer id "'.concat(i.id,'", previously used at line ').concat(e.id.__line__)))}}if("ref"in i){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in i&&t.push(new ir(n,i[e],'"'.concat(e,'" is prohibited for ref layers')))}),r.layers.forEach(t=>{it(t.id)===a&&(e=t)}),e?e.ref?t.push(new ir(n,i.ref,"ref cannot reference another ref layer")):o=it(e.type):"string"==typeof a&&t.push(new ir(n,i.ref,'ref layer "'.concat(a,'" not found')))}else if("background"!==o&&"sky"!==o)if(i.source){const e=r.sources&&r.sources[i.source],s=e&&it(e.type);e?"vector"===s&&"raster"===o?t.push(new ir(n,i.source,'layer "'.concat(i.id,'" requires a raster source'))):"raster"===s&&"raster"!==o?t.push(new ir(n,i.source,'layer "'.concat(i.id,'" requires a vector source'))):"vector"!==s||i["source-layer"]?"raster-dem"===s&&"hillshade"!==o?t.push(new ir(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===s&&e.lineMetrics||t.push(new ir(n,i,'layer "'.concat(i.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new ir(n,i,'layer "'.concat(i.id,'" must specify a "source-layer"'))):t.push(new ir(n,i.source,'source "'.concat(i.source,'" not found')))}else t.push(new ir(n,i,'missing required property "source"'));return t=t.concat(nr({key:n,value:i,valueSpec:s.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Br({key:"".concat(n,".type"),value:i.type,valueSpec:s.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"}),filter:e=>Er(tt({layerType:o},e)),layout:e=>nr({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>Sr(tt({layerType:o},e))}}),paint:e=>nr({layer:i,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>Dr(tt({layerType:o},e))}})}})),t}function Pr(e){const t=e.value,i=e.key,n=Nn(t);return"string"!==n?[new ir(i,t,"string expected, ".concat(n," found"))]:[]}const Ir={promoteId:function(e){let{key:t,value:i}=e;if("string"===Nn(i))return Pr({key:t,value:i});{const e=[];for(const n in i)e.push(...Pr({key:"".concat(t,".").concat(n),value:i[n]}));return e}}};function kr(e){const t=e.value,i=e.key,n=e.styleSpec,r=e.style;if(!t.type)return[new ir(i,t,'"type" is required')];const s=it(t.type);let o;switch(s){case"vector":case"raster":case"raster-dem":return o=nr({key:i,value:t,valueSpec:n["source_".concat(s.replace("-","_"))],style:e.style,styleSpec:n,objectElementValidators:Ir}),o;case"geojson":if(o=nr({key:i,value:t,valueSpec:n.source_geojson,style:r,styleSpec:n,objectElementValidators:Ir}),t.cluster)for(const e in t.clusterProperties){const[n,r]=t.clusterProperties[e],s="string"==typeof n?[n,["accumulated"],["get",e]]:n;o.push(...ar({key:"".concat(i,".").concat(e,".map"),value:r,expressionContext:"cluster-map"})),o.push(...ar({key:"".concat(i,".").concat(e,".reduce"),value:s,expressionContext:"cluster-reduce"}))}return o;case"video":return nr({key:i,value:t,valueSpec:n.source_video,style:r,styleSpec:n});case"image":return nr({key:i,value:t,valueSpec:n.source_image,style:r,styleSpec:n});case"canvas":return[new ir(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cr({key:"".concat(i,".type"),value:t.type,valueSpec:{values:Mr(n)},style:r,styleSpec:n})}}function Mr(e){return e.source.reduce((t,i)=>{const n=e[i];return"enum"===n.type.type&&(t=t.concat(Object.keys(n.type.values))),t},[])}function Rr(e){const t=e.value,i=e.styleSpec,n=i.light,r=e.style;let s=[];const o=Nn(t);if(void 0===t)return s;if("object"!==o)return s=s.concat([new ir("light",t,"object expected, ".concat(o," found"))]),s;for(const a in t){const e=a.match(/^(.*)-transition$/);s=s.concat(e&&n[e[1]]&&n[e[1]].transition?Br({key:a,value:t[a],valueSpec:i.transition,style:r,styleSpec:i}):n[a]?Br({key:a,value:t[a],valueSpec:n[a],style:r,styleSpec:i}):[new ir(a,t[a],'unknown property "'.concat(a,'"'))])}return s}function Fr(e){const t=e.value,i=e.key,n=e.style,r=e.styleSpec,s=r.terrain;let o=[];const a=Nn(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new ir("terrain",t,"object expected, ".concat(a," found"))]),o;for(const l in t){const e=l.match(/^(.*)-transition$/);o=o.concat(e&&s[e[1]]&&s[e[1]].transition?Br({key:l,value:t[l],valueSpec:r.transition,style:n,styleSpec:r}):s[l]?Br({key:l,value:t[l],valueSpec:s[l],style:n,styleSpec:r}):[new ir(l,t[l],'unknown property "'.concat(l,'"'))])}if(t.source){const e=n.sources&&n.sources[t.source],r=e&&it(e.type);e?"raster-dem"!==r&&o.push(new ir(i,t.source,"terrain cannot be used with a source of type ".concat(String(r),', it only be used with a "raster-dem" source type'))):o.push(new ir(i,t.source,'source "'.concat(t.source,'" not found')))}else o.push(new ir(i,t,'terrain is missing required property "source"'));return o}function Lr(e){const t=e.value,i=e.style,n=e.styleSpec,r=n.fog;let s=[];const o=Nn(t);if(void 0===t)return s;if("object"!==o)return s=s.concat([new ir("fog",t,"object expected, ".concat(o," found"))]),s;for(const a in t){const e=a.match(/^(.*)-transition$/);s=s.concat(e&&r[e[1]]&&r[e[1]].transition?Br({key:a,value:t[a],valueSpec:n.transition,style:i,styleSpec:n}):r[a]?Br({key:a,value:t[a],valueSpec:r[a],style:i,styleSpec:n}):[new ir(a,t[a],'unknown property "'.concat(a,'"'))])}return s}const Or={"*":()=>[],array:rr,boolean:function(e){const t=e.value,i=e.key,n=Nn(t);return"boolean"!==n?[new ir(i,t,"boolean expected, ".concat(n," found"))]:[]},number:sr,color:function(e){const t=e.key,i=e.value,n=Nn(i);return"string"!==n?[new ir(t,i,"color expected, ".concat(n," found"))]:null===At(i)?[new ir(t,i,'color expected, "'.concat(i,'" found'))]:[]},enum:cr,filter:Er,function:or,layer:Cr,object:nr,source:kr,light:Rr,terrain:Fr,fog:Lr,string:Pr,formatted:function(e){return 0===Pr(e).length?[]:ar(e)},resolvedImage:function(e){return 0===Pr(e).length?[]:ar(e)},projection:function(e){const t=e.value,i=e.styleSpec,n=i.projection,r=e.style;let s=[];const o=Nn(t);if("object"===o)for(const a in t)s=s.concat(Br({key:a,value:t[a],valueSpec:n[a],style:r,styleSpec:i}));else"string"!==o&&(s=s.concat([new ir("projection",t,"object or string expected, ".concat(o," found"))]));return s}};function Br(e){const t=e.value,i=e.valueSpec,n=e.styleSpec;return i.expression&&Un(it(t))?or(e):i.expression&&Yn(nt(t))?ar(e):i.type&&Or[i.type]?Or[i.type](e):nr(tt({},e,{valueSpec:i.type?n[i.type]:i}))}function zr(e){const t=e.value,i=e.key,n=Pr(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new ir(i,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new ir(i,t,'"glyphs" url must include a "{range}" token'))),n}function Nr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:et;return Vr(Br({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:zr,"*":()=>[]}}))}const Ur=e=>Vr(Dr(e)),jr=e=>Vr(Sr(e));function Vr(e){return e.slice().sort((e,t)=>e.line&&t.line?e.line-t.line:0)}function Gr(e,t){let i=!1;if(t&&t.length)for(const n of t)e.fire(new $e(new Error(n.message))),i=!0;return i}var Wr=Xr,Hr=3;function Xr(e,t,i){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(i=r[2]);for(var s=0;s<this.d*this.d;s++){var o=r[Hr+s],a=r[Hr+s+1];n.push(o===a?null:r.subarray(o,a))}var l=r[Hr+n.length+1];this.keys=r.subarray(r[Hr+n.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var u=i/t*e;this.min=-u,this.max=e+u}Xr.prototype.insert=function(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)},Xr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xr.prototype._insertCell=function(e,t,i,n,r,s){this.cells[r].push(s)},Xr.prototype.query=function(e,t,i,n,r){var s=this.min,o=this.max;if(e<=s&&t<=s&&o<=i&&o<=n&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(e,t,i,n,this._queryCell,a,{},r),a},Xr.prototype._queryCell=function(e,t,i,n,r,s,o,a){var l=this.cells[r];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===o[d]){var p=4*d;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):e<=u[p+2]&&t<=u[p+3]&&i>=u[p+0]&&n>=u[p+1])?(o[d]=!0,s.push(c[d])):o[d]=!1}}},Xr.prototype._forEachCell=function(e,t,i,n,r,s,o,a){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(i),h=this._convertToCellCoord(n),d=l;d<=u;d++)for(var p=c;p<=h;p++){var m=this.d*p+d;if((!a||a(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&r.call(this,e,t,i,n,m,s,o,a))return}},Xr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Xr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Xr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=Hr+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var r=new Int32Array(t+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var s=t,o=0;o<e.length;o++){var a=e[o];r[Hr+o]=s,r.set(a,s),s+=a.length}return r[Hr+e.length]=s,r.set(this.keys,s),r[Hr+e.length+1]=s+=this.keys.length,r.set(this.bboxes,s),s+=this.bboxes.length,r.buffer};var qr=d(Wr);const Zr={};function Yr(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Zr[t]={klass:e,omit:i.omit||[]}}Yr(Object,"Object"),qr.serialize=function(e,t){const i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},qr.deserialize=function(e){return new qr(e.buffer)},Object.defineProperty(qr,"name",{value:"Grid"}),Yr(qr,"Grid"),Yr(kt,"Color"),Yr(Error,"Error"),Yr(ce,"AJAXError"),Yr(Lt,"ResolvedImage"),Yr(er,"StylePropertyFunction"),Yr(Zn,"StyleExpression",{omit:["_evaluator"]}),Yr($n,"ZoomDependentExpression"),Yr(Jn,"ZoomConstantExpression"),Yr(ei,"CompoundExpression",{omit:["_evaluate"]});for(const Ef in Rn)Zr[Rn[Ef]._classRegistryKey]||Yr(Rn[Ef],"Expression".concat(Ef));function Kr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Jr(e){return t.ImageBitmap&&e instanceof t.ImageBitmap}function $r(e,i){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Kr(e)||Jr(e))return i&&i.push(e),e;if(ArrayBuffer.isView(e)){const t=e;return i&&i.push(t.buffer),t}if(e instanceof t.ImageData)return i&&i.push(e.data.buffer),e;if(Array.isArray(e)){const t=[];for(const n of e)t.push($r(n,i));return t}if("object"==typeof e){const t=e.constructor,n=t._classRegistryKey;if(!n)throw new Error("can't serialize object of unregistered class ".concat(n));const r=t.serialize?t.serialize(e,i):{};if(!t.serialize){for(const t in e)e.hasOwnProperty(t)&&(Zr[n].omit.indexOf(t)>=0||(r[t]=$r(e[t],i)));e instanceof Error&&(r.message=e.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}throw new Error("can't serialize object of type "+typeof e)}function Qr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Kr(e)||Jr(e)||ArrayBuffer.isView(e)||e instanceof t.ImageData)return e;if(Array.isArray(e))return e.map(Qr);if("object"==typeof e){const t=e.$name||"Object",{klass:i}=Zr[t];if(!i)throw new Error("can't deserialize unregistered class ".concat(t));if(i.deserialize)return i.deserialize(e);const n=Object.create(i.prototype);for(const r of Object.keys(e))"$name"!==r&&(n[r]=Qr(e[r]));return n}throw new Error("can't deserialize object of type "+typeof e)}const es={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function ts(e){for(const t of e)if(rs(t.charCodeAt(0)))return!0;return!1}function is(e){for(const t of e)if(!ns(t.charCodeAt(0)))return!1;return!0}function ns(e){return!(es.Arabic(e)||es["Arabic Supplement"](e)||es["Arabic Extended-A"](e)||es["Arabic Presentation Forms-A"](e)||es["Arabic Presentation Forms-B"](e))}function rs(e){return!(746!==e&&747!==e&&(e<4352||!(es["Bopomofo Extended"](e)||es.Bopomofo(e)||es["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||es["CJK Compatibility Ideographs"](e)||es["CJK Compatibility"](e)||es["CJK Radicals Supplement"](e)||es["CJK Strokes"](e)||!(!es["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||es["CJK Unified Ideographs Extension A"](e)||es["CJK Unified Ideographs"](e)||es["Enclosed CJK Letters and Months"](e)||es["Hangul Compatibility Jamo"](e)||es["Hangul Jamo Extended-A"](e)||es["Hangul Jamo Extended-B"](e)||es["Hangul Jamo"](e)||es["Hangul Syllables"](e)||es.Hiragana(e)||es["Ideographic Description Characters"](e)||es.Kanbun(e)||es["Kangxi Radicals"](e)||es["Katakana Phonetic Extensions"](e)||es.Katakana(e)&&12540!==e||!(!es["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!es["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||es["Unified Canadian Aboriginal Syllabics"](e)||es["Unified Canadian Aboriginal Syllabics Extended"](e)||es["Vertical Forms"](e)||es["Yijing Hexagram Symbols"](e)||es["Yi Syllables"](e)||es["Yi Radicals"](e))))}function ss(e){return!(rs(e)||function(e){return!!(es["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||es["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||es["Letterlike Symbols"](e)||es["Number Forms"](e)||es["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||es["Control Pictures"](e)&&9251!==e||es["Optical Character Recognition"](e)||es["Enclosed Alphanumerics"](e)||es["Geometric Shapes"](e)||es["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||es["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||es["CJK Symbols and Punctuation"](e)||es.Katakana(e)||es["Private Use Area"](e)||es["CJK Compatibility Forms"](e)||es["Small Form Variants"](e)||es["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function os(e){return e>=1424&&e<=2303||es["Arabic Presentation Forms-A"](e)||es["Arabic Presentation Forms-B"](e)}function as(e,t){return!(!t&&os(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||es.Khmer(e))}function ls(e){for(const t of e)if(os(t.charCodeAt(0)))return!0;return!1}const cs="deferred",us="loading",hs="loaded";let ds=null,ps="unavailable",ms=null;const fs=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(ps="error"),ds&&ds(e)};function gs(){_s.fire(new Je("pluginStateChange",{pluginStatus:ps,pluginURL:ms}))}const _s=new Qe,vs=function(){return ps},ys=function(){if(ps!==cs||!ms)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ps=us,gs(),ms&&de({url:ms},e=>{e?fs(e):(ps=hs,gs())})},bs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ps===hs||null!=bs.applyArabicShaping,isLoading:()=>ps===us,setState(e){ps=e.pluginStatus,ms=e.pluginURL},isParsed:()=>null!=bs.applyArabicShaping&&null!=bs.processBidirectionalText&&null!=bs.processStyledBidirectionalText,getPluginURL:()=>ms};class xs{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(e,t){for(const i of e)if(!as(i.charCodeAt(0),t))return!1;return!0}(e,bs.isLoaded())}}class ws{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Un(e))return new er(e,t);if(Yn(e)){const i=Qn(e,t);if("error"===i.result)throw new Error(i.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));return i.value}{let i=e;return"string"==typeof e&&"color"===t.type&&(i=kt.parse(e)),{kind:"constant",evaluate:()=>i}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)}}class Es{constructor(e){this.property=e,this.value=new ws(e,void 0)}transitioned(e,t){return new Ts(this.property,this.value,t,M({},e.transition,this.transition),e.now)}untransitioned(){return new Ts(this.property,this.value,null,{},0)}}class As{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return V(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Es(this._values[e].property)),this._values[e].value=new ws(this._values[e].property,null===t?void 0:V(t))}getTransition(e){return V(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Es(this._values[e].property)),this._values[e].transition=V(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i);const n=this.getTransition(t);void 0!==n&&(e["".concat(t,"-transition")]=n)}return e}transitioned(e,t){const i=new Ds(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(e,t._values[n]);return i}untransitioned(){const e=new Ds(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Ts{constructor(e,t,i,n,r){const s=n.delay||0,o=n.duration||0;r=r||0,this.property=e,this.value=t,this.begin=r+s,this.end=this.begin+o,e.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(e,t,i){const n=e.now||0,r=this.value.possiblyEvaluate(e,t,i),s=this.prior;if(s){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return s.possiblyEvaluate(e,t,i);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(e,t,i),r,A(o))}}return r}}class Ds{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,i){const n=new Ps(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ss{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return V(this._values[e].value)}setValue(e,t){this._values[e]=new ws(this._values[e].property,null===t?void 0:V(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const i=this.getValue(t);void 0!==i&&(e[t]=i)}return e}possiblyEvaluate(e,t,i){const n=new Ps(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(e,t,i);return n}}class Cs{constructor(e,t,i){this.property=e,this.value=t,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,i,n){return this.property.evaluate(this.value,this.parameters,e,t,i,n)}}class Ps{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Is{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,i){const n=Mi[this.specification.type];return n?n(e,t,i):e}}class ks{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,i,n){return new Cs(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},i,n)}:e.expression,t)}interpolate(e,t,i){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Cs(this,{kind:"constant",value:void 0},e.parameters);const n=Mi[this.specification.type];return n?new Cs(this,{kind:"constant",value:n(e.value.value,t.value.value,i)},e.parameters):e}evaluate(e,t,i,n,r,s){return"constant"===e.kind?e.value:e.evaluate(t,i,n,r,s)}}class Ms{constructor(e){this.specification=e}possiblyEvaluate(e,t,i,n){return!!e.expression.evaluate(t,null,{},i,n)}interpolate(){return!1}}class Rs{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new xs(0,{});for(const i in e){const n=e[i];n.specification.overridable&&this.overridableProperties.push(i);const r=this.defaultPropertyValues[i]=new ws(n,void 0),s=this.defaultTransitionablePropertyValues[i]=new Es(n);this.defaultTransitioningPropertyValues[i]=s.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=r.possiblyEvaluate(t)}}}function Fs(e,t){return 256*(e=S(Math.floor(e),0,255))+S(Math.floor(t),0,255)}Yr(ks,"DataDrivenProperty"),Yr(Is,"DataConstantProperty"),Yr(Ms,"ColorRampProperty");const Ls={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Os{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bs{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function zs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,n=0;return{members:e.map(e=>{const r=Ls[e.type].BYTES_PER_ELEMENT,s=i=Ns(i,Math.max(t,r)),o=e.components||1;return n=Math.max(n,r),i+=r*o,{name:e.name,type:e.type,components:o,offset:s}}),size:Ns(i,Math.max(n,t)),alignment:t}}function Ns(e,t){return Math.ceil(e/t)*t}class Us extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=i,e}}Us.prototype.bytesPerElement=4,Yr(Us,"StructArrayLayout2i4");class js extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.int16[r+0]=t,this.int16[r+1]=i,this.int16[r+2]=n,e}}js.prototype.bytesPerElement=6,Yr(js,"StructArrayLayout3i6");class Vs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.int16[s+0]=t,this.int16[s+1]=i,this.int16[s+2]=n,this.int16[s+3]=r,e}}Vs.prototype.bytesPerElement=8,Yr(Vs,"StructArrayLayout4i8");class Gs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r,s,o)}emplace(e,t,i,n,r,s,o,a){const l=6*e,c=12*e,u=3*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.uint8[c+4]=n,this.uint8[c+5]=r,this.uint8[c+6]=s,this.uint8[c+7]=o,this.float32[u+2]=a,e}}Gs.prototype.bytesPerElement=12,Yr(Gs,"StructArrayLayout2i4ub1f12");class Ws extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.float32[s+0]=t,this.float32[s+1]=i,this.float32[s+2]=n,this.float32[s+3]=r,e}}Ws.prototype.bytesPerElement=16,Yr(Ws,"StructArrayLayout4f16");class Hs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=6*e,a=3*e;return this.uint16[o+0]=t,this.uint16[o+1]=i,this.uint16[o+2]=n,this.uint16[o+3]=r,this.float32[a+2]=s,e}}Hs.prototype.bytesPerElement=12,Yr(Hs,"StructArrayLayout4ui1f12");class Xs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=4*e;return this.uint16[s+0]=t,this.uint16[s+1]=i,this.uint16[s+2]=n,this.uint16[s+3]=r,e}}Xs.prototype.bytesPerElement=8,Yr(Xs,"StructArrayLayout4ui8");class qs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,s)}emplace(e,t,i,n,r,s,o){const a=6*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.int16[a+3]=r,this.int16[a+4]=s,this.int16[a+5]=o,e}}qs.prototype.bytesPerElement=12,Yr(qs,"StructArrayLayout6i12");class Zs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,i,n,r,s,o,a,l,c,u,h)}emplace(e,t,i,n,r,s,o,a,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=i,this.int16[p+2]=n,this.int16[p+3]=r,this.uint16[p+4]=s,this.uint16[p+5]=o,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}Zs.prototype.bytesPerElement=24,Yr(Zs,"StructArrayLayout4i4ui4i24");class Ys extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,i,n,r,s)}emplace(e,t,i,n,r,s,o){const a=10*e,l=5*e;return this.int16[a+0]=t,this.int16[a+1]=i,this.int16[a+2]=n,this.float32[l+2]=r,this.float32[l+3]=s,this.float32[l+4]=o,e}}Ys.prototype.bytesPerElement=20,Yr(Ys,"StructArrayLayout3i3f20");class Ks extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}Ks.prototype.bytesPerElement=4,Yr(Ks,"StructArrayLayout1ul4");class Js extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,u,h,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,i,n,r,s,o,a,l,c,u,h,d)}emplace(e,t,i,n,r,s,o,a,l,c,u,h,d,p){const m=20*e,f=10*e;return this.int16[m+0]=t,this.int16[m+1]=i,this.int16[m+2]=n,this.int16[m+3]=r,this.int16[m+4]=s,this.float32[f+3]=o,this.float32[f+4]=a,this.float32[f+5]=l,this.float32[f+6]=c,this.int16[m+14]=u,this.uint32[f+8]=h,this.uint16[m+18]=d,this.uint16[m+19]=p,e}}Js.prototype.bytesPerElement=40,Yr(Js,"StructArrayLayout5i4f1i1ul2ui40");class $s extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,i,n,r,s,o)}emplace(e,t,i,n,r,s,o,a){const l=8*e;return this.int16[l+0]=t,this.int16[l+1]=i,this.int16[l+2]=n,this.int16[l+4]=r,this.int16[l+5]=s,this.int16[l+6]=o,this.int16[l+7]=a,e}}$s.prototype.bytesPerElement=16,Yr($s,"StructArrayLayout3i2i2i16");class Qs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=4*e,a=8*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.int16[a+6]=r,this.int16[a+7]=s,e}}Qs.prototype.bytesPerElement=16,Yr(Qs,"StructArrayLayout2f1f2i16");class eo extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=12*e,o=3*e;return this.uint8[s+0]=t,this.uint8[s+1]=i,this.float32[o+1]=n,this.float32[o+2]=r,e}}eo.prototype.bytesPerElement=12,Yr(eo,"StructArrayLayout2ub2f12");class to extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.float32[r+0]=t,this.float32[r+1]=i,this.float32[r+2]=n,e}}to.prototype.bytesPerElement=12,Yr(to,"StructArrayLayout3f12");class io extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,i)}emplace(e,t,i,n){const r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=i,this.uint16[r+2]=n,e}}io.prototype.bytesPerElement=6,Yr(io,"StructArrayLayout3ui6");class no extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b){const x=this.length;return this.resize(x+1),this.emplace(x,e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b)}emplace(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x){const w=30*e,E=15*e,A=60*e;return this.int16[w+0]=t,this.int16[w+1]=i,this.int16[w+2]=n,this.float32[E+2]=r,this.float32[E+3]=s,this.uint16[w+8]=o,this.uint16[w+9]=a,this.uint32[E+5]=l,this.uint32[E+6]=c,this.uint32[E+7]=u,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[E+10]=m,this.float32[E+11]=f,this.uint8[A+48]=g,this.uint8[A+49]=_,this.uint8[A+50]=v,this.uint32[E+13]=y,this.int16[w+28]=b,this.uint8[A+58]=x,e}}no.prototype.bytesPerElement=60,Yr(no,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ro extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A,T,D,S,C,P){const I=this.length;return this.resize(I+1),this.emplace(I,e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A,T,D,S,C,P)}emplace(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A,T,D,S,C,P,I){const k=38*e,M=19*e;return this.int16[k+0]=t,this.int16[k+1]=i,this.int16[k+2]=n,this.float32[M+2]=r,this.float32[M+3]=s,this.int16[k+8]=o,this.int16[k+9]=a,this.int16[k+10]=l,this.int16[k+11]=c,this.int16[k+12]=u,this.int16[k+13]=h,this.uint16[k+14]=d,this.uint16[k+15]=p,this.uint16[k+16]=m,this.uint16[k+17]=f,this.uint16[k+18]=g,this.uint16[k+19]=_,this.uint16[k+20]=v,this.uint16[k+21]=y,this.uint16[k+22]=b,this.uint16[k+23]=x,this.uint16[k+24]=w,this.uint16[k+25]=E,this.uint16[k+26]=A,this.uint16[k+27]=T,this.uint16[k+28]=D,this.uint32[M+15]=S,this.float32[M+16]=C,this.float32[M+17]=P,this.float32[M+18]=I,e}}ro.prototype.bytesPerElement=76,Yr(ro,"StructArrayLayout3i2f6i15ui1ul3f76");class so extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}so.prototype.bytesPerElement=4,Yr(so,"StructArrayLayout1f4");class oo extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,i,n,r){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,i,n,r)}emplace(e,t,i,n,r,s){const o=5*e;return this.float32[o+0]=t,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=r,this.float32[o+4]=s,e}}oo.prototype.bytesPerElement=20,Yr(oo,"StructArrayLayout5f20");class ao extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,i,n)}emplace(e,t,i,n,r){const s=6*e;return this.uint32[3*e+0]=t,this.uint16[s+2]=i,this.uint16[s+3]=n,this.uint16[s+4]=r,e}}ao.prototype.bytesPerElement=12,Yr(ao,"StructArrayLayout1ul3ui12");class lo extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=i,e}}lo.prototype.bytesPerElement=4,Yr(lo,"StructArrayLayout2ui4");class co extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}co.prototype.bytesPerElement=2,Yr(co,"StructArrayLayout1ui2");class uo extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const i=this.length;return this.resize(i+1),this.emplace(i,e,t)}emplace(e,t,i){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=i,e}}uo.prototype.bytesPerElement=8,Yr(uo,"StructArrayLayout2f8");class ho extends Os{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ho.prototype.size=40;class po extends Js{get(e){return new ho(this,e)}}Yr(po,"CollisionBoxArray");class mo extends Os{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}mo.prototype.size=60;class fo extends no{get(e){return new mo(this,e)}}Yr(fo,"PlacedSymbolArray");class go extends Os{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}go.prototype.size=76;class _o extends ro{get(e){return new go(this,e)}}Yr(_o,"SymbolInstanceArray");class vo extends so{getoffsetX(e){return this.float32[1*e+0]}}Yr(vo,"GlyphOffsetArray");class yo extends Us{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Yr(yo,"SymbolLineVertexArray");class bo extends Os{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}bo.prototype.size=12;class xo extends ao{get(e){return new bo(this,e)}}Yr(xo,"FeatureIndexArray");class wo extends lo{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Yr(wo,"FillExtrusionCentroidArray");const Eo=zs([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ao=zs([{name:"a_dash",components:4,type:"Uint16"}]);var To={exports:{}},Do={exports:{}};Do.exports=function(e,t){var i,n,r,s,o,a,l,c;for(n=e.length-(i=3&e.length),r=t,o=3432918353,a=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(s=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var So=Do.exports,Co={exports:{}};Co.exports=function(e,t){for(var i,n=e.length,r=t^n,s=0;n>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++s;switch(n){case 3:r^=(255&e.charCodeAt(s+2))<<16;case 2:r^=(255&e.charCodeAt(s+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(s)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var Po=So,Io=Co.exports;To.exports=Po,To.exports.murmur3=Po,To.exports.murmur2=Io;var ko=d(To.exports);class Mo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,i,n){this.ids.push(Ro(e)),this.positions.push(t,i,n)}getPositions(e){const t=Ro(e);let i=0,n=this.ids.length-1;for(;i<n;){const e=i+n>>1;this.ids[e]>=t?n=e:i=e+1}const r=[];for(;this.ids[i]===t;)r.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return r}static serialize(e,t){const i=new Float64Array(e.ids),n=new Uint32Array(e.positions);return Fo(i,n,0,i.length-1),t&&t.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(e){const t=new Mo;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function Ro(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:ko(String(e))}function Fo(e,t,i,n){for(;i<n;){const r=e[i+n>>1];let s=i-1,o=n+1;for(;;){do{s++}while(e[s]<r);do{o--}while(e[o]>r);if(s>=o)break;Lo(e,s,o),Lo(t,3*s,3*o),Lo(t,3*s+1,3*o+1),Lo(t,3*s+2,3*o+2)}o-i<n-o?(Fo(e,t,i,o),i=o+1):(Fo(e,t,o+1,n),n=o)}}function Lo(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}Yr(Mo,"FeaturePositionMap");class Oo{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}}class Bo extends Oo{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class zo extends Oo{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3])))}}class No extends Oo{constructor(e){super(e),this.current=kt.transparent}set(e,t,i){this.fetchUniformLocation(e,t)&&(i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a)))}}const Uo=new Float32Array(16),jo=new Float32Array(9),Vo=new Float32Array(4);function Go(e){return[Fs(255*e.r,255*e.g),Fs(255*e.b,255*e.a)]}class Wo{constructor(e,t,i){this.value=e,this.uniformNames=t.map(e=>"u_".concat(e)),this.type=i}setUniform(e,t,i,n,r){t.set(e,r,n.constantOr(this.value))}getBinding(e,t){return"color"===this.type?new No(e):new Bo(e)}}class Ho{constructor(e,t){this.uniformNames=t.map(e=>"u_".concat(e)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,i,n,r){const s="u_pattern"===r||"u_dash"===r?this.pattern:"u_pixel_ratio"===r?this.pixelRatio:null;s&&t.set(e,r,s)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new zo(e):new Bo(e)}}class Xo{constructor(e,t,i,n){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_".concat(e),type:"Float32",components:"color"===i?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,t,i,n,r,s){const o=this.paintVertexArray.length,a=this.expression.evaluate(new xs(0),t,{},r,n,s);this.paintVertexArray.resize(e),this._setPaintValue(o,e,a)}updatePaintArray(e,t,i,n,r){const s=this.expression.evaluate({zoom:0},i,n,void 0,r);this._setPaintValue(e,t,s)}_setPaintValue(e,t,i){if("color"===this.type){const n=Go(i);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qo{constructor(e,t,i,n,r,s){this.expression=e,this.uniformNames=t.map(e=>"u_".concat(e,"_t")),this.type=i,this.useIntegerZoom=n,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_".concat(e),type:"Float32",components:"color"===i?4:2,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,t,i,n,r,s){const o=this.expression.evaluate(new xs(this.zoom),t,{},r,n,s),a=this.expression.evaluate(new xs(this.zoom+1),t,{},r,n,s),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,a)}updatePaintArray(e,t,i,n,r){const s=this.expression.evaluate({zoom:this.zoom},i,n,void 0,r),o=this.expression.evaluate({zoom:this.zoom+1},i,n,void 0,r);this._setPaintValue(e,t,s,o)}_setPaintValue(e,t,i,n){if("color"===this.type){const r=Go(i),s=Go(n);for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r[0],r[1],s[0],s[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,i,n,r){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,o=S(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(e,r,o)}getBinding(e,t){return new Bo(e)}}class Zo{constructor(e,t,i,n,r){this.expression=e,this.layerId=r,this.paintVertexAttributes=("array"===i?Ao:Eo).members;for(let s=0;s<t.length;++s);this.paintVertexArray=new n}populatePaintArray(e,t,i){const n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],i)}updatePaintArray(e,t,i,n,r,s){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],s)}_setPaintValues(e,t,i,n){if(!n||!i)return;const r=n[i];if(!r)return;const{tl:s,br:o,pixelRatio:a}=r;for(let l=e;l<t;l++)this.paintVertexArray.emplace(l,s[0],s[1],o[0],o[1],a)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Yo{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.binders={},this._buffers=[];const n=[];for(const r in e.paint._values){if(!i(r))continue;const s=e.paint.get(r);if(!(s instanceof Cs&&On(s.property.specification)))continue;const o=$o(r,e.type),a=s.value,l=s.property.specification.type,c=!!s.property.useIntegerZoom,u="line-dasharray"===r||r.endsWith("pattern"),h="line-dasharray"===r&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==a.kind||h)if("source"===a.kind||h||u){const t=ta(r,l,"source");this.binders[r]=u?new Zo(a,o,l,t,e.id):new Xo(a,o,l,t),n.push("/a_".concat(r))}else{const e=ta(r,l,"composite");this.binders[r]=new qo(a,o,l,c,t,e),n.push("/z_".concat(r))}else this.binders[r]=u?new Ho(a.value,o):new Wo(a.value,o,l),n.push("/u_".concat(r))}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Xo||t instanceof qo?t.maxValue:0}populatePaintArrays(e,t,i,n,r,s){for(const o in this.binders){const a=this.binders[o];(a instanceof Xo||a instanceof qo||a instanceof Zo)&&a.populatePaintArray(e,t,i,n,r,s)}}setConstantPatternPositions(e){for(const t in this.binders){const i=this.binders[t];i instanceof Ho&&i.setConstantPatternPositions(e)}}updatePaintArrays(e,t,i,n,r,s){let o=!1;for(const a in e){const l=t.getPositions(a);for(const t of l){const l=i.feature(t.index);for(const i in this.binders){const c=this.binders[i];if((c instanceof Xo||c instanceof qo||c instanceof Zo)&&!0===c.expression.isStateDependent){const u=n.paint.get(i);c.expression=u.value,c.updatePaintArray(t.start,t.end,l,e[a],r,s),o=!0}}}}return o}defines(){const e=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Wo||i instanceof Ho)&&e.push(...i.uniformNames.map(e=>"#define HAS_UNIFORM_".concat(e)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Xo||i instanceof qo||i instanceof Zo)for(let t=0;t<i.paintVertexAttributes.length;t++)e.push(i.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const i=this.binders[t];if(i instanceof Wo||i instanceof Ho||i instanceof qo)for(const t of i.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const i in this.binders){const n=this.binders[i];if(n instanceof Wo||n instanceof Ho||n instanceof qo)for(const r of n.uniformNames)t.push({name:r,property:i,binding:n.getBinding(e,r)})}return t}setUniforms(e,t,i,n,r){for(const{name:s,property:o,binding:a}of i)this.binders[o].setUniform(e,a,r,n.get(o),s)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof Xo||t instanceof qo||t instanceof Zo)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const i=this.binders[t];(i instanceof Xo||i instanceof qo||i instanceof Zo)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Xo||t instanceof qo||t instanceof Zo)&&t.destroy()}}}class Ko{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new Yo(n,t,i);this.needsUpload=!1,this._featureMap=new Mo,this._bufferOffset=0}populatePaintArrays(e,t,i,n,r,s,o){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,n,r,s,o);void 0!==t.id&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,i,n,r){for(const s of i)this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(e,this._featureMap,t,s,n,r)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Jo={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function $o(e,t){return Jo[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}const Qo={"line-pattern":{source:Hs,composite:Hs},"fill-pattern":{source:Hs,composite:Hs},"fill-extrusion-pattern":{source:Hs,composite:Hs},"line-dasharray":{source:Xs,composite:Xs}},ea={color:{source:uo,composite:Ws},number:{source:so,composite:uo}};function ta(e,t,i){const n=Qo[e];return n&&n[i]||ea[t][i]}Yr(Wo,"ConstantBinder"),Yr(Ho,"PatternConstantBinder"),Yr(Xo,"SourceExpressionBinder"),Yr(Zo,"PatternCompositeBinder"),Yr(qo,"CompositeExpressionBinder"),Yr(Yo,"ProgramConfiguration",{omit:["_buffers"]}),Yr(Ko,"ProgramConfigurationSet");const ia="-transition";class na extends Qe{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Ss(t.layout)),t.paint)){this._transitionablePaint=new As(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ps(t.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(jr,"layers.".concat(this.id,".layout.").concat(e),e,t,i)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return N(e,ia)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(Ur,"layers.".concat(this.id,".paint.").concat(e),e,t,i))return!1;if(N(e,ia))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const i=this._transitionablePaint._values[e],n=i.value.isDataDriven(),r=i.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const s=this._transitionablePaint._values[e].value,o=s.isDataDriven(),a=N(e,"pattern")||"line-dasharray"===e;return o||n||a||this._handleOverridablePaintPropertyUpdate(e,r,s)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,t,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),j(e,(e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length))}_validate(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&Gr(this,e.call(Nr,{key:t,layerType:this.type,objectKey:i,value:n,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Cs&&On(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=hr(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ra=zs([{name:"a_pos",components:2,type:"Int16"}],4),sa=zs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class oa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}prepareSegment(e,t,i,n){let r=this.segments[this.segments.length-1];return e>oa.MAX_VERTEX_ARRAY_LENGTH&&W("Max vertices per segment is ".concat(oa.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!r||r.vertexLength+e>oa.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==n)&&(r={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(r.sortKey=n),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,i,n){return new oa([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}}oa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yr(oa,"SegmentVector");var aa=8192;class la{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Vl?new Vl(e.lng,e.lat):Vl.convert(e),this}setSouthWest(e){return this._sw=e instanceof Vl?new Vl(e.lng,e.lat):Vl.convert(e),this}extend(e){const t=this._sw,i=this._ne;let n,r;if(e instanceof Vl)n=e,r=e;else{if(!(e instanceof la))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(la.convert(e)):this.extend(Vl.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Vl.convert(e)):this;if(n=e._sw,r=e._ne,!n||!r)return this}return t||i?(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new Vl(n.lng,n.lat),this._ne=new Vl(r.lng,r.lat)),this}getCenter(){return new Vl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vl(this.getWest(),this.getNorth())}getSouthEast(){return new Vl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:i}=Vl.convert(e);let n=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n}static convert(e){return!e||e instanceof la?e:new la(e)}}var ca=1e-6,ua="undefined"!=typeof Float32Array?Float32Array:Array;function ha(){var e=new ua(9);return ua!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function da(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1],m=i[2],f=i[3],g=i[4],_=i[5],v=i[6],y=i[7],b=i[8];return e[0]=d*n+p*o+m*c,e[1]=d*r+p*a+m*u,e[2]=d*s+p*l+m*h,e[3]=f*n+g*o+_*c,e[4]=f*r+g*a+_*u,e[5]=f*s+g*l+_*h,e[6]=v*n+y*o+b*c,e[7]=v*r+y*a+b*u,e[8]=v*s+y*l+b*h,e}function pa(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ma(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],v=i*a-n*o,y=i*l-r*o,b=i*c-s*o,x=n*l-r*a,w=n*c-s*a,E=r*c-s*l,A=u*f-h*m,T=u*g-d*m,D=u*_-p*m,S=h*g-d*f,C=h*_-p*f,P=d*_-p*g,I=v*P-y*C+b*S+x*D-w*T+E*A;return I?(e[0]=(a*P-l*C+c*S)*(I=1/I),e[1]=(r*C-n*P-s*S)*I,e[2]=(f*E-g*w+_*x)*I,e[3]=(d*w-h*E-p*x)*I,e[4]=(l*D-o*P-c*T)*I,e[5]=(i*P-r*D+s*T)*I,e[6]=(g*b-m*E-_*y)*I,e[7]=(u*E-d*b+p*y)*I,e[8]=(o*C-a*D+c*A)*I,e[9]=(n*D-i*C-s*A)*I,e[10]=(m*w-f*b+_*v)*I,e[11]=(h*b-u*w-p*v)*I,e[12]=(a*T-o*S-l*A)*I,e[13]=(i*S-n*T+r*A)*I,e[14]=(f*y-m*x-g*v)*I,e[15]=(u*x-h*y+d*v)*I,e):null}function fa(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],_=t[14],v=t[15],y=i[0],b=i[1],x=i[2],w=i[3];return e[0]=y*n+b*a+x*h+w*f,e[1]=y*r+b*l+x*d+w*g,e[2]=y*s+b*c+x*p+w*_,e[3]=y*o+b*u+x*m+w*v,e[4]=(y=i[4])*n+(b=i[5])*a+(x=i[6])*h+(w=i[7])*f,e[5]=y*r+b*l+x*d+w*g,e[6]=y*s+b*c+x*p+w*_,e[7]=y*o+b*u+x*m+w*v,e[8]=(y=i[8])*n+(b=i[9])*a+(x=i[10])*h+(w=i[11])*f,e[9]=y*r+b*l+x*d+w*g,e[10]=y*s+b*c+x*p+w*_,e[11]=y*o+b*u+x*m+w*v,e[12]=(y=i[12])*n+(b=i[13])*a+(x=i[14])*h+(w=i[15])*f,e[13]=y*r+b*l+x*d+w*g,e[14]=y*s+b*c+x*p+w*_,e[15]=y*o+b*u+x*m+w*v,e}function ga(e,t,i){var n,r,s,o,a,l,c,u,h,d,p,m,f=i[0],g=i[1],_=i[2];return t===e?(e[12]=t[0]*f+t[4]*g+t[8]*_+t[12],e[13]=t[1]*f+t[5]*g+t[9]*_+t[13],e[14]=t[2]*f+t[6]*g+t[10]*_+t[14],e[15]=t[3]*f+t[7]*g+t[11]*_+t[15]):(r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],m=t[11],e[0]=n=t[0],e[1]=r,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=m,e[12]=n*f+a*g+h*_+t[12],e[13]=r*f+l*g+d*_+t[13],e[14]=s*f+c*g+p*_+t[14],e[15]=o*f+u*g+m*_+t[15]),e}function _a(e,t,i){var n=i[0],r=i[1],s=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function va(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*n,e[5]=o*r+u*n,e[6]=a*r+h*n,e[7]=l*r+d*n,e[8]=c*r-s*n,e[9]=u*r-o*n,e[10]=h*r-a*n,e[11]=d*r-l*n,e}function ya(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r-c*n,e[1]=o*r-u*n,e[2]=a*r-h*n,e[3]=l*r-d*n,e[8]=s*n+c*r,e[9]=o*n+u*r,e[10]=a*n+h*r,e[11]=l*n+d*r,e}function ba(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xa(e,t,i){var n,r,s,o=i[0],a=i[1],l=i[2],c=Math.hypot(o,a,l);return c<ca?null:(o*=c=1/c,a*=c,l*=c,n=Math.sin(t),r=Math.cos(t),e[0]=o*o*(s=1-r)+r,e[1]=a*o*s+l*n,e[2]=l*o*s-a*n,e[3]=0,e[4]=o*a*s-l*n,e[5]=a*a*s+r,e[6]=l*a*s+o*n,e[7]=0,e[8]=o*l*s+a*n,e[9]=a*l*s-o*n,e[10]=l*l*s+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var wa=fa;function Ea(){var e=new ua(3);return ua!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Aa(e){var t=new ua(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ta(e){return Math.hypot(e[0],e[1],e[2])}function Da(e,t,i){var n=new ua(3);return n[0]=e,n[1]=t,n[2]=i,n}function Sa(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function Ca(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Pa(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Ia(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e}function ka(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e}function Ma(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function Ra(e,t,i,n){return e[0]=t[0]+i[0]*n,e[1]=t[1]+i[1]*n,e[2]=t[2]+i[2]*n,e}function Fa(e,t){var i=t[0],n=t[1],r=t[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function La(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Oa(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[0],a=i[1],l=i[2];return e[0]=r*l-s*a,e[1]=s*o-n*l,e[2]=n*a-r*o,e}function Ba(e,t,i){var n=t[0],r=t[1],s=t[2],o=i[3]*n+i[7]*r+i[11]*s+i[15];return e[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/(o=o||1),e[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/o,e}function za(e,t,i){var n=i[0],r=i[1],s=i[2],o=t[0],a=t[1],l=t[2],c=r*l-s*a,u=s*o-n*l,h=n*a-r*o,d=r*h-s*u,p=s*c-n*h,m=n*u-r*c,f=2*i[3];return u*=f,h*=f,p*=2,m*=2,e[0]=o+(c*=f)+(d*=2),e[1]=a+u+p,e[2]=l+h+m,e}var Na,Ua=Ca,ja=Pa,Va=Ta;function Ga(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function Wa(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i*i+n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=i*o,e[1]=n*o,e[2]=r*o,e[3]=s*o,e}function Ha(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,e}function Xa(){var e=new ua(4);return ua!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function qa(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Za(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l+o*a,e[1]=r*l+s*a,e[2]=s*l-r*a,e[3]=o*l-n*a,e}function Ya(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l-s*a,e[1]=r*l+o*a,e[2]=s*l+n*a,e[3]=o*l-r*a,e}Ea(),Na=new ua(4),ua!=Float32Array&&(Na[0]=0,Na[1]=0,Na[2]=0,Na[3]=0);var Ka=Wa;Ea(),Da(1,0,0),Da(0,1,0),Xa(),Xa(),ha();const Ja=zs([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:$a}=Ja,Qa=zs([{name:"a_pos_3",components:3,type:"Int16"}]);var el=zs([{name:"a_pos",type:"Int16",components:2}]);class tl{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,i){const n=La(t,this.dir);if(Math.abs(n)<1e-6)return!1;const r=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/n;return i[0]=this.pos[0]+this.dir[0]*r,i[1]=this.pos[1]+this.dir[1]*r,i[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(e,t,i){if(function(e,t){var i=e[0],n=e[1],r=e[2],s=t[0],o=t[1],a=t[2];return Math.abs(i-s)<=ca*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-o)<=ca*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=ca*Math.max(1,Math.abs(r),Math.abs(a))}(this.pos,e)||0===t)return i[0]=i[1]=i[2]=0,!1;const[n,r,s]=this.dir,o=this.pos[0]-e[0],a=this.pos[1]-e[1],l=this.pos[2]-e[2],c=n*n+r*r+s*s,u=2*(o*n+a*r+l*s),h=u*u-4*c*(o*o+a*a+l*l-t*t);if(h<0){const e=Math.max(-u/2,0),c=o+n*e,h=a+r*e,d=l+s*e,p=Math.hypot(c,h,d);return i[0]=c*t/p,i[1]=h*t/p,i[2]=d*t/p,!1}{const e=(-u-Math.sqrt(h))/(2*c);if(e<0){const e=Math.hypot(o,a,l);return i[0]=o*t/e,i[1]=a*t/e,i[2]=l*t/e,!1}return i[0]=o+n*e,i[1]=a+r*e,i[2]=l+s*e,!0}}}class il{constructor(e,t,i,n,r){this.TL=e,this.TR=t,this.BR=i,this.BL=n,this.horizon=r}static fromInvProjectionMatrix(e,t,i){const n=[-1,1,1],r=[1,1,1],s=[1,-1,1],o=[-1,-1,1],a=Ba(n,n,e),l=Ba(r,r,e),c=Ba(s,s,e),u=Ba(o,o,e);return new il(a,l,c,u,t/i)}}class nl{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,i,n){const r=Math.pow(2,i),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>{const s=Ha([],i,e),o=1/s[3]/t*r;return function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}(s,s,[o,o,n?1/s[3]:o,o])}),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const t=Fa([],Oa([],Ua([],s[e[0]],s[e[1]]),Ua([],s[e[2]],s[e[1]]))),i=-La(t,s[e[1]]);return t.concat(i)});return new nl(s,o)}}class rl{static fromPoints(e){const t=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const n of e)Ia(t,t,n),ka(i,i,n);return new rl(t,i)}static applyTransform(e,t){const i=e.getCorners();for(let n=0;n<i.length;++n)Ba(i[n],i[n],t);return rl.fromPoints(i)}constructor(e,t){this.min=e,this.max=t,this.center=Ma([],Sa([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],i=Aa(this.min),n=Aa(this.max);for(let r=0;r<t.length;r++)i[r]=t[r]?this.min[r]:this.center[r],n[r]=t[r]?this.center[r]:this.max[r];return n[2]=this.max[2],new rl(i,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){const t=this.getCorners();let i=!0;for(let n=0;n<e.planes.length;n++){const r=e.planes[n];let s=0;for(let e=0;e<t.length;e++)s+=La(r,t[e])+r[3]>=0;if(0===s)return 0;s!==t.length&&(i=!1)}if(i)return 2;for(let n=0;n<3;n++){let t=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const s=e.points[r][n]-this.min[n];t=Math.min(t,s),i=Math.max(i,s)}if(i<0||t>this.max[n]-this.min[n])return 0}return 1}}const sl=5,ol=6,al=aa/Math.PI/2,ll=16383,cl=64,ul=[cl,32,16],hl=-al,dl=al,pl=[new rl([hl,hl,hl],[dl,dl,dl]),new rl([hl,hl,hl],[0,0,dl]),new rl([0,hl,hl],[dl,0,dl]),new rl([hl,0,hl],[0,dl,dl]),new rl([0,0,hl],[dl,dl,dl])];function ml(e){return e*al/Nl}function fl(e,t,i){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=Ma([],e._camera.position,e.worldSize),s=[t,i,1,1];Ha(s,s,e.pixelMatrixInverse),Ga(s,s,1/s[3]);const o=Fa([],Ua([],s,r)),a=e.globeMatrix,l=[a[12],a[13],a[14]],c=Ua([],l,r),u=Ta(c),h=Fa([],c),d=e.worldSize/(2*Math.PI),p=La(h,o),m=Math.asin(d/u);if(m<Math.acos(p)){if(!n)return null;const e=[],t=[];Ma(e,o,u/p),Fa(t,Ua(t,e,c)),Fa(o,Sa(o,c,Ma(o,t,Math.tan(m)*u)))}const f=[];new tl(r,o).closestPointOnSphere(l,d,f);const g=Fa([],$(a,0)),_=Fa([],$(a,1)),v=Fa([],$(a,2)),y=La(g,f),b=La(_,f),x=La(v,f),E=w(Math.asin(-b/d));let A=w(Math.atan2(y,x));A=e.center.lng+function(e,t){const i=(t-e+180)%360-180;return i<-180?i+360:i}(e.center.lng,A);const T=Wl(A),D=S(Hl(E),0,1);return new $l(T,D)}class gl{constructor(e,t,i){this.a=Ua([],e,i),this.b=Ua([],t,i),this.center=i;const n=Fa([],this.a),r=Fa([],this.b);this.angle=Math.acos(La(n,r))}}function _l(e,t){if(0===e.angle)return null;let i;return i=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),i<0||i>1?null:function(e,t,i,n){const r=Math.sin(i);return e*(Math.sin((1-n)*i)/r)+t*(Math.sin(n*i)/r)}(e.a[t],e.b[t],e.angle,S(i,0,1))+e.center[t]}function vl(e){if(e.z<=1)return pl[e.z+2*e.y+e.x];const t=Al(El(e));return rl.fromPoints(t)}function yl(e,t,i){return Ma(e,e,1-i),Ra(e,e,t,i)}function bl(e,t){const i=Rl(t.zoom);if(0===i)return vl(e);const n=El(e),r=Al(n),s=Wl(n.getWest())*t.worldSize,o=Wl(n.getEast())*t.worldSize,a=Hl(n.getNorth())*t.worldSize,l=Hl(n.getSouth())*t.worldSize,c=[s,a,0],u=[o,a,0],h=[s,l,0],d=[o,l,0],p=ma([],t.globeMatrix);return Ba(c,c,p),Ba(u,u,p),Ba(h,h,p),Ba(d,d,p),r[0]=yl(r[0],h,i),r[1]=yl(r[1],d,i),r[2]=yl(r[2],u,i),r[3]=yl(r[3],c,i),rl.fromPoints(r)}function xl(e,t,i){for(const n of e)Ba(n,n,t),Ma(n,n,i)}function wl(e,t,i){const n=t/e.worldSize,r=e.globeMatrix;if(i.z<=1){const e=vl(i).getCorners();return xl(e,r,n),rl.fromPoints(e)}const s=El(i),o=Al(s);xl(o,r,n);const a=Number.MAX_VALUE,l=[-a,-a,-a],c=[a,a,a];if(s.contains(e.center)){for(const e of o)Ia(c,c,e),ka(l,l,e);l[2]=0;const t=e.point,i=[t.x*n,t.y*n,0];return Ia(c,c,i),ka(l,l,i),new rl(c,l)}const u=[r[12]*n,r[13]*n,r[14]*n],h=s.getCenter(),d=S(e.center.lat,-Kl,Kl),p=S(h.lat,-Kl,Kl),m=Wl(e.center.lng),f=Hl(d);let g=m-Wl(h.lng);const _=f-Hl(p);g>.5?g-=1:g<-.5&&(g+=1);let v=0;Math.abs(g)>Math.abs(_)?v=g>=0?1:3:(v=_>=0?0:2,Ra(u,u,[r[4]*n,r[5]*n,r[6]*n],-Math.sin(x(_>=0?s.getSouth():s.getNorth()))*al));const y=o[v],b=o[(v+1)%4],w=new gl(y,b,u),E=[_l(w,0)||y[0],_l(w,1)||y[1],_l(w,2)||y[2]],A=Rl(e.zoom);if(A>0){const n=function(e,t,i,n,r){let{x:s,y:o,z:a}=e;const l=1/(1<<a);let c=s*l,u=c+l,h=o*l,d=h+l,p=0;const m=(c+u)/2-n;return m>.5?p=-1:m<-.5&&(p=1),c=((c+p)*t-(n*=t))*i+n,u=((u+p)*t-n)*i+n,h=(h*t-(r*=t))*i+r,d=(d*t-r)*i+r,[[c,d,0],[u,d,0],[u,h,0],[c,h,0]]}(i,t,e._pixelsPerMercatorPixel,m,f);for(let e=0;e<o.length;e++)yl(o[e],n[e],A);const r=Sa([],n[v],n[(v+1)%4]);Ma(r,r,.5),yl(E,r,A)}for(const x of o)Ia(c,c,x),ka(l,l,x);return c[2]=Math.min(y[2],b[2]),Ia(c,c,E),ka(l,l,E),new rl(c,l)}function El(e){let{x:t,y:i,z:n}=e;const r=1/(1<<n),s=new Vl(ql(t*r),Zl((i+1)*r)),o=new Vl(ql((t+1)*r),Zl(i*r));return new la(s,o)}function Al(e){const t=x(e.getNorth()),i=x(e.getSouth()),n=Math.cos(t),r=Math.cos(i),s=Math.sin(t),o=Math.sin(i),a=e.getWest(),l=e.getEast();return[Tl(r,o,a),Tl(r,o,l),Tl(n,s,l),Tl(n,s,a)]}function Tl(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:al;return i=x(i),[e*Math.sin(i)*n,-t*n,e*Math.cos(i)*n]}function Dl(e,t,i){return Tl(Math.cos(x(e)),Math.sin(x(e)),t,i)}function Sl(e,t,i,n){const r=1<<i.z,s=(e/aa+i.x)/r;return Dl(Zl((t/aa+i.y)/r),ql(s),n)}function Cl(e){let{min:t,max:i}=e;return ll/Math.max(i[0]-t[0],i[1]-t[1],i[2]-t[2])}const Pl=new Float64Array(16);function Il(e){const t=Cl(e),i=ba(Pl,[t,t,t]);return ga(i,i,((n=[])[0]=-(r=e.min)[0],n[1]=-r[1],n[2]=-r[2],n));var n,r}function kl(e){const t=(n=e.min,(i=Pl)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=n[0],i[13]=n[1],i[14]=n[2],i[15]=1,i);var i,n;const r=1/Cl(e);return _a(t,t,[r,r,r])}function Ml(e,t,i,n,r){const s=function(e){const t=aa/(2*Math.PI);return e/(2*Math.PI)/t}(i),o=[e,t,-i/(2*Math.PI)],a=pa(new Float64Array(16));return ga(a,a,o),_a(a,a,[s,s,s]),va(a,a,x(-r)),ya(a,a,x(-n)),a}function Rl(e){return C(sl,ol,e)}function Fl(e,t){const i=Dl(t.lat,t.lng),n=function(e){const t=Dl(e._center.lat,e._center.lng);let i=Oa([],Da(0,1,0),t);const n=xa([],-e.angle,t);i=Ba(i,i,n),xa(n,-e._pitch,i);const r=Fa([],t);return Ma(r,r,ml(e.cameraToCenterDistance/e.pixelsPerMeter)),Ba(r,r,n),Sa([],t,r)}(e);return o=(r=Ca([],n,i))[0],a=r[1],l=r[2],c=(s=i)[0],u=s[1],h=s[2],p=(d=Math.sqrt(o*o+a*a+l*l)*Math.sqrt(c*c+u*u+h*h))&&La(r,s)/d,Math.acos(Math.min(Math.max(p,-1),1));var r,s,o,a,l,c,u,h,d,p}function Ll(e,t){return Fl(e,t)>Math.PI/2*1.01}const Ol=x(85),Bl=Math.cos(Ol),zl=Math.sin(Ol),Nl=6371008.8,Ul=2*Math.PI*Nl;class jl{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new jl(P(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){const t=Math.PI/180,i=this.lat*t,n=e.lat*t,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Nl*Math.acos(Math.min(r,1))}toBounds(){const e=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,t=e/Math.cos(Math.PI/180*this.lat);return new la(new jl(this.lng-t,this.lat-e),new jl(this.lng+t,this.lat+e))}toEcef(e){const t=ml(e);return Dl(this.lat,this.lng,al+t)}static convert(e){if(e instanceof jl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new jl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new jl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Vl=jl;function Gl(e){return Ul*Math.cos(e*Math.PI/180)}function Wl(e){return(180+e)/360}function Hl(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Xl(e,t){return e/Gl(t)}function ql(e){return 360*e-180}function Zl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Yl(e,t){return e*Gl(Zl(t))}const Kl=85.051129;function Jl(e){return 1/Math.cos(e*Math.PI/180)}class $l{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+i}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=Vl.convert(e);return new $l(Wl(i.lng),Hl(i.lat),Xl(t,i.lat))}toLngLat(){return new Vl(ql(this.x),Zl(this.y))}toAltitude(){return Yl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ul*Jl(Zl(this.y))}}function Ql(e,t,i,n,r,s,o,a,l){const c=(t+n)/2,u=(i+r)/2,h=new v(c,u);a(h),function(e,t,i,n,r,s){const o=i-r,a=n-s;return Math.abs((n-t)*o-(i-e)*a)/Math.hypot(o,a)}(h.x,h.y,s.x,s.y,o.x,o.y)>=l?(Ql(e,t,i,c,u,s,h,a,l),Ql(e,c,u,n,r,h,o,a,l)):e.push(o)}function ec(e,t,i){let n=e[0],r=n.x,s=n.y;t(n);const o=[n];for(let a=1;a<e.length;a++){const l=e[a],{x:c,y:u}=l;t(l),Ql(o,r,s,c,u,n,l,t,i),r=c,s=u,n=l}return o}function tc(e,t,i,n){if(n(t,i)){const r=t.add(i)._mult(.5);tc(e,t,r,n),tc(e,r,i,n)}else e.push(i)}function ic(e,t){let i=e[0];const n=[i];for(let r=1;r<e.length;r++){const s=e[r];tc(n,i,s,t),i=s}return n}const nc=Math.pow(2,14)-1,rc=-nc-1;function sc(e,t){const i=Math.round(e.x*t),n=Math.round(e.y*t);return e.x=S(i,rc,nc),e.y=S(n,rc,nc),(i<e.x||i>e.x+1||n<e.y||n>e.y+1)&&W("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function oc(e,t,i){const n=e.loadGeometry(),r=e.extent,s=aa/r;if(t&&i&&i.projection.isReprojectedInTileSpace){const s=1<<t.z,{scale:o,x:a,y:l,projection:c}=i,u=e=>{const i=ql((t.x+e.x/r)/s),n=Zl((t.y+e.y/r)/s),u=c.project(i,n);e.x=(u.x*o-a)*r,e.y=(u.y*o-l)*r};for(let t=0;t<n.length;t++)if(1!==e.type)n[t]=ec(n[t],u,1);else{const e=[];for(const i of n[t])i.x<0||i.x>=r||i.y<0||i.y>=r||(u(i),e.push(i));n[t]=e}}for(const o of n)for(const e of o)sc(e,s);return n}function ac(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?oc(e):[]}}function lc(e,t,i,n,r){e.emplaceBack(2*t+(n+1)/2,2*i+(r+1)/2)}function cc(e,t,i){const n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}class uc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Us,this.indexArray=new io,this.segments=new oa,this.programConfigurations=new Ko(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,i,n){const r=this.layers[0],s=[];let o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(const{feature:l,id:c,index:u,sourceLayerIndex:h}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ac(l,e);if(!this.layers[0]._featureFilter.filter(new xs(this.zoom),t,i))continue;const r=o?o.evaluate(t,{},i):void 0,a={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:e?t.geometry:oc(l,i,n),patterns:{},sortKey:r};s.push(a)}o&&s.sort((e,t)=>e.sortKey-t.sortKey);let a=null;"globe"===n.projection.name&&(this.globeExtVertexArray=new qs,a=n.projection);for(const l of s){const{geometry:n,index:r,sourceLayerIndex:s}=l,o=e[r].feature;this.addFeature(l,n,r,t.availableImages,i,a),t.featureIndex.insert(o,n,r,s,this.index)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ra.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,sa.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,i,n,r,s){for(const o of t)for(const t of o){const i=t.x,n=t.y;if(i<0||i>=aa||n<0||n>=aa)continue;if(s){const e=s.projectTilePoint(i,n,r),t=s.upVector(r,i,n),o=this.globeExtVertexArray;cc(o,e,t),cc(o,e,t),cc(o,e,t),cc(o,e,t)}const o=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=o.vertexLength;lc(this.layoutVertexArray,i,n,-1,-1),lc(this.layoutVertexArray,i,n,1,-1),lc(this.layoutVertexArray,i,n,1,1),lc(this.layoutVertexArray,i,n,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),o.vertexLength+=4,o.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},n,r)}}function hc(e,t){for(let i=0;i<e.length;i++)if(bc(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(bc(e,t[i]))return!0;return!!fc(e,t)}function dc(e,t,i){return!!bc(e,t)||!!_c(t,e,i)}function pc(e,t){if(1===e.length)return yc(t,e[0]);for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<n.length;t++)if(bc(e,n[t]))return!0}for(let i=0;i<e.length;i++)if(yc(t,e[i]))return!0;for(let i=0;i<t.length;i++)if(fc(e,t[i]))return!0;return!1}function mc(e,t,i){if(e.length>1){if(fc(e,t))return!0;for(let n=0;n<t.length;n++)if(_c(t[n],e,i))return!0}for(let n=0;n<e.length;n++)if(_c(e[n],t,i))return!0;return!1}function fc(e,t){if(0===e.length||0===t.length)return!1;for(let i=0;i<e.length-1;i++){const n=e[i],r=e[i+1];for(let e=0;e<t.length-1;e++)if(gc(n,r,t[e],t[e+1]))return!0}return!1}function gc(e,t,i,n){return H(e,i,n)!==H(t,i,n)&&H(e,t,i)!==H(e,t,n)}function _c(e,t,i){const n=i*i;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(vc(e,t[r-1],t[r])<n)return!0;return!1}function vc(e,t,i){const n=t.distSqr(i);if(0===n)return e.distSqr(t);const r=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/n;return e.distSqr(r<0?t:r>1?i:i.sub(t)._mult(r)._add(t))}function yc(e,t){let i,n,r,s=!1;for(let o=0;o<e.length;o++){i=e[o];for(let e=0,o=i.length-1;e<i.length;o=e++)n=i[e],r=i[o],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(s=!s)}return s}function bc(e,t){let i=!1;for(let n=0,r=e.length-1;n<e.length;r=n++){const s=e[n],o=e[r];s.y>t.y!=o.y>t.y&&t.x<(o.x-s.x)*(t.y-s.y)/(o.y-s.y)+s.x&&(i=!i)}return i}function xc(e,t,i,n,r){for(const o of e)if(t<=o.x&&i<=o.y&&n>=o.x&&r>=o.y)return!0;const s=[new v(t,i),new v(t,r),new v(n,r),new v(n,i)];if(e.length>2)for(const o of s)if(bc(e,o))return!0;for(let o=0;o<e.length-1;o++)if(wc(e[o],e[o+1],s))return!0;return!1}function wc(e,t,i){const n=i[0],r=i[2];if(e.x<n.x&&t.x<n.x||e.x>r.x&&t.x>r.x||e.y<n.y&&t.y<n.y||e.y>r.y&&t.y>r.y)return!1;const s=H(e,t,i[0]);return s!==H(e,t,i[1])||s!==H(e,t,i[2])||s!==H(e,t,i[3])}function Ec(e,t,i){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ac(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Tc(e,t,i,n,r){if(!t[0]&&!t[1])return e;const s=v.convert(t)._mult(r);"viewport"===i&&s._rotate(-n);const o=[];for(let a=0;a<e.length;a++)o.push(e[a].sub(s));return o}function Dc(e,t,i,n){const r=v.convert(e)._mult(n);return"viewport"===t&&r._rotate(-i),r}Yr(uc,"CircleBucket",{omit:["layers"]});const Sc=new Rs({"circle-sort-key":new ks(et.layout_circle["circle-sort-key"])});var Cc={paint:new Rs({"circle-radius":new ks(et.paint_circle["circle-radius"]),"circle-color":new ks(et.paint_circle["circle-color"]),"circle-blur":new ks(et.paint_circle["circle-blur"]),"circle-opacity":new ks(et.paint_circle["circle-opacity"]),"circle-translate":new Is(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Is(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Is(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Is(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ks(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ks(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ks(et.paint_circle["circle-stroke-opacity"])}),layout:Sc};function Pc(e,t,i,n,r,s,o,a,l){if(s&&e.queryGeometry.isAboveHorizon)return!1;s&&(l*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,u=i.projection.upVectorScale(c,i.center.lat,i.worldSize).metersToTile;for(const h of t)for(const t of h){const h=t.add(a),d=r&&i.elevation?i.elevation.exaggeration()*r.getElevationAt(h.x,h.y,!0):0,p=i.projection.projectTilePoint(h.x,h.y,c);if(d>0){const e=i.projection.upVector(c,h.x,h.y);p.x+=e[0]*u*d,p.y+=e[1]*u*d,p.z+=e[2]*u*d}const m=s?h:Ic(p.x,p.y,p.z,n),f=s?e.tilespaceRays.map(e=>Rc(e,d)):e.queryGeometry.screenGeometry,g=Ha([],[p.x,p.y,p.z,1],n);if(!o&&s?l*=g[3]/i.cameraToCenterDistance:o&&!s&&(l*=i.cameraToCenterDistance/g[3]),s){const e=Zl((t.y/aa+c.y)/(1<<c.z));l/=i.projection.pixelsPerMeter(e,1)/Xl(1,e)}if(dc(f,m,l))return!0}return!1}function Ic(e,t,i,n){const r=Ha([],[e,t,i,1],n);return new v(r[0]/r[3],r[1]/r[3])}const kc=Da(0,0,0),Mc=Da(0,0,1);function Rc(e,t){const i=Ea();return kc[2]=t,e.intersectsPlane(kc,Mc,i),new v(i[0],i[1])}class Fc extends uc{}function Lc(e,t,i,n){let{width:r,height:s}=t;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==r*s*i)throw new RangeError("mismatched image size")}else n=new Uint8Array(r*s*i);return e.width=r,e.height=s,e.data=n,e}function Oc(e,t,i){const{width:n,height:r}=t;n===e.width&&r===e.height||(Bc(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,r)},i),e.width=n,e.height=r,e.data=t.data)}function Bc(e,t,i,n,r,s){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,a=t.data;for(let l=0;l<r.height;l++){const c=((i.y+l)*e.width+i.x)*s,u=((n.y+l)*t.width+n.x)*s;for(let e=0;e<r.width*s;e++)a[u+e]=o[c+e]}return t}Yr(Fc,"HeatmapBucket",{omit:["layers"]});class zc{constructor(e,t){Lc(this,e,1,t)}resize(e){Oc(this,new zc(e),1)}clone(){return new zc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Bc(e,t,i,n,r,1)}}class Nc{constructor(e,t){Lc(this,e,4,t)}resize(e){Oc(this,new Nc(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Nc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,i,n,r){Bc(e,t,i,n,r,4)}}Yr(zc,"AlphaImage"),Yr(Nc,"RGBAImage");var Uc={paint:new Rs({"heatmap-radius":new ks(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ks(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Is(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ms(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Is(et.paint_heatmap["heatmap-opacity"])})};function jc(e){const t={},i=e.resolution||256,n=e.clips?e.clips.length:1,r=e.image||new Nc({width:i,height:n}),s=(i,n,s)=>{t[e.evaluationKey]=s;const o=e.expression.evaluate(t);r.data[i+n+0]=Math.floor(255*o.r/o.a),r.data[i+n+1]=Math.floor(255*o.g/o.a),r.data[i+n+2]=Math.floor(255*o.b/o.a),r.data[i+n+3]=Math.floor(255*o.a)};if(e.clips)for(let o=0,a=0;o<n;++o,a+=4*i)for(let t=0,n=0;t<i;t++,n+=4){const r=t/(i-1),{start:l,end:c}=e.clips[o];s(a,n,l*(1-r)+c*r)}else for(let o=0,a=0;o<i;o++,a+=4)s(0,a,o/(i-1));return r}var Vc={paint:new Rs({"hillshade-illumination-direction":new Is(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Is(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Is(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Is(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Is(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Is(et.paint_hillshade["hillshade-accent-color"])})};const Gc=zs([{name:"a_pos",components:2,type:"Int16"}],4),{members:Wc}=Gc;var Hc={exports:{}};function Xc(e,t,i){i=i||2;var n,r,s,o,a,l,c,u=t&&t.length,h=u?t[0]*i:e.length,d=qc(e,0,h,i,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(e,t,i,n){var r,s,o,a=[];for(r=0,s=t.length;r<s;r++)(o=qc(e,t[r]*n,r<s-1?t[r+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),a.push(ru(o));for(a.sort(eu),r=0;r<a.length;r++)i=tu(a[r],i);return i}(e,t,d,i)),e.length>80*i){n=s=e[0],r=o=e[1];for(var m=i;m<h;m+=i)(a=e[m])<n&&(n=a),(l=e[m+1])<r&&(r=l),a>s&&(s=a),l>o&&(o=l);c=0!==(c=Math.max(s-n,o-r))?32767/c:0}return Yc(d,p,i,n,r,c,0),p}function qc(e,t,i,n,r){var s,o;if(r===_u(e,t,i,n)>0)for(s=t;s<i;s+=n)o=mu(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=mu(s,e[s],e[s+1],o);return o&&lu(o,o.next)&&(fu(o),o=o.next),o}function Zc(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!lu(n,n.next)&&0!==au(n.prev,n,n.next))n=n.next;else{if(fu(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function Yc(e,t,i,n,r,s,o){if(e){!o&&s&&function(e,t,i,n){var r=e;do{0===r.z&&(r.z=nu(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,s,o,a,l,c=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<c&&(a++,n=n.nextZ);t++);for(l=c;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1)}(r)}(e,n,r,s);for(var a,l,c=e;e.prev!==e.next;)if(a=e.prev,l=e.next,s?Jc(e,n,r,s):Kc(e))t.push(a.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),fu(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?Yc(e=$c(Zc(e),t,i),t,i,n,r,s,2):2===o&&Qc(e,t,i,n,r,s):Yc(Zc(e),t,i,n,r,s,1);break}}}function Kc(e){var t=e.prev,i=e,n=e.next;if(au(t,i,n)>=0)return!1;for(var r=t.x,s=i.x,o=n.x,a=t.y,l=i.y,c=n.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,m=n.next;m!==t;){if(m.x>=u&&m.x<=d&&m.y>=h&&m.y<=p&&su(r,a,s,l,o,c,m.x,m.y)&&au(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Jc(e,t,i,n){var r=e.prev,s=e,o=e.next;if(au(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=a<l?a<c?a:c:l<c?l:c,m=u<h?u<d?u:d:h<d?h:d,f=a>l?a>c?a:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,_=nu(p,m,t,i,n),v=nu(f,g,t,i,n),y=e.prevZ,b=e.nextZ;y&&y.z>=_&&b&&b.z<=v;){if(y.x>=p&&y.x<=f&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&su(a,u,l,h,c,d,y.x,y.y)&&au(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&su(a,u,l,h,c,d,b.x,b.y)&&au(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=_;){if(y.x>=p&&y.x<=f&&y.y>=m&&y.y<=g&&y!==r&&y!==o&&su(a,u,l,h,c,d,y.x,y.y)&&au(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==r&&b!==o&&su(a,u,l,h,c,d,b.x,b.y)&&au(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function $c(e,t,i){var n=e;do{var r=n.prev,s=n.next.next;!lu(r,s)&&cu(r,n,n.next,s)&&du(r,s)&&du(s,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(s.i/i|0),fu(n),fu(n.next),n=e=s),n=n.next}while(n!==e);return Zc(n)}function Qc(e,t,i,n,r,s){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ou(o,a)){var l=pu(o,a);return o=Zc(o,o.next),l=Zc(l,l.next),Yc(o,t,i,n,r,s,0),void Yc(l,t,i,n,r,s,0)}a=a.next}o=o.next}while(o!==e)}function eu(e,t){return e.x-t.x}function tu(e,t){var i=function(e,t){var i,n=t,r=e.x,s=e.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o&&(o=a,i=n.x<n.next.x?n:n.next,a===r))return i}n=n.next}while(n!==t);if(!i)return null;var l,c=i,u=i.x,h=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=u&&r!==n.x&&su(s<h?r:o,s,u,h,s<h?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),du(n,e)&&(l<d||l===d&&(n.x>i.x||n.x===i.x&&iu(i,n)))&&(i=n,d=l)),n=n.next}while(n!==c);return i}(e,t);if(!i)return t;var n=pu(i,e);return Zc(n,n.next),Zc(i,i.next)}function iu(e,t){return au(e.prev,e,t.prev)<0&&au(t.next,e,e.next)<0}function nu(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ru(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function su(e,t,i,n,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(n-a)>=(i-o)*(t-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function ou(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&cu(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(du(e,t)&&du(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(au(e.prev,e,t.prev)||au(e,t.prev,t))||lu(e,t)&&au(e.prev,e,e.next)>0&&au(t.prev,t,t.next)>0)}function au(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function lu(e,t){return e.x===t.x&&e.y===t.y}function cu(e,t,i,n){var r=hu(au(e,t,i)),s=hu(au(e,t,n)),o=hu(au(i,n,e)),a=hu(au(i,n,t));return r!==s&&o!==a||!(0!==r||!uu(e,i,t))||!(0!==s||!uu(e,n,t))||!(0!==o||!uu(i,e,n))||!(0!==a||!uu(i,t,n))}function uu(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function hu(e){return e>0?1:e<0?-1:0}function du(e,t){return au(e.prev,e,e.next)<0?au(e,t,e.next)>=0&&au(e,e.prev,t)>=0:au(e,t,e.prev)<0||au(e,e.next,t)<0}function pu(e,t){var i=new gu(e.i,e.x,e.y),n=new gu(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function mu(e,t,i,n){var r=new gu(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function fu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gu(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _u(e,t,i,n){for(var r=0,s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}Hc.exports=Xc,Hc.exports.default=Xc,Xc.deviation=function(e,t,i,n){var r=t&&t.length,s=Math.abs(_u(e,0,r?t[0]*i:e.length,i));if(r)for(var o=0,a=t.length;o<a;o++)s-=Math.abs(_u(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i));var l=0;for(o=0;o<n.length;o+=3){var c=n[o]*i,u=n[o+1]*i,h=n[o+2]*i;l+=Math.abs((e[c]-e[h])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[h+1]-e[c+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},Xc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)i.vertices.push(e[r][s][o]);r>0&&i.holes.push(n+=e[r-1].length)}return i};var vu=d(Hc.exports);function yu(e,t,i,n,r){bu(e,t,i||0,n||e.length-1,r||wu)}function bu(e,t,i,n,r){for(;n>i;){if(n-i>600){var s=n-i+1,o=t-i+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);bu(e,t,Math.max(i,Math.floor(t-o*l/s+c)),Math.min(n,Math.floor(t+(s-o)*l/s+c)),r)}var u=e[t],h=i,d=n;for(xu(e,i,t),r(e[n],u)>0&&xu(e,i,n);h<d;){for(xu(e,h,d),h++,d--;r(e[h],u)<0;)h++;for(;r(e[d],u)>0;)d--}0===r(e[i],u)?xu(e,i,d):xu(e,++d,n),d<=t&&(i=d+1),t<=d&&(n=d-1)}}function xu(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function wu(e,t){return e<t?-1:e>t?1:0}function Eu(e,t){const i=e.length;if(i<=1)return[e];const n=[];let r,s;for(let o=0;o<i;o++){const t=X(e[o]);0!==t&&(e[o].area=Math.abs(t),void 0===s&&(s=t<0),s===t<0?(r&&n.push(r),r=[e[o]]):r.push(e[o]))}if(r&&n.push(r),t>1)for(let o=0;o<n.length;o++)n[o].length<=t||(yu(n[o],t,1,n[o].length-1,Au),n[o]=n[o].slice(0,t));return n}function Au(e,t){return t.area-e.area}function Tu(e,t,i){const n=i.patternDependencies;let r=!1;for(const s of t){const t=s.paint.get("".concat(e,"-pattern"));t.isConstant()||(r=!0);const i=t.constantOr(null);i&&(r=!0,n[i]=!0)}return r}function Du(e,t,i,n,r){const s=r.patternDependencies;for(const o of t){const t=o.paint.get("".concat(e,"-pattern")).value;if("constant"!==t.kind){let e=t.evaluate({zoom:n},i,{},r.availableImages);e=e&&e.name?e.name:e,s[e]=!0,i.patterns[o.id]=e}}return i}class Su{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Us,this.indexArray=new io,this.indexArray2=new lo,this.programConfigurations=new Ko(e.layers,e.zoom),this.segments=new oa,this.segments2=new oa,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.projection=e.projection}populate(e,t,i,n){this.hasPattern=Tu("fill",this.layers,t);const r=this.layers[0].layout.get("fill-sort-key"),s=[];for(const{feature:o,id:a,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=ac(o,e);if(!this.layers[0]._featureFilter.filter(new xs(this.zoom),u,i))continue;const h=r?r.evaluate(u,{},i,t.availableImages):void 0,d={id:a,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:oc(o,i,n),patterns:{},sortKey:h};s.push(d)}r&&s.sort((e,t)=>e.sortKey-t.sortKey);for(const o of s){const{geometry:n,index:r,sourceLayerIndex:s}=o;if(this.hasPattern){const e=Du("fill",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,n,r,i,{},t.availableImages);t.featureIndex.insert(e[r].feature,n,r,s,this.index)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}addFeatures(e,t,i,n,r){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];for(const o of Eu(t,500)){let e=0;for(const a of o)e+=a.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=t.vertexLength,n=[],r=[];for(const a of o){if(0===a.length)continue;a!==o[0]&&r.push(n.length/2);const e=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(t+a.length-1,t),n.push(a[0].x),n.push(a[0].y);for(let i=1;i<a.length;i++)this.layoutVertexArray.emplaceBack(a[i].x,a[i].y),this.indexArray2.emplaceBack(t+i-1,t+i),n.push(a[i].x),n.push(a[i].y);e.vertexLength+=a.length,e.primitiveLength+=a.length}const s=vu(n,r);for(let o=0;o<s.length;o+=3)this.indexArray.emplaceBack(i+s[o],i+s[o+1],i+s[o+2]);t.vertexLength+=e,t.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}}Yr(Su,"FillBucket",{omit:["layers","patternFeatures"]});const Cu=new Rs({"fill-sort-key":new ks(et.layout_fill["fill-sort-key"])});var Pu={paint:new Rs({"fill-antialias":new Is(et.paint_fill["fill-antialias"]),"fill-opacity":new ks(et.paint_fill["fill-opacity"]),"fill-color":new ks(et.paint_fill["fill-color"]),"fill-outline-color":new ks(et.paint_fill["fill-outline-color"]),"fill-translate":new Is(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Is(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new ks(et.paint_fill["fill-pattern"])}),layout:Cu};const Iu=zs([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ku=zs([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Mu=zs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ru}=Iu;var Fu={},Lu=g,Ou=Bu;function Bu(e,t,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=r,e.readFields(zu,this,t)}function zu(e,t,i){1==e?t.id=i.readVarint():2==e?function(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var n=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[n]=r}}(i,t):3==e?t.type=i.readVarint():4==e&&(t._geometry=i.pos)}function Nu(e){for(var t,i,n=0,r=0,s=e.length,o=s-1;r<s;o=r++)n+=((i=e[o]).x-(t=e[r]).x)*(t.y+i.y);return n}Bu.types=["Unknown","Point","LineString","Polygon"],Bu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,n=1,r=0,s=0,o=0,a=[];e.pos<i;){if(r<=0){var l=e.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)s+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&a.push(t),t=[]),t.push(new Lu(s,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&a.push(t),a},Bu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,r=0,s=0,o=1/0,a=-1/0,l=1/0,c=-1/0;e.pos<t;){if(n<=0){var u=e.readVarint();i=7&u,n=u>>3}if(n--,1===i||2===i)(r+=e.readSVarint())<o&&(o=r),r>a&&(a=r),(s+=e.readSVarint())<l&&(l=s),s>c&&(c=s);else if(7!==i)throw new Error("unknown command "+i)}return[o,l,a,c]},Bu.prototype.toGeoJSON=function(e,t,i){var n,r,s=this.extent*Math.pow(2,i),o=this.extent*e,a=this.extent*t,l=this.loadGeometry(),c=Bu.types[this.type];function u(e){for(var t=0;t<e.length;t++){var i=e[t];e[t]=[360*(i.x+o)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+a)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];u(l=h);break;case 2:for(n=0;n<l.length;n++)u(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var i,n,r=[],s=0;s<t;s++){var o=Nu(e[s]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(i&&r.push(i),i=[e[s]]):i.push(e[s]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)u(l[n][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var Uu=Ou,ju=Vu;function Vu(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Gu,this,t),this.length=this._features.length}function Gu(e,t,i){15===e?t.version=i.readVarint():1===e?t.name=i.readString():5===e?t.extent=i.readVarint():2===e?t._features.push(i.pos):3===e?t._keys.push(i.readString()):4===e&&t._values.push(function(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(i))}Vu.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Uu(this._pbf,t,this.extent,this._keys,this._values)};var Wu=ju;function Hu(e,t,i){if(3===e){var n=new Wu(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}var Xu=Fu.VectorTile=function(e,t){this.layers=e.readFields(Hu,{},t)},qu=Fu.VectorTileFeature=Ou;function Zu(e,t,i,n){const r=[],s=0===n?(e,t,i,n,r,s)=>{e.push(new v(s,i+(s-t)/(n-t)*(r-i)))}:(e,t,i,n,r,s)=>{e.push(new v(t+(s-i)/(r-i)*(n-t),s))};for(const o of e){const e=[];for(const r of o){if(r.length<=2)continue;const o=[];for(let e=0;e<r.length-1;e++){const a=r[e].x,l=r[e].y,c=r[e+1].x,u=r[e+1].y,h=0===n?a:l,d=0===n?c:u;h<t?d>t&&s(o,a,l,c,u,t):h>i?d<i&&s(o,a,l,c,u,i):o.push(r[e]),d<t&&h>=t&&s(o,a,l,c,u,t),d>i&&h<=i&&s(o,a,l,c,u,i)}let a=r[r.length-1];const l=0===n?a.x:a.y;l>=t&&l<=i&&o.push(a),o.length&&(a=o[o.length-1],o[0].x===a.x&&o[0].y===a.y||o.push(o[0]),e.push(o))}e.length&&r.push(e)}return r}Fu.VectorTileLayer=ju;const Yu=qu.types,Ku=Math.pow(2,13);function Ju(e,t,i,n,r,s,o,a){e.emplaceBack((t<<1)+o,(i<<1)+s,(Math.floor(n*Ku)<<1)+r,Math.round(a))}function $u(e,t,i){const n=16384;e.emplaceBack(t.x,t.y,t.z,i[0]*n,i[1]*n,i[2]*n)}class Qu{constructor(){this.acc=new v(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new v(e.x,e.y),this.max=new v(e.x,e.y))}append(e,t){this.currentPolyCount.edges++,this.acc._add(e);const i=this.min,n=this.max;e.x<i.x?i.x=e.x:e.x>n.x&&(n.x=e.x),e.y<i.y?i.y=e.y:e.y>n.y&&(n.y=e.y),((0===e.x||e.x===aa)&&e.x===t.x)!=((0===e.y||e.y===aa)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,ki(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>aa!=e.x>aa&&this.addBorderIntersection(1,ki(t.y,e.y,(aa-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,ki(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>aa!=e.y>aa&&this.addBorderIntersection(3,ki(t.x,e.x,(aa-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[e];t<i[0]&&(i[0]=t),t>i[1]&&(i[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const i=0===e.x?0:1;this.addBorderIntersection(i,t.y),this.addBorderIntersection(i,e.y)}else{const i=0===e.y?2:3;this.addBorderIntersection(i,t.x),this.addBorderIntersection(i,e.x)}}centroid(){const e=this.polyCount.reduce((e,t)=>e+t.edges,0);return 0!==e?this.acc.div(e)._round():new v(0,0)}span(){return new v(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,t)=>e+ +(t[0]!==Number.MAX_VALUE),0)}}class eh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Vs,this.centroidVertexArray=new wo,this.indexArray=new io,this.programConfigurations=new Ko(e.layers,e.zoom),this.segments=new oa,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.enableTerrain=e.enableTerrain}populate(e,t,i,n){this.features=[],this.hasPattern=Tu("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){const t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/aa/(1<<e.z)}(i),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:r,id:s,index:o,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=ac(r,e);if(!this.layers[0]._featureFilter.filter(new xs(this.zoom),l,i))continue;const c={id:s,sourceLayerIndex:a,index:o,geometry:e?l.geometry:oc(r,i,n),properties:r.properties,type:r.type,patterns:{}},u=this.layoutVertexArray.length;this.hasPattern?this.features.push(Du("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,o,i,{},t.availableImages,n),t.featureIndex.insert(r,c.geometry,o,a,this.index,u)}this.sortBorders()}addFeatures(e,t,i,n,r){for(const s of this.features){const{geometry:e}=s;this.addFeature(s,e,s.index,t,i,n,r)}this.sortBorders()}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ru),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Mu.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,ku.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,i,n,r,s,o){const a=[new v(0,0),new v(aa,aa)],l=o.projection,c="globe"===l.name,u=this.enableTerrain&&!c?new Qu:null,h="Polygon"===Yu[e.type];c&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new qs);const d=Eu(t,500);for(let g=d.length-1;g>=0;g--){const e=d[g];(0===e.length||(p=e[0]).every(e=>e.x<=0)||p.every(e=>e.x>=aa)||p.every(e=>e.y<=0)||p.every(e=>e.y>=aa))&&d.splice(g,1)}var p;let m;if(c)m=lh(d,a,n);else{m=[];for(const e of d)m.push({polygon:e,bounds:a})}const f=h?this.edgeRadius:0;for(const{polygon:g,bounds:_}of m){let e=0,t=0;for(const n of g)h&&!n[0].equals(n[n.length-1])&&n.push(n[0]),t+=h?n.length-1:n.length;const i=this.segments.prepareSegment((h?5:4)*t,this.layoutVertexArray,this.indexArray);if(h){const t=[],r=[];e=i.vertexLength;for(const e of g){let s,o;e.length&&e!==g[0]&&r.push(t.length/2),s=e[1].sub(e[0])._perp()._unit();for(let r=1;r<e.length;r++){const a=e[r],u=e[r===e.length-1?1:r+1];let{x:h,y:d}=a;if(f){o=u.sub(a)._perp()._unit();const e=s.add(o)._unit(),t=f*Math.min(4,1/(s.x*e.x+s.y*e.y));h+=t*e.x,d+=t*e.y,s=o}Ju(this.layoutVertexArray,h,d,0,0,1,1,0),i.vertexLength++,t.push(a.x,a.y),c&&$u(this.layoutVertexExtArray,l.projectTilePoint(h,d,n),l.upVector(n,h,d))}}const s=vu(t,r);for(let n=0;n<s.length;n+=3)this.indexArray.emplaceBack(e+s[n],e+s[n+2],e+s[n+1]),i.primitiveLength++}for(const r of g){u&&r.length&&u.startRing(r[0]);let t,s,o,a=r.length>4&&sh(r[r.length-2],r[0],r[1]),d=f?ih(r[r.length-2],r[0],r[1],f):0;s=r[1].sub(r[0])._perp()._unit();let p=!0;for(let m=1,g=0;m<r.length;m++){let v=r[m-1],y=r[m];const b=r[m===r.length-1?1:m+1];if(u&&h&&u.currentPolyCount.top++,rh(y,v,_)){f&&(s=b.sub(y)._perp()._unit(),p=!p);continue}u&&u.append(y,v);const x=y.sub(v)._perp(),w=x.x/(Math.abs(x.x)+Math.abs(x.y)),E=x.y>0?1:0,A=v.dist(y);if(g+A>32768&&(g=0),f){o=b.sub(y)._perp()._unit();let e=nh(v,y,b,th(s,o),f);isNaN(e)&&(e=0);const t=y.sub(v)._unit();v=v.add(t.mult(d))._round(),y=y.add(t.mult(-e))._round(),d=e,s=o}const T=i.vertexLength,D=r.length>4&&sh(v,y,b);let S=oh(g,a,p);if(Ju(this.layoutVertexArray,v.x,v.y,w,E,0,0,S),Ju(this.layoutVertexArray,v.x,v.y,w,E,0,1,S),g+=A,S=oh(g,D,!p),a=D,Ju(this.layoutVertexArray,y.x,y.y,w,E,0,0,S),Ju(this.layoutVertexArray,y.x,y.y,w,E,0,1,S),i.vertexLength+=4,this.indexArray.emplaceBack(T+0,T+1,T+2),this.indexArray.emplaceBack(T+1,T+3,T+2),i.primitiveLength+=2,f){const n=e+(1===m?r.length-2:m-2),s=1===m?e:n+1;if(this.indexArray.emplaceBack(T+1,n,T+3),this.indexArray.emplaceBack(n,s,T+3),i.primitiveLength+=2,void 0===t&&(t=T),!rh(b,r[m],_)){const e=m===r.length-1?t:i.vertexLength;this.indexArray.emplaceBack(T+2,T+3,e),this.indexArray.emplaceBack(T+3,e+1,e),this.indexArray.emplaceBack(T+3,s,e+1),i.primitiveLength+=3}p=!p}if(c){const e=this.layoutVertexExtArray,t=l.projectTilePoint(v.x,v.y,n),i=l.projectTilePoint(y.x,y.y,n),r=l.upVector(n,v.x,v.y),s=l.upVector(n,y.x,y.y);$u(e,t,r),$u(e,t,r),$u(e,i,s),$u(e,i,s)}}h&&(e+=r.length-1)}}if(u&&u.polyCount.length>0){if(u.borders){u.vertexArrayOffset=this.centroidVertexArray.length;const e=u.borders,t=this.featuresOnBorder.push(u)-1;for(let i=0;i<4;i++)e[i][0]!==Number.MAX_VALUE&&this.borders[i].push(t)}this.encodeCentroid(u.borders?void 0:u.centroid(),u)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((t,i)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[i].borders[e][0])}encodeCentroid(e,t){let i,n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e)if(0!==e.y){const r=t.span()._mult(this.tileToMeter);i=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(r.x/10)),n=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(r.y/10))}else i=Math.ceil(7*(e.x+450)),n=0;else i=0,n=+r;let s=r?this.centroidVertexArray.length:t.vertexArrayOffset;for(const o of t.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*o.edges+o.top);for(let e=0;e<o.top;e++)this.centroidVertexArray.emplace(s++,i,n);for(let e=0;e<2*o.edges;e++)this.centroidVertexArray.emplace(s++,0,n),this.centroidVertexArray.emplace(s++,i,n)}}}function th(e,t){const i=e.add(t)._unit();return e.x*i.x+e.y*i.y}function ih(e,t,i,n){const r=t.sub(e)._perp()._unit(),s=i.sub(t)._perp()._unit();return nh(e,t,i,th(r,s),n)}function nh(e,t,i,n,r){const s=Math.sqrt(1-n*n);return Math.min(e.dist(t)/3,t.dist(i)/3,r*s/n)}function rh(e,t,i){return e.x<i[0].x&&t.x<i[0].x||e.x>i[1].x&&t.x>i[1].x||e.y<i[0].y&&t.y<i[0].y||e.y>i[1].y&&t.y>i[1].y}function sh(e,t,i){if(e.x<0||e.x>=aa||t.x<0||t.x>=aa||i.x<0||i.x>=aa)return!1;const n=i.sub(t),r=n.perp(),s=e.sub(t);return(n.x*s.x+n.y*s.y)/Math.sqrt((n.x*n.x+n.y*n.y)*(s.x*s.x+s.y*s.y))>-.866&&r.x*s.x+r.y*s.y<0}function oh(e,t,i){const n=t?2|e:-3&e;return i?1|n:-2&n}function ah(){const e=Math.PI/32,t=Math.tan(e),i=Nl;return i*Math.sqrt(1+2*t*t)-i}function lh(e,t,i){const n=1<<i.z,r=ql(i.x/n),s=ql((i.x+1)/n),o=Zl(i.y/n),a=Zl((i.y+1)/n);return function(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;const o=[];if(!e.length||!i||!n)return o;const a=(e,t)=>{for(const i of e)o.push({polygon:i,bounds:t})},l=Math.ceil(Math.log2(i)),c=Math.ceil(Math.log2(n)),u=l-c,h=[];for(let m=0;m<Math.abs(u);m++)h.push(u>0?0:1);for(let m=0;m<Math.min(l,c);m++)h.push(0),h.push(1);let d=e;if(d=Zu(d,t[0].y-r,t[1].y+r,1),d=Zu(d,t[0].x-r,t[1].x+r,0),!d.length)return o;const p=[];for(h.length?p.push({polygons:d,bounds:t,depth:0}):a(d,t);p.length;){const e=p.pop(),t=e.depth,i=h[t],n=e.bounds[0],o=e.bounds[1],l=0===i?n.x:n.y,c=0===i?o.x:o.y,u=s?s(i,l,c):.5*(l+c),d=Zu(e.polygons,l-r,u+r,i),m=Zu(e.polygons,u-r,c+r,i);if(d.length){const e=[n,new v(0===i?u:o.x,1===i?u:o.y)];h.length>t+1?p.push({polygons:d,bounds:e,depth:t+1}):a(d,e)}if(m.length){const e=[new v(0===i?u:n.x,1===i?u:n.y),o];h.length>t+1?p.push({polygons:m,bounds:e,depth:t+1}):a(m,e)}}return o}(e,t,Math.ceil((s-r)/11.25),Math.ceil((o-a)/11.25),1,(e,t,r)=>{if(0===e)return.5*(t+r);{const e=Zl((i.y+t/aa)/n);return(Hl(.5*(Zl((i.y+r/aa)/n)+e))*n-i.y)*aa}})}Yr(eh,"FillExtrusionBucket",{omit:["layers","features"]}),Yr(Qu,"PartMetadata");const ch=new Rs({"fill-extrusion-edge-radius":new Is(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var uh={paint:new Rs({"fill-extrusion-opacity":new Is(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ks(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Is(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Is(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ks(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ks(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ks(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Is(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Is(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Is(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Is(et["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:ch};function hh(e,t,i){var n=2*Math.PI*6378137/256/Math.pow(2,i);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class dh{constructor(e,t,i){this.z=e,this.x=t,this.y=i,this.key=fh(0,e,e,t,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const i=function(e,t,i){var n=hh(256*e,256*(t=Math.pow(2,i)-t-1),i),r=hh(256*(e+1),256*(t+1),i);return n[0]+","+n[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),n=function(e,t,i){let n,r="";for(let s=e;s>0;s--)n=1<<s-1,r+=(t&n?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",i)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class ph{constructor(e,t){this.wrap=e,this.canonical=t,this.key=fh(e,t.z,t.z,t.x,t.y)}}class mh{constructor(e,t,i,n,r){this.overscaledZ=e,this.wrap=t,this.canonical=new dh(i,+n,+r),this.key=0===t&&e===i?this.canonical.key:fh(t,e,i,n,r)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new mh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mh(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return fh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-e;return fh(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new mh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new mh(t,this.wrap,t,i,n),new mh(t,this.wrap,t,i+1,n),new mh(t,this.wrap,t,i,n+1),new mh(t,this.wrap,t,i+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new mh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new mh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ph(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}function fh(e,t,i,n,r){const s=1<<Math.min(i,22);let o=s*(r%s)+n%s;return e&&i<22&&(o+=s*s*((e<0?-2*e-1:2*e)%(1<<2*(22-i)))),16*(32*o+i)+(t-i)}Yr(dh,"CanonicalTileID"),Yr(mh,"OverscaledTileID",{omit:["projMatrix"]});class gh extends v{constructor(e,t,i){super(e,t),this.z=i}}function _h(e,t){return e.x*t.x+e.y*t.y}function vh(e,t){if(1===e.length){let i=0;const n=t[i++];let r;for(;!r||n.equals(r);)if(r=t[i++],!r)return 1/0;for(;i<t.length;i++){const s=t[i],o=e[0],a=r.sub(n),l=s.sub(n),c=o.sub(n),u=_h(a,a),h=_h(a,l),d=_h(l,l),p=_h(c,a),m=_h(c,l),f=u*d-h*h,g=(d*p-h*m)/f,_=(u*m-h*p)/f,v=n.z*(1-g-_)+r.z*g+s.z*_;if(isFinite(v))return v}return 1/0}{let e=1/0;for(const i of t)e=Math.min(e,i.z);return e}}function yh(e,t,i,n,r,s,o,a){const l=o*r.getElevationAt(e,t,!0,!0),c=0!==s[0],u=c?0===s[1]?o*(s[0]/7-450):o*function(e,t,i){const n=Math.floor(t[0]/8),r=Math.floor(t[1]/8),s=10*(t[0]-8*n),o=10*(t[1]-8*r),a=e.getElevationAt(n,r,!0,!0),l=e.getMeterToDEM(i),c=Math.floor(.5*(s*l-1)),u=Math.floor(.5*(o*l-1)),h=e.tileCoordToPixel(n,r),d=2*c+1,p=2*u+1,m=function(e,t,i,n,r){return[e.getElevationAtPixel(t,i,!0),e.getElevationAtPixel(t+r,i,!0),e.getElevationAtPixel(t,i+r,!0),e.getElevationAtPixel(t+n,i+r,!0)]}(e,h.x-c,h.y-u,d,p),f=Math.abs(m[0]-m[1]),g=Math.abs(m[2]-m[3]),_=Math.abs(m[0]-m[2])+Math.abs(m[1]-m[3]),v=Math.min(.25,.5*l*(f+g)/d),y=Math.min(.25,.5*l*_/p);return a+Math.max(v*s,y*o)}(r,s,a):l;return{base:l+(0===i)?-1:i,top:c?Math.max(u+n,l+i+2):l+n}}const bh=zs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:xh}=bh,wh=zs([{name:"a_packed",components:4,type:"Float32"}]),{members:Eh}=wh,Ah=qu.types,Th=Math.cos(Math.PI/180*37.5);class Dh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(e=>{this.gradients[e.id]={}}),this.layoutVertexArray=new Gs,this.layoutVertexArray2=new Ws,this.indexArray=new io,this.programConfigurations=new Ko(e.layers,e.zoom),this.segments=new oa,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,i,n){this.hasPattern=Tu("line",this.layers,t);const r=this.layers[0].layout.get("line-sort-key"),s=[];for(const{feature:c,id:u,index:h,sourceLayerIndex:d}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ac(c,e);if(!this.layers[0]._featureFilter.filter(new xs(this.zoom),t,i))continue;const o=r?r.evaluate(t,{},i):void 0,a={id:u,properties:c.properties,type:c.type,sourceLayerIndex:d,index:h,geometry:e?t.geometry:oc(c,i,n),patterns:{},sortKey:o};s.push(a)}r&&s.sort((e,t)=>e.sortKey-t.sortKey);const{lineAtlas:o,featureIndex:a}=t,l=this.addConstantDashes(o);for(const c of s){const{geometry:n,index:r,sourceLayerIndex:s}=c;if(l&&this.addFeatureDashes(c,o),this.hasPattern){const e=Du("line",this.layers,c,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(c,n,r,i,o.positions,t.availableImages);a.insert(e[r].feature,n,r,s,this.index)}}addConstantDashes(e){let t=!1;for(const i of this.layers){const n=i.paint.get("line-dasharray").value,r=i.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==r.kind)t=!0;else{const t=r.value,i=n.value;if(!i)continue;e.addDash(i,t)}}return t}addFeatureDashes(e,t){const i=this.zoom;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,s=n.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===s.kind)continue;let o,a;if("constant"===r.kind){if(o=r.value,!o)continue}else o=r.evaluate({zoom:i},e);a="constant"===s.kind?s.value:s.evaluate({zoom:i},e),t.addDash(o,a),e.patterns[n.id]=t.getKey(o,a)}}update(e,t,i,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i,n)}addFeatures(e,t,i,n,r){for(const s of this.patternFeatures)this.addFeature(s,s.geometry,s.index,t,i,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Eh)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xh),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,i,n,r,s){const o=this.layers[0].layout,a=o.get("line-join").evaluate(e,{}),l=o.get("line-cap").evaluate(e,{}),c=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const h of t)this.addLine(h,e,a,l,c,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,r,s,n)}addLine(e,t,i,n,r,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Ah[t.type];let a=e.length;for(;a>=2&&e[a-1].equals(e[a-2]);)a--;let l=0;for(;l<a-1&&e[l].equals(e[l+1]);)l++;if(a<(o?3:2))return;"bevel"===i&&(r=1.05);const c=this.overscaling<=16?15*aa/(512*this.overscaling):0,u=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,d,p,m,f;this.e1=this.e2=-1,o&&(h=e[a-2],f=e[l].sub(h)._unit()._perp());for(let g=l;g<a;g++){if(p=g===a-1?o?e[l+1]:void 0:e[g+1],p&&e[g].equals(p))continue;f&&(m=f),h&&(d=h),h=e[g],f=p?p.sub(h)._unit()._perp():m,m=m||f;let t=m.add(f);0===t.x&&0===t.y||t._unit();const _=m.x*f.x+m.y*f.y,v=t.x*f.x+t.y*f.y,y=0!==v?1/v:1/0,b=2*Math.sqrt(2-2*v),x=v<Th&&d&&p,w=m.x*f.y-m.y*f.x>0;if(x&&g>l){const e=h.dist(d);if(e>2*c){const t=h.sub(h.sub(d)._mult(c/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,m,0,0,u),d=t}}const E=d&&p;let A=E?i:o?"butt":n;if(E&&"round"===A&&(y<s?A="miter":y<=2&&(A="fakeround")),"miter"===A&&y>r&&(A="bevel"),"bevel"===A&&(y>2&&(A="flipbevel"),y<r&&(A="miter")),d&&this.updateDistance(d,h),"miter"===A)t._mult(y),this.addCurrentVertex(h,t,0,0,u);else if("flipbevel"===A){if(y>100)t=f.mult(-1);else{const e=y*m.add(f).mag()/m.sub(f).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(h,t,0,0,u),this.addCurrentVertex(h,t.mult(-1),0,0,u)}else if("bevel"===A||"fakeround"===A){const e=-Math.sqrt(y*y-1),t=w?e:0,i=w?0:e;if(d&&this.addCurrentVertex(h,m,t,i,u),"fakeround"===A){const e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let i=t/e;if(.5!==i){const e=i-.5;i+=i*e*(i-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*e*e+(.848013+_*(.215638*_-1.06021)))}const n=f.sub(m)._mult(i)._add(m)._unit()._mult(w?-1:1);this.addHalfVertex(h,n.x,n.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,f,-t,-i,u)}else if("butt"===A)this.addCurrentVertex(h,t,0,0,u);else if("square"===A){const e=d?1:-1;d||this.addCurrentVertex(h,t,e,e,u),this.addCurrentVertex(h,t,0,0,u),d&&this.addCurrentVertex(h,t,e,e,u)}else"round"===A&&(d&&(this.addCurrentVertex(h,m,0,0,u),this.addCurrentVertex(h,m,1,1,u,!0)),p&&(this.addCurrentVertex(h,f,-1,-1,u,!0),this.addCurrentVertex(h,f,0,0,u)));if(x&&g<a-1){const e=h.dist(p);if(e>2*c){const t=h.add(p.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,f,0,0,u),h=t}}}}addCurrentVertex(e,t,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=t.y*n-t.x,a=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,s,!1,i,r),this.addHalfVertex(e,o,a,s,!0,-n,r)}addHalfVertex(e,t,i,n,r,s,o){let{x:a,y:l}=e;this.layoutVertexArray.emplaceBack((a<<1)+(n?1:0),(l<<1)+(r?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const c=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),o.primitiveLength++),r?this.e2=c:this.e1=c}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}Yr(Dh,"LineBucket",{omit:["layers","patternFeatures"]});const Sh=new Rs({"line-cap":new ks(et.layout_line["line-cap"]),"line-join":new ks(et.layout_line["line-join"]),"line-miter-limit":new Is(et.layout_line["line-miter-limit"]),"line-round-limit":new Is(et.layout_line["line-round-limit"]),"line-sort-key":new ks(et.layout_line["line-sort-key"])});var Ch={paint:new Rs({"line-opacity":new ks(et.paint_line["line-opacity"]),"line-color":new ks(et.paint_line["line-color"]),"line-translate":new Is(et.paint_line["line-translate"]),"line-translate-anchor":new Is(et.paint_line["line-translate-anchor"]),"line-width":new ks(et.paint_line["line-width"]),"line-gap-width":new ks(et.paint_line["line-gap-width"]),"line-offset":new ks(et.paint_line["line-offset"]),"line-blur":new ks(et.paint_line["line-blur"]),"line-dasharray":new ks(et.paint_line["line-dasharray"]),"line-pattern":new ks(et.paint_line["line-pattern"]),"line-gradient":new Ms(et.paint_line["line-gradient"]),"line-trim-offset":new Is(et.paint_line["line-trim-offset"])}),layout:Sh};const Ph=new class extends ks{possiblyEvaluate(e,t){return t=new xs(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,i,n){return t=M({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,i,n)}}(Ch.paint.properties["line-width"].specification);function Ih(e,t){return t>0?t+2*e:e}Ph.useIntegerZoom=!0;const kh=zs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Mh=zs([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Rh=zs([{name:"a_projected_pos",components:4,type:"Float32"}],4);zs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Fh=zs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Lh=zs([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);zs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Oh=zs([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Bh=zs([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);zs([{name:"triangle",components:3,type:"Uint16"}]),zs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),zs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zs([{type:"Float32",name:"offsetX"}]),zs([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var zh=24;const Nh=128;function Uh(e,t){const{expression:i}=t;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new xs(e+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=i;let r=0;for(;r<t.length&&t[r]<=e;)r++;r=Math.max(0,r-1);let s=r;for(;s<t.length&&t[s]<e+1;)s++;s=Math.min(t.length-1,s);const o=t[r],a=t[s];return"composite"===i.kind?{kind:"composite",minZoom:o,maxZoom:a,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:a,minSize:i.evaluate(new xs(o)),maxSize:i.evaluate(new xs(a)),interpolationType:n}}}function jh(e,t,i){let{uSize:n,uSizeT:r}=t,{lowerSize:s,upperSize:o}=i;return"source"===e.kind?s/Nh:"composite"===e.kind?ki(s/Nh,o/Nh,r):n}function Vh(e,t){let i=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:r,minZoom:s,maxZoom:o}=e,a=r?S(Qi.interpolationFactor(r,t,s,o),0,1):0;"camera"===e.kind?n=ki(e.minSize,e.maxSize,a):i=a}return{uSizeT:i,uSize:n}}var Gh=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Nh,evaluateSizeForFeature:jh,evaluateSizeForZoom:Vh,getSizeData:Uh});function Wh(e,t,i){return e.sections.forEach(e=>{e.text=function(e,t,i){const n=t.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),bs.applyArabicShaping&&(e=bs.applyArabicShaping(e)),e}(e.text,t,i)}),e}const Hh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Xh(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function qh(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var Zh=Jh,Yh=function(e,t,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?r-1:0,d=i?-1:1,p=e[t+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)},Kh=function(e,t,i,n,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,m=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,r),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[i+p]=255&a,p+=m,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[i+p]=255&o,p+=m,o/=256,c-=8);e[i+p-m]|=128*f};function Jh(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Jh.Varint=0,Jh.Fixed64=1,Jh.Bytes=2,Jh.Fixed32=5;var $h=4294967296,Qh=1/$h,ed="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function td(e){return e.type===Jh.Bytes?e.readVarint()+e.pos:e.pos+1}function id(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function nd(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=e;r--)i.buf[r+n]=i.buf[r]}function rd(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function sd(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function od(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function ad(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function ld(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function cd(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function ud(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function hd(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function dd(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function pd(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function md(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function fd(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Jh.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,e(r,t,this),this.pos===s&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=pd(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=fd(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=pd(this.buf,this.pos)+pd(this.buf,this.pos+4)*$h;return this.pos+=8,e},readSFixed64:function(){var e=pd(this.buf,this.pos)+fd(this.buf,this.pos+4)*$h;return this.pos+=8,e},readFloat:function(){var e=Yh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Yh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,n=this.buf;return t=127&(i=n[this.pos++]),i<128?t:(t|=(127&(i=n[this.pos++]))<<7,i<128?t:(t|=(127&(i=n[this.pos++]))<<14,i<128?t:(t|=(127&(i=n[this.pos++]))<<21,i<128?t:function(e,t,i){var n,r,s=i.buf;if(n=(112&(r=s[i.pos++]))>>4,r<128)return id(e,n,t);if(n|=(127&(r=s[i.pos++]))<<3,r<128)return id(e,n,t);if(n|=(127&(r=s[i.pos++]))<<10,r<128)return id(e,n,t);if(n|=(127&(r=s[i.pos++]))<<17,r<128)return id(e,n,t);if(n|=(127&(r=s[i.pos++]))<<24,r<128)return id(e,n,t);if(n|=(1&(r=s[i.pos++]))<<31,r<128)return id(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ed?function(e,t,i){return ed.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var n="",r=t;r<i;){var s,o,a,l=e[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>i)break;1===u?l<128&&(c=l):2===u?128==(192&(s=e[r+1]))&&(c=(31&l)<<6|63&s)<=127&&(c=null):3===u?(o=e[r+2],128==(192&(s=e[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&s)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=e[r+2],a=e[r+3],128==(192&(s=e[r+1]))&&128==(192&o)&&128==(192&a)&&((c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),r+=u}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Jh.Bytes)return e.push(this.readVarint(t));var i=td(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Jh.Bytes)return e.push(this.readSVarint());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Jh.Bytes)return e.push(this.readBoolean());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Jh.Bytes)return e.push(this.readFloat());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Jh.Bytes)return e.push(this.readDouble());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Jh.Bytes)return e.push(this.readFixed32());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Jh.Bytes)return e.push(this.readSFixed32());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Jh.Bytes)return e.push(this.readFixed64());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Jh.Bytes)return e.push(this.readSFixed64());var t=td(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Jh.Varint)for(;this.buf[this.pos++]>127;);else if(t===Jh.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Jh.Fixed32)this.pos+=4;else{if(t!==Jh.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),md(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),md(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),md(this.buf,-1&e,this.pos),md(this.buf,Math.floor(e*Qh),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),md(this.buf,-1&e,this.pos),md(this.buf,Math.floor(e*Qh),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,i.buf[i.pos]=127&(e>>>=7)}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var n,r,s=0;s<t.length;s++){if((n=t.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):r=n;continue}if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(e[i++]=239,e[i++]=191,e[i++]=189,r=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=63&n|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&nd(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),Kh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Kh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&nd(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,Jh.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,rd,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,sd,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,ld,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,od,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,ad,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,cd,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,ud,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,hd,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,dd,t)},writeBytesField:function(e,t){this.writeTag(e,Jh.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Jh.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Jh.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Jh.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Jh.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Jh.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Jh.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Jh.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Jh.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Jh.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var gd=d(Zh);const _d=3;function vd(e,t,i){t.glyphs=[],1===e&&i.readMessage(yd,t)}function yd(e,t,i){if(3===e){const{id:e,bitmap:n,width:r,height:s,left:o,top:a,advance:l}=i.readMessage(bd,{});t.glyphs.push({id:e,bitmap:new zc({width:r+2*_d,height:s+2*_d},n),metrics:{width:r,height:s,left:o,top:a,advance:l}})}else 4===e?t.ascender=i.readSVarint():5===e&&(t.descender=i.readSVarint())}function bd(e,t,i){1===e?t.id=i.readVarint():2===e?t.bitmap=i.readBytes():3===e?t.width=i.readVarint():4===e?t.height=i.readVarint():5===e?t.left=i.readSVarint():6===e?t.top=i.readSVarint():7===e&&(t.advance=i.readVarint())}const xd=_d;function wd(e){let t=0,i=0;for(const o of e)t+=o.w*o.h,i=Math.max(i,o.w);e.sort((e,t)=>t.h-e.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let r=0,s=0;for(const o of e)for(let e=n.length-1;e>=0;e--){const t=n[e];if(!(o.w>t.w||o.h>t.h)){if(o.x=t.x,o.y=t.y,s=Math.max(s,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===t.w&&o.h===t.h){const t=n.pop();e<n.length&&(n[e]=t)}else o.h===t.h?(t.x+=o.w,t.w-=o.w):o.w===t.w?(t.y+=o.h,t.h-=o.h):(n.push({x:t.x+o.w,y:t.y,w:t.w-o.w,h:o.h}),t.y+=o.h,t.h-=o.h);break}}return{w:r,h:s,fill:t/(r*s)||0}}const Ed=1;class Ad{constructor(e,t){let{pixelRatio:i,version:n,stretchX:r,stretchY:s,content:o}=t;this.paddedRect=e,this.pixelRatio=i,this.stretchX=r,this.stretchY=s,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+Ed,this.paddedRect.y+Ed]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ed,this.paddedRect.y+this.paddedRect.h-Ed]}get displaySize(){return[(this.paddedRect.w-2*Ed)/this.pixelRatio,(this.paddedRect.h-2*Ed)/this.pixelRatio]}}class Td{constructor(e,t){const i={},n={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,i,r),this.addImages(t,n,r);const{w:s,h:o}=wd(r),a=new Nc({width:s||1,height:o||1});for(const l in e){const t=e[l],n=i[l].paddedRect;Nc.copy(t.data,a,{x:0,y:0},{x:n.x+Ed,y:n.y+Ed},t.data)}for(const l in t){const e=t[l],i=n[l].paddedRect,r=i.x+Ed,s=i.y+Ed,o=e.data.width,c=e.data.height;Nc.copy(e.data,a,{x:0,y:0},{x:r,y:s},e.data),Nc.copy(e.data,a,{x:0,y:c-1},{x:r,y:s-1},{width:o,height:1}),Nc.copy(e.data,a,{x:0,y:0},{x:r,y:s+c},{width:o,height:1}),Nc.copy(e.data,a,{x:o-1,y:0},{x:r-1,y:s},{width:1,height:c}),Nc.copy(e.data,a,{x:0,y:0},{x:r+o,y:s},{width:1,height:c})}this.image=a,this.iconPositions=i,this.patternPositions=n}addImages(e,t,i){for(const n in e){const r=e[n],s={x:0,y:0,w:r.data.width+2*Ed,h:r.data.height+2*Ed};i.push(s),t[n]=new Ad(s,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(t=>e.hasImage(t)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)}patchUpdatedImage(e,t,i){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,r]=e.tl;i.update(t.data,void 0,{x:n,y:r})}}Yr(Ad,"ImagePosition"),Yr(Td,"ImageAtlas");const Dd={horizontal:1,vertical:2,horizontalOnly:3},Sd=-17;class Cd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const i=new Cd;return i.scale=e||1,i.fontStack=t,i}static forImage(e){const t=new Cd;return t.imageName=e,t}}class Pd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const i=new Pd;for(let n=0;n<e.sections.length;n++){const r=e.sections[n];r.image?i.addImageSection(r):i.addTextSection(r,t)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(e,t){let i="";for(let n=0;n<e.length;n++){const r=e.charCodeAt(n+1)||null,s=e.charCodeAt(n-1)||null;i+=!t&&(r&&ss(r)&&!Hh[e[n+1]]||s&&ss(s)&&!Hh[e[n-1]])||!Hh[e[n]]?e[n]:Hh[e[n]]}return i}(this.text,e)}trim(){let e=0;for(let i=0;i<this.text.length&&kd[this.text.charCodeAt(i)];i++)e++;let t=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&kd[this.text.charCodeAt(i)];i--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const i=new Pd;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,t)=>Math.max(e,this.sections[t].scale),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(Cd.forText(e.scale,e.fontStack||t));const i=this.sections.length-1;for(let n=0;n<e.text.length;++n)this.sectionIndex.push(i)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void W("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Cd.forImage(t)),this.sectionIndex.push(this.sections.length-1)):W("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Id(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m){const f=Pd.fromFeature(e,r);h===Dd.vertical&&f.verticalizePunctuation(d);let g=[];const _=function(e,t,i,n,r,s){if(!e)return[];const o=[],a=function(e,t,i,n,r,s){let o=0;for(let a=0;a<e.length();a++){const i=e.getSection(a);o+=Rd(e.getCharCode(a),i,n,r,t,s)}return o/Math.max(1,Math.ceil(o/i))}(e,t,i,n,r,s),l=e.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<e.length();h++){const i=e.getSection(h),d=e.getCharCode(h);if(kd[d]||(c+=Rd(d,i,n,r,t,s)),h<e.length()-1){const t=!((u=d)<11904||!(es["Bopomofo Extended"](u)||es.Bopomofo(u)||es["CJK Compatibility Forms"](u)||es["CJK Compatibility Ideographs"](u)||es["CJK Compatibility"](u)||es["CJK Radicals Supplement"](u)||es["CJK Strokes"](u)||es["CJK Symbols and Punctuation"](u)||es["CJK Unified Ideographs Extension A"](u)||es["CJK Unified Ideographs"](u)||es["Enclosed CJK Letters and Months"](u)||es["Halfwidth and Fullwidth Forms"](u)||es.Hiragana(u)||es["Ideographic Description Characters"](u)||es["Kangxi Radicals"](u)||es["Katakana Phonetic Extensions"](u)||es.Katakana(u)||es["Vertical Forms"](u)||es["Yi Radicals"](u)||es["Yi Syllables"](u)));(Md[d]||t||i.imageName)&&o.push(Od(h+1,c,a,o,Ld(d,e.getCharCode(h+1),t&&l),!1))}}var u;return Bd(Od(e.length(),c,a,o,0,!0))}(f,c,s,t,n,p),{processBidirectionalText:v,processStyledBidirectionalText:y}=bs;if(v&&1===f.sections.length){const e=v(f.toString(),_);for(const t of e){const e=new Pd;e.text=t,e.sections=f.sections;for(let i=0;i<t.length;i++)e.sectionIndex.push(0);g.push(e)}}else if(y){const e=y(f.text,f.sectionIndex,_);for(const t of e){const e=new Pd;e.text=t[0],e.sectionIndex=t[1],e.sections=f.sections,g.push(e)}}else g=function(e,t){const i=[],n=e.text;let r=0;for(const s of t)i.push(e.substring(r,s)),r=s;return r<n.length&&i.push(e.substring(r,n.length)),i}(f,_);const b=[],x={positionedLines:b,text:f.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,i,n,r,s,o,a,l,c,u,h){let d=0,p=0,m=0;const f="right"===a?1:"left"===a?0:.5;let g=!1;for(const w of r){const e=w.getSections();for(const i of e){if(i.imageName)continue;const e=t[i.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let _=0;for(const w of r){w.trim();const r=w.getMaxScale(),o=(r-1)*zh,a={positionedGlyphs:[],lineOffset:0};e.positionedLines[_]=a;const y=a.positionedGlyphs;let b=0;if(!w.length()){p+=s,++_;continue}let x=0,E=0;for(let s=0;s<w.length();s++){const o=w.getSection(s),a=w.getSectionIndex(s),m=w.getCharCode(s);let f=o.scale,_=null,A=null,T=null,D=zh,S=0;const C=!(l===Dd.horizontal||!u&&!rs(m)||u&&(kd[m]||(v=m,es.Arabic(v)||es["Arabic Supplement"](v)||es["Arabic Extended-A"](v)||es["Arabic Presentation Forms-A"](v)||es["Arabic Presentation Forms-B"](v))));if(o.imageName){const t=n[o.imageName];if(!t)continue;T=o.imageName,e.iconsInText=e.iconsInText||!0,A=t.paddedRect;const i=t.displaySize;f=f*zh/h,_={width:i[0],height:i[1],left:Ed,top:-xd,advance:C?i[1]:i[0],localGlyph:!1},S=g?-_.height*f:Sd+r*zh-i[1]*f,D=_.advance;const s=(C?i[0]:i[1])*f-zh*r;s>0&&s>b&&(b=s)}else{const e=i[o.fontStack];if(!e)continue;e[m]&&(A=e[m]);const n=t[o.fontStack];if(!n)continue;const s=n.glyphs[m];if(!s)continue;if(_=s.metrics,D=8203!==m?zh:0,g){const e=void 0!==n.ascender?Math.abs(n.ascender):0,t=void 0!==n.descender?Math.abs(n.descender):0,i=(e+t)*f;x<i&&(x=i,E=(e-t)/2*f),S=-e*f}else S=Sd+(r-f)*zh}C?(e.verticalizable=!0,y.push({glyph:m,imageName:T,x:d,y:p+S,vertical:C,scale:f,localGlyph:_.localGlyph,fontStack:o.fontStack,sectionIndex:a,metrics:_,rect:A}),d+=D*f+c):(y.push({glyph:m,imageName:T,x:d,y:p+S,vertical:C,scale:f,localGlyph:_.localGlyph,fontStack:o.fontStack,sectionIndex:a,metrics:_,rect:A}),d+=_.advance*f+c)}0!==y.length&&(m=Math.max(d-c,m),g?Nd(y,f,b,E,s*r/2):Nd(y,f,b,0,s/2)),d=0;const A=s*r+b;a.lineOffset=Math.max(b,o),p+=A,++_}var v;const y=p,{horizontalAlign:b,verticalAlign:x}=zd(o);(function(e,t,i,n,r,s){const o=(t-i)*r,a=-s*n;for(const l of e)for(const e of l.positionedGlyphs)e.x+=o,e.y+=a})(e.positionedLines,f,b,x,m,y),e.top+=-x*y,e.bottom=e.top+y,e.left+=-b*m,e.right=e.left+m,e.hasBaseline=g}(x,t,i,n,g,o,a,l,h,c,d,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(b)&&x}const kd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Md={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Rd(e,t,i,n,r,s){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*zh/s+r:0}{const n=i[t.fontStack],s=n&&n.glyphs[e];return s?s.metrics.advance*t.scale+r:0}}function Fd(e,t,i,n){const r=Math.pow(e-t,2);return n?e<t?r/2:2*r:r+Math.abs(i)*i}function Ld(e,t,i){let n=0;return 10===e&&(n-=1e4),i&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function Od(e,t,i,n,r,s){let o=null,a=Fd(t,i,r,s);for(const l of n){const e=Fd(t-l.x,i,r,s)+l.badness;e<=a&&(o=l,a=e)}return{index:e,x:t,priorBreak:o,badness:a}}function Bd(e){return e?Bd(e.priorBreak).concat(e.index):[]}function zd(e){let t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Nd(e,t,i,n,r){if(!(t||i||n||r))return;const s=e.length-1,o=e[s],a=(o.x+o.metrics.advance*o.scale)*t;for(let l=0;l<=s;l++)e[l].x-=a,e[l].y+=i+n+r}function Ud(e,t,i){const{horizontalAlign:n,verticalAlign:r}=zd(i),s=t[0]-e.displaySize[0]*n,o=t[1]-e.displaySize[1]*r;return{image:e,top:o,bottom:o+e.displaySize[1],left:s,right:s+e.displaySize[0]}}function jd(e,t,i,n,r,s){const o=e.image;let a;if(o.content){const e=o.content,t=o.pixelRatio||1;a=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*s,c=t.right*s;let u,h,d,p;"width"===i||"both"===i?(p=r[0]+l-n[3],h=r[0]+c+n[1]):(p=r[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const m=t.top*s,f=t.bottom*s;return"height"===i||"both"===i?(u=r[1]+m-n[0],d=r[1]+f+n[2]):(u=r[1]+(m+f-o.displaySize[1])/2,d=u+o.displaySize[1]),{image:o,top:u,right:h,bottom:d,left:p,collisionPadding:a}}class Vd extends v{constructor(e,t,i,n,r){super(e,t),this.angle=n,this.z=i,void 0!==r&&(this.segment=r)}clone(){return new Vd(this.x,this.y,this.z,this.angle,this.segment)}}function Gd(e,t,i,n,r){if(void 0===t.segment)return!0;let s=t,o=t.segment+1,a=0;for(;a>-i/2;){if(o--,o<0)return!1;a-=e[o].dist(s),s=e[o]}a+=e[o].dist(e[o+1]),o++;const l=[];let c=0;for(;a<i/2;){const t=e[o],i=e[o+1];if(!i)return!1;let s=e[o-1].angleTo(t)-t.angleTo(i);for(s=Math.abs((s+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:s}),c+=s;a-l[0].distance>n;)c-=l.shift().angleDelta;if(c>r)return!1;o++,a+=t.dist(i)}return!0}function Wd(e){let t=0;for(let i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Hd(e,t,i){return e?.6*t*i:0}function Xd(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function qd(e,t,i,n,r,s){const o=Hd(i,r,s),a=Xd(i,n)*s;let l=0;const c=Wd(e)/2;for(let u=0;u<e.length-1;u++){const i=e[u],n=e[u+1],r=i.dist(n);if(l+r>c){const s=(c-l)/r,h=ki(i.x,n.x,s),d=ki(i.y,n.y,s),p=new Vd(h,d,0,n.angleTo(i),u);return!o||Gd(e,p,a,o,t)?p:void 0}l+=r}}function Zd(e,t,i,n,r,s,o,a,l){const c=Hd(n,s,o),u=Xd(n,r),h=u*o,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Yd(e,d?t/2*a%t:(u/2+2*s)*o*a%t,t,c,i,h,d,!1,l)}function Yd(e,t,i,n,r,s,o,a,l){const c=s/2,u=Wd(e);let h=0,d=t-i,p=[];for(let m=0;m<e.length-1;m++){const t=e[m],o=e[m+1],a=t.dist(o),f=o.angleTo(t);for(;d+i<h+a;){d+=i;const g=(d-h)/a,_=ki(t.x,o.x,g),v=ki(t.y,o.y,g);if(_>=0&&_<l&&v>=0&&v<l&&d-c>=0&&d+c<=u){const t=new Vd(_,v,0,f,m);t._round(),n&&!Gd(e,t,s,n,r)||p.push(t)}}h+=a}return a||p.length||o||(p=Yd(e,h/2,i,n,r,s,o,!0,l)),p}function Kd(e,t,i,n,r){const s=[];for(let o=0;o<e.length;o++){const a=e[o];let l;for(let e=0;e<a.length-1;e++){let o=a[e],c=a[e+1];o.x<t&&c.x<t||(o.x<t?o=new v(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x<t&&(c=new v(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y<i&&c.y<i||(o.y<i?o=new v(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round():c.y<i&&(c=new v(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round()),o.x>=n&&c.x>=n||(o.x>=n?o=new v(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x>=n&&(c=new v(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y>=r&&c.y>=r||(o.y>=r?o=new v(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round():c.y>=r&&(c=new v(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round()),l&&o.equals(l[l.length-1])||(l=[o],s.push(l)),l.push(c)))))}}return s}Yr(Vd,"Anchor");const Jd=1e20;function $d(e,t,i,n,r,s,o,a,l){for(let c=t;c<t+n;c++)Qd(e,i*s+c,s,r,o,a,l);for(let c=i;c<i+r;c++)Qd(e,c*s+t,1,n,o,a,l)}function Qd(e,t,i,n,r,s,o){s[0]=0,o[0]=-Jd,o[1]=Jd,r[0]=e[t];for(let a=1,l=0,c=0;a<n;a++){r[a]=e[t+a*i];const n=a*a;do{const e=s[l];c=(r[a]-r[e]+n-e*e)/(a-e)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=Jd}for(let a=0,l=0;a<n;a++){for(;o[l+1]<a;)l++;const n=s[l],c=a-n;e[t+a*i]=r[n]+c*c}}const ep=2,tp={none:0,ideographs:1,all:2};class ip{constructor(e,t,i){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=i,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,t){const i=[];for(const n in e)for(const t of e[n])i.push({stack:n,id:t});I(i,(e,t)=>{let{stack:i,id:n}=e,r=this.entries[i];r||(r=this.entries[i]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let s=r.glyphs[n];if(void 0!==s)return void t(null,{stack:i,id:n,glyph:s});if(s=this._tinySDF(r,i,n),s)return r.glyphs[n]=s,void t(null,{stack:i,id:n,glyph:s});const o=Math.floor(n/256);if(256*o>65535)return void t(new Error("glyphs > 65535 not supported"));if(r.ranges[o])return void t(null,{stack:i,id:n,glyph:s});let a=r.requests[o];a||(a=r.requests[o]=[],ip.loadGlyphRange(i,o,this.url,this.requestManager,(e,t)=>{if(t){r.ascender=t.ascender,r.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(r.glyphs[+e]=t.glyphs[+e]);r.ranges[o]=!0}for(const i of a)i(e,t);delete r.requests[o]})),a.push((e,r)=>{e?t(e):r&&t(null,{stack:i,id:n,glyph:r.glyphs[n]||null})})},(e,i)=>{if(e)t(e);else if(i){const e={};for(const{stack:t,id:n,glyph:r}of i)void 0===e[t]&&(e[t]={}),void 0===e[t].glyphs&&(e[t].glyphs={}),e[t].glyphs[n]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics},e[t].ascender=this.entries[t].ascender,e[t].descender=this.entries[t].descender;t(null,e)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==tp.none&&(this.localGlyphMode===tp.all?!!this.localFontFamily:!!this.localFontFamily&&(es["CJK Unified Ideographs"](e)||es["Hangul Syllables"](e)||es.Hiragana(e)||es.Katakana(e)||es["CJK Symbols and Punctuation"](e)))}_tinySDF(e,t,i){const n=this.localFontFamily;if(!n||!this._doesCharSupportLocalGlyph(i))return;let r=e.tinySDF;if(!r){let i="400";/bold/i.test(t)?i="900":/medium/i.test(t)?i="500":/light/i.test(t)&&(i="200"),r=e.tinySDF=new ip.TinySDF({fontFamily:n,fontWeight:i,fontSize:24*ep,buffer:3*ep,radius:8*ep}),r.fontWeight=i}if(this.localGlyphs[r.fontWeight][i])return this.localGlyphs[r.fontWeight][i];const s=String.fromCharCode(i),{data:o,width:a,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:h,glyphTop:d,glyphAdvance:p}=r.draw(s);return this.localGlyphs[r.fontWeight][i]={id:i,bitmap:new zc({width:a,height:l},o),metrics:{width:c/ep,height:u/ep,left:h/ep,top:d/ep-27,advance:p/ep,localGlyph:!0}}}}ip.loadGlyphRange=function(e,t,i,n,r){const s=256*t,o=s+255,a=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}","".concat(s,"-").concat(o)),le.Glyphs);de(a,(e,t)=>{if(e)r(e);else if(t){const e={},i=function(e){return new gd(e).readFields(vd,{})}(t);for(const t of i.glyphs)e[t.id]=t;r(null,{glyphs:e,ascender:i.ascender,descender:i.descender})}})},ip.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:i=8,cutoff:n=.25,fontFamily:r="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=n,this.radius=i;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font="".concat(o," ").concat(s," ").concat(e,"px ").concat(r),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:r,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(i),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return p;const{ctx:m,buffer:f,gridInner:g,gridOuter:_}=this;m.clearRect(f,f,a,l),m.fillText(e,f,f+o);const v=m.getImageData(f,f,a,l);_.fill(Jd,0,h),g.fill(0,0,h);for(let y=0;y<l;y++)for(let e=0;e<a;e++){const t=v.data[4*(y*a+e)+3]/255;if(0===t)continue;const i=(y+f)*c+e+f;if(1===t)_[i]=0,g[i]=Jd;else{const e=.5-t;_[i]=e>0?e*e:0,g[i]=e<0?e*e:0}}$d(_,0,0,c,u,c,this.f,this.v,this.z),$d(g,f,f,a,l,c,this.f,this.v,this.z);for(let y=0;y<h;y++){const e=Math.sqrt(_[y])-Math.sqrt(g[y]);d[y]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const np=Ed;function rp(e,t,i,n){const r=[],s=e.image,o=s.pixelRatio,a=s.paddedRect.w-2*np,l=s.paddedRect.h-2*np,c=e.right-e.left,u=e.bottom-e.top,h=s.stretchX||[[0,a]],d=s.stretchY||[[0,l]],p=(e,t)=>e+t[1]-t[0],m=h.reduce(p,0),f=d.reduce(p,0),g=a-m,_=l-f;let y=0,b=m,x=0,w=f,E=0,A=g,T=0,D=_;if(s.content&&n){const e=s.content;y=sp(h,0,e[0]),x=sp(d,0,e[1]),b=sp(h,e[0],e[2]),w=sp(d,e[1],e[3]),E=e[0]-y,T=e[1]-x,A=e[2]-e[0]-b,D=e[3]-e[1]-w}const S=(n,r,a,l)=>{const h=ap(n.stretch-y,b,c,e.left),d=lp(n.fixed-E,A,n.stretch,m),p=ap(r.stretch-x,w,u,e.top),g=lp(r.fixed-T,D,r.stretch,f),_=ap(a.stretch-y,b,c,e.left),S=lp(a.fixed-E,A,a.stretch,m),C=ap(l.stretch-x,w,u,e.top),P=lp(l.fixed-T,D,l.stretch,f),I=new v(h,p),k=new v(_,p),M=new v(_,C),R=new v(h,C),F=new v(d/o,g/o),L=new v(S/o,P/o),O=t*Math.PI/180;if(O){const e=Math.sin(O),t=Math.cos(O),i=[t,-e,e,t];I._matMult(i),k._matMult(i),R._matMult(i),M._matMult(i)}const B=n.stretch+n.fixed,z=r.stretch+r.fixed;return{tl:I,tr:k,bl:R,br:M,tex:{x:s.paddedRect.x+np+B,y:s.paddedRect.y+np+z,w:a.stretch+a.fixed-B,h:l.stretch+l.fixed-z},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:F,pixelOffsetBR:L,minFontScaleX:A/o/c,minFontScaleY:D/o/u,isSDF:i}};if(n&&(s.stretchX||s.stretchY)){const e=op(h,g,m),t=op(d,_,f);for(let i=0;i<e.length-1;i++){const n=e[i],s=e[i+1];for(let e=0;e<t.length-1;e++)r.push(S(n,t[e],s,t[e+1]))}}else r.push(S({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return r}function sp(e,t,i){let n=0;for(const r of e)n+=Math.max(t,Math.min(i,r[1]))-Math.max(t,Math.min(i,r[0]));return n}function op(e,t,i){const n=[{fixed:-np,stretch:0}];for(const[r,s]of e){const e=n[n.length-1];n.push({fixed:r-e.stretch,stretch:e.stretch}),n.push({fixed:r-e.stretch,stretch:e.stretch+(s-r)})}return n.push({fixed:t+np,stretch:i}),n}function ap(e,t,i,n){return e/t*i+n}function lp(e,t,i,n){return e-t*i/n}function cp(e,t,i,n){const r=t+e.positionedLines[n].lineOffset;return 0===n?i+r/2:i+(r+(t+e.positionedLines[n-1].lineOffset))/2}class up{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hp;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,n=t[e];for(;e>0;){const r=e-1>>1,s=t[r];if(i(n,s)>=0)break;t[e]=s,e=r}t[e]=n}_down(e){const{data:t,compare:i}=this,n=this.length>>1,r=t[e];for(;e<n;){let n=1+(e<<1),s=t[n];const o=n+1;if(o<this.length&&i(t[o],s)<0&&(n=o,s=t[o]),i(s,r)>=0)break;t[e]=s,e=n}t[e]=r}}function hp(e,t){return e<t?-1:e>t?1:0}function dp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=1/0,r=1/0,s=-1/0,o=-1/0;const a=e[0];for(let p=0;p<a.length;p++){const e=a[p];(!p||e.x<n)&&(n=e.x),(!p||e.y<r)&&(r=e.y),(!p||e.x>s)&&(s=e.x),(!p||e.y>o)&&(o=e.y)}const l=Math.min(s-n,o-r);let c=l/2;const u=new up([],pp);if(0===l)return new v(n,r);for(let p=n;p<s;p+=l)for(let t=r;t<o;t+=l)u.push(new mp(p+c,t+c,c,e));let h=function(e){let t=0,i=0,n=0;const r=e[0];for(let s=0,o=r.length,a=o-1;s<o;a=s++){const e=r[s],o=r[a],l=e.x*o.y-o.x*e.y;i+=(e.x+o.x)*l,n+=(e.y+o.y)*l,t+=3*l}return new mp(i/t,n/t,0,e)}(e),d=u.length;for(;u.length;){const n=u.pop();(n.d>h.d||!h.d)&&(h=n,i&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,d)),n.max-h.d<=t||(c=n.h/2,u.push(new mp(n.p.x-c,n.p.y-c,c,e)),u.push(new mp(n.p.x+c,n.p.y-c,c,e)),u.push(new mp(n.p.x-c,n.p.y+c,c,e)),u.push(new mp(n.p.x+c,n.p.y+c,c,e)),d+=4)}return i&&(console.log("num probes: ".concat(d)),console.log("best distance: ".concat(h.d))),h.p}function pp(e,t){return t.max-e.max}class mp{constructor(e,t,i,n){this.p=new v(e,t),this.h=i,this.d=function(e,t){let i=!1,n=1/0;for(let r=0;r<t.length;r++){const s=t[r];for(let t=0,r=s.length,o=r-1;t<r;o=t++){const r=s[t],a=s[o];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(i=!i),n=Math.min(n,vc(e,r,a))}}return(i?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}}const fp=7,gp=Number.POSITIVE_INFINITY,_p=Math.sqrt(2);function vp(e,t){let[i,n]=t,r=0,s=0;if(n===gp){i<0&&(i=0);const t=i/_p;switch(e){case"top-right":case"top-left":s=t-fp;break;case"bottom-right":case"bottom-left":s=-t+fp;break;case"bottom":s=-i+fp;break;case"top":s=i-fp}switch(e){case"top-right":case"bottom-right":r=-t;break;case"top-left":case"bottom-left":r=t;break;case"left":r=i;break;case"right":r=-i}}else{switch(i=Math.abs(i),n=Math.abs(n),e){case"top-right":case"top-left":case"top":s=n-fp;break;case"bottom-right":case"bottom-left":case"bottom":s=-n+fp}switch(e){case"top-right":case"bottom-right":case"right":r=-i;break;case"top-left":case"bottom-left":case"left":r=i}}return[r,s]}function yp(e,t,i,n,r,s,o,a,l,c){e.createArrays(),e.tilePixelRatio=aa/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const u=e.layers[0].layout,h=e.layers[0]._unevaluatedLayout._values,d={};if("composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:i}=e.textSizeData;d.compositeTextSizes=[h["text-size"].possiblyEvaluate(new xs(t),a),h["text-size"].possiblyEvaluate(new xs(i),a)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:i}=e.iconSizeData;d.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new xs(t),a),h["icon-size"].possiblyEvaluate(new xs(i),a)]}d.layoutTextSize=h["text-size"].possiblyEvaluate(new xs(l+1),a),d.layoutIconSize=h["icon-size"].possiblyEvaluate(new xs(l+1),a),d.textMaxSize=h["text-size"].possiblyEvaluate(new xs(18),a);const p="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),m=u.get("text-size");for(const f of e.features){const s=u.get("text-font").evaluate(f,{},a).join(","),l=m.evaluate(f,{},a),h=d.layoutTextSize.evaluate(f,{},a),g=(d.layoutIconSize.evaluate(f,{},a),{horizontal:{},vertical:void 0}),_=f.text;let v,y=[0,0];if(_){const n=_.toString(),o=u.get("text-letter-spacing").evaluate(f,{},a)*zh,c=u.get("text-line-height").evaluate(f,{},a)*zh,d=is(n)?o:0,m=u.get("text-anchor").evaluate(f,{},a),v=u.get("text-variable-anchor");if(!v){const e=u.get("text-radial-offset").evaluate(f,{},a);y=e?vp(m,[e*zh,gp]):u.get("text-offset").evaluate(f,{},a).map(e=>e*zh)}let b=p?"center":u.get("text-justify").evaluate(f,{},a);const x="point"===u.get("symbol-placement"),w=x?u.get("text-max-width").evaluate(f,{},a)*zh:1/0,E=o=>{e.allowVerticalPlacement&&ts(n)&&(g.vertical=Id(_,t,i,r,s,w,c,m,o,d,y,Dd.vertical,!0,h,l))};if(!p&&v){const e="auto"===b?v.map(e=>bp(e)):[b];let n=!1;for(let o=0;o<e.length;o++){const a=e[o];if(!g.horizontal[a])if(n)g.horizontal[a]=g.horizontal[0];else{const e=Id(_,t,i,r,s,w,c,"center",a,d,y,Dd.horizontal,!1,h,l);e&&(g.horizontal[a]=e,n=1===e.positionedLines.length)}}E("left")}else{if("auto"===b&&(b=bp(m)),x||u.get("text-writing-mode").indexOf("horizontal")>=0||!ts(n)){const e=Id(_,t,i,r,s,w,c,m,b,d,y,Dd.horizontal,!1,h,l);e&&(g.horizontal[b]=e)}E(x?"left":b)}}let b=!1;if(f.icon&&f.icon.name){const t=n[f.icon.name];t&&(v=Ud(r[f.icon.name],u.get("icon-offset").evaluate(f,{},a),u.get("icon-anchor").evaluate(f,{},a)),b=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&W("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==u.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const x=Tp(g.horizontal)||g.vertical;e.iconsInText||(e.iconsInText=!!x&&x.iconsInText),(x||v)&&xp(e,f,g,v,n,d,h,0,y,b,o,a,c)}s&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray)}function bp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xp(e,t,i,n,r,s,o,a,l,c,u,h,d){let p=s.textMaxSize.evaluate(t,{},h);void 0===p&&(p=o);const m=e.layers[0].layout,f=m.get("icon-offset").evaluate(t,{},h),g=Tp(i.horizontal)||i.vertical,_="globe"===d.name,v=zh,y=o/v,b=e.tilePixelRatio*p/v,w=(I=e.overscaling,e.zoom>18&&I>2&&(I>>=1),Math.max(aa/(512*I),1)*m.get("symbol-spacing")),E=m.get("text-padding")*e.tilePixelRatio,A=m.get("icon-padding")*e.tilePixelRatio,T=x(m.get("text-max-angle")),D="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement"),S="map"===m.get("icon-rotation-alignment")&&"point"!==m.get("symbol-placement"),C=m.get("symbol-placement"),P=w/2;var I;const k=m.get("icon-text-fit");let M;n&&"none"!==k&&(e.allowVerticalPlacement&&i.vertical&&(M=jd(n,i.vertical,k,m.get("icon-text-fit-padding"),f,y)),g&&(n=jd(n,g,k,m.get("icon-text-fit-padding"),f,y)));const R=(o,a,p)=>{if(a.x<0||a.x>=aa||a.y<0||a.y>=aa)return;let m=null;if(_){const{x:e,y:t,z:i}=d.projectTilePoint(a.x,a.y,p);m={anchor:new Vd(e,t,i,0,void 0),up:d.upVector(p,a.x,a.y)}}!function(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A){const T=e.addToLineVertexArray(t,n);let D,S,C,P,I,k,M,R=0,F=0,L=0,O=0,B=-1,z=-1;const N={};let U=ko("");const j=i?i.anchor:t;let V=0,G=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[V,G]=l.layout.get("text-offset").evaluate(b,{},A).map(e=>e*zh):(V=l.layout.get("text-radial-offset").evaluate(b,{},A)*zh,G=gp),e.allowVerticalPlacement&&r.vertical){const e=r.vertical;if(m)k=Sp(e),a&&(M=Sp(a));else{const i=l.layout.get("text-rotate").evaluate(b,{},A)+90;C=Dp(c,j,t,u,h,d,e,p,i,f),a&&(P=Dp(c,j,t,u,h,d,a,_,i))}}if(s){const n=l.layout.get("icon-rotate").evaluate(b,{},A),r="none"!==l.layout.get("icon-text-fit"),o=rp(s,n,w,r),p=a?rp(a,n,w,r):void 0;S=Dp(c,j,t,u,h,d,s,_,n),R=4*o.length;const m=e.iconSizeData;let f=null;"source"===m.kind?(f=[Nh*l.layout.get("icon-size").evaluate(b,{},A)],f[0]>Ep&&W("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(wp,'. Reduce your "icon-size".'))):"composite"===m.kind&&(f=[Nh*x.compositeIconSizes[0].evaluate(b,{},A),Nh*x.compositeIconSizes[1].evaluate(b,{},A)],(f[0]>Ep||f[1]>Ep)&&W("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(wp,'. Reduce your "icon-size".'))),e.addSymbols(e.icon,o,f,y,v,b,!1,i,t,T.lineStartIndex,T.lineLength,-1,E,A),B=e.icon.placedSymbolArray.length-1,p&&(F=4*p.length,e.addSymbols(e.icon,p,f,y,v,b,Dd.vertical,i,t,T.lineStartIndex,T.lineLength,-1,E,A),z=e.icon.placedSymbolArray.length-1)}for(const W in r.horizontal){const n=r.horizontal[W];D||(U=ko(n.text),m?I=Sp(n):D=Dp(c,j,t,u,h,d,n,p,l.layout.get("text-rotate").evaluate(b,{},A),f));const s=1===n.positionedLines.length;if(L+=Ap(e,i,t,n,o,l,m,b,f,T,r.vertical?Dd.horizontal:Dd.horizontalOnly,s?Object.keys(r.horizontal):[W],N,B,x,E,A),s)break}r.vertical&&(O+=Ap(e,i,t,r.vertical,o,l,m,b,f,T,Dd.vertical,["vertical"],N,z,x,E,A));let H=-1;const X=(e,t)=>e?Math.max(e,t):t;H=X(I,H),H=X(k,H),H=X(M,H);const q=H>-1?1:0;e.glyphOffsetArray.length>=om.MAX_GLYPHS&&W("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey),e.symbolInstances.emplaceBack(j.x,j.y,j.z,t.x,t.y,N.right>=0?N.right:-1,N.center>=0?N.center:-1,N.left>=0?N.left:-1,N.vertical>=0?N.vertical:-1,B,z,U,void 0!==D?D:e.collisionBoxArray.length,void 0!==D?D+1:e.collisionBoxArray.length,void 0!==C?C:e.collisionBoxArray.length,void 0!==C?C+1:e.collisionBoxArray.length,void 0!==S?S:e.collisionBoxArray.length,void 0!==S?S+1:e.collisionBoxArray.length,P||e.collisionBoxArray.length,P?P+1:e.collisionBoxArray.length,u,L,O,R,F,q,0,V,G,H)}(e,a,m,o,i,n,r,M,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,E,D,l,0,A,S,f,t,s,c,u,h)};if("line"===C)for(const x of Kd(t.geometry,0,0,aa,aa)){const t=Zd(x,w,T,i.vertical||g,n,v,b,e.overscaling,aa);for(const i of t)g&&Cp(e,g.text,P,i)||R(x,i,h)}else if("line-center"===C){for(const x of t.geometry)if(x.length>1){const e=qd(x,T,i.vertical||g,n,v,b);e&&R(x,e,h)}}else if("Polygon"===t.type)for(const x of Eu(t.geometry,0)){const e=dp(x,16);R(x[0],new Vd(e.x,e.y,0,0,void 0),h)}else if("LineString"===t.type)for(const x of t.geometry)R(x,new Vd(x[0].x,x[0].y,0,0,void 0),h);else if("Point"===t.type)for(const x of t.geometry)for(const e of x)R([e],new Vd(e.x,e.y,0,0,void 0),h)}const wp=255,Ep=wp*Nh;function Ap(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g){const _=function(e,t,i,n,r,s,o,a){const l=[];if(0===t.positionedLines.length)return l;const c=n.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,u=function(e){const t=e[0],i=e[1],n=t*i;return n>0?[t,-i]:n<0?[-t,i]:0===t?[i,t]:[i,-t]}(i);let h=Math.abs(t.top-t.bottom);for(const f of t.positionedLines)h-=f.lineOffset;const d=t.positionedLines.length,p=h/d;let m=t.top-i[1];for(let f=0;f<d;++f){const e=t.positionedLines[f];m=cp(t,p,m,f);for(const n of e.positionedGlyphs){if(!n.rect)continue;const e=n.rect||{};let s=xd+1,h=!0,d=1,p=0;if(n.imageName){const e=o[n.imageName];if(!e)continue;if(e.sdf){W("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,d=e.pixelRatio,s=Ed/d}const f=(r||a)&&n.vertical,g=n.metrics.advance*n.scale/2,_=n.metrics,y=n.rect;if(null===y)continue;a&&t.verticalizable&&(p=n.imageName?g-n.metrics.width*n.scale/2:0);const b=r?[n.x+g,n.y]:[0,0];let x=[0,0],w=[0,0],E=!1;r||(f?(w=[n.x+g+u[0],n.y+u[1]-p],E=!0):x=[n.x+g+i[0],n.y+i[1]-p]);const A=y.w*n.scale/(d*(n.localGlyph?ep:1)),T=y.h*n.scale/(d*(n.localGlyph?ep:1));let D,S,C,P;if(f){const e=n.y-m,t=new v(-g,g-e),i=-Math.PI/2,r=new v(...w);D=new v(-g+x[0],x[1]),D._rotateAround(i,t)._add(r),D.x+=-e+g,D.y-=(_.left-s)*n.scale;const o=n.imageName?_.advance*n.scale:zh*n.scale,a=String.fromCharCode(n.glyph);Xh(a)?D.x+=(1-s)*n.scale:qh(a)?D.x+=o-_.height*n.scale+(-s-1)*n.scale:D.x+=n.imageName||_.width+2*s===y.w&&_.height+2*s===y.h?(o-T)/2:(o-(_.height+2*s)*n.scale)/2,S=new v(D.x,D.y-A),C=new v(D.x+T,D.y),P=new v(D.x+T,D.y-A)}else{const e=(_.left-s)*n.scale-g+x[0],t=(-_.top-s)*n.scale+x[1],i=e+A,r=t+T;D=new v(e,t),S=new v(i,t),C=new v(e,r),P=new v(i,r)}if(c){let e;e=r?new v(0,0):E?new v(u[0],u[1]):new v(i[0],i[1]),D._rotateAround(c,e),S._rotateAround(c,e),C._rotateAround(c,e),P._rotateAround(c,e)}const I=new v(0,0),k=new v(0,0);l.push({tl:D,tr:S,bl:C,br:P,tex:e,writingMode:t.writingMode,glyphOffset:b,sectionIndex:n.sectionIndex,isSDF:h,pixelOffsetTL:I,pixelOffsetBR:k,minFontScaleX:0,minFontScaleY:0})}}return l}(0,n,l,s,o,a,r,e.allowVerticalPlacement),y=e.textSizeData;let b=null;"source"===y.kind?(b=[Nh*s.layout.get("text-size").evaluate(a,{},g)],b[0]>Ep&&W("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(wp,'. Reduce your "text-size".'))):"composite"===y.kind&&(b=[Nh*m.compositeTextSizes[0].evaluate(a,{},g),Nh*m.compositeTextSizes[1].evaluate(a,{},g)],(b[0]>Ep||b[1]>Ep)&&W("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(wp,'. Reduce your "text-size".'))),e.addSymbols(e.text,_,b,l,o,a,u,t,i,c.lineStartIndex,c.lineLength,p,f,g);for(const v of h)d[v]=e.text.placedSymbolArray.length-1;return 4*_.length}function Tp(e){for(const t in e)return e[t];return null}function Dp(e,t,i,n,r,s,o,a,l,c){let u=o.top,h=o.bottom,d=o.left,p=o.right;const m=o.collisionPadding;if(m&&(d-=m[0],u-=m[1],p+=m[2],h+=m[3]),l){const e=new v(d,u),t=new v(p,u),i=new v(d,h),n=new v(p,h),r=x(l);let s=new v(0,0);c&&(s=new v(c[0],c[1])),e._rotateAround(r,s),t._rotateAround(r,s),i._rotateAround(r,s),n._rotateAround(r,s),d=Math.min(e.x,t.x,i.x,n.x),p=Math.max(e.x,t.x,i.x,n.x),u=Math.min(e.y,t.y,i.y,n.y),h=Math.max(e.y,t.y,i.y,n.y)}return e.emplaceBack(t.x,t.y,t.z,i.x,i.y,d,u,p,h,a,n,r,s),e.length-1}function Sp(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Cp(e,t,i,n){const r=e.compareText;if(t in r){const e=r[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<i)return!0}else r[t]=[];return r[t].push(n),!1}function Pp(e,t){const i=e.fovAboveCenter,n=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,r=(e._camera.position[2]*e.worldSize-n)/Math.cos(e._pitch),s=Math.sin(i)*r/Math.sin(Math.max(Math.PI/2-e._pitch-i,.01)),o=Math.sin(e._pitch)*s+r;return Math.min(1.01*o,r*(1/e._horizonShift))}function Ip(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const i=Math.pow(2,-e.z),n=e.x*i,r=(e.x+1)*i,s=e.y*i,o=(e.y+1)*i,a=ql(n),l=ql(r),c=Zl(s),u=Zl(o),h=t.project(a,c),d=t.project(l,c),p=t.project(l,u),m=t.project(a,u);let f=Math.min(h.x,d.x,p.x,m.x),g=Math.min(h.y,d.y,p.y,m.y),_=Math.max(h.x,d.x,p.x,m.x),v=Math.max(h.y,d.y,p.y,m.y);const y=i/16;function b(e,i,n,r,s,o){const a=(n+s)/2,l=(r+o)/2,c=t.project(ql(a),Zl(l)),u=Math.max(0,f-c.x,g-c.y,c.x-_,c.y-v);f=Math.min(f,c.x),_=Math.max(_,c.x),g=Math.min(g,c.y),v=Math.max(v,c.y),u>y&&(b(e,c,n,r,a,l),b(c,i,a,l,s,o))}b(h,d,n,s,r,s),b(d,p,r,s,r,o),b(p,m,r,o,n,o),b(m,h,n,o,n,s),f-=y,g-=y,_+=y,v+=y;const x=1/Math.max(_-f,v-g);return{scale:x,x:f*x,y:g*x,x2:_*x,y2:v*x,projection:t}}const kp=pa(new Float32Array(16));class Mp{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new Vl(0,0)}projectTilePoint(e,t,i){return{x:e,y:t,z:0}}locationPoint(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._coordinatePoint(e.locationCoordinate(t),i)}pixelsPerMeter(e,t){return Xl(1,e)*t}pixelSpaceConversion(e,t,i){return 1}farthestPixelDistance(e){return Pp(e,e.pixelsPerMeter)}pointCoordinate(e,t,i,n){const r=e.horizonLineFromTop(!1),s=new v(t,Math.max(r,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(s,n))}pointCoordinate3D(e,t,i){const n=new v(t,i);if(e.elevation)return e.elevation.pointCoordinate(n);{const t=this.pointCoordinate(e,n.x,n.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);const i=e.horizonLineFromTop();return t.y<i}createInversionMatrix(e,t){return kp}createTileMatrix(e,t,i){let n,r,s;const o=i.canonical,a=pa(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=Ip(o,this);n=1,r=l.x+i.wrap*l.scale,s=l.y,_a(a,a,[n/l.scale,n/l.scale,e.pixelsPerMeter/t])}else n=t/e.zoomScale(o.z),r=(o.x+Math.pow(2,o.z)*i.wrap)*n,s=o.y*n;return ga(a,a,[r,s,0]),_a(a,a,[n/aa,n/aa,1]),a}upVector(e,t,i){return[0,0,1]}upVectorScale(e,t,i){return{metersToTile:1}}}class Rp extends Mp{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,i]=this.parallels=e.parallels||[29.5,45.5],n=Math.sin(x(t));this.n=(n+Math.sin(x(i)))/2,this.c=1+n*(2*this.n-n),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:i,c:n,r0:r}=this,s=x(e-this.center[0]),o=x(t),a=Math.sqrt(n-2*i*Math.sin(o))/i;return{x:a*Math.sin(s*i),y:a*Math.cos(s*i)-r,z:0}}unproject(e,t){const{n:i,c:n,r0:r}=this,s=r+t;let o=Math.atan2(e,Math.abs(s))*Math.sign(s);s*i<0&&(o-=Math.PI*Math.sign(e)*Math.sign(s));const a=x(this.center[0])*i;o=P(o,-Math.PI-a,Math.PI-a);const l=S(w(o/i)+this.center[0],-180,180),c=Math.asin(S((n-(e*e+s*s)*i*i)/(2*i),-1,1)),u=S(w(c),-Kl,Kl);return new Vl(l,u)}}const Fp=1.340264,Lp=-.081106,Op=893e-6,Bp=.003796,zp=Math.sqrt(3)/2;class Np extends Mp{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const i=Math.asin(zp*Math.sin(t)),n=i*i,r=n*n*n;return{x:.5*(e*Math.cos(i)/(zp*(Fp+3*Lp*n+r*(7*Op+9*Bp*n)))/Math.PI+.5),y:1-.5*(i*(Fp+Lp*n+r*(Op+Bp*n))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,n=i*i,r=n*n*n;for(let c,u,h,d=0;d<12&&(u=i*(Fp+Lp*n+r*(Op+Bp*n))-t,h=Fp+3*Lp*n+r*(7*Op+9*Bp*n),c=u/h,i=S(i-c,-Math.PI/3,Math.PI/3),n=i*i,r=n*n*n,!(Math.abs(c)<1e-12));++d);const s=zp*e*(Fp+3*Lp*n+r*(7*Op+9*Bp*n))/Math.cos(i),o=Math.asin(Math.sin(i)/zp),a=S(180*s/Math.PI,-180,180),l=S(180*o/Math.PI,-Kl,Kl);return new Vl(a,l)}}class Up extends Mp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const i=360*(e-.5),n=S(360*(.5-t),-Kl,Kl);return new Vl(i,n)}}const jp=Math.PI/2;function Vp(e){return Math.tan((jp+e)/2)}class Gp extends Mp{constructor(e){super(e),this.center=e.center||[0,30];const[t,i]=this.parallels=e.parallels||[30,30];let n=x(t),r=x(i);this.southernCenter=n+r<0,this.southernCenter&&(n=-n,r=-r);const s=Math.cos(n),o=Vp(n);this.n=n===r?Math.sin(n):Math.log(s/Math.cos(r))/Math.log(Vp(r)/o),this.f=s*Math.pow(Vp(n),this.n)/this.n}project(e,t){t=x(t),this.southernCenter&&(t=-t),e=x(e-this.center[0]);const i=1e-6,{n:n,f:r}=this;r>0?t<-jp+i&&(t=-jp+i):t>jp-i&&(t=jp-i);const s=r/Math.pow(Vp(t),n);let o=s*Math.sin(n*e),a=r-s*Math.cos(n*e);return o=.5*(o/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:o,y:this.southernCenter?a:1-a,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:i,f:n}=this,r=n-t,s=Math.sign(r),o=Math.sign(i)*Math.sqrt(e*e+r*r);let a=Math.atan2(e,Math.abs(r))*s;r*i<0&&(a-=Math.PI*Math.sign(e)*s);const l=S(w(a/i)+this.center[0],-180,180),c=S(w(2*Math.atan(Math.pow(n/o,1/i))-jp),-Kl,Kl);return new Vl(l,this.southernCenter?-c:c)}}class Wp extends Mp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:Wl(e),y:Hl(t),z:0}}unproject(e,t){const i=ql(e),n=Zl(t);return new Vl(i,n)}}const Hp=x(Kl);class Xp extends Mp{project(e,t){const i=(t=x(t))*t,n=i*i;return{x:.5*((e=x(e))*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let i=t=(2*(1-t)-1)*Math.PI,n=25,r=0,s=i*i;do{s=i*i;const e=s*s;r=(i*(1.007226+s*(.015085+e*(.028874*s-.044475-.005916*e)))-t)/(1.007226+s*(.045255+e*(.259866*s-.311325-.005916*11*e))),i=S(i-r,-Hp,Hp)}while(Math.abs(r)>1e-6&&--n>0);s=i*i;const o=S(w(e/(.8707+s*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979))),-180,180),a=w(i);return new Vl(o,a)}}const qp=x(Kl);class Zp extends Mp{project(e,t){t=x(t),e=x(e);const i=Math.cos(t),n=2/Math.PI,r=Math.acos(i*Math.cos(e/2)),s=Math.sin(r)/r,o=.5*(e*n+2*i*Math.sin(e/2)/s)||0,a=.5*(t+Math.sin(t)/s)||0;return{x:.5*(o/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(e,t){let i=e=(2*e-.5)*Math.PI,n=t=(2*(1-t)-1)*Math.PI,r=25;const s=1e-6;let o=0,a=0;do{const r=Math.cos(n),s=Math.sin(n),l=2*s*r,c=s*s,u=r*r,h=Math.cos(i/2),d=Math.sin(i/2),p=2*h*d,m=d*d,f=1-u*h*h,g=f?1/f:0,_=f?Math.acos(r*h)*Math.sqrt(1/f):0,v=.5*(2*_*r*d+2*i/Math.PI)-e,y=.5*(_*s+n)-t,b=.5*g*(u*m+_*r*h*c)+1/Math.PI,x=g*(p*l/4-_*s*d),w=.125*g*(l*d-_*s*u*p),E=.5*g*(c*h+_*m*r)+.5,A=x*w-E*b;o=(y*x-v*E)/A,a=(v*w-y*b)/A,i=S(i-o,-Math.PI,Math.PI),n=S(n-a,-qp,qp)}while((Math.abs(o)>s||Math.abs(a)>s)&&--r>0);return new Vl(w(i),w(n))}}class Yp extends Mp{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(x(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:i,cosPhi:n}=this;return{x:x(e)*n*i+.5,y:-Math.sin(x(t))/n*i+.5,z:0}}unproject(e,t){const{scale:i,cosPhi:n}=this,r=-(t-.5)/i,s=S(w((e-.5)/i)/n,-180,180),o=Math.asin(S(r*n,-1,1)),a=S(w(o),-Kl,Kl);return new Vl(s,a)}}class Kp extends Wp{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,i){const n=Sl(e,t,i);return Ba(n,n,Il(vl(i))),{x:n[0],y:n[1],z:n[2]}}locationPoint(e,t){const i=Dl(t.lat,t.lng),n=Fa([],i),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;Ra(i,i,n,Xl(1,0)*aa*r);const s=pa(new Float64Array(16));return fa(s,e.pixelMatrix,e.globeMatrix),Ba(i,i,s),new v(i[0],i[1])}pixelsPerMeter(e,t){return Xl(1,0)*t}pixelSpaceConversion(e,t,i){const n=Xl(1,e)*t,r=ki(Xl(1,45)*t,n,i);return this.pixelsPerMeter(e,t)/r}createTileMatrix(e,t,i){const n=kl(vl(i.canonical));return fa(new Float64Array(16),e.globeMatrix,n)}createInversionMatrix(e,t){const{center:i}=e,n=Il(vl(t));return ya(n,n,x(i.lng)),va(n,n,x(i.lat)),_a(n,n,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(n)}pointCoordinate(e,t,i,n){return fl(e,t,i,!0)||new $l(0,0)}pointCoordinate3D(e,t,i){const n=this.pointCoordinate(e,t,i,0);return[n.x,n.y,n.z]}isPointAboveHorizon(e,t){return!fl(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const i=e.cameraToCenterDistance,n=e._centerAltitude*t,r=e._camera,s=e._camera.forward(),o=Sa([],Ma([],s,-i),[0,0,n]),a=e.worldSize/(2*Math.PI),l=[0,0,-a],c=e.width/e.height,u=Math.tan(e.fovAboveCenter),h=Ma([],r.up(),u),d=Ma([],r.right(),u*c),p=Fa([],Sa([],Sa([],s,h),d)),m=[];let f;if(new tl(o,p).closestPointOnSphere(l,a,m)){const t=Sa([],m,l),i=Ua([],t,o);f=Math.cos(e.fovAboveCenter)*Ta(i)}else{const e=Ua([],o,l),t=Ua([],l,o);Fa(t,t);const i=Ta(e)-a;f=Math.sqrt(i*(i+2*a));const n=Math.acos(f/(a+i))-Math.acos(La(s,t));f*=Math.cos(n)}return 1.01*f}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=Rl(e.zoom);if(i>0){const n=Pp(e,Xl(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),s=Math.max(e.width,e.height)/e.worldSize*Math.PI;return ki(t,n+r*(1-Math.cos(s)),Math.pow(i,10))}return t}upVector(e,t,i){return Sl(t,i,e,1)}upVectorScale(e){return{metersToTile:ml(Cl(vl(e)))}}}function Jp(e){const t=e.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new Wp(e);case"equirectangular":return new Up(e);case"naturalEarth":return new Xp(e);case"equalEarth":return new Np(e);case"winkelTripel":return new Zp(e);case"albers":return i?new Yp(e):new Rp(e);case"lambertConformalConic":return i?new Yp(e):new Gp(e);case"globe":return new Kp(e)}throw new Error("Invalid projection name: ".concat(e.name))}const $p=qu.types,Qp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function em(e,t,i,n,r,s,o,a,l,c,u,h,d){const p=a?Math.min(Ep,Math.round(a[0])):0,m=a?Math.min(Ep,Math.round(a[1])):0;e.emplaceBack(t,i,Math.round(32*n),Math.round(32*r),s,o,(p<<1)+(l?1:0),m,16*c,16*u,256*h,256*d)}function tm(e,t,i,n,r,s,o){e.emplaceBack(t,i,n,r,s,o)}function im(e,t,i,n,r){e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r),e.emplaceBack(t,i,n,r)}function nm(e){for(const t of e.sections)if(ls(t.text))return!0;return!1}class rm{constructor(e){this.layoutVertexArray=new Zs,this.indexArray=new io,this.programConfigurations=e,this.segments=new oa,this.dynamicLayoutVertexArray=new Ws,this.opacityVertexArray=new Ks,this.placedSymbolArray=new fo,this.globeExtVertexArray=new Ys}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Rh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Qp,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Mh.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Yr(rm,"SymbolBuffers");class sm{constructor(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new oa,this.collisionVertexArray=new eo,this.collisionVertexArrayExt=new to}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Fh.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Lh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Yr(sm,"CollisionBuffers");class om{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=pa([]),this.placementViewportMatrix=pa([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Uh(this.zoom,t["text-size"]),this.iconSizeData=Uh(this.zoom,t["icon-size"]);const i=this.layers[0].layout,n=i.get("symbol-sort-key"),r=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map(e=>Dd[e]),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new rm(new Ko(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new rm(new Ko(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new vo,this.lineVertexArray=new yo,this.symbolInstances=new _o}calculateGlyphDependencies(e,t,i,n,r){for(let s=0;s<e.length;s++)if(t[e.charCodeAt(s)]=!0,n&&r){const i=Hh[e.charAt(s)];i&&(t[i.charCodeAt(0)]=!0)}}populate(e,t,i,n){const r=this.layers[0],s=r.layout,o="globe"===this.projection.name,a=s.get("text-font"),l=s.get("text-field"),c=s.get("icon-image"),u=("constant"!==l.value.kind||l.value.value instanceof Ft&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),h="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,d=s.get("symbol-sort-key");if(this.features=[],!u&&!h)return;const p=t.iconDependencies,m=t.glyphDependencies,f=t.availableImages,g=new xs(this.zoom);for(const{feature:_,id:v,index:y,sourceLayerIndex:b}of e){const e=r._featureFilter.needGeometry,t=ac(_,e);if(!r._featureFilter.filter(g,t,i))continue;if(e||(t.geometry=oc(_,i,n)),o&&1!==_.type&&i.z<=5){const e=t.geometry,n=.98078528056,r=(e,t)=>La(Sl(e.x,e.y,i,1),Sl(t.x,t.y,i,1))<n;for(let t=0;t<e.length;t++)e[t]=ic(e[t],r)}let l,c;if(u){const e=r.getValueAndResolveTokens("text-field",t,i,f),n=Ft.factory(e);nm(n)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===vs()||this.hasRTLText&&bs.isParsed())&&(l=Wh(n,r,t))}if(h){const e=r.getValueAndResolveTokens("icon-image",t,i,f);c=e instanceof Lt?e:Lt.fromString(e)}if(!l&&!c)continue;const x=this.sortFeaturesByKey?d.evaluate(t,{},i):void 0;if(this.features.push({id:v,text:l,icon:c,index:y,sourceLayerIndex:b,geometry:t.geometry,properties:_.properties,type:$p[_.type],sortKey:x}),c&&(p[c.name]=!0),l){const e=a.evaluate(t,{},i).join(","),n="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Dd.vertical)>=0;for(const t of l.sections)if(t.image)p[t.image.name]=!0;else{const i=ts(l.toString()),r=t.fontStack||e,s=m[r]=m[r]||{};this.calculateGlyphDependencies(t.text,s,n,this.allowVerticalPlacement,i)}}}"line"===s.get("symbol-placement")&&(this.features=function(e){const t={},i={},n=[];let r=0;function s(t){n.push(e[t]),r++}function o(e,t,r){const s=i[e];return delete i[e],i[t]=s,n[s].geometry[0].pop(),n[s].geometry[0]=n[s].geometry[0].concat(r[0]),s}function a(e,i,r){const s=t[i];return delete t[i],t[e]=s,n[s].geometry[0].shift(),n[s].geometry[0]=r[0].concat(n[s].geometry[0]),s}function l(e,t,i){const n=i?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(n.x,":").concat(n.y)}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){s(c);continue}const p=l(d,h),m=l(d,h,!0);if(p in i&&m in t&&i[p]!==t[m]){const e=a(p,m,h),r=o(p,m,n[e].geometry);delete t[p],delete i[m],i[l(d,n[r].geometry,!0)]=r,n[e].geometry=null}else p in i?o(p,m,h):m in t?a(p,m,h):(s(c),t[p]=r-1,i[m]=r-1)}return n.filter(e=>e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((e,t)=>e.sortKey-t.sortKey)}update(e,t,i,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Jp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const i=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:n,y:r}of t)this.lineVertexArray.emplaceBack(n,r);return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,t,i,n,r,s,o,a,l,c,u,h,d,p){const m=e.indexArray,f=e.layoutVertexArray,g=e.globeExtVertexArray,_=e.segments.prepareSegment(4*t.length,f,m,this.canOverlap?s.sortKey:void 0),v=this.glyphOffsetArray.length,y=_.vertexLength,b=this.allowVerticalPlacement&&o===Dd.vertical?Math.PI/2:0,x=s.text&&s.text.sections;for(let E=0;E<t.length;E++){const{tl:n,tr:r,bl:o,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:v,minFontScaleX:y,minFontScaleY:w,glyphOffset:A,isSDF:T,sectionIndex:D}=t[E],S=_.vertexLength,C=A[1];if(em(f,l.x,l.y,n.x,C+n.y,u.x,u.y,i,T,h.x,h.y,y,w),em(f,l.x,l.y,r.x,C+r.y,u.x+u.w,u.y,i,T,v.x,h.y,y,w),em(f,l.x,l.y,o.x,C+o.y,u.x,u.y+u.h,i,T,h.x,v.y,y,w),em(f,l.x,l.y,c.x,C+c.y,u.x+u.w,u.y+u.h,i,T,v.x,v.y,y,w),a){const{x:t,y:i,z:n}=a.anchor,[r,s,o]=a.up;tm(g,t,i,n,r,s,o),tm(g,t,i,n,r,s,o),tm(g,t,i,n,r,s,o),tm(g,t,i,n,r,s,o),im(e.dynamicLayoutVertexArray,t,i,n,b)}else im(e.dynamicLayoutVertexArray,l.x,l.y,l.z,b);m.emplaceBack(S,S+1,S+2),m.emplaceBack(S+1,S+2,S+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),E!==t.length-1&&D===t[E+1].sectionIndex||e.programConfigurations.populatePaintArrays(f.length,s,s.index,{},d,p,x&&x[D])}const w=a?a.anchor:l;e.placedSymbolArray.emplaceBack(w.x,w.y,w.z,l.x,l.y,v,this.glyphOffsetArray.length-v,y,c,u,l.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],o,0,!1,0,h,0)}_commitLayoutVertex(e,t,i,n,r,s,o){e.emplaceBack(t,i,n,r,s,Math.round(o.x),Math.round(o.y))}_addCollisionDebugVertices(e,t,i,n,r,s,o){const a=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=a.vertexLength,c=o.tileAnchorX,u=o.tileAnchorY;for(let d=0;d<4;d++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),i.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,u,new v(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,u,new v(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,u,new v(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,n,r,s,c,u,new v(e.x1,e.y2)),a.vertexLength+=4;const h=i.indexArray;h.emplaceBack(l,l+1),h.emplaceBack(l+1,l+2),h.emplaceBack(l+2,l+3),h.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceTextSize(e,s,t,o);this._addCollisionDebugVertices(n,r,this.textCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s)}}_addIconDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceIconSize(e,t,s.placedIconSymbolIndex);this._addCollisionDebugVertices(n,r,this.iconCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,s)}}generateCollisionDebugBuffers(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sm($s,Oh.members,lo),this.iconCollisionBox=new sm($s,Oh.members,lo);const i=Vh(this.iconSizeData,e),n=Vh(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(n,e,t,s.textBoxStartIndex,s.textBoxEndIndex,s),this._addTextDebugCollisionBoxes(n,e,t,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._addIconDebugCollisionBoxes(i,e,t,s.iconBoxStartIndex,s.iconBoxEndIndex,s),this._addIconDebugCollisionBoxes(i,e,t,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s)}}getSymbolInstanceTextSize(e,t,i,n){const r=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n),s=jh(this.textSizeData,e,r)/zh;return this.tilePixelRatio*s}getSymbolInstanceIconSize(e,t,i){const n=this.icon.placedSymbolArray.get(i),r=jh(this.iconSizeData,e,n);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(e,t,i){e.emplaceBack(t,-i,-i),e.emplaceBack(t,i,-i),e.emplaceBack(t,i,i),e.emplaceBack(t,-i,i)}_updateTextDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceTextSize(e,s,t,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,n.padding)}}_updateIconDebugCollisionBoxes(e,t,i,n,r,s){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceIconSize(e,t,s);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,n.padding)}}updateCollisionDebugBuffers(e,t){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=Vh(this.iconSizeData,e),n=Vh(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(n,e,t,s.textBoxStartIndex,s.textBoxEndIndex,s),this._updateTextDebugCollisionBoxes(n,e,t,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s),this._updateIconDebugCollisionBoxes(i,e,t,s.iconBoxStartIndex,s.iconBoxEndIndex,s.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(i,e,t,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,i,n,r,s,o,a,l){const c={};if(t<i){const{x1:i,y1:n,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(t);c.textBox={x1:i,y1:n,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.textFeatureIndex=p}if(n<r){const{x1:t,y1:i,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(n);c.verticalTextBox={x1:t,y1:i,x2:r,y2:s,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(s<o){const{x1:t,y1:i,x2:n,y2:r,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(s);c.iconBox={x1:t,y1:i,x2:n,y2:r,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.iconFeatureIndex=p}if(a<l){const{x1:t,y1:i,x2:n,y2:r,padding:s,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(a);c.verticalIconBox={x1:t,y1:i,x2:n,y2:r,padding:s,projectedAnchorX:o,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const i=e.placedSymbolArray.get(t),n=i.vertexStartIndex+4*i.numGlyphs;for(let r=i.vertexStartIndex;r<n;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),i=Math.cos(e),n=[],r=[],s=[];for(let o=0;o<this.symbolInstances.length;++o){s.push(o);const e=this.symbolInstances.get(o);n.push(0|Math.round(t*e.tileAnchorX+i*e.tileAnchorY)),r.push(e.featureIndex)}return s.sort((e,t)=>n[e]-n[t]||r[t]-r[e]),s}addToSortKeyRanges(e,t){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:i,centerJustifiedTextSymbolIndex:n,leftJustifiedTextSymbolIndex:r,verticalPlacedTextSymbolIndex:s,placedIconSymbolIndex:o,verticalPlacedIconSymbolIndex:a}=t;i>=0&&this.addIndicesForPlacedSymbol(this.text,i),n>=0&&n!==i&&this.addIndicesForPlacedSymbol(this.text,n),r>=0&&r!==n&&r!==i&&this.addIndicesForPlacedSymbol(this.text,r),s>=0&&this.addIndicesForPlacedSymbol(this.text,s),o>=0&&this.addIndicesForPlacedSymbol(this.icon,o),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Yr(om,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),om.MAX_GLYPHS=65535,om.addDynamicAttributes=im;const am=new Rs({"symbol-placement":new Is(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Is(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Is(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ks(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Is(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Is(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Is(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Is(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Is(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new ks(et.layout_symbol["icon-size"]),"icon-text-fit":new Is(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Is(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new ks(et.layout_symbol["icon-image"]),"icon-rotate":new ks(et.layout_symbol["icon-rotate"]),"icon-padding":new Is(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Is(et.layout_symbol["icon-keep-upright"]),"icon-offset":new ks(et.layout_symbol["icon-offset"]),"icon-anchor":new ks(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Is(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Is(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Is(et.layout_symbol["text-rotation-alignment"]),"text-field":new ks(et.layout_symbol["text-field"]),"text-font":new ks(et.layout_symbol["text-font"]),"text-size":new ks(et.layout_symbol["text-size"]),"text-max-width":new ks(et.layout_symbol["text-max-width"]),"text-line-height":new ks(et.layout_symbol["text-line-height"]),"text-letter-spacing":new ks(et.layout_symbol["text-letter-spacing"]),"text-justify":new ks(et.layout_symbol["text-justify"]),"text-radial-offset":new ks(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Is(et.layout_symbol["text-variable-anchor"]),"text-anchor":new ks(et.layout_symbol["text-anchor"]),"text-max-angle":new Is(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Is(et.layout_symbol["text-writing-mode"]),"text-rotate":new ks(et.layout_symbol["text-rotate"]),"text-padding":new Is(et.layout_symbol["text-padding"]),"text-keep-upright":new Is(et.layout_symbol["text-keep-upright"]),"text-transform":new ks(et.layout_symbol["text-transform"]),"text-offset":new ks(et.layout_symbol["text-offset"]),"text-allow-overlap":new Is(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Is(et.layout_symbol["text-ignore-placement"]),"text-optional":new Is(et.layout_symbol["text-optional"])});var lm={paint:new Rs({"icon-opacity":new ks(et.paint_symbol["icon-opacity"]),"icon-color":new ks(et.paint_symbol["icon-color"]),"icon-halo-color":new ks(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new ks(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ks(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Is(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Is(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new ks(et.paint_symbol["text-opacity"]),"text-color":new ks(et.paint_symbol["text-color"],{runtimeType:dt,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new ks(et.paint_symbol["text-halo-color"]),"text-halo-width":new ks(et.paint_symbol["text-halo-width"]),"text-halo-blur":new ks(et.paint_symbol["text-halo-blur"]),"text-translate":new Is(et.paint_symbol["text-translate"]),"text-translate-anchor":new Is(et.paint_symbol["text-translate-anchor"])}),layout:am};class cm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:lt,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Yr(cm,"FormatSectionOverride",{omit:["defaultValue"]});class um extends na{constructor(e){super(e,lm)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const i=this.layout.get("text-writing-mode");if(i){const e=[];for(const t of i)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,i,n){const r=this.layout.get(e).evaluate(t,{},i,n),s=this._unevaluatedLayout._values[e];return s.isDataDriven()||Yn(s.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,(t,i)=>i in e?String(e[i]):"")}(t.properties,r)}createBucket(e){return new om(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of lm.paint.overridableProperties){if(!um.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),i=new cm(t),n=new Zn(i,t.property.specification);let r=null;r="constant"===t.value.kind||"source"===t.value.kind?new Jn("source",n):new $n("composite",n,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new Cs(t.property,r,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven())&&um.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const i=e.get("text-field"),n=lm.paint.properties[t];let r=!1;const s=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(r=!0)};if("constant"===i.value.kind&&i.value.value instanceof Ft)s(i.value.value.sections);else if("source"===i.value.kind){const e=t=>{r||(t instanceof jt&&zt(t.value)===gt?s(t.value.sections):t instanceof Xt?s(t.sections):t.eachChild(e))},t=i.value;t._styleExpression&&e(t._styleExpression.expression)}return r}getProgramConfiguration(e){return new Yo(this,e)}}var hm={paint:new Rs({"background-color":new Is(et.paint_background["background-color"]),"background-pattern":new Is(et.paint_background["background-pattern"]),"background-opacity":new Is(et.paint_background["background-opacity"])})},dm={paint:new Rs({"raster-opacity":new Is(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Is(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Is(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Is(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Is(et.paint_raster["raster-saturation"]),"raster-contrast":new Is(et.paint_raster["raster-contrast"]),"raster-resampling":new Is(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Is(et.paint_raster["raster-fade-duration"])})};class pm extends na{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var mm={paint:new Rs({"sky-type":new Is(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Is(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Is(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Is(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Is(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ms(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Is(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Is(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Is(et.paint_sky["sky-opacity"])})};function fm(e,t,i){const n=[0,0,1],r=qa([]);return Ya(r,r,i?-x(e)+Math.PI:x(e)),Za(r,r,-x(t)),za(n,n,r),Fa(n,n)}const gm={circle:class extends na{constructor(e){super(e,Cc)}createBucket(e){return new uc(e)}queryRadius(e){const t=e;return Ec("circle-radius",this,t)+Ec("circle-stroke-width",this,t)+Ac(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,i,n,r,s,o,a){const l=Dc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return Pc(e,n,s,o,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getProgramConfiguration(e){return new Yo(this,e)}},heatmap:class extends na{createBucket(e){return new Fc(e)}constructor(e){super(e,Uc),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return Ec("heatmap-radius",this,e)}queryIntersectsFeature(e,t,i,n,r,s,o,a){const l=this.paint.get("heatmap-radius").evaluate(t,i);return Pc(e,n,s,o,a,!0,!0,new v(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(e){return new Yo(this,e)}},hillshade:class extends na{constructor(e){super(e,Vc)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends na{constructor(e){super(e,Pu)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(e){return new Yo(this,e)}recalculate(e,t){super.recalculate(e,t);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Su(e)}queryRadius(){return Ac(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,i,n,r,s){return!e.queryGeometry.isAboveHorizon&&pc(Tc(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends na{constructor(e){super(e,uh)}createBucket(e){return new eh(e)}queryRadius(){return Ac(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(e){return new Yo(this,e)}queryIntersectsFeature(e,t,i,n,r,s,o,a,l){const c=Dc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),u=this.paint.get("fill-extrusion-height").evaluate(t,i),h=this.paint.get("fill-extrusion-base").evaluate(t,i),d=[0,0],p=a&&s.elevation,m=s.elevation?s.elevation.exaggeration():1,f=e.tile.getBucket(this);if(p&&f instanceof eh){const e=f.centroidVertexArray,t=l+1;t<e.length&&(d[0]=e.geta_centroid_pos0(t),d[1]=e.geta_centroid_pos1(t))}if(0===d[0]&&1===d[1])return!1;"globe"===s.projection.name&&(n=lh([n],[new v(0,0),new v(aa,aa)],e.tileID.canonical).map(e=>e.polygon).flat());const g=p?a:null,[_,y]=function(e,t,i,n,r,s,o,a,l,c,u){return"globe"===e.projection.name?function(e,t,i,n,r,s,o,a,l,c,u){const h=[],d=[],p=e.projection.upVectorScale(u,e.center.lat,e.worldSize).metersToTile,m=[0,0,0,1],f=[0,0,0,1],g=(e,t,i,n)=>{e[0]=t,e[1]=i,e[2]=n,e[3]=1},_=ah();i>0&&(i+=_),n+=_;for(const v of t){const t=[],_=[];for(const h of v){const d=h.x+r.x,v=h.y+r.y,y=e.projection.projectTilePoint(d,v,u),b=e.projection.upVector(u,h.x,h.y);let x=i,w=n;if(o){const e=yh(d,v,i,n,o,a,l,c);x+=e.base,w+=e.top}0!==i?g(m,y.x+b[0]*p*x,y.y+b[1]*p*x,y.z+b[2]*p*x):g(m,y.x,y.y,y.z),g(f,y.x+b[0]*p*w,y.y+b[1]*p*w,y.z+b[2]*p*w),Ba(m,m,s),Ba(f,f,s),t.push(new gh(m[0],m[1],m[2])),_.push(new gh(f[0],f[1],f[2]))}h.push(t),d.push(_)}return[h,d]}(e,t,i,n,r,s,o,a,l,c,u):o?function(e,t,i,n,r,s,o,a,l){const c=[],u=[],h=[0,0,0,1];for(const d of e){const e=[],p=[];for(const c of d){const u=c.x+n.x,d=c.y+n.y,m=yh(u,d,t,i,s,o,a,l);h[0]=u,h[1]=d,h[2]=m.base,h[3]=1,Ha(h,h,r),h[3]=Math.max(h[3],1e-5);const f=new gh(h[0]/h[3],h[1]/h[3],h[2]/h[3]);h[0]=u,h[1]=d,h[2]=m.top,h[3]=1,Ha(h,h,r),h[3]=Math.max(h[3],1e-5);const g=new gh(h[0]/h[3],h[1]/h[3],h[2]/h[3]);e.push(f),p.push(g)}c.push(e),u.push(p)}return[c,u]}(t,i,n,r,s,o,a,l,c):function(e,t,i,n,r){const s=[],o=[],a=r[8]*t,l=r[9]*t,c=r[10]*t,u=r[11]*t,h=r[8]*i,d=r[9]*i,p=r[10]*i,m=r[11]*i;for(const f of e){const e=[],t=[];for(const i of f){const s=i.x+n.x,o=i.y+n.y,f=r[0]*s+r[4]*o+r[12],g=r[1]*s+r[5]*o+r[13],_=r[2]*s+r[6]*o+r[14],v=r[3]*s+r[7]*o+r[15],y=f+a,b=g+l,x=_+c,w=Math.max(v+u,1e-5),E=f+h,A=g+d,T=_+p,D=Math.max(v+m,1e-5);e.push(new gh(y/w,b/w,x/w)),t.push(new gh(E/D,A/D,T/D))}s.push(e),o.push(t)}return[s,o]}(t,i,n,r,s)}(s,n,h,u,c,o,g,d,m,s.center.lat,e.tileID.canonical),b=e.queryGeometry;return function(e,t,i){let n=1/0;pc(i,t)&&(n=vh(i,t[0]));for(let r=0;r<t.length;r++){const s=t[r],o=e[r];for(let e=0;e<s.length-1;e++){const t=s[e],r=[t,s[e+1],o[e+1],o[e],t];hc(i,r)&&(n=Math.min(n,vh(i,r)))}}return n!==1/0&&n}(_,y,b.isPointQuery()?b.screenBounds:b.screenGeometry)}},line:class extends na{constructor(e){super(e,Ch),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ii,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Ph.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Dh(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(e){return new Yo(this,e)}queryRadius(e){const t=e,i=Ih(Ec("line-width",this,t),Ec("line-gap-width",this,t)),n=Ec("line-offset",this,t);return i/2+Math.abs(n)+Ac(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,i,n,r,s){if(e.queryGeometry.isAboveHorizon)return!1;const o=Tc(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,e.pixelToTileUnitsFactor),a=e.pixelToTileUnitsFactor/2*Ih(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),l=this.paint.get("line-offset").evaluate(t,i);return l&&(n=function(e,t){const i=[],n=new v(0,0);for(let r=0;r<e.length;r++){const s=e[r],o=[];for(let e=0;e<s.length;e++){const i=s[e],r=s[e+1],a=0===e?n:i.sub(s[e-1])._unit()._perp(),l=e===s.length-1?n:r.sub(i)._unit()._perp(),c=a._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),o.push(c._mult(t)._add(i))}i.push(o)}return i}(n,l*e.pixelToTileUnitsFactor)),function(e,t,i){for(let n=0;n<t.length;n++){const r=t[n];if(e.length>=3)for(let t=0;t<r.length;t++)if(bc(e,r[t]))return!0;if(mc(e,r,i))return!0}return!1}(o,n,a)}isTileClipped(){return!0}},symbol:um,background:class extends na{constructor(e){super(e,hm)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends na{constructor(e){super(e,dm)}getProgramIds(){return["raster"]}},sky:class extends na{constructor(e){super(e,mm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=jc({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const i=this.paint.get("sky-atmosphere-sun"),n=!i,r=e.style.light,s=r.properties.get("position");return n&&"viewport"===r.properties.get("anchor")&&W("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?fm(s.azimuthal,90-s.polar,t):fm(i[0],90-i[1],t)}const i=this.paint.get("sky-gradient-center");return fm(i[0],90-i[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}};class _m{constructor(e,t,i,n){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,i,n){const{width:r,height:s}=e,{context:o}=this,{gl:a}=o,{HTMLImageElement:l,HTMLCanvasElement:c,HTMLVideoElement:u,ImageData:h,ImageBitmap:d}=t;if(a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!i||!1!==i.premultiply)),n||this.size&&this.size[0]===r&&this.size[1]===s){const{x:t,y:i}=n||{x:0,y:0};e instanceof l||e instanceof c||e instanceof u||e instanceof h||d&&e instanceof d?a.texSubImage2D(a.TEXTURE_2D,0,t,i,a.RGBA,a.UNSIGNED_BYTE,e):a.texSubImage2D(a.TEXTURE_2D,0,t,i,r,s,a.RGBA,a.UNSIGNED_BYTE,e.data)}else this.size=[r,s],e instanceof l||e instanceof c||e instanceof u||e instanceof h||d&&e instanceof d?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,e):a.texImage2D(a.TEXTURE_2D,0,this.format,r,s,0,this.format,a.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D)}bind(e,t){const{context:i}=this,{gl:n}=i;n.bindTexture(n.TEXTURE_2D,this.texture),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap?e===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class vm{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class ym{constructor(){this.tasks={},this.taskQueue=[],z(["process"],this),this.invoker=new vm(this.process),this.nextId=0}add(e,t){const i=this.nextId++,n=function(e){let{type:t,isSymbolTile:i,zoom:n}=e;return n=n||0,"message"===t?0:"maybePrepare"!==t||i?"parseTile"!==t||i?"parseTile"===t&&i?300-n:"maybePrepare"===t&&i?400-n:500:200-n:100-n}(t);if(0===n){q();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[i]={fn:e,metadata:t,priority:n,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){q();try{if(this.taskQueue=this.taskQueue.filter(e=>!!this.tasks[e]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let n=0;n<this.taskQueue.length;n++){const i=this.tasks[this.taskQueue[n]];i.priority<t&&(t=i.priority,e=n)}if(null===e)return null;const i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}remove(){this.invoker.remove()}}class bm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const xm=["tile","layer","source","sourceLayer","state"];class wm{constructor(e,t,i,n,r){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=i,this._y=n,this.properties=e.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const t of xm)void 0!==this[t]&&(e[t]=this[t]);return e}}const Em=32,Am=33,Tm=new Uint16Array(8184);for(let Ef=0;Ef<2046;Ef++){let e=Ef+2,t=0,i=0,n=0,r=0,s=0,o=0;for(1&e?n=r=s=Em:t=i=o=Em;(e>>=1)>1;){const a=t+n>>1,l=i+r>>1;1&e?(n=t,r=i,t=s,i=o):(t=n,i=r,n=s,r=o),s=a,o=l}const a=4*Ef;Tm[a+0]=t,Tm[a+1]=i,Tm[a+2]=n,Tm[a+3]=r}const Dm=new Uint16Array(2178),Sm=new Uint8Array(1089),Cm=new Uint16Array(1089);function Pm(e){return 0===e?-.03125:32===e?.03125:0}var Im=zs([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const km={type:2,extent:aa,loadGeometry:()=>[[new v(0,0),new v(aa+1,0),new v(aa+1,aa+1),new v(0,aa+1),new v(0,0)]]};class Mm{constructor(e,t,i,n,r){this.tileID=e,this.uid=F(),this.uses=0,this.tileSize=t,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=r,this.expiredRequestCount=0,this.state="loading",n&&n.transform&&(this.projection=n.transform.projection)}registerFadeDuration(e){const t=e+this.timeAdded;t<Ze.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Ip(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,t,i){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const i={};if(!t)return i;for(const n of e){const e=n.layerIds.map(e=>t.getLayer(e)).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(t=>e.filter(e=>e.id===t)[0]));for(const t of e)i[t.id]=n}}return i}(e.buckets,t.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const t=this.buckets[e];if(t instanceof om){if(this.hasSymbolBuckets=!0,!i)break;t.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const t=this.buckets[e];if(t instanceof om&&t.hasRTLText){this.hasRTLText=!0,bs.isLoading()||bs.isLoaded()||"deferred"!==vs()||ys();break}}this.queryPadding=0;for(const e in this.buckets){const i=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(e).queryRadius(i))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new po}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const i in this.buckets){const t=this.buckets[i];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _m(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _m(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _m(e,this.lineAtlas.image,t.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,i,n,r,s,o,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:o,transform:s,params:r,tileTransform:this.tileTransform},e,t,i):{}}querySourceFeatures(e,t){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const n=i.loadVTLayers(),r=t?t.sourceLayer:"",s=n._geojsonTileLayer||n[r];if(!s)return;const o=hr(t&&t.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let h=0;h<s.length;h++){const t=s.feature(h);if(o.needGeometry){const e=ac(t,!0);if(!o.filter(new xs(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!o.filter(new xs(this.tileID.overscaledZ),t))continue;const n=i.getId(t,r),d=new wm(t,a,l,c,n);d.tile=u,e.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const t=this.expirationTime;if(e.cacheControl){const t=Z(e.cacheControl);t["max-age"]&&(this.expirationTime=Date.now()+1e3*t["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let i=!1;if(this.expirationTime>e)i=!1;else if(t)if(this.expirationTime<t)i=!0;else{const n=this.expirationTime-t;n?this.expirationTime=e+Math.max(n,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!t)return;const i=this.latestFeatureIndex.loadVTLayers(),n=t.style.listImages();for(const r in this.buckets){if(!t.style.hasLayer(r))continue;const s=this.buckets[r],o=s.layers[0].sourceLayer||"_geojsonTileLayer",a=i[o],l=e[o];if(!a||!l||0===Object.keys(l).length)continue;if(s.update(l,a,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),s instanceof Dh||s instanceof Su){const e=t.style._getSourceCache(s.layers[0].source);t._terrain&&t._terrain.enabled&&e&&s.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(e.id,this.tileID)}const c=t&&t.style&&t.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(s)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ze.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ze.now()+e}setTexture(e,t){const i=t.context,n=i.gl;this.texture=this.texture||t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new _m(i,e,n.RGBA,{useMipmap:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE))}setDependencies(e,t){const i={};for(const n of t)i[n]=!0;this.dependencies[e]=i}hasDependency(e,t){for(const i of e){const e=this.dependencies[i];if(e)for(const i of t)if(e[i])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,t){if(!t||"mercator"===t.name||this._tileDebugBuffer)return;const i=oc(km,this.tileID.canonical,this.tileTransform)[0],n=new Us,r=new co;for(let s=0;s<i.length;s++){const{x:e,y:t}=i[s];n.emplaceBack(e,t),r.emplaceBack(s)}r.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(n,el.members),this._tileDebugSegments=oa.simpleSegment(0,0,n.length,r.length)}_makeTileBoundsBuffers(e,t){if(this._tileBoundsBuffer||!t||"mercator"===t.name)return;const i=oc(km,this.tileID.canonical,this.tileTransform)[0];let n,r;if(this.isRaster){const e=function(e,t){const i=Ip(e,t),n=Math.pow(2,e.z);for(let c=0;c<Am;c++)for(let r=0;r<Am;r++){const s=ql((e.x+(r+Pm(r))/Em)/n),o=Zl((e.y+(c+Pm(c))/Em)/n),a=t.project(s,o),l=c*Am+r;Dm[2*l+0]=Math.round((a.x*i.scale-i.x)*aa),Dm[2*l+1]=Math.round((a.y*i.scale-i.y)*aa)}Sm.fill(0),Cm.fill(0);for(let c=2045;c>=0;c--){const e=4*c,t=Tm[e+0],i=Tm[e+1],n=Tm[e+2],r=Tm[e+3],s=t+n>>1,o=i+r>>1,a=s+o-i,l=o+t-s,u=i*Am+t,h=r*Am+n,d=o*Am+s,p=Math.hypot((Dm[2*u+0]+Dm[2*h+0])/2-Dm[2*d+0],(Dm[2*u+1]+Dm[2*h+1])/2-Dm[2*d+1])>=16;Sm[d]=Sm[d]||(p?1:0),c<1022&&(Sm[d]=Sm[d]||Sm[(i+l>>1)*Am+(t+a>>1)]||Sm[(r+l>>1)*Am+(n+a>>1)])}const r=new Vs,s=new io;let o=0;function a(e,t){const i=t*Am+e;return 0===Cm[i]&&(r.emplaceBack(Dm[2*i+0],Dm[2*i+1],e*aa/Em,t*aa/Em),Cm[i]=++o),Cm[i]-1}function l(e,t,i,n,r,o){const c=e+i>>1,u=t+n>>1;if(Math.abs(e-r)+Math.abs(t-o)>1&&Sm[u*Am+c])l(r,o,e,t,c,u),l(i,n,r,o,c,u);else{const l=a(e,t),c=a(i,n),u=a(r,o);s.emplaceBack(l,c,u)}}return l(0,0,Em,Em,Em,0),l(Em,Em,0,0,0,Em),{vertices:r,indices:s}}(this.tileID.canonical,t);n=e.vertices,r=e.indices}else{n=new Vs,r=new io;for(const{x:t,y:r}of i)n.emplaceBack(t,r,0,0);const e=vu(n.int16,void 0,4);for(let t=0;t<e.length;t+=3)r.emplaceBack(e[t],e[t+1],e[t+2])}this._tileBoundsBuffer=e.createVertexBuffer(n,Im.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(r),this._tileBoundsSegments=oa.simpleSegment(0,0,n.length,r.length)}_makeGlobeTileDebugBuffers(e,t){const i=t.projection;if(!i||"globe"!==i.name||t.freezeTileCoverage)return;const n=this.tileID.canonical,r=Il(bl(n,t)),s=Rl(t.zoom);let o;s>0&&(o=ma(new Float64Array(16),t.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,n,t,r,o,s),this._makeGlobeTileDebugTextBuffer(e,n,t,r,o,s)}_globePoint(e,t,i,n,r,s,o){let a=Sl(e,t,i);if(s){const r=1<<i.z,l=Wl(n.center.lng),c=Hl(n.center.lat),u=(i.x+.5)/r-l;let h=0;u>.5?h=-1:u<-.5&&(h=1);let d=(e/aa+i.x)/r+h,p=(t/aa+i.y)/r;d=(d-l)*n._pixelsPerMercatorPixel+l,p=(p-c)*n._pixelsPerMercatorPixel+c;const m=[d*n.worldSize,p*n.worldSize,0];Ba(m,m,s),a=yl(a,m,o)}return Ba(a,a,r)}_makeGlobeTileDebugBorderBuffer(e,t,i,n,r,s){const o=new Us,a=new co,l=new js,c=(e,c,u,h,d)=>{const p=(u-e)/(d-1),m=(h-c)/(d-1),f=o.length;for(let g=0;g<d;g++){const u=e+g*p,h=c+g*m;o.emplaceBack(u,h);const d=this._globePoint(u,h,t,i,n,r,s);l.emplaceBack(d[0],d[1],d[2]),a.emplaceBack(f+g)}},u=aa;c(0,0,u,0,16),c(u,0,u,u,16),c(u,u,0,u,16),c(0,u,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(a),this._tileDebugBuffer=e.createVertexBuffer(o,el.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(l,Qa.members),this._tileDebugSegments=oa.simpleSegment(0,0,o.length,a.length)}_makeGlobeTileDebugTextBuffer(e,t,i,n,r,s){const o=aa/4,a=new Us,l=new io,c=new js,u=25;l.reserve(32),a.reserve(u),c.reserve(u);const h=(e,t)=>u*e+t;for(let d=0;d<u;d++){const e=d*o;for(let l=0;l<u;l++){const u=l*o;a.emplaceBack(u,e);const h=this._globePoint(u,e,t,i,n,r,s);c.emplaceBack(h[0],h[1],h[2])}}for(let d=0;d<4;d++)for(let e=0;e<4;e++){const t=h(d,e),i=h(d,e+1),n=h(d+1,e),r=h(d+1,e+1);l.emplaceBack(t,i,n),l.emplaceBack(n,i,r)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(l),this._tileDebugTextBuffer=e.createVertexBuffer(a,el.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(c,Qa.members),this._tileDebugTextSegments=oa.simpleSegment(0,0,u,32)}}class Rm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,i){const n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},M(this.stateChanges[e][n],i),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==n&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][n]){this.deletedStates[e][n]={};for(const t in this.state[e][n])i[t]||(this.deletedStates[e][n][t]=null)}else for(const r in i)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][r]&&delete this.deletedStates[e][n][r]}removeFeatureState(e,t,i){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][i]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(i in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][i]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,t){const i=String(t),n=M({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const i=this.deletedStates[e][t];if(null===i)return{};for(const e in i)delete n[e]}return n}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){const i={};for(const n in this.stateChanges){this.state[n]=this.state[n]||{};const e={};for(const t in this.stateChanges[n])this.state[n][t]||(this.state[n][t]={}),M(this.state[n][t],this.stateChanges[n][t]),e[t]=this.state[n][t];i[n]=e}for(const n in this.deletedStates){this.state[n]=this.state[n]||{};const e={};if(null===this.deletedStates[n])for(const t in this.state[n])e[t]={},this.state[n][t]={};else for(const t in this.deletedStates[n]){if(null===this.deletedStates[n][t])this.state[n][t]={};else if(this.state[n][t])for(const e of Object.keys(this.deletedStates[n][t]))delete this.state[n][t][e];e[t]=this.state[n][t]}i[n]=i[n]||{},M(i[n],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const n in e)e[n].setFeatureState(i,t)}}class Fm{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const i=this.toIdx(e,t);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function Lm(e,t,i,n){let r=0,s=Number.MAX_VALUE;for(let o=0;o<3;o++)if(Math.abs(n[o])<1e-15){if(i[o]<e[o]||i[o]>t[o])return null}else{const a=1/n[o];let l=(e[o]-i[o])*a,c=(t[o]-i[o])*a;if(l>c){const e=l;l=c,c=e}if(l>r&&(r=l),c<s&&(s=c),r>s)return null}return r}function Om(e,t,i,n,r,s,o,a,l,c,u){const h=n-e,d=r-t,p=s-i,m=o-e,f=a-t,g=l-i,_=u[1]*g-u[2]*f,v=u[2]*m-u[0]*g,y=u[0]*f-u[1]*m,b=h*_+d*v+p*y;if(Math.abs(b)<1e-15)return null;const x=1/b,w=c[0]-e,E=c[1]-t,A=c[2]-i,T=(w*_+E*v+A*y)*x;if(T<0||T>1)return null;const D=E*p-A*d,S=A*h-w*p,C=w*d-E*h,P=(u[0]*D+u[1]*S+u[2]*C)*x;return P<0||T+P>1?null:(m*D+f*S+g*C)*x}function Bm(e,t,i){return(e-t)/(i-t)}function zm(e,t,i,n,r,s,o,a,l){const c=1<<i,u=s-n,h=o-r,d=(e+1)/c*u+n,p=(t+0)/c*h+r,m=(t+1)/c*h+r;a[0]=(e+0)/c*u+n,a[1]=p,l[0]=d,l[1]=m}class Nm{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),i=[];let n=Math.ceil(Math.pow(2,t));const r=1/n,s=(e,t,i,n,r)=>{const s=n?1:0,o=(e+1)*i-s,a=t*i,l=(t+1)*i-s;r[0]=e*i,r[1]=a,r[2]=o,r[3]=l};let o=new Fm(n);const a=[];for(let l=0;l<n*n;l++){s(l%n,Math.floor(l/n),r,!1,a);const t=jm(a[0],a[1],e),i=jm(a[2],a[1],e),c=jm(a[2],a[3],e),u=jm(a[0],a[3],e);o.minimums.push(Math.min(t,i,c,u)),o.maximums.push(Math.max(t,i,c,u)),o.leaves.push(1)}for(i.push(o),n/=2;n>=1;n/=2){const e=i[i.length-1];o=new Fm(n);for(let t=0;t<n*n;t++){s(t%n,Math.floor(t/n),2,!0,a);const i=e.getElevation(a[0],a[1]),r=e.getElevation(a[2],a[1]),l=e.getElevation(a[2],a[3]),c=e.getElevation(a[0],a[3]),u=e.isLeaf(a[0],a[1]),h=e.isLeaf(a[2],a[1]),d=e.isLeaf(a[2],a[3]),p=e.isLeaf(a[0],a[3]),m=Math.min(i.min,r.min,l.min,c.min),f=Math.max(i.max,r.max,l.max,c.max),g=u&&h&&d&&p;o.maximums.push(f),o.minimums.push(m),o.leaves.push(f-m<=5&&g?1:0)}i.push(o)}return i}(this.dem),i=t.length-1,n=t[i];this._addNode(n.minimums[0],n.maximums[0],n.leaves[0]),this._construct(t,0,0,i,0)}raycastRoot(e,t,i,n,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Lm([e,t,-100],[i,n,this.maximums[0]*o],r,s)}raycast(e,t,i,n,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;const a=this.raycastRoot(e,t,i,n,r,s,o);if(null==a)return null;const l=[],c=[],u=[],h=[],d=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:a,t:p,nodex:m,nodey:f,depth:g}=d.pop();if(this.leaves[a]){zm(m,f,g,e,t,i,n,u,h);const a=1<<g,l=(m+0)/a,c=(m+1)/a,d=(f+0)/a,_=(f+1)/a,v=jm(l,d,this.dem)*o,y=jm(c,d,this.dem)*o,b=jm(c,_,this.dem)*o,x=jm(l,_,this.dem)*o,w=Om(u[0],u[1],v,h[0],u[1],y,h[0],h[1],b,r,s),E=Om(h[0],h[1],b,u[0],h[1],x,u[0],u[1],v,r,s),A=Math.min(null!==w?w:Number.MAX_VALUE,null!==E?E:Number.MAX_VALUE);if(A!==Number.MAX_VALUE)return A;{const e=Ra([],r,s,p);if(Um(v,y,x,b,Bm(e[0],u[0],h[0]),Bm(e[1],u[1],h[1]))>=e[2])return p}continue}let _=0;for(let d=0;d<this._siblingOffset.length;d++){zm((m<<1)+this._siblingOffset[d][0],(f<<1)+this._siblingOffset[d][1],g+1,e,t,i,n,u,h),u[2]=-100,h[2]=this.maximums[this.childOffsets[a]+d]*o;const p=Lm(u,h,r,s);if(null!=p){const e=p;l[d]=e;let t=!1;for(let i=0;i<_&&!t;i++)e>=l[c[i]]&&(c.splice(i,0,d),t=!0);t||(c[_]=d),_++}}for(let e=0;e<_;e++){const t=c[e];d.push({idx:this.childOffsets[a]+t,t:l[t],nodex:(m<<1)+this._siblingOffset[t][0],nodey:(f<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,i){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,i,n,r){if(1===e[n].isLeaf(t,i))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const s=n-1,o=e[s];let a=0,l=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],n=2*i+this._siblingOffset[c][1],r=o.getElevation(e,n),s=o.isLeaf(e,n),u=this._addNode(r.min,r.max,s);s&&(a|=1<<c),l||(l=u)}for(let c=0;c<this._siblingOffset.length;c++)a&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*i+this._siblingOffset[c][1],s,l+c)}}function Um(e,t,i,n,r,s){return ki(ki(e,i,s),ki(t,n,s),r)}function jm(e,t,i){const n=i.dim,r=S(e*n-.5,0,n-1),s=S(t*n-.5,0,n-1),o=Math.floor(r),a=Math.floor(s),l=Math.min(o+1,n-1),c=Math.min(a+1,n-1);return Um(i.get(o,a),i.get(l,a),i.get(o,c),i.get(l,c),r-o,s-a)}const Vm={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Gm(e,t,i){return(256*e*256+256*t+i)/10-1e4}function Wm(e,t,i){return 256*e+t+i/256-32768}class Hm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return W('"'.concat(i,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=t.height;const s=this.dim=t.height-2,o=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.encoding=i||"mapbox",this.borderReady=n,!n){for(let e=0;e<s;e++)o[this._idx(-1,e)]=o[this._idx(0,e)],o[this._idx(s,e)]=o[this._idx(s-1,e)],o[this._idx(e,-1)]=o[this._idx(e,0)],o[this._idx(e,s)]=o[this._idx(e,s-1)];o[this._idx(-1,-1)]=o[this._idx(0,0)],o[this._idx(s,-1)]=o[this._idx(s-1,0)],o[this._idx(-1,s)]=o[this._idx(0,s-1)],o[this._idx(s,s)]=o[this._idx(s-1,s-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Nm(this)}get(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(e=S(e,-1,this.dim),t=S(t,-1,this.dim));const i=4*this._idx(e,t);return("terrarium"===this.encoding?Wm:Gm)(this.pixels[i],this.pixels[i+1],this.pixels[i+2])}static getUnpackVector(e){return Vm[e]}get unpackVector(){return Vm[this.encoding]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}static pack(e,t){const i=[0,0,0,0],n=Hm.getUnpackVector(t);let r=Math.floor((e+n[3])/n[2]);return i[2]=r%256,r=Math.floor(r/256),i[1]=r%256,r=Math.floor(r/256),i[0]=r,i}getPixels(){return new Nc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,r=t*this.dim+this.dim,s=i*this.dim,o=i*this.dim+this.dim;switch(t){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:s=o-1;break;case 1:o=s+1}const a=-t*this.dim,l=-i*this.dim;for(let c=s;c<o;c++)for(let t=n;t<r;t++){const i=4*this._idx(t,c),n=4*this._idx(t+a,c+l);this.pixels[i+0]=e.pixels[n+0],this.pixels[i+1]=e.pixels[n+1],this.pixels[i+2]=e.pixels[n+2],this.pixels[i+3]=e.pixels[n+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Yr(Hm,"DEMData"),Yr(Nm,"DemMinMaxQuadTree",{omit:["dem"]});class Xm{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,i){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const r={value:t,timeout:void 0};if(void 0!==i&&(r.timeout=setTimeout(()=>{this.remove(e,r)},i)),this.data[n].push(r),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const i=e.wrapped().key,n=void 0===t?0:this.data[i].indexOf(t),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const i in this.data)for(const n of this.data[i])e(n.value)||t.push(n);for(const i of t)this.remove(i.value.tileID,i)}}class qm{constructor(e,t,i){this.func=e,this.mask=t,this.range=i}}qm.ReadOnly=!1,qm.ReadWrite=!0,qm.disabled=new qm(519,qm.ReadOnly,[0,1]);const Zm=7680;class Ym{constructor(e,t,i,n,r,s){this.test=e,this.ref=t,this.mask=i,this.fail=n,this.depthFail=r,this.pass=s}}Ym.disabled=new Ym({func:519,mask:0},0,0,Zm,Zm,Zm);class Km{constructor(e,t,i){this.blendFunction=e,this.blendColor=t,this.mask=i}}Km.Replace=[1,0],Km.disabled=new Km(Km.Replace,kt.transparent,[!1,!1,!1,!1]),Km.unblended=new Km(Km.Replace,kt.transparent,[!0,!0,!0,!0]),Km.alphaBlended=new Km([1,771],kt.transparent,[!0,!0,!0,!0]);const Jm=1029,$m=2305;class Qm{constructor(e,t,i){this.enable=e,this.mode=t,this.frontFace=i}}Qm.disabled=new Qm(!1,Jm,$m),Qm.backCCW=new Qm(!0,Jm,$m),Qm.backCW=new Qm(!0,Jm,2304),Qm.frontCW=new Qm(!0,1028,2304),Qm.frontCCW=new Qm(!0,1028,$m);class ef extends Qe{constructor(e,t,i){super(),this.id=e,this._onlySymbols=i,t.on("data",e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),t.on("error",()=>{this._sourceErrored=!0}),this._source=t,this._tiles={},this._cache=new Xm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Rm,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const i=this._tiles[t];i.upload(e),i.prepare(this.map.style.imageManager)}}getIds(){return k(this._tiles).map(e=>e.tileID).sort(tf).map(e=>e.key)}getRenderableIds(e){const t=[];for(const i in this._tiles)this._isIdRenderable(+i,e)&&t.push(this._tiles[i]);return e?t.sort((e,t)=>{const i=e.tileID,n=t.tileID,r=new v(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),s=new v(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-n.overscaledZ||s.y-r.y||s.x-r.x}).map(e=>e.tileID.key):t.map(e=>e.tileID).sort(tf).map(e=>e.key)}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))}_tileLoaded(e,t,i,n){if(n)if(e.state="errored",404!==n.status)this._source.fire(new $e(n,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ze.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Je("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const r=t[n];if(e.neighboringTiles&&e.neighboringTiles[r]){const t=this.getTileByID(r);i(e,t),i(t,e)}}function i(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let i=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),s=t.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,n),e.neighboringTiles&&e.neighboringTiles[s]&&(e.neighboringTiles[s].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,i,n){for(const r in this._tiles){let s=this._tiles[r];if(n[r]||!s.hasData()||s.tileID.overscaledZ<=t||s.tileID.overscaledZ>i)continue;let o=s.tileID;for(;s&&s.tileID.overscaledZ>t+1;){const e=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=this._tiles[e.key],s&&s.hasData()&&(o=e)}let a=o;for(;a.overscaledZ>t;)if(a=a.scaledTo(a.overscaledZ-1),e[a.key]){n[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=t?i:null}for(let i=e.overscaledZ-1;i>=t;i--){const t=e.scaledTo(i),n=this._getLoadedTile(t);if(n)return n}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const i=Math.ceil(e.width/t)+1,n=Math.ceil(e.height/t)+1,r=Math.floor(i*n*5),s="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,s):s;this._cache.setMaxSize(o)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const i in this._tiles){const n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(e,t,i){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!i)return;let n;this.updateCacheSize(e,t),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(e=>new mh(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)):(n=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(n=n.filter(e=>this._source.hasTile(e)))):n=[];const r=this._updateRetainedTiles(n);if(nf(this._source.type)&&0!==n.length){const e={},t={},i=Object.keys(r);for(const n of i){const i=r[n],s=this._tiles[n];if(!s||s.fadeEndTime&&s.fadeEndTime<=Ze.now())continue;const o=this.findLoadedParent(i,Math.max(i.overscaledZ-ef.maxOverzooming,this._source.minzoom));o&&(this._addTile(o.tileID),e[o.tileID.key]=o.tileID),t[n]=i}const s=n[n.length-1].overscaledZ;for(const n in this._tiles){const e=this._tiles[n];if(r[n]||!e.hasData())continue;let i=e.tileID;for(;i.overscaledZ>s;){i=i.scaledTo(i.overscaledZ-1);const s=this._tiles[i.key];if(s&&s.hasData()&&t[i.key]){r[n]=e.tileID;break}}}for(const n in e)r[n]||(this._coveredTiles[n]=!0,r[n]=e[n])}for(const o in r)this._tiles[o].clearFadeHold();const s=function(e,t){const i=[];for(const n in e)n in t||i.push(n);return i}(this._tiles,r);for(const o of s){const e=this._tiles[o];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+o)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const i={},n=e.reduce((e,t)=>Math.min(e,t.overscaledZ),1/0),r=e[0].overscaledZ,s=Math.max(r-ef.maxOverzooming,this._source.minzoom),o=Math.max(r+ef.maxUnderzooming,this._source.minzoom),a={};for(const l of e){const e=this._addTile(l);t[l.key]=l,e.hasData()||n<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,n,o,t);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],i=this.getTile(e);if(i&&i.hasData()){t[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let n=e.wasRequested();for(let r=l.overscaledZ-1;r>=s;--r){const s=l.scaledTo(r);if(i[s.key])break;if(i[s.key]=!0,e=this.getTile(s),!e&&n&&(e=this._addTile(s)),e&&(t[s.key]=s,n=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let i,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(e),i)break;n=e}for(const e of t)this._loadedParentTiles[e]=i}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));const i=Boolean(t);if(!i){const i=this.map?this.map.painter:null;t=new Mm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,i,this._isRaster),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,i||this._source.fire(new Je("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,t,i){const n=[],r=this.transform;if(!r)return n;const s="globe"===r.projection.name,o=Wl(r.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(i&&l.clearQueryDebugViz(),l.holdingForFade())continue;let c;if(s){const e=l.tileID.canonical;if(0===e.z){const t=[Math.abs(S(o,...rf(e,-1))-o),Math.abs(S(o,...rf(e,1))-o)];c=[0,2*t.indexOf(Math.min(...t))-1]}else{const t=[Math.abs(S(o,...rf(e,-1))-o),Math.abs(S(o,...rf(e,0))-o),Math.abs(S(o,...rf(e,1))-o)];c=[t.indexOf(Math.min(...t))-1]}}else c=[0];for(const i of c){const s=e.containsTile(l,r,t,i);s&&n.push(s)}}return n}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map(e=>this._tiles[e].tileID);for(const i of t)i.projMatrix=this.transform.calculateProjMatrix(i.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(nf(this._source.type))for(const e in this._tiles){const t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=Ze.now())return!0}return!1}setFeatureState(e,t,i){this._state.updateState(e=e||"_geojsonTileLayer",t,i)}removeFeatureState(e,t,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,i)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,i){const n=this._tiles[e];n&&n.setDependencies(t,i)}reloadTilesForDependencies(e,t){for(const i in this._tiles)this._tiles[i].hasDependency(e,t)&&this._reloadTile(+i,"reloading");this._cache.filter(i=>!i.hasDependency(e,t))}_preloadTiles(e,t){if(!this._sourceLoaded){const i=()=>{this._sourceLoaded&&(this._source.off("data",i),this._preloadTiles(e,t))};return void this._source.on("data",i)}const i=new Map,n=Array.isArray(e)?e:[e],r=this.map.painter.terrain,s=this.usedForTerrain&&r?r.getScaledDemTileSize():this._source.tileSize;for(const o of n){const e=o.coveringTiles({tileSize:s,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)i.set(t.key,t);this.usedForTerrain&&o.updateElevation(!1)}I(Array.from(i.values()),(e,t)=>{const i=new Mm(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(i,e=>{"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),t(e,i)})},t)}}function tf(e,t){const i=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-i||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function nf(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function rf(e,t){const i=1<<e.z;return[e.x/i+t,(e.x+1)/i+t]}ef.maxOverzooming=10,ef.maxUnderzooming=3;class sf{constructor(e,t,i){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=i}static create(e,t,i){const n=i||e.findDEMTileFor(t);if(!n||!n.dem)return;const r=n.dem,s=n.tileID,o=1<<t.canonical.z-s.canonical.z;return new sf(n,n.tileSize/aa/o,[(t.canonical.x/o-s.canonical.x)*r.dim,(t.canonical.y/o-s.canonical.y)*r.dim])}tileCoordToPixel(e,t){const i=t*this._scale+this._offset[1],n=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(i);return new v(n,r)}getElevationAt(e,t,i,n){const r=e*this._scale+this._offset[0],s=t*this._scale+this._offset[1],o=Math.floor(r),a=Math.floor(s),l=this._dem;return n=!!n,i?ki(ki(l.get(o,a,n),l.get(o,a+1,n),s-a),ki(l.get(o+1,a,n),l.get(o+1,a+1,n),s-a),r-o):l.get(o,a,n)}getElevationAtPixel(e,t,i){return this._dem.get(e,t,!!i)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Xl(1,e)*this._dem.stride}}class of{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new qr(aa,16,0),this.featureIndexArray=new xo,this.promoteId=t}insert(e,t,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r,s);const a=this.grid;for(let l=0;l<t.length;l++){const e=t[l],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const n=e[t];i[0]=Math.min(i[0],n.x),i[1]=Math.min(i[1],n.y),i[2]=Math.max(i[2],n.x),i[3]=Math.max(i[3],n.y)}i[0]<aa&&i[1]<aa&&i[2]>=0&&i[3]>=0&&a.insert(o,i[0],i[1],i[2],i[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Xu(new gd(this.rawTileData)).layers,this.sourceLayerCoder=new bm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,i,n){var r=this;this.loadVTLayers();const s=e.params||{},o=hr(s.filter),a=e.tileResult,l=e.transform,c=a.bufferedTilespaceBounds,u=this.grid.query(c.min.x,c.min.y,c.max.x,c.max.y,(e,t,i,n)=>xc(a.bufferedTilespaceGeometry,e,t,i,n));u.sort(lf);let h=null;l.elevation&&u.length>0&&(h=sf.create(l.elevation,this.tileID));const d={};let p;for(let m=0;m<u.length;m++){const l=u[m];if(l===p)continue;p=l;const c=this.featureIndexArray.get(l);let f=null;this.loadMatchingFeature(d,c,o,s.layers,s.availableImages,t,i,n,function(t,i,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return f||(f=oc(t,r.tileID.canonical,e.tileTransform)),i.queryIntersectsFeature(a,t,n,f,r.z,e.transform,e.pixelPosMatrix,h,s)})}return d}loadMatchingFeature(e,t,i,n,r,s,o,a,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:h,layoutVertexArrayOffset:d}=t,p=this.bucketLayerIDs[u];if(n&&!function(e,t){for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>=0)return!0;return!1}(n,p))return;const m=this.sourceLayerCoder.decode(h),f=this.vtLayers[m].feature(c);if(i.needGeometry){const e=ac(f,!0);if(!i.filter(new xs(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new xs(this.tileID.overscaledZ),f))return;const g=this.getId(f,m);for(let _=0;_<p.length;_++){const t=p[_];if(n&&n.indexOf(t)<0)continue;const i=s[t];if(!i)continue;let u={};void 0!==g&&a&&(u=a.getState(i.sourceLayer||"_geojsonTileLayer",g));const h=M({},o[t]);h.paint=af(h.paint,i.paint,f,u,r),h.layout=af(h.layout,i.layout,f,u,r);const m=!l||l(f,i,u,d);if(!m)continue;const v=new wm(f,this.z,this.x,this.y,g);v.layer=h;let y=e[t];void 0===y&&(y=e[t]=[]),y.push({featureIndex:c,feature:v,intersectionZ:m})}}lookupSymbolFeatures(e,t,i,n,r,s,o,a){const l={};this.loadVTLayers();const c=hr(r);for(const u of e)this.loadMatchingFeature(l,{bucketIndex:i,sourceLayerIndex:n,featureIndex:u,layoutVertexArrayOffset:0},c,s,o,a,t);return l}loadFeature(e){const{featureIndex:t,sourceLayerIndex:i}=e;this.loadVTLayers();const n=this.sourceLayerCoder.decode(i),r=this.vtFeatures[n];if(r[t])return r[t];const s=this.vtLayers[n].feature(t);return r[t]=s,s}hasLayer(e){for(const t of this.bucketLayerIDs)for(const i of t)if(e===i)return!0;return!1}getId(e,t){let i=e.id;if(this.promoteId){const n="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=n&&(i=e.properties[n]),"boolean"==typeof i&&(i=Number(i))}return i}}function af(e,t,i,n,r){return U(e,(e,s)=>{const o=t instanceof Ps?t.get(s):null;return o&&o.evaluate?o.evaluate(i,n,r):o})}function lf(e,t){return t-e}Yr(of,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class cf{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new zc({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const i=this.getKey(e,t);return this.positions[i]}trim(){const e=this.width,t=this.height=O(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,i){const n=[];let r=e.length%2==1?-e[e.length-1]*i:0,s=e[0]*i,o=!0;n.push({left:r,right:s,isDash:o,zeroLength:0===e[0]});let a=e[0];for(let l=1;l<e.length;l++){o=!o;const t=e[l];r=a*i,a+=t,s=a*i,n.push({left:r,right:s,isDash:o,zeroLength:0===t})}return n}addRoundDash(e,t,i){const n=t/2;for(let r=-i;r<=i;r++){const t=this.width*(this.nextRow+i+r);let s=0,o=e[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=e[++s]);const l=Math.abs(a-o.left),c=Math.abs(a-o.right),u=Math.min(l,c);let h;const d=r/i*(n+1);if(o.isDash){const e=n-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=n-Math.sqrt(u*u+d*d);this.image.data[t+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e,t){for(let a=e.length-1;a>=0;--a){const t=e[a],i=e[a+1];t.zeroLength?e.splice(a,1):i&&i.isDash===t.isDash&&(i.left=t.left,e.splice(a,1))}const i=e[0],n=e[e.length-1];i.isDash===n.isDash&&(i.left=n.left-this.width,n.right=i.right+this.width);const r=this.width*this.nextRow;let s=0,o=e[s];for(let a=0;a<this.width;a++){a/o.right>1&&(o=e[++s]);const i=Math.abs(a-o.left),n=Math.abs(a-o.right),l=Math.min(i,n);this.image.data[r+a]=Math.max(0,Math.min(255,(o.isDash?l:-l)+t+128))}}addDash(e,t){const i=this.getKey(e,t);if(this.positions[i])return this.positions[i];const n="round"===t,r=n?7:0,s=2*r+1;if(this.nextRow+s>this.height)return W("LineAtlas out of space"),null;0===e.length&&e.push(1);let o=0;for(let c=0;c<e.length;c++)e[c]<0&&(W("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),o+=e[c];if(0!==o){const i=this.width/o,s=this.getDashRanges(e,this.width,i);n?this.addRoundDash(s,i,r):this.addRegularDash(s,"square"===t?.5*i:0)}const a=this.nextRow+r;this.nextRow+=s;const l={tl:[a,r],br:[o,0]};return this.positions[i]=l,l}}Yr(cf,"LineAtlas");const uf=1*ep;class hf{constructor(e){const t={},i=[];for(const o in e){const n=e[o],r=t[o]={};for(const e in n.glyphs){const t=n.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const s=t.metrics.localGlyph?uf:1,o={x:0,y:0,w:t.bitmap.width+2*s,h:t.bitmap.height+2*s};i.push(o),r[e]=o}}const{w:n,h:r}=wd(i),s=new zc({width:n||1,height:r||1});for(const o in e){const i=e[o];for(const e in i.glyphs){const n=i.glyphs[+e];if(!n||0===n.bitmap.width||0===n.bitmap.height)continue;const r=t[o][e],a=n.metrics.localGlyph?uf:1;zc.copy(n.bitmap,s,{x:0,y:0},{x:r.x+a,y:r.y+a},n.bitmap)}}this.image=s,this.positions=t}}Yr(hf,"GlyphAtlas");class df{constructor(e){this.tileID=new mh(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Ip(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,t,i,n,r){this.status="parsing",this.data=e,this.collisionBoxArray=new po;const s=new bm(Object.keys(e.layers).sort()),o=new of(this.tileID,this.promoteId);o.bucketLayerIDs=[];const a={},l=new cf(256,256),c={featureIndex:o,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:i},u=t.familiesBySource[this.source];for(const b in u){const t=e.layers[b];if(!t)continue;let n=!1,r=!1;for(const e of u[b])"symbol"===e[0].type?n=!0:r=!0;if(!0===this.isSymbolTile&&!n)continue;if(!1===this.isSymbolTile&&!r)continue;1===t.version&&W('Vector tile source "'.concat(this.source,'" layer "').concat(b,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const l=s.encode(b),h=[];for(let e=0;e<t.length;e++){const i=t.feature(e),n=o.getId(i,b);h.push({feature:i,id:n,index:e,sourceLayerIndex:l})}for(const e of u[b]){const t=e[0];void 0!==this.isSymbolTile&&"symbol"===t.type!==this.isSymbolTile||t.minzoom&&this.zoom<Math.floor(t.minzoom)||t.maxzoom&&this.zoom>=t.maxzoom||"none"!==t.visibility&&(pf(e,this.zoom,i),(a[t.id]=t.createBucket({index:o.bucketLayerIDs.length,layers:e,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:i})).populate(h,c,this.tileID.canonical,this.tileTransform),o.bucketLayerIDs.push(e.map(e=>e.id)))}}let h,d,p,m;l.trim();const f={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=()=>{if(h)return r(h);if(d&&p&&m){const e=new hf(d),t=new Td(p,m);for(const n in a){const r=a[n];r instanceof om?(pf(r.layers,this.zoom,i),yp(r,d,e.positions,p,t.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection)):r.hasPattern&&(r instanceof Dh||r instanceof Su||r instanceof eh)&&(pf(r.layers,this.zoom,i),r.addFeatures(c,this.tileID.canonical,t.patternPositions,i,this.tileTransform))}this.status="done",r(null,{buckets:k(a).filter(e=>!e.isEmpty()),featureIndex:o,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:l,imageAtlas:t,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?e.positions:null})}},_=U(c.glyphDependencies,e=>Object.keys(e).map(Number));Object.keys(_).length?n.send("getGlyphs",{uid:this.uid,stacks:_},(e,t)=>{h||(h=e,d=t,g())},void 0,!1,f):d={};const v=Object.keys(c.iconDependencies);v.length?n.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},(e,t)=>{h||(h=e,p=t,g())},void 0,!1,f):p={};const y=Object.keys(c.patternDependencies);y.length?n.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"patterns"},(e,t)=>{h||(h=e,m=t,g())},void 0,!1,f):m={},g()}}function pf(e,t,i){const n=new xs(t);for(const r of e)r.recalculate(n,i)}class mf{constructor(e){this.entries={},this.scheduler=e}request(e,t,i,n){const r=this.entries[e]=this.entries[e]||{callbacks:[]};if(r.result){const[e,i]=r.result;return this.scheduler?this.scheduler.add(()=>{n(e,i)},t):n(e,i),()=>{}}return r.callbacks.push(n),r.cancel||(r.cancel=i((i,n)=>{r.result=[i,n];for(const e of r.callbacks)this.scheduler?this.scheduler.add(()=>{e(i,n)},t):e(i,n);setTimeout(()=>delete this.entries[e],3e3)})),()=>{r.result||(r.callbacks=r.callbacks.filter(e=>e!==n),r.callbacks.length||(r.cancel(),delete this.entries[e]))}}}function ff(e,t,i){const n=JSON.stringify(e.request);return e.data&&(this.deduped.entries[n]={result:[null,e.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},t=>{const n=de(e.request,(e,n,r,s)=>{e?t(e):n&&t(null,{vectorTile:i?void 0:new Xu(new gd(n)),rawData:n,cacheControl:r,expires:s})});return()=>{n.cancel(),t()}},t)}const gf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _f{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,i]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=i>>4;if(1!==n)throw new Error("Got v".concat(n," data when expected v1."));const r=gf[15&i];if(!r)throw new Error("Unrecognized array type.");const[s]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new _f(o,s,r,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,n=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=gf.indexOf(this.ArrayType),s=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-o%8)%8;if(r<0)throw new Error("Unexpected typed array class: ".concat(i,"."));n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+s+o+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=t,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return vf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:s,nodeSize:o}=this,a=[0,r.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const a=s[2*o],c=s[2*o+1];a>=e&&a<=i&&c>=t&&c<=n&&l.push(r[o])}continue}const d=h+u>>1,p=s[2*d],m=s[2*d+1];p>=e&&p<=i&&m>=t&&m<=n&&l.push(r[d]),(0===c?e<=p:t<=m)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?i>=p:n>=m)&&(a.push(d+1),a.push(u),a.push(1-c))}return l}within(e,t,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:r,nodeSize:s}=this,o=[0,n.length-1,0],a=[],l=i*i;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=s){for(let i=h;i<=u;i++)wf(r[2*i],r[2*i+1],e,t)<=l&&a.push(n[i]);continue}const d=h+u>>1,p=r[2*d],m=r[2*d+1];wf(p,m,e,t)<=l&&a.push(n[d]),(0===c?e-i<=p:t-i<=m)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?e+i>=p:t+i>=m)&&(o.push(d+1),o.push(u),o.push(1-c))}return a}}function vf(e,t,i,n,r,s){if(r-n<=i)return;const o=n+r>>1;yf(e,t,o,n,r,s),vf(e,t,i,n,o-1,1-s),vf(e,t,i,o+1,r,1-s)}function yf(e,t,i,n,r,s){for(;r>n;){if(r-n>600){const o=r-n+1,a=i-n+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(a-o/2<0?-1:1);yf(e,t,i,Math.max(n,Math.floor(i-a*c/o+u)),Math.min(r,Math.floor(i+(o-a)*c/o+u)),s)}const o=t[2*i+s];let a=n,l=r;for(bf(e,t,n,i),t[2*r+s]>o&&bf(e,t,n,r);a<l;){for(bf(e,t,a,l),a++,l--;t[2*a+s]<o;)a++;for(;t[2*l+s]>o;)l--}t[2*n+s]===o?bf(e,t,n,l):(l++,bf(e,t,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}}function bf(e,t,i,n){xf(e,i,n),xf(t,2*i,2*n),xf(t,2*i+1,2*n+1)}function xf(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}function wf(e,t,i,n){const r=e-i,s=t-n;return r*r+s*s}e.ARRAY_TYPE=ua,e.AUTH_ERR_MSG=ve,e.Aabb=rl,e.Actor=class{constructor(e,i,n){this.target=e,this.parent=i,this.mapId=n,this.callbacks={},this.cancelCallbacks={},z(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=q()?e:t,this.scheduler=new ym}send(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const o=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=s,this.callbacks[o]=i);const a=K(this.globalScope)?void 0:[];return this.target.postMessage({id:o,type:e,hasCallback:!!i,targetMapId:n,mustQueue:r,sourceMapId:this.mapId,data:$r(t,a)},a),{cancel:()=>{i&&delete this.callbacks[o],this.target.postMessage({id:o,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(e){const t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[i];delete this.cancelCallbacks[i],e&&e.cancel()}else if(t.mustQueue||q()){const e=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,t),e&&e.metadata||{type:"message"})}else this.processTask(i,t)}processTask(e,t){if("<response>"===t.type){const i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(Qr(t.error)):i(null,Qr(t.data)))}else{const i=K(this.globalScope)?void 0:[],n=t.hasCallback?(t,n)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?$r(t):null,data:$r(n,i)},i)}:e=>{},r=Qr(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,r,n);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],r.source)[e[1]](r,n)}else n(new Error("Could not find function ".concat(t.type)))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.CanonicalTileID=dh,e.Color=kt,e.ColorMode=Km,e.CullFaceMode=Qm,e.DEMData=Hm,e.DataConstantProperty=Is,e.DedupedRequest=mf,e.DepthMode=qm,e.EXTENT=aa,e.Elevation=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const i=t.getSource().maxzoom,n=1<<i,r=Math.floor(e.x),s=Math.floor((e.x-r)*n),o=Math.floor(e.y*n),a=this.findDEMTileFor(new mh(i,r,i,s,o));return!(!a||!a.dem)}getAtPointOrZero(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}getAtPoint(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==t&&(t=null);const n=this._source();if(!n)return t;if(e.y<0||e.y>1)return t;const r=n.getSource().maxzoom,s=1<<r,o=Math.floor(e.x),a=e.x-o,l=new mh(r,o,r,Math.floor(a*s),Math.floor(e.y*s)),c=this.findDEMTileFor(l);if(!c||!c.dem)return t;const u=c.dem,h=1<<c.tileID.canonical.z,d=(a*h-c.tileID.canonical.x)*u.dim,p=(e.y*h-c.tileID.canonical.y)*u.dim,m=Math.floor(d),f=Math.floor(p);return(i?this.exaggeration():1)*ki(ki(u.get(m,f),u.get(m,f+1),p-f),ki(u.get(m+1,f),u.get(m+1,f+1),p-f),d-m)}getAtTileOffset(e,t,i){const n=1<<e.canonical.z;return this.getAtPointOrZero(new $l(e.wrap+(e.canonical.x+t/aa)/n,(e.canonical.y+i/aa)/n))}getAtTileOffsetFunc(e,t,i,n){return r=>{const s=this.getAtTileOffset(e,r.x,r.y),o=n.upVector(e.canonical,r.x,r.y);return Ma(o,o,s*n.upVectorScale(e.canonical,t,i).metersToTile),o}}getForTilePoints(e,t,i,n){if(this.isUsingMockSource())return!1;const r=sf.create(this,e,n);return!!r&&(t.forEach(e=>{e[2]=this.exaggeration()*r.getElevationAt(e[0],e[1],i)}),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const i=t.dem.tree,n=t.tileID,r=1<<e.canonical.z-n.canonical.z;let s=e.canonical.x/r-n.canonical.x,o=e.canonical.y/r-n.canonical.y,a=0;for(let l=0;l<e.canonical.z-n.canonical.z&&!i.leaves[a];l++){s*=2,o*=2;const e=2*Math.floor(o)+Math.floor(s);a=i.childOffsets[a]+e,s%=1,o%=1}return{min:this.exaggeration()*i.minimums[a],max:this.exaggeration()*i.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},e.ErrorEvent=$e,e.EvaluationParameters=xs,e.Event=Je,e.Evented=Qe,e.FillExtrusionBucket=eh,e.Frustum=nl,e.FrustumCorners=il,e.GLOBE_RADIUS=al,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=ol,e.GLOBE_ZOOM_THRESHOLD_MIN=sl,e.GlobeSharedBuffers=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const e of this._wireframeSegments)e.destroy()}}_fillGridMeshWithLods(e,t){const i=new Us,n=new io,r=[],s=e+1+2,o=t[0]+1,a=t[0]+1+(1+t.length),l=(e,t,i)=>{let n=e===s-1?e-2:0===e?e:e-1;return n+=i?24575:0,[n,t]};for(let c=0;c<s;++c)i.emplaceBack(...l(c,0,!0));for(let c=0;c<o;++c)for(let e=0;e<s;++e)i.emplaceBack(...l(e,c,(0===e||e===s-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<s;++t)i.emplaceBack(...l(t,e,!0))}for(let c=0;c<t.length;++c){const e=n.length,o=t[c]+1+2,l=new io;for(let i=0;i<o-1;i++){const e=i===o-2,r=e?s*(a-t.length+c-i):s;for(let t=0;t<s-1;t++){const o=i*s+t;0===i||e||0===t||t===s-2?(l.emplaceBack(o+1,o,o+r),l.emplaceBack(o+r,o+r+1,o+1)):(n.emplaceBack(o+1,o,o+r),n.emplaceBack(o+r,o+r+1,o+1))}}const u=oa.simpleSegment(0,e,i.length,n.length-e);for(let t=0;t<l.uint16.length;t+=3)n.emplaceBack(l.uint16[t],l.uint16[t+1],l.uint16[t+2]);const h=oa.simpleSegment(0,e,i.length,n.length-e);r.push({withoutSkirts:u,withSkirts:h})}return{vertices:i,indices:n,segments:r}}_createGrid(e){const t=this._fillGridMeshWithLods(cl,ul);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,el.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new io;for(let r=0;r<=cl;r++)t.emplaceBack(0,r+1,r+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const i=new oo,n=new oo;this._poleSegments=[];for(let r=0,s=0;r<sl;r++){const e=360/(1<<r);i.emplaceBack(0,-al,0,.5,0),n.emplaceBack(0,-al,0,.5,1);for(let t=0;t<=cl;t++){const r=t/cl,s=ki(0,e,r),[o,a,l]=Tl(Bl,zl,s,al);i.emplaceBack(o,a,l,r,0),n.emplaceBack(o,a,l,r,1)}this._poleSegments.push(oa.simpleSegment(s,0,66,64)),s+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,$a,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(n,$a,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}getWirefameBuffers(e,t){if(!this._wireframeSegments){const t=new lo,i=cl,n=i+1+2,r=1;this._wireframeSegments=[];for(let e=0,s=0;e<ul.length;e++){const o=ul[e];for(let e=r;e<o+r;e++)for(let s=r;s<i+r;s++){const i=e*n+s;t.emplaceBack(i,i+1),t.emplaceBack(i,i+n),t.emplaceBack(i,i+n+1)}const a=o*i*3;this._wireframeSegments.push(oa.simpleSegment(0,s,(o+1)*n,a)),s+=a}this._wireframeIndexBuffer=e.createIndexBuffer(t)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},e.GlyphManager=ip,e.ImagePosition=Ad,e.KDBush=_f,e.LivePerformanceUtils=Ue,e.LngLat=Vl,e.LngLatBounds=la,e.LocalGlyphMode=tp,e.MAX_MERCATOR_LATITUDE=Kl,e.MercatorCoordinate=$l,e.ONE_EM=zh,e.OverscaledTileID=mh,e.PerformanceMarkers=Ne,e.Point=v,e.Properties=Rs,e.RGBAImage=Nc,e.Ray=tl,e.RequestManager=class{constructor(e,t,i){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",h,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(e,t){if(!ye(e))return e;const i=Te(e);return i.path="/styles/v1".concat(i.path),this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(e,t){if(!ye(e))return e;const i=Te(e);return i.path="/fonts/v1".concat(i.path),this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(e,t,i,n){if(!ye(e))return e;const r=Te(e);return r.path="/v4/".concat(r.authority,".json"),r.params.push("secure"),i&&r.params.push("language=".concat(i)),n&&r.params.push("worldview=".concat(n)),this._makeAPIURL(r,this._customAccessToken||t)}normalizeSpriteURL(e,t,i,n){const r=Te(e);return ye(e)?(r.path="/styles/v1".concat(r.path,"/sprite").concat(t).concat(i),this._makeAPIURL(r,this._customAccessToken||n)):(r.path+="".concat(t).concat(i),De(r))}normalizeTileURL(e,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!ye(e))return e;const n=Te(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(t||i&&"raster"!==n.authority&&512===i?"@2x":"").concat(s.supported?".webp":"$1")),"raster"===n.authority?n.path="/".concat(r.RASTER_URL_PREFIX).concat(n.path):(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/".concat(r.TILE_URL_VERSION).concat(n.path));const o=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(n.params)||r.ACCESS_TOKEN;return r.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&n.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(n,o)}canonicalizeTileURL(e,t){const i=Te(e);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return e;let n="mapbox://";i.path.match(/^\/raster\/v1\//)?n+="raster/".concat(i.path.replace("/".concat(r.RASTER_URL_PREFIX,"/"),"")):n+="tiles/".concat(i.path.replace("/".concat(r.TILE_URL_VERSION,"/"),""));let s=i.params;return t&&(s=s.filter(e=>!e.match(/^access_token=/))),s.length&&(n+="?".concat(s.join("&"))),n}canonicalizeTileset(e,t){const i=!!t&&ye(t),n=[];for(const r of e.tiles||[])be(r)?n.push(this.canonicalizeTileURL(r,i)):n.push(r);return n}_makeAPIURL(e,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=Te(r.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){const t=e.params.indexOf("secure");t>=0&&e.params.splice(t,1)}if("/"!==n.path&&(e.path="".concat(n.path).concat(e.path)),!r.REQUIRE_ACCESS_TOKEN)return De(e);if(t=t||r.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error("An API access token is required to use Mapbox GL. ".concat(i));if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(i))}return e.params=e.params.filter(e=>-1===e.indexOf("access_token")),e.params.push("access_token=".concat(t||"")),De(e)}},e.ResourceType=le,e.SegmentVector=oa,e.SourceCache=ef,e.StencilMode=Ym,e.StructArrayLayout1ui2=co,e.StructArrayLayout2f1f2i16=Qs,e.StructArrayLayout2i4=Us,e.StructArrayLayout2ui4=lo,e.StructArrayLayout3f12=to,e.StructArrayLayout3ui6=io,e.StructArrayLayout4i8=Vs,e.StructArrayLayout5f20=oo,e.Texture=_m,e.Tile=Mm,e.Transitionable=As,e.Uniform1f=Bo,e.Uniform1i=class extends Oo{constructor(e){super(e),this.current=0}set(e,t,i){this.fetchUniformLocation(e,t)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},e.Uniform2f=class extends Oo{constructor(e){super(e),this.current=[0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},e.Uniform3f=class extends Oo{constructor(e){super(e),this.current=[0,0,0]}set(e,t,i){this.fetchUniformLocation(e,t)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},e.Uniform4f=zo,e.UniformColor=No,e.UniformMatrix2f=class extends Oo{constructor(e){super(e),this.current=Vo}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let n=0;n<4;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},e.UniformMatrix3f=class extends Oo{constructor(e){super(e),this.current=jo}set(e,t,i){if(this.fetchUniformLocation(e,t))for(let n=0;n<9;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},e.UniformMatrix4f=class extends Oo{constructor(e){super(e),this.current=Uo}set(e,t,i){if(this.fetchUniformLocation(e,t)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},e.UnwrappedTileID=ph,e.ValidationError=ir,e.VectorTileFeature=qu,e.VectorTileWorkerSource=class extends Qe{constructor(e,t,i,n,r){super(),this.actor=e,this.layerIndex=t,this.availableImages=i,this.loadVectorData=r||ff,this.loading={},this.loaded={},this.deduped=new mf(e.scheduler),this.isSpriteLoaded=n,this.scheduler=e.scheduler}loadTile(e,t){const i=e.uid,n=e&&e.request,r=n&&n.collectResourceTiming,s=this.loading[i]=new df(e);s.abort=this.loadVectorData(e,(o,a)=>{const l=!this.loading[i];if(delete this.loading[i],l||o||!a)return s.status="done",l||(this.loaded[i]=s),t(o);const c=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl),s.vectorTile=a.vectorTile||new Xu(new gd(c));const h=()=>{s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,(e,i)=>{if(e||!i)return t(e);const s={};if(r){const e=Ge(n);e.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(e)))}t(null,M({rawTileData:c.slice(0)},i,u,s))})};this.isSpriteLoaded?h():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):h()}),this.loaded=this.loaded||{},this.loaded[i]=s})}reloadTile(e,t){const i=this.loaded,n=e.uid,r=this;if(i&&i[n]){const s=i[n];s.showCollisionBoxes=e.showCollisionBoxes,s.enableTerrain=!!e.enableTerrain,s.projection=e.projection,s.tileTransform=Ip(e.tileID.canonical,e.projection);const o=(e,i)=>{const n=s.reloadCallback;n&&(delete s.reloadCallback,s.parse(s.vectorTile,r.layerIndex,this.availableImages,r.actor,n)),t(e,i)};"parsing"===s.status?s.reloadCallback=o:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}}abortTile(e,t){const i=e.uid,n=this.loading[i];n&&(n.abort&&n.abort(),delete this.loading[i]),t()}removeTile(e,t){const i=this.loaded,n=e.uid;i&&i[n]&&delete i[n],t()}},e.WritingMode=Dd,e.ZoomDependentExpression=$n,e.add=Sa,e.addDynamicAttributes=im,e.adjoint=function(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=o*u-a*c,e[1]=r*c-n*u,e[2]=n*a-r*o,e[3]=a*l-s*u,e[4]=i*u-r*l,e[5]=r*s-i*a,e[6]=s*c-o*l,e[7]=n*l-i*c,e[8]=i*o-n*s,e},e.asyncAll=I,e.bezier=T,e.bindAll=z,e.boundsAttributes=Im,e.bufferConvexPolygon=function(e,t){const i=[];for(let n=0;n<e.length;n++){const r=P(n-1,-1,e.length-1),s=P(n+1,-1,e.length-1),o=e[n],a=e[s],l=e[r].sub(o).unit(),c=a.sub(o).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*t/Math.sin(u/2));i.push(o.add(h))}return i},e.cacheEntryPossiblyAdded=function(e){ae++,ae>ne&&(e.getActor().send("enforceCacheSizeLimit",ie),ae=0)},e.calculateGlobeLabelMatrix=function(e,t){const{x:i,y:n}=e.point,r=Ml(i,n,e.worldSize/e._pixelsPerMercatorPixel,0,0);return fa(r,r,kl(vl(t)))},e.calculateGlobeMatrix=function(e){const{x:t,y:i}=e.point,{lng:n,lat:r}=e._center;return Ml(t,i,e.worldSize,n,r)},e.calculateGlobeMercatorMatrix=function(e){const t=e.pixelsPerMeter,i=t/Xl(1,e.center.lat),n=pa(new Float64Array(16));return ga(n,n,[e.point.x,e.point.y,0]),_a(n,n,[i,i,t]),Float32Array.from(n)},e.circumferenceAtLatitude=Gl,e.clamp=S,e.clearTileCache=function(e){if(!re())return;const i=t.caches.delete(Q);e&&i.catch(e).then(()=>e())},e.clipLine=Kd,e.clone=function(e){var t=new ua(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=V,e.collisionCircleLayout=Bh,e.config=r,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new ua(16);return ua!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=ha,e.createExpression=Kn,e.createLayout=zs,e.createStyleLayer=function(e){return"custom"===e.type?new pm(e):new gm[e.type](e)},e.cross=Oa,e.degToRad=x,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},e.dot=La,e.earthRadius=Nl,e.ease=D,e.easeCubicInOut=A,e.ecefToLatLng=function(e){let[t,i,n]=e;const r=Math.hypot(t,i,n),s=Math.atan2(t,n),o=.5*Math.PI-Math.acos(-i/r);return new Vl(w(s),w(o))},e.emitValidationErrors=Gr,e.endsWith=N,e.enforceCacheSizeLimit=function(e){se(),ee&&ee.then(t=>{t.keys().then(i=>{for(let n=0;n<i.length-e;n++)t.delete(i[n])})})},e.evaluateSizeForFeature=jh,e.evaluateSizeForZoom=Vh,e.evaluateVariableOffset=vp,e.evented=_s,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=Ze,e.exported$1=s,e.extend=M,e.extend$1=tt,e.fillExtrusionHeightLift=ah,e.filterObject=j,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,l=r+r,c=i*o,u=n*o,h=n*a,d=r*o,p=r*a,m=r*l,f=s*o,g=s*a,_=s*l;return e[0]=1-h-m,e[1]=u+_,e[2]=d-g,e[3]=0,e[4]=u-_,e[5]=1-c-m,e[6]=p+f,e[7]=0,e[8]=d+g,e[9]=p-f,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var i=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=i,e[2]=0,e[3]=-i,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=ba,e.furthestTileCorner=function(e){const t=Math.round((e+45+360)%360/90)%4;return E[t]},e.getAABBPointSquareDist=function(e,t,i){let n=0;for(let r=0;r<2;++r){const s=i?i[r]:0;e[r]>s&&(n+=(e[r]-s)*(e[r]-s)),t[r]<s&&(n+=(s-t[r])*(s-t[r]))}return n},e.getAnchorAlignment=zd,e.getAnchorJustification=bp,e.getBounds=function(e){let t=1/0,i=1/0,n=-1/0,r=-1/0;for(const s of e)t=Math.min(t,s.x),i=Math.min(i,s.y),n=Math.max(n,s.x),r=Math.max(r,s.y);return{min:new v(t,i),max:new v(n,r)}},e.getColumn=$,e.getDefaultExportFromCjs=d,e.getGridMatrix=function(e,t,i,n){const r=t.getNorth(),s=t.getSouth(),o=t.getWest(),a=t.getEast(),l=1<<e.z,c=a-o,u=r-s,h=c/cl,d=-u/ul[i],p=[0,h,0,d,0,0,r,o,0];if(e.z>0){const e=180/n;da(p,p,[e/c+1,0,0,0,e/u+1,0,-.5*e/h,.5*e/d,1])}return p[2]=l,p[5]=e.x,p[8]=e.y,p},e.getImage=_e,e.getJSON=function(e,t){return he(M(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){const t=Kl-5;e=S(e,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(x(e))),3);return Math.round(i*(ul.length-1))},e.getMapSessionAPI=Be,e.getPerformanceMeasurement=Ge,e.getProjection=Jp,e.getRTLTextPluginStatus=vs,e.getReferrer=ue,e.getTilePoint=function(e,t){let{x:i,y:n}=t;return new v(((i-(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0))*e.scale-e.x)*aa,(n*e.scale-e.y)*aa)},e.getTileVec3=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Da(((t.x-i)*e.scale-e.x)*aa,(t.y*e.scale-e.y)*aa,Yl(t.z,t.y))},e.getVideo=function(e,i){const n=t.document.createElement("video");n.muted=!0,n.onloadstart=function(){i(null,n)};for(let r=0;r<e.length;r++){const i=t.document.createElement("source");pe(e[r])||(n.crossOrigin="Anonymous"),i.src=e[r],n.appendChild(i)}return{cancel:()=>{}}},e.globeCenterToScreenPoint=function(e){const t=[0,0,0],i=pa(new Float64Array(16));return fa(i,e.pixelMatrix,e.globeMatrix),Ba(t,t,i),new v(t[0],t[1])},e.globeDenormalizeECEF=kl,e.globeECEFOrigin=function(e,t){const i=[0,0,0];return Ba(i,i,Il(vl(t.canonical))),Ba(i,i,e),i},e.globeMetersToEcef=ml,e.globeNormalizeECEF=Il,e.globePixelsToTileUnits=function(e,t){return aa/(512*Math.pow(2,e))*Cl(vl(t))},e.globePoleMatrixForTile=function(e,t,i){const n=pa(new Float64Array(16)),r=(t/(1<<e)-.5)*Math.PI*2;return ya(n,i.globeMatrix,r),Float32Array.from(n)},e.globeTileBounds=vl,e.globeTiltAtLngLat=Fl,e.globeToMercatorTransition=Rl,e.globeUseCustomAntiAliasing=function(e,t,i){const n=Rl(i.zoom),r=e.style.map._antialias,s=!!t.extStandardDerivatives,o=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===n&&!r&&!o&&s},e.identity=pa,e.identity$1=qa,e.invert=ma,e.isFullscreen=function(){return!!t.document.fullscreenElement||!!t.document.webkitFullscreenElement},e.isLngLatBehindGlobe=Ll,e.isMapAuthenticated=function(e){return ze.has(e)},e.isMapboxURL=ye,e.isSafariWithAntialiasingBug=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!K(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=Zl,e.latLngToECEF=Dl,e.len=Va,e.length=Ta,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.lngFromMercatorX=ql,e.loadVectorTile=ff,e.makeRequest=he,e.mapValue=function(e,t,i,n,r){return S((e-t)/(i-t)*(r-n)+n,n,r)},e.mercatorScale=Jl,e.mercatorXfromLng=Wl,e.mercatorYfromLat=Hl,e.mercatorZfromAltitude=Xl,e.mul=wa,e.mul$1=ja,e.multiply=fa,e.multiply$1=da,e.multiply$2=Pa,e.nextPowerOfTwo=O,e.normalize=Fa,e.normalize$1=Ka,e.normalize$2=Wa,e.number=ki,e.ortho=function(e,t,i,n,r,s,o){var a=1/(t-i),l=1/(n-r),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(r+n)*l,e[14]=(o+s)*c,e[15]=1,e},e.pbf=Zh,e.perspective=function(e,t,i,n,r){var s,o=1/Math.tan(t/2);return e[0]=o/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+n)*(s=1/(n-r)),e[14]=2*r*n*s):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){const i={};for(let n=0;n<t.length;n++){const r=t[n];r in e&&(i[r]=e[r])}return i},e.plugin=bs,e.pointGeometry=g,e.polesInViewport=function(e){const t=pa(new Float64Array(16));fa(t,e.pixelMatrix,e.globeMatrix);const i=[0,hl,0],n=[0,dl,0];return Ba(i,i,t),Ba(n,n,t),[i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!Ll(e,new Vl(e.center.lat,90)),n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!Ll(e,new Vl(e.center.lat,-90))]},e.polygonContainsPoint=bc,e.polygonIntersectsBox=xc,e.polygonIntersectsPolygon=hc,e.polygonizeBounds=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=new v(i,i),s=e.sub(r),o=t.add(r),a=[s,new v(o.x,s.y),o,new v(s.x,o.y)];return n&&a.push(s.clone()),a},e.posAttributes=el,e.postMapLoadEvent=Re,e.postPerformanceEvent=Le,e.postTurnstileEvent=ke,e.potpack=wd,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=w,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:ps,pluginURL:ms}),_s.on("pluginStateChange",e),e},e.removeAuthState=function(e){ze.delete(e)},e.renderColorRamp=jc,e.resample=ec,e.rotateX=va,e.rotateX$1=Za,e.rotateY=ya,e.rotateY$1=Ya,e.rotateZ=function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*n,e[1]=o*r+u*n,e[2]=a*r+h*n,e[3]=l*r+d*n,e[4]=c*r-s*n,e[5]=u*r-o*n,e[6]=h*r-a*n,e[7]=d*r-l*n,e},e.rotateZ$1=function(e,t,i){i*=.5;var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=n*l+r*a,e[1]=r*l-n*a,e[2]=s*l+o*a,e[3]=o*l-s*a,e},e.scale=_a,e.scale$1=Ga,e.scale$2=Ma,e.scaleAndAdd=Ra,e.set=function(e,t,i,n){return e[0]=t,e[1]=i,e[2]=n,e},e.setCacheLimits=function(e,t){ie=e,ne=t},e.setColumn=function(e,t,i){e[4*t+0]=i[0],e[4*t+1]=i[1],e[4*t+2]=i[2],e[4*t+3]=i[3]},e.setRTLTextPlugin=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ps===cs||ps===us||ps===hs)throw new Error("setRTLTextPlugin cannot be called multiple times.");ms=Ze.resolveURL(e),ps=cs,ds=t,gs(),i||ys()},e.smoothstep=C,e.spec=et,e.squaredLength=function(e){var t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n},e.storeAuthState=function(e,t){t?ze.add(e):ze.delete(e)},e.sub=Ua,e.subtract=Ca,e.symbolSize=Gh,e.tileAABB=function(e,t,i,n,r,s,o,a,l){if("globe"===l.name)return wl(e,t,new dh(i,n,r));const c=Ip({z:i,x:n,y:r},l);return new rl([(s+c.x/c.scale)*t,t*(c.y/c.scale),o],[(s+c.x2/c.scale)*t,t*(c.y2/c.scale),a])},e.tileCornersToBounds=El,e.tileTransform=Ip,e.transformMat3=function(e,t,i){var n=t[0],r=t[1],s=t[2];return e[0]=n*i[0]+r*i[3]+s*i[6],e[1]=n*i[1]+r*i[4]+s*i[7],e[2]=n*i[2]+r*i[5]+s*i[8],e},e.transformMat4=Ba,e.transformMat4$1=Ha,e.transformQuat=za,e.transitionTileAABBinECEF=bl,e.translate=ga,e.transpose=function(e,t){if(e===t){var i=t[1],n=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=n,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=fs,e.uniqueId=F,e.updateGlobeVertexNormal=function(e,t,i,n,r){const s=5*t+2;e.float32[s+0]=i,e.float32[s+1]=n,e.float32[s+2]=r},e.validateCustomStyleLayer=function(e){const t=[],i=e.id;return void 0===i&&t.push({message:"layers.".concat(i,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(i,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(i,': property "renderingMode" must be either "2d" or "3d"')}),t},e.validateFilter=e=>Vr(Er(e)),e.validateFog=e=>Vr(Lr(e)),e.validateLayer=e=>Vr(Cr(e)),e.validateLight=e=>Vr(Rr(e)),e.validateSource=e=>Vr(kr(e)),e.validateStyle=Nr,e.validateTerrain=e=>Vr(Fr(e)),e.values=k,e.vectorTile=Fu,e.version=i,e.warnOnce=W,e.window=t,e.wrap=P}),n(["./shared"],function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let i="[";for(const n of e)i+="".concat(t(n),",");return"".concat(i,"]")}let i="{";for(const n of Object.keys(e).sort())i+="".concat(n,":").concat(t(e[n]),",");return"".concat(i,"}")}function i(i){let n="";for(const r of e.refProperties)n+="/".concat(t(i[r]));return n}class n{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const i of t)this._layerConfigs[i.id]=i,(this._layers[i.id]=e.createStyleLayer(i)).compileFilter(),this.keyCache[i.id]&&delete this.keyCache[i.id];for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const r=function(e,t){const n={};for(let s=0;s<e.length;s++){const r=t&&t[e[s].id]||i(e[s]);t&&(t[e[s].id]=r);let o=n[r];o||(o=n[r]=[]),o.push(e[s])}const r=[];for(const i in n)r.push(n[i]);return r}(e.values(this._layerConfigs),this.keyCache);for(const e of r){const t=e.map(e=>this._layers[e.id]),i=t[0];if("none"===i.visibility)continue;const n=i.source||"";let r=this.familiesBySource[n];r||(r=this.familiesBySource[n]={});const s=i.sourceLayer||"_geojsonTileLayer";let o=r[s];o||(o=r[s]=[]),o.push(t)}}}class r{loadTile(t,i){const{uid:n,encoding:r,rawImageData:s,padding:o,buildQuadTree:a}=t,l=e.window.ImageBitmap&&s instanceof e.window.ImageBitmap?this.getImageData(s,o):s;i(null,new e.DEMData(n,l,r,o<1,a))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const i=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),i}}function s(e,t){if(0!==e.length){o(e[0],t);for(var i=1;i<e.length;i++)o(e[i],!t)}}function o(e,t){for(var i=0,n=0,r=0,s=e.length,o=s-1;r<s;o=r++){var a=(e[r][0]-e[o][0])*(e[o][1]+e[r][1]),l=i+a;n+=Math.abs(i)>=Math.abs(a)?i-l+a:a-l+i,i=l}i+n>=0!=!!t&&e.reverse()}var a=e.getDefaultExportFromCjs(function e(t,i){var n,r=t&&t.type;if("FeatureCollection"===r)for(n=0;n<t.features.length;n++)e(t.features[n],i);else if("GeometryCollection"===r)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],i);else if("Feature"===r)e(t.geometry,i);else if("Polygon"===r)s(t.coordinates,i);else if("MultiPolygon"===r)for(n=0;n<t.coordinates.length;n++)s(t.coordinates[n],i);return t});const l=e.VectorTileFeature.prototype.toGeoJSON;var c={exports:{}},u=e.pointGeometry,h=e.vectorTile.VectorTileFeature,d=p;function p(e,t){this.options=t||{},this.features=e,this.length=e.length}function m(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}p.prototype.feature=function(e){return new m(this.features[e],this.options.extent)},m.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var i=e[t],n=[],r=0;r<i.length;r++)n.push(new u(i[r][0],i[r][1]));this.geometry.push(n)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,i=-1/0,n=1/0,r=-1/0,s=0;s<e.length;s++)for(var o=e[s],a=0;a<o.length;a++){var l=o[a];t=Math.min(t,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),r=Math.max(r,l.y)}return[t,n,i,r]},m.prototype.toGeoJSON=h.prototype.toGeoJSON;var f=e.pbf,g=d;function _(e){var t=new f;return function(e,t){for(var i in e.layers)t.writeMessage(3,v,e.layers[i])}(e,t),t.finish()}function v(e,t){var i;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<e.length;i++)n.feature=e.feature(i),t.writeMessage(2,y,n);var r=n.keys;for(i=0;i<r.length;i++)t.writeStringField(3,r[i]);var s=n.values;for(i=0;i<s.length;i++)t.writeMessage(4,A,s[i])}function y(e,t){var i=e.feature;void 0!==i.id&&t.writeVarintField(1,i.id),t.writeMessage(2,b,e),t.writeVarintField(3,i.type),t.writeMessage(4,E,i)}function b(e,t){var i=e.feature,n=e.keys,r=e.values,s=e.keycache,o=e.valuecache;for(var a in i.properties){var l=i.properties[a],c=s[a];if(null!==l){void 0===c&&(n.push(a),s[a]=c=n.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=o[h];void 0===d&&(r.push(l),o[h]=d=r.length-1),t.writeVarint(d)}}}function x(e,t){return(t<<3)+(7&e)}function w(e){return e<<1^e>>31}function E(e,t){for(var i=e.loadGeometry(),n=e.type,r=0,s=0,o=i.length,a=0;a<o;a++){var l=i[a],c=1;1===n&&(c=l.length),t.writeVarint(x(1,c));for(var u=3===n?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==n&&t.writeVarint(x(2,u-1));var d=l[h].x-r,p=l[h].y-s;t.writeVarint(w(d)),t.writeVarint(w(p)),r+=d,s+=p}3===n&&t.writeVarint(x(7,1))}}function A(e,t){var i=typeof e;"string"===i?t.writeStringField(1,e):"boolean"===i?t.writeBooleanField(7,e):"number"===i&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}c.exports=_,c.exports.fromVectorTileJs=_,c.exports.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var n in e)i[n]=new g(e[n].features,t),i[n].name=n,i[n].version=t.version,i[n].extent=t.extent;return _({layers:i})},c.exports.GeoJSONWrapper=g;var T=e.getDefaultExportFromCjs(c.exports);const D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},S=Math.fround||(C=new Float32Array(1),e=>(C[0]=+e,C[0]));var C;const P=3,I=5,k=6;class M{constructor(e){this.options=Object.assign(Object.create(D),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:i,maxZoom:n}=this.options;t&&console.time("total time");const r="prepare ".concat(e.length," points");t&&console.time(r),this.points=e;const s=[];for(let a=0;a<e.length;a++){const t=e[a];if(!t.geometry)continue;const[i,n]=t.geometry.coordinates,r=S(L(i)),o=S(O(n));s.push(r,o,1/0,a,-1,1),this.options.reduce&&s.push(0)}let o=this.trees[n+1]=this._createTree(s);t&&console.timeEnd(r);for(let a=n;a>=i;a--){const e=+Date.now();o=this.trees[a]=this._createTree(this._cluster(o,a)),t&&console.log("z%d: %d clusters in %dms",a,o.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let i=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,r=180;else if(i>r){const e=this.getClusters([i,n,180,s],t),o=this.getClusters([-180,n,r,s],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],a=o.range(L(i),O(s),L(r),O(n)),l=o.data,c=[];for(const u of a){const e=this.stride*u;c.push(l[e+I]>1?R(l,e,this.clusterProps):this.points[l[e+P]])}return c}getChildren(e){const t=this._getOriginId(e),i=this._getOriginZoom(e),n="No cluster with the specified id.",r=this.trees[i];if(!r)throw new Error(n);const s=r.data;if(t*this.stride>=s.length)throw new Error(n);const o=this.options.radius/(this.options.extent*Math.pow(2,i-1)),a=r.within(s[t*this.stride],s[t*this.stride+1],o),l=[];for(const c of a){const t=c*this.stride;s[t+4]===e&&l.push(s[t+I]>1?R(s,t,this.clusterProps):this.points[s[t+P]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,i){const n=[];return this._appendLeaves(n,e,t=t||10,i=i||0,0),n}getTile(e,t,i){const n=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:s,radius:o}=this.options,a=o/s,l=(i-a)/r,c=(i+1+a)/r,u={features:[]};return this._addTileFeatures(n.range((t-a)/r,l,(t+1+a)/r,c),n.data,t,i,r,u),0===t&&this._addTileFeatures(n.range(1-a/r,l,1,c),n.data,r,i,r,u),t===r-1&&this._addTileFeatures(n.range(0,l,a/r,c),n.data,-1,i,r,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}_appendLeaves(e,t,i,n,r){const s=this.getChildren(t);for(const o of s){const t=o.properties;if(t&&t.cluster?r+t.point_count<=n?r+=t.point_count:r=this._appendLeaves(e,t.cluster_id,i,n,r):r<n?r++:e.push(o),e.length===i)break}return r}_createTree(t){const i=new e.KDBush(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)i.add(t[e],t[e+1]);return i.finish(),i.data=t,i}_addTileFeatures(e,t,i,n,r,s){for(const o of e){const e=o*this.stride,a=t[e+I]>1;let l,c,u;if(a)l=F(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const i=this.points[t[e+P]];l=i.properties;const[n,r]=i.geometry.coordinates;c=L(n),u=O(r)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-i)),Math.round(this.options.extent*(u*r-n))]],tags:l};let d;d=a||this.options.generateId?t[e+P]:this.points[t[e+P]].id,void 0!==d&&(h.id=d),s.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:i,extent:n,reduce:r,minPoints:s}=this.options,o=i/(n*Math.pow(2,t)),a=e.data,l=[],c=this.stride;for(let u=0;u<a.length;u+=c){if(a[u+2]<=t)continue;a[u+2]=t;const i=a[u],n=a[u+1],h=e.within(a[u],a[u+1],o),d=a[u+I];let p=d;for(const e of h){const i=e*c;a[i+2]>t&&(p+=a[i+I])}if(p>d&&p>=s){let e,s=i*d,o=n*d,m=-1;const f=(u/c<<5)+(t+1)+this.points.length;for(const i of h){const n=i*c;if(a[n+2]<=t)continue;a[n+2]=t;const l=a[n+I];s+=a[n]*l,o+=a[n+1]*l,a[n+4]=f,r&&(e||(e=this._map(a,u,!0),m=this.clusterProps.length,this.clusterProps.push(e)),r(e,this._map(a,n)))}a[u+4]=f,l.push(s/p,o/p,1/0,f,-1,p),r&&l.push(m)}else{for(let e=0;e<c;e++)l.push(a[u+e]);if(p>1)for(const e of h){const i=e*c;if(!(a[i+2]<=t)){a[i+2]=t;for(let e=0;e<c;e++)l.push(a[i+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,i){if(e[t+I]>1){const n=this.clusterProps[e[t+k]];return i?Object.assign({},n):n}const n=this.points[e[t+P]].properties,r=this.options.map(n);return i&&r===n?Object.assign({},r):r}}function R(e,t,i){return{type:"Feature",id:e[t+P],properties:F(e,t,i),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),B(e[t+1])]}};var n}function F(e,t,i){const n=e[t+I],r=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?Math.round(n/100)/10+"k":n,s=e[t+k],o=-1===s?{}:Object.assign({},i[s]);return Object.assign(o,{cluster:!0,cluster_id:e[t+P],point_count:n,point_count_abbreviated:r})}function L(e){return e/360+.5}function O(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function B(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function z(e,t,i,n){for(var r,s=n,o=i-t>>1,a=i-t,l=e[t],c=e[t+1],u=e[i],h=e[i+1],d=t+3;d<i;d+=3){var p=N(e[d],e[d+1],l,c,u,h);if(p>s)r=d,s=p;else if(p===s){var m=Math.abs(d-o);m<a&&(r=d,a=m)}}s>n&&(r-t>3&&z(e,t,r,n),e[r+2]=s,i-r>3&&z(e,r,i,n))}function N(e,t,i,n,r,s){var o=r-i,a=s-n;if(0!==o||0!==a){var l=((e-i)*o+(t-n)*a)/(o*o+a*a);l>1?(i=r,n=s):l>0&&(i+=o*l,n+=a*l)}return(o=e-i)*o+(a=t-n)*a}function U(e,t,i,n){var r={id:void 0===e?null:e,type:t,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)j(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<t.length;n++)j(e,t[n]);else if("MultiPolygon"===i)for(n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)j(e,t[n][r])}(r),r}function j(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}function V(e,t,i,n){if(t.geometry){var r=t.geometry.coordinates,s=t.geometry.type,o=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),a=[],l=t.id;if(i.promoteId?l=t.properties[i.promoteId]:i.generateId&&(l=n||0),"Point"===s)G(r,a);else if("MultiPoint"===s)for(var c=0;c<r.length;c++)G(r[c],a);else if("LineString"===s)W(r,a,o,!1);else if("MultiLineString"===s){if(i.lineMetrics){for(c=0;c<r.length;c++)W(r[c],a=[],o,!1),e.push(U(l,"LineString",a,t.properties));return}H(r,a,o,!1)}else if("Polygon"===s)H(r,a,o,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(c=0;c<t.geometry.geometries.length;c++)V(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];H(r[c],u,o,!0),a.push(u)}}e.push(U(l,s,a,t.properties))}}function G(e,t){t.push(X(e[0])),t.push(q(e[1])),t.push(0)}function W(e,t,i,n){for(var r,s,o=0,a=0;a<e.length;a++){var l=X(e[a][0]),c=q(e[a][1]);t.push(l),t.push(c),t.push(0),a>0&&(o+=n?(r*c-l*s)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-s,2))),r=l,s=c}var u=t.length-3;t[2]=1,z(t,0,u,i),t[u+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function H(e,t,i,n){for(var r=0;r<e.length;r++){var s=[];W(e[r],s,i,n),t.push(s)}}function X(e){return e/360+.5}function q(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function Z(e,t,i,n,r,s,o,a){if(n/=t,s>=(i/=t)&&o<n)return e;if(o<i||s>=n)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,m=0===r?u.maxX:u.maxY;if(p>=i&&m<n)l.push(u);else if(!(m<i||p>=n)){var f=[];if("Point"===d||"MultiPoint"===d)Y(h,f,i,n,r);else if("LineString"===d)K(h,f,i,n,r,!1,a.lineMetrics);else if("MultiLineString"===d)$(h,f,i,n,r,!1);else if("Polygon"===d)$(h,f,i,n,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var _=[];$(h[g],_,i,n,r,!0),_.length&&f.push(_)}if(f.length){if(a.lineMetrics&&"LineString"===d){for(g=0;g<f.length;g++)l.push(U(u.id,d,f[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===f.length?(d="LineString",f=f[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===f.length?"Point":"MultiPoint"),l.push(U(u.id,d,f,u.tags))}}}return l.length?l:null}function Y(e,t,i,n,r){for(var s=0;s<e.length;s+=3){var o=e[s+r];o>=i&&o<=n&&(t.push(e[s]),t.push(e[s+1]),t.push(e[s+2]))}}function K(e,t,i,n,r,s,o){for(var a,l,c=J(e),u=0===r?ee:te,h=e.start,d=0;d<e.length-3;d+=3){var p=e[d],m=e[d+1],f=e[d+2],g=e[d+3],_=e[d+4],v=0===r?p:m,y=0===r?g:_,b=!1;o&&(a=Math.sqrt(Math.pow(p-g,2)+Math.pow(m-_,2))),v<i?y>i&&(l=u(c,p,m,g,_,i),o&&(c.start=h+a*l)):v>n?y<n&&(l=u(c,p,m,g,_,n),o&&(c.start=h+a*l)):Q(c,p,m,f),y<i&&v>=i&&(l=u(c,p,m,g,_,i),b=!0),y>n&&v<=n&&(l=u(c,p,m,g,_,n),b=!0),!s&&b&&(o&&(c.end=h+a*l),t.push(c),c=J(e)),o&&(h+=a)}var x=e.length-3;p=e[x],m=e[x+1],f=e[x+2],(v=0===r?p:m)>=i&&v<=n&&Q(c,p,m,f),x=c.length-3,s&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&Q(c,c[0],c[1],c[2]),c.length&&t.push(c)}function J(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function $(e,t,i,n,r,s){for(var o=0;o<e.length;o++)K(e[o],t,i,n,r,s,!1)}function Q(e,t,i,n){e.push(t),e.push(i),e.push(n)}function ee(e,t,i,n,r,s){var o=(s-t)/(n-t);return e.push(s),e.push(i+(r-i)*o),e.push(1),o}function te(e,t,i,n,r,s){var o=(s-i)/(r-i);return e.push(t+(n-t)*o),e.push(s),e.push(1),o}function ie(e,t){for(var i=[],n=0;n<e.length;n++){var r,s=e[n],o=s.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=ne(s.geometry,t);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var a=0;a<s.geometry.length;a++)r.push(ne(s.geometry[a],t))}else if("MultiPolygon"===o)for(r=[],a=0;a<s.geometry.length;a++){for(var l=[],c=0;c<s.geometry[a].length;c++)l.push(ne(s.geometry[a][c],t));r.push(l)}i.push(U(s.id,o,r,s.tags))}return i}function ne(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var n=0;n<e.length;n+=3)i.push(e[n]+t,e[n+1],e[n+2]);return i}function re(e,t){if(e.transformed)return e;var i,n,r,s=1<<e.z,o=e.x,a=e.y;for(i=0;i<e.features.length;i++){var l=e.features[i],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(n=0;n<c.length;n+=2)l.geometry.push(se(c[n],c[n+1],t,s,o,a));else for(n=0;n<c.length;n++){var h=[];for(r=0;r<c[n].length;r+=2)h.push(se(c[n][r],c[n][r+1],t,s,o,a));l.geometry.push(h)}}return e.transformed=!0,e}function se(e,t,i,n,r,s){return[Math.round(i*(e*n-r)),Math.round(i*(t*n-s))]}function oe(e,t,i,n,r){for(var s=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){o.numFeatures++,ae(o,e[a],s,r);var l=e[a].minX,c=e[a].minY,u=e[a].maxX,h=e[a].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),u>o.maxX&&(o.maxX=u),h>o.maxY&&(o.maxY=h)}return o}function ae(e,t,i,n){var r=t.geometry,s=t.type,o=[];if("Point"===s||"MultiPoint"===s)for(var a=0;a<r.length;a+=3)o.push(r[a]),o.push(r[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===s)le(o,r,e,i,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(a=0;a<r.length;a++)le(o,r[a],e,i,"Polygon"===s,0===a);else if("MultiPolygon"===s)for(var l=0;l<r.length;l++){var c=r[l];for(a=0;a<c.length;a++)le(o,c[a],e,i,!0,0===a)}if(o.length){var u=t.tags||null;if("LineString"===s&&n.lineMetrics){for(var h in u={},t.tags)u[h]=t.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:u};null!==t.id&&(d.id=t.id),e.features.push(d)}}function le(e,t,i,n,r,s){var o=n*n;if(n>0&&t.size<(r?o:n))i.numPoints+=t.length/3;else{for(var a=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>o)&&(i.numSimplified++,a.push(t[l]),a.push(t[l+1])),i.numPoints++;r&&function(e,t){for(var i=0,n=0,r=e.length,s=r-2;n<r;s=n,n+=2)i+=(e[n]-e[s])*(e[n+1]+e[s+1]);if(i>0===t)for(n=0,r=e.length;n<r/2;n+=2){var o=e[n],a=e[n+1];e[n]=e[r-2-n],e[n+1]=e[r-1-n],e[r-2-n]=o,e[r-1-n]=a}}(a,s),e.push(a)}}function ce(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var i=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)V(i,e.features[n],t,n);else V(i,"Feature"===e.type?e:{geometry:e},t);return i}(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){var i=t.buffer/t.extent,n=e,r=Z(e,1,-1-i,i,0,-1,2,t),s=Z(e,1,1-i,2+i,0,-1,2,t);return(r||s)&&(n=Z(e,1,-i,1+i,0,-1,2,t)||[],r&&(n=ie(r,1).concat(n)),s&&(n=n.concat(ie(s,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ue(e,t,i){return 32*((1<<e)*i+t)+e}function he(t,i){const n=t.tileID.canonical;if(!this._geoJSONIndex)return i(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return i(null,null);const s=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const i of this._feature.geometry)t.push([new e.Point(i[0],i[1])]);return t}{const t=[];for(const i of this._feature.geometry){const n=[];for(const t of i)n.push(new e.Point(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,i){return l.call(this,e,t,i)}}(this._features[t])}}(r.features);let o=T(s);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),i(null,{vectorTile:s,rawData:o.buffer})}ce.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ce.prototype.splitTile=function(e,t,i,n,r,s,o){for(var a=[e,t,i,n],l=this.options,c=l.debug;a.length;){n=a.pop(),i=a.pop(),t=a.pop(),e=a.pop();var u=1<<t,h=ue(t,i,n),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=oe(e,t,i,n,l),this.tileCoords.push({z:t,x:i,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,r){if(t===l.maxZoom||t===r)continue;var m=1<<r-t;if(i!==Math.floor(s/m)||n!==Math.floor(o/m))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){c>1&&console.time("clipping");var f,g,_,v,y,b,x=.5*l.buffer/l.extent,w=.5-x,E=.5+x,A=1+x;f=g=_=v=null,y=Z(e,u,i-x,i+E,0,d.minX,d.maxX,l),b=Z(e,u,i+w,i+A,0,d.minX,d.maxX,l),e=null,y&&(f=Z(y,u,n-x,n+E,1,d.minY,d.maxY,l),g=Z(y,u,n+w,n+A,1,d.minY,d.maxY,l),y=null),b&&(_=Z(b,u,n-x,n+E,1,d.minY,d.maxY,l),v=Z(b,u,n+w,n+A,1,d.minY,d.maxY,l),b=null),c>1&&console.timeEnd("clipping"),a.push(f||[],t+1,2*i,2*n),a.push(g||[],t+1,2*i,2*n+1),a.push(_||[],t+1,2*i+1,2*n),a.push(v||[],t+1,2*i+1,2*n+1)}}},ce.prototype.getTile=function(e,t,i){var n=this.options,r=n.extent,s=n.debug;if(e<0||e>24)return null;var o=1<<e,a=ue(e,t=(t%o+o)%o,i);if(this.tiles[a])return re(this.tiles[a],r);s>1&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var l,c=e,u=t,h=i;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[ue(c,u,h)];return l&&l.source?(s>1&&console.log("found parent tile z%d-%d-%d",c,u,h),s>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,e,t,i),s>1&&console.timeEnd("drilling down"),this.tiles[a]?re(this.tiles[a],r):null):null};class de extends e.VectorTileWorkerSource{constructor(e,t,i,n,r){super(e,t,i,n,he),r&&(this.loadGeoJSON=r)}loadData(t,i){const n=t&&t.request,r=n&&n.collectResourceTiming;this.loadGeoJSON(t,(s,o)=>{if(s||!o)return i(s);if("object"!=typeof o)return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));{a(o,!0);try{if(t.filter){const i=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw new Error(i.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));const n=o.features.filter(e=>i.value.evaluate({zoom:0},e));o={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new M(function(t){let{superclusterOptions:i,clusterProperties:n}=t;if(!n||!i)return i;const r={},s={},o={accumulated:null,zoom:0},a={properties:null},l=Object.keys(n);for(const c of l){const[t,i]=n[c],o=e.createExpression(i),a=e.createExpression("string"==typeof t?[t,["accumulated"],["get",c]]:t);r[c]=o.value,s[c]=a.value}return i.map=e=>{a.properties=e;const t={};for(const i of l)t[i]=r[i].evaluate(o,a);return t},i.reduce=(e,t)=>{a.properties=t;for(const i of l)o.accumulated=e[i],e[i]=s[i].evaluate(o,a)},i}(t)).load(o.features):function(e,t){return new ce(e,t)}(o,t.geojsonVtOptions)}catch(s){return i(s)}this.loaded={};const l={};if(r){const i=e.getPerformanceMeasurement(n);i&&(l.resourceTiming={},l.resourceTiming[t.source]=JSON.parse(JSON.stringify(i)))}i(null,l)}})}reloadTile(e,t){const i=this.loaded;return i&&i[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,i){if(t.request)e.getJSON(t.request,i);else{if("string"!=typeof t.data)return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));try{return i(null,JSON.parse(t.data))}catch(e){return i(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class pe{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:de},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,i){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],i()}checkIfReady(e,t,i){i()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,i){this.isSpriteLoaded[t]=i;for(const n in this.workerSources[t]){const r=this.workerSources[t][n];for(const t in r)r[t]instanceof e.VectorTileWorkerSource&&(r[t].isSpriteLoaded=i,r[t].fire(new e.Event("isSpriteLoaded")))}}setImages(e,t,i){this.availableImages[e]=t;for(const n in this.workerSources[e]){const i=this.workerSources[e][n];for(const e in i)i[e].availableImages=t}i()}enableTerrain(e,t,i){this.terrain=t,i()}setProjection(t,i){this.projections[t]=e.getProjection(i)}setLayers(e,t,i){this.getLayerIndex(e).replace(t),i()}updateLayers(e,t,i){this.getLayerIndex(e).update(t.layers,t.removedIds),i()}loadTile(t,i,n){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).loadTile(r,n)}loadDEMTile(t,i,n){const r=this.enableTerrain?e.extend({buildQuadTree:this.terrain},i):i;this.getDEMWorkerSource(t,i.source).loadTile(r,n)}reloadTile(t,i,n){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},i):i;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,i.type,i.source).reloadTile(r,n)}abortTile(e,t,i){this.getWorkerSource(e,t.type,t.source).abortTile(t,i)}removeTile(e,t,i){this.getWorkerSource(e,t.type,t.source).removeTile(t,i)}removeSource(e,t,i){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,i):i()}loadWorkerSource(e,t,i){try{this.self.importScripts(t.url),i()}catch(e){i(e.toString())}}syncRTLPluginState(t,i,n){try{e.plugin.setState(i);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const i=e.plugin.isParsed();n(i?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(t)),i)}}catch(e){n(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}getWorkerSource(e,t,i){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][i]){const n={send:(t,i,n,r,s,o)=>{this.actor.send(t,i,n,e,s,o)},scheduler:this.actor.scheduler};this.workerSources[e][t][i]=new this.workerSourceTypes[t](n,this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])}return this.workerSources[e][t][i]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new r),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,i){e.enforceCacheSizeLimit(i)}getWorkerPerformanceMetrics(e,t,i){i(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new pe(self)),pe}),n(["./shared"],function(e){function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let n=0;n<e.length;n++)if(!t(e[n],i[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const n in e)if(!t(e[n],i[n]))return!1;return!0}return e===i}var i=n;function n(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,i=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(i);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var i=t.getImageData(0,0,1,1);return i&&i.width===e.width}()?(void 0===r[t=e&&e.failIfMajorPerformanceCaveat]&&(r[t]=function(e){var t,i=function(e){var t=document.createElement("canvas"),i=Object.create(n.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=e,t.getContext("webgl",i)||t.getContext("experimental-webgl",i)}(e);if(!i)return!1;try{t=i.createShader(i.VERTEX_SHADER)}catch(e){return!1}return!(!t||i.isContextLost())&&(i.shaderSource(t,"void main() {}"),i.compileShader(t),!0===i.getShaderParameter(t,i.COMPILE_STATUS))}(t)),r[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var r={};function s(t,i,n){const r=e.window.document.createElement(t);return void 0!==i&&(r.className=i),n&&n.appendChild(r),r}function o(t,i,n){const r=e.window.document.createElementNS("http://www.w3.org/2000/svg",t);for(const e of Object.keys(i))r.setAttributeNS(null,e,i[e]);return n&&n.appendChild(r),r}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const a=e.window.document&&e.window.document.documentElement.style,l=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let c;function u(){a&&l&&(c=a[l],a[l]="none")}function h(){a&&l&&(a[l]=c)}function d(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",d,!0)}function p(){e.window.addEventListener("click",d,!0),e.window.setTimeout(()=>{e.window.removeEventListener("click",d,!0)},0)}function m(e,t){const i=e.getBoundingClientRect();return _(e,i,t)}function f(e,t){const i=e.getBoundingClientRect(),n=[];for(let r=0;r<t.length;r++)n.push(_(e,i,t[r]));return n}function g(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function _(t,i,n){const r=t.offsetWidth===i.width?1:t.offsetWidth/i.width;return new e.Point((n.clientX-i.left)*r,(n.clientY-i.top)*r)}function v(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=i*s-r*n;return o?(e[0]=s*(o=1/o),e[1]=-n*o,e[2]=-r*o,e[3]=i*o,e):null}function y(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class b extends e.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}hasImage(e){return!!this.getImage(e)}getImage(e){return this.images[e]}addImage(e,t){this._validate(e,t)&&(this.images[e]=t)}_validate(t,i){let n=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),n=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),n=!1),this._validateContent(i.content,i)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "content" value')))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let i=0;for(const n of e){if(n[0]<i||n[1]<n[0]||t<n[1])return!1;i=n[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let i=!0;if(!this.isLoaded())for(const n of e)this.images[n]||(i=!1);this.isLoaded()||i?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,i){const n={};for(const r of t){this.images[r]||this.fire(new e.Event("styleimagemissing",{id:r}));const t=this.images[r];t?n[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.warnOnce('Image "'.concat(r,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}i(null,n)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const i=this.patterns[t],n=this.getImage(t);if(!n)return null;if(i&&i.position.version===n.version)return i.position;if(i)i.position.version=n.version;else{const i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},r=new e.ImagePosition(i,n);this.patterns[t]={bin:i,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const i=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,i.RGBA),this.atlasTexture&&this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:i,h:n}=e.potpack(t),r=this.atlasImage;r.resize({width:i||1,height:n||1});for(const s in this.patterns){const{bin:t}=this.patterns[s],i=t.x+1,n=t.y+1,o=this.images[s].data,a=o.width,l=o.height;e.RGBAImage.copy(o,r,{x:0,y:0},{x:i,y:n},{width:a,height:l}),e.RGBAImage.copy(o,r,{x:0,y:l-1},{x:i,y:n-1},{width:a,height:1}),e.RGBAImage.copy(o,r,{x:0,y:0},{x:i,y:n+l},{width:a,height:1}),e.RGBAImage.copy(o,r,{x:a-1,y:0},{x:i-1,y:n},{width:1,height:l}),e.RGBAImage.copy(o,r,{x:0,y:0},{x:i+a,y:n},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;const e=this.images[t];y(e)&&this.updateImage(t,e)}}}const x=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new class{constructor(){this.specification=e.spec.light.position}possiblyEvaluate(t,i){return function(t){let[i,n,r]=t;const s=e.degToRad(n+90),o=e.degToRad(r);return{x:i*Math.cos(s)*Math.sin(o),y:i*Math.sin(s)*Math.sin(o),z:i*Math.cos(o),azimuthal:n,polar:r}}(t.expression.evaluate(i))}interpolate(t,i,n){return{x:e.number(t.x,i.x,n),y:e.number(t.y,i.y,n),z:e.number(t.z,i.z,n),azimuthal:e.number(t.azimuthal,i.azimuthal,n),polar:e.number(t.polar,i.polar,n)}}},color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)});class w extends e.Evented{constructor(t){super(),this._transitionable=new e.Transitionable(x),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateLight,t,i))for(const n in t){const i=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),i):this._transitionable.setValue(n,i)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}const E=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)});let A=class extends e.Evented{constructor(t,i){super(),this._transitionable=new e.Transitionable(E),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(t){for(const i in t){const n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),n):this._transitionable.setValue(i,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}};function T(t,i,n,r){const s=e.smoothstep(45,65,n),[o,a]=D(t,r),l=e.length(i);let c=1-Math.min(1,Math.exp((l-o)/(a-o)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*s*t.alpha}function D(e,t){const i=.5/Math.tan(.5*t);return[e.range[0]+i,e.range[1]+i]}const S=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])});class C extends e.Evented{constructor(t,i){super(),this._transitionable=new e.Transitionable(S),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=i}get state(){const t=this._transform,i="globe"===t.projection.name,n=e.globeToMercatorTransition(t.zoom),r=this.properties.get("range"),s=[.5,3];return{range:i?[e.number(s[0],r[0],n),e.number(s[1],r[1],n)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateFog,t,i)){for(const i of Object.keys(e.spec.fog))t&&void 0===t[i]&&(t[i]=e.spec.fog[i].default);for(const i in t){const n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),n):this._transitionable.setValue(i,n)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const i=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*i.a}getOpacityAtLatLng(t,i){return this._transform.projection.supportsFog?function(t,i,n){const r=e.MercatorCoordinate.fromLngLat(i),s=n.elevation?n.elevation.getAtPointOrZero(r):0,o=[r.x,r.y,s];return e.transformMat4(o,o,n.mercatorFogMatrix),T(t,o,n.pitch,n._fov)}(this.state,t,i):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?D(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,i,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}class P{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();const n=this.workerPool.acquire(this.id);for(let e=0;e<n.length;e++){const t=new P.Actor(n[e],i,this.id);t.name="Worker ".concat(e),this.actors.push(t)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,i,n){e.asyncAll(this.actors,(e,n)=>{e.send(t,i,n)},n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}function I(t,i,n){return i*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}P.Actor=e.Actor;class k{constructor(e,t,i,n){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,n)}static createFromScreenPoints(t,i){let n,r;if(t instanceof e.Point||"number"==typeof t[0]){const s=e.Point.convert(t);n=[s],r=i.isPointAboveHorizon(s)}else{const s=e.Point.convert(t[0]),o=e.Point.convert(t[1]);n=[s,o],r=e.polygonizeBounds(s,o).every(e=>i.isPointAboveHorizon(e))}return new k(n,i.getCameraPoint(),r,i)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<n.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?r[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(r[3]=this.cameraPoint)),e.bufferConvexPolygon(r,t)}bufferedCameraGeometryGlobe(t){const i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(i,n,t),s=this.cameraPoint.clone();switch(3*((s.y>i.y)+(s.y>n.y))+((s.x>i.x)+(s.x>n.x))){case 0:r[0]=s,r[4]=s.clone();break;case 1:r.splice(1,0,s);break;case 2:r[1]=s;break;case 3:r.splice(4,0,s);break;case 5:r.splice(2,0,s);break;case 6:r[3]=s;break;case 7:r.splice(3,0,s);break;case 8:r[2]=s}return r}containsTile(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=t.queryPadding/i._pixelsPerMercatorPixel+1,o=n?this._bufferedCameraMercator(s,i):this._bufferedScreenMercator(s,i);let a=t.tileID.wrap+(o.unwrapped?r:0);const l=o.polygon.map(i=>e.getTilePoint(t.tileTransform,i,a));if(!e.polygonIntersectsBox(l,0,0,e.EXTENT,e.EXTENT))return;a=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);const c=this.screenGeometryMercator.polygon.map(i=>e.getTileVec3(t.tileTransform,i,a)),u=c.map(t=>new e.Point(t[0],t[1])),h=i.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),d=e.getTileVec3(t.tileTransform,h,a),p=c.map(t=>{const i=e.sub(t,t,d);return e.normalize(i,i),new e.Ray(d,i)}),m=I(t,1,i.zoom)*i._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(f=e.getBounds(l),f.min.x=e.clamp(f.min.x,0,e.EXTENT),f.min.y=e.clamp(f.min.y,0,e.EXTENT),f.max.x=e.clamp(f.max.x,0,e.EXTENT),f.max.y=e.clamp(f.max.y,0,e.EXTENT),f),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:m};var f}_bufferedScreenMercator(e,t){const i=F(e);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map(e=>t.pointCoordinate3D(e)),unwrapped:!0},this._screenRaycastCache[i]=n,n}}_bufferedCameraMercator(e,t){const i=F(e);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map(e=>t.pointCoordinate3D(e)),unwrapped:!0},this._cameraRaycastCache[i]=n,n}}_projectAndResample(t,i){const n=function(t,i){const n=e.multiply([],i.pixelMatrix,i.globeMatrix),r=[0,-e.GLOBE_RADIUS,0,1],s=[0,e.GLOBE_RADIUS,0,1],o=[0,0,0,1];e.transformMat4$1(r,r,n),e.transformMat4$1(s,s,n),e.transformMat4$1(o,o,n);const a=new e.Point(r[0]/r[3],r[1]/r[3]),l=new e.Point(s[0]/s[3],s[1]/s[3]),c=e.polygonContainsPoint(t,a)&&r[3]<o[3],u=e.polygonContainsPoint(t,l)&&s[3]<o[3];if(!c&&!u)return null;const h=function(e,t,i){for(let n=1;n<e.length;n++){const r=R(t.pointCoordinate3D(e[n-1]).x),s=R(t.pointCoordinate3D(e[n]).x);if(i<0){if(r<s)return{idx:n,t:-r/(s-1-r)}}else if(s<r)return{idx:n,t:(1-r)/(s+1-r)}}return null}(t,i,c?-1:1);if(!h)return null;const{idx:d,t:p}=h;let m=d>1?M(t.slice(0,d),i):[],f=d<t.length?M(t.slice(d),i):[];m=m.map(t=>new e.Point(R(t.x),t.y)),f=f.map(t=>new e.Point(R(t.x),t.y));const g=[...m];0===g.length&&g.push(f[f.length-1]);const _=e.number(g[g.length-1].y,(0===f.length?m[0]:f[0]).y,p);let v;return v=c?[new e.Point(0,_),new e.Point(0,0),new e.Point(1,0),new e.Point(1,_)]:[new e.Point(1,_),new e.Point(1,1),new e.Point(0,1),new e.Point(0,_)],g.push(...v),0===f.length?g.push(m[0]):g.push(...f),{polygon:g.map(t=>new e.MercatorCoordinate(t.x,t.y)),unwrapped:!1}}(t,i);if(n)return n;const r=function(t,i){let n=!1,r=-1/0,s=0;for(let e=0;e<t.length-1;e++)t[e].x>r&&(r=t[e].x,s=e);for(let e=0;e<t.length-1;e++){const i=(s+e)%(t.length-1),r=t[i],o=t[i+1];Math.abs(r.x-o.x)>.5&&(r.x<o.x?(r.x+=1,0===i&&(t[t.length-1].x+=1)):(o.x+=1,i+1===t.length-1&&(t[0].x+=1)),n=!0)}const o=e.mercatorXfromLng(i.center.lng);return n&&o<Math.abs(o-1)&&t.forEach(e=>{e.x-=1}),{polygon:t,unwrapped:n}}(M(t,i).map(t=>new e.Point(R(t.x),t.y)),i);return{polygon:r.polygon.map(t=>new e.MercatorCoordinate(t.x,t.y)),unwrapped:r.unwrapped}}}function M(t,i){return e.resample(t,e=>{const t=i.pointCoordinate3D(e);e.x=t.x,e.y=t.y},1/256)}function R(e){return e<0?1+e%1:e%1}function F(e){return 100*e|0}function L(t,i,n,r,s){const o=function(n,r){if(n)return s(n);if(r){t.url&&r.tiles&&t.tiles&&delete t.tiles;const n=e.pick(e.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(n.vectorLayers=r.vector_layers,n.vectorLayerIds=n.vectorLayers.map(e=>e.id)),n.tiles=i.canonicalizeTileset(n,t.url),s(null,n)}};return t.url?e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url,null,n,r),e.ResourceType.Source),o):e.exported.frame(()=>o(null,t))}class O{constructor(t,i,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=i||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*i),r=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*i),s=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*i),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*i);return t.x>=n&&t.x<s&&t.y>=r&&t.y<o}}class B{constructor(e,t,i){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const z={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class N{constructor(e,t,i,n){this.length=t.length,this.attributes=i,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const r=e.gl;this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let i=0;i<this.attributes.length;i++){const n=t.attributes[this.attributes[i].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,i){for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n],s=t.attributes[r.name];void 0!==s&&e.vertexAttribPointer(s,r.components,e[z[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class U{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class j extends U{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class V extends U{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class G extends U{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class W extends U{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class H extends U{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class X extends U{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class q extends U{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Z extends U{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Y extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class K extends U{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class J extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class $ extends U{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Q extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ee extends U{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class te extends U{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ie extends U{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ne extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class re extends U{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class se extends U{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let oe,ae=class extends U{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class le extends U{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ce extends U{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ue extends U{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class he extends U{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class de extends U{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class pe extends U{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class me extends U{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fe extends U{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class ge extends U{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class _e extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ve extends U{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ye extends U{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class be extends ye{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class xe extends ye{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class we extends xe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ee{constructor(e,t,i,n){this.context=e,this.width=t,this.height=i;const r=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new be(e,r),n&&(this.depthAttachment=new xe(e,r))}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Ae{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.gl=e,this.isWebGL2=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),t){const t=e;this.extVertexArrayObject={createVertexArrayOES:t.createVertexArray.bind(e),deleteVertexArrayOES:t.deleteVertexArray.bind(e),bindVertexArrayOES:t.bindVertexArray.bind(e)}}this.clearColor=new j(this),this.clearDepth=new V(this),this.clearStencil=new G(this),this.colorMask=new W(this),this.depthMask=new H(this),this.stencilMask=new X(this),this.stencilFunc=new q(this),this.stencilOp=new Z(this),this.stencilTest=new Y(this),this.depthRange=new K(this),this.depthTest=new J(this),this.depthFunc=new $(this),this.blend=new Q(this),this.blendFunc=new ee(this),this.blendColor=new te(this),this.blendEquation=new ie(this),this.cullFace=new ne(this),this.cullFaceSide=new re(this),this.frontFace=new se(this),this.program=new ae(this),this.activeTexture=new le(this),this.viewport=new ce(this),this.bindFramebuffer=new ue(this),this.bindRenderbuffer=new he(this),this.bindTexture=new de(this),this.bindVertexBuffer=new pe(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fe(this),this.pixelStoreUnpack=new ge(this),this.pixelStoreUnpackPremultiplyAlpha=new _e(this),this.pixelStoreUnpackFlipY=new ve(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),t||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(t||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new B(this,e,t)}createVertexBuffer(e,t,i){return new N(this,e,t,i)}createRenderbuffer(e,t,i){const n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,e,t,i),this.bindRenderbuffer.set(null),r}createFramebuffer(e,t,i){return new Ee(this,e,t,i)}clear(e){let{color:t,depth:i,stencil:n}=e;const r=this.gl;let s=0;t&&(s|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(s|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),void 0!==n&&(s|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),r.clear(s)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(i){t(i.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Te extends e.Evented{constructor(t,i,n,r){if(super(),this.id=t,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(i,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new e.DedupedRequest}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=L(this._options,this.map._requestManager,i,n,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?(i&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ".concat(i)),n&&2!==n.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(n)),this.fire(new e.ErrorEvent(r))):s&&(e.extend(this,s),s.bounds&&(this.tileBounds=new O(s.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(s.tiles,this.map._requestManager._customAccessToken),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}loadTile(t,i){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=i:t.request=t.actor.send("reloadTile",r,s.bind(this));else if(t.actor=this._tileWorkers[n]=this._tileWorkers[n]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",r,s.bind(this),void 0,!0);else{const i=e.loadVectorTile.call({deduped:this._deduped},r,(e,i)=>{e||!i?s.call(this,e):(r.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},t.actor&&t.actor.send("loadTile",r,s.bind(this),void 0,!0))},!0);t.request={cancel:i}}function s(n,r){return delete t.request,t.aborted?i(null):n&&404!==n.status?i(n):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class De extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.dispatcher=n,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},i),e.extend(this,e.pick(i,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=L(this._options,this.map._requestManager,null,null,(i,n)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new e.ErrorEvent(i)):n&&(e.extend(this,n),n.bounds&&(this.tileBounds=new O(n.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(n.tiles),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,i){const n=e.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),n,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(r,e.ResourceType.Tile),(n,r,s,o)=>(delete t.request,t.aborted?(t.state="unloaded",i(null)):n?(t.state="errored",i(n)):r?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:s,expires:o}),t.setTexture(r,this.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(this.dispatcher),void i(null)):i(null)))}static loadTileData(e,t,i){e.setTexture(t,i)}static unloadTileData(e,t){e.texture&&t.saveTileTexture(e.texture)}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Se(t,i,n,r,s,o,a,l){const c=[t,n,s,i,r,o,1,1,1],u=[a,l,1],h=e.adjoint([],c),[d,p,m]=e.transformMat3(u,u,e.transpose(h,h));return e.multiply$1(c,[d,0,0,0,p,0,0,0,m],c)}class Ce extends e.Evented{constructor(e,t,i,n){super(),this.id=e,this.dispatcher=i,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t,this._dirty=!1}load(t,i){this._loaded=i||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(i,n)=>{if(this._imageRequest=null,this._loaded=!0,i)this.fire(new e.ErrorEvent(i));else if(n){const{HTMLImageElement:i}=e.window;this.image=n instanceof i?e.exported.getImageData(n):n,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const i=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){let i=1/0,n=1/0,r=-1/0,s=-1/0;for(const e of t)i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),s=Math.max(s,e.y);const o=Math.max(r-i,s-n),a=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,a);return new e.CanonicalTileID(a,Math.floor((i+r)/2*l),Math.floor((n+s)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}if(this._boundsArray)return;const i=e.tileTransform(this.tileID,this.map.transform.projection),[n,r,s,o]=this.coordinates.map(t=>{const n=i.projection.project(t[0],t[1]);return e.getTilePoint(i,n)._round()});this.perspectiveTransform=function(t,i,n,r,s,o,a,l,c,u){const h=Se(0,0,t,0,0,i,t,i),d=Se(n,r,s,o,a,l,c,u);return e.multiply$1(d,e.adjoint(h,h),d),[d[6]/d[8]*t/e.EXTENT,d[7]/d[8]*i/e.EXTENT]}(this.width,this.height,n.x,n.y,r.x,r.y,o.x,o.y,s.x,s.y);const a=this._boundsArray=new e.StructArrayLayout4i8;a.emplaceBack(n.x,n.y,0,0),a.emplaceBack(r.x,r.y,e.EXTENT,0),a.emplaceBack(o.x,o.y,0,e.EXTENT),a.emplaceBack(s.x,s.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(a,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,i=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Pe={vector:Te,raster:De,"raster-dem":class extends De{constructor(t,i,n,r){super(t,i,n,r),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(t,i){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(e,n){e&&(t.state="errored",i(e)),n&&(t.dem=n,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",i(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,s,o,a){if(delete t.request,t.aborted)t.state="unloaded",i(null);else if(n)t.state="errored",i(n);else if(s){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:a});const i=e.window.ImageBitmap&&s instanceof e.window.ImageBitmap&&(null==oe&&(oe=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),oe),n=1-(s.width-e.prevPowerOfTwo(s.width))/2;n<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const l=i?s:e.exported.getImageData(s,n),c={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:n};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,r.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(t){const i=t.canonical,n=Math.pow(2,i.z),r=(i.x-1+n)%n,s=0===i.x?t.wrap-1:t.wrap,o=(i.x+1+n)%n,a=i.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y).key]={backfilled:!1},i.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y-1).key]={backfilled:!1}),i.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,s,i.z,r,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,i.z,o,i.y+1).key]={backfilled:!1}),l}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}},geojson:class extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(r),this._data=i.data,this._options=e.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const s=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*s,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*s,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*s,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:i},n),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;const t=e.extend({},this.workerOptions),i=this._data;"string"==typeof i?(t.request=this.map._requestManager.transformRequest(e.exported.resolveURL(i),e.ResourceType.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(i),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),t,(t,i)=>{if(this._loaded=!0,this._pendingLoad=null,t)this.fire(new e.ErrorEvent(t));else{const t={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(t.resourceTiming=i.resourceTiming[this.id]),this.fire(new e.Event("data",t)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(t,i){const n=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(n,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(e,r)=>(delete t.request,t.unloadVectorData(),t.aborted?i(null):e?i(e):(t.loadVectorData(r,this.map.painter,"reloadTile"===n),i(null))),void 0,"loadTile"===n)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ce{constructor(e,t,i,n){super(e,t,i,n),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const i of t.urls)this.urls.push(this.map._requestManager.transformRequest(i,e.ResourceType.Source).url);e.getVideo(this.urls,(t,i)=>{this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const i=this.video.seekable;t<i.start(0)||t>i.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(i.start(0)," and ").concat(i.end(0),"-second mark.")))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,i=t.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ce,canvas:class extends Ce{constructor(t,i,n,r){super(t,i,n,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(e=>!Array.isArray(e)||2!==e.length||e.some(e=>"number"!=typeof e))||this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.Evented{constructor(t,i,n,r){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=i,this.setEventedParent(r),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.ErrorEvent(new Error("Missing implementation for ".concat(this.id," custom source")))),this._implementation.loadTile||this.fire(new e.ErrorEvent(new Error("Missing loadTile implementation for ".concat(this.id," custom source")))),this._implementation.bounds&&(this.tileBounds=new O(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),e.extend(this,e.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:i,z:n}=e.canonical;return this._implementation.hasTile({x:t,y:i,z:n})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,i){const{x:n,y:r,z:s}=t.tileID.canonical,o=new e.window.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:n,y:r,z:s},{signal:o.signal})).then(function(n){return delete t.request,t.aborted?(t.state="unloaded",i(null)):void 0===n?(t.state="errored",i(null)):null===n?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",i(null)):function(t){return t instanceof e.window.ImageData||t instanceof e.window.HTMLCanvasElement||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLImageElement}(n)?(this.loadTileData(t,n),t.state="loaded",void i(null)):(t.state="errored",i(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment"))))}.bind(this)).catch(e=>{20!==e.code&&(t.state="errored",i(e))}),t.request.cancel=()=>o.abort()}loadTileData(e,t){De.loadTileData(e,t,this._map.painter)}unloadTileData(e){De.unloadTileData(e,this._map.painter)}unloadTile(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){const{x:t,y:i,z:n}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:i,z:n})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ie=function(t,i,n,r){const s=new Pe[i.type](t,i,n,r);if(s.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(s.id));return e.bindAll(["load","abort","unload","serialize","prepare"],s),s};function ke(t,i){const n=e.identity([]);return e.scale(n,n,[.5*t.width,.5*-t.height,1]),e.translate(n,n,[1,-1,0]),e.multiply(n,n,t.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(n)}function Me(e,t,i,n,r,s,o){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=e.tilesIn(n,o,a);l.sort(Fe);const c=[];for(const h of l)c.push({wrappedTileID:h.tile.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,i,e._state,h,r,s,ke(e.transform,h.tile.tileID),a)});const u=function(e){const t={},i={};for(const n of e){const e=n.queryResults,r=n.wrappedTileID,s=i[r]=i[r]||{};for(const i in e){const n=e[i],r=s[i]=s[i]||{},o=t[i]=t[i]||[];for(const e of n)r[e.featureIndex]||(r[e.featureIndex]=!0,o.push(e))}}return t}(c);for(const h in u)u[h].forEach(t=>{const i=t.feature,n=i.layer;n&&"background"!==n.type&&"sky"!==n.type&&(i.source=n.source,n["source-layer"]&&(i.sourceLayer=n["source-layer"]),i.state=void 0!==i.id?e.getFeatureState(n["source-layer"],i.id):{})});return u}function Re(e,t){const i=e.getRenderableIds().map(t=>e.getTileByID(t)),n=[],r={};for(let s=0;s<i.length;s++){const e=i[s],o=e.tileID.canonical.key;r[o]||(r[o]=!0,e.querySourceFeatures(n,t))}return n}function Fe(e,t){const i=e.tileID,n=t.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}function Le(){return null!=ds.workerClass?new ds.workerClass:new e.window.Worker(ds.workerUrl)}const Oe="mapboxgl_preloaded_worker_pool";class Be{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Be.workerCount;)this.workers.push(new Le);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(e=>{e.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Oe]}numActive(){return Object.keys(this.active).length}}let ze;function Ne(){return ze||(ze=new Be),ze}function Ue(t,i){const n={};for(const e in t)"ref"!==e&&(n[e]=t[e]);return e.refProperties.forEach(e=>{e in i&&(n[e]=i[e])}),n}function je(e){e=e.slice();const t=Object.create(null);for(let i=0;i<e.length;i++)t[e[i].id]=e[i];for(let i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=Ue(e[i],t[e[i].ref]));return e}Be.workerCount=2;const Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ge(e,t,i){i.push({command:Ve.addSource,args:[e,t[e]]})}function We(e,t,i){t.push({command:Ve.removeSource,args:[e]}),i[e]=!0}function He(e,t,i,n){We(e,i,n),Ge(e,t,i)}function Xe(e,i,n){let r;for(r in e[n])if(e[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;for(r in i[n])if(i[n].hasOwnProperty(r)&&"data"!==r&&!t(e[n][r],i[n][r]))return!1;return!0}function qe(e,i,n,r,s,o){let a;for(a in i=i||{},e=e||{})e.hasOwnProperty(a)&&(t(e[a],i[a])||n.push({command:o,args:[r,a,i[a],s]}));for(a in i)i.hasOwnProperty(a)&&!e.hasOwnProperty(a)&&(t(e[a],i[a])||n.push({command:o,args:[r,a,i[a],s]}))}function Ze(e){return e.id}function Ye(e,t){return e[t.id]=t,e}class Ke{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);let i=1,n=this._distances[i];const r=t*this.paddedLength+this.padding;for(;n<r&&i<this._distances.length;)n=this._distances[++i];const s=i-1,o=this._distances[s],a=n-o,l=a>0?(r-o)/a:0;return this.points[s].mult(1-l).add(this.points[i].mult(l))}}class Je{constructor(e,t,i){const n=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(let s=0;s<this.xCellCount*this.yCellCount;s++)n.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,i,n,r){this._forEachCell(t,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}insertCircle(e,t,i,n){this._forEachCell(t-n,i-n,t+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(n)}_insertBoxCell(e,t,i,n,r,s){this.boxCells[r].push(s)}_insertCircleCell(e,t,i,n,r,s){this.circleCells[r].push(s)}_query(e,t,i,n,r,s){if(i<0||e>this.width||n<0||t>this.height)return!r&&[];const o=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=n){if(r)return!0;for(let e=0;e<this.boxKeys.length;e++)o.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],i=this.circles[3*e+1],n=this.circles[3*e+2];o.push({key:this.circleKeys[e],x1:t-n,y1:i-n,x2:t+n,y2:i+n})}return s?o.filter(s):o}return this._forEachCell(e,t,i,n,this._queryCell,o,{hitTest:r,seenUids:{box:{},circle:{}}},s),r?o.length>0:o}_queryCircle(e,t,i,n,r){const s=e-i,o=e+i,a=t-i,l=t+i;if(o<0||s>this.width||l<0||a>this.height)return!n&&[];const c=[];return this._forEachCell(s,a,o,l,this._queryCellCircle,c,{hitTest:n,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}},r),n?c.length>0:c}query(e,t,i,n,r){return this._query(e,t,i,n,!1,r)}hitTest(e,t,i,n,r){return this._query(e,t,i,n,!0,r)}hitTestCircle(e,t,i,n){return this._queryCircle(e,t,i,!0,n)}_queryCell(e,t,i,n,r,s,o,a){const l=o.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(e<=r[c+2]&&t<=r[c+3]&&i>=r[c+0]&&n>=r[c+1]&&(!a||a(this.boxKeys[u]))){if(o.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[u],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]})}}}const u=this.circleCells[r];if(null!==u){const r=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(r[u],r[u+1],r[u+2],e,t,i,n)&&(!a||a(this.circleKeys[c]))){if(o.hitTest)return s.push(!0),!0;{const e=r[u],t=r[u+1],i=r[u+2];s.push({key:this.circleKeys[c],x1:e-i,y1:t-i,x2:e+i,y2:t+i})}}}}}_queryCellCircle(e,t,i,n,r,s,o,a){const l=o.circle,c=o.seenUids,u=this.boxCells[r];if(null!==u){const e=this.bboxes;for(const t of u)if(!c.box[t]){c.box[t]=!0;const i=4*t;if(this._circleAndRectCollide(l.x,l.y,l.radius,e[i+0],e[i+1],e[i+2],e[i+3])&&(!a||a(this.boxKeys[t])))return s.push(!0),!0}}const h=this.circleCells[r];if(null!==h){const e=this.circles;for(const t of h)if(!c.circle[t]){c.circle[t]=!0;const i=3*t;if(this._circlesCollide(e[i],e[i+1],e[i+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[t])))return s.push(!0),!0}}}_forEachCell(e,t,i,n,r,s,o,a){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(i),h=this._convertToYCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,e,t,i,n,this.xCellCount*l+d,s,o,a))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,i,n,r,s){const o=n-e,a=r-t,l=i+s;return l*l>o*o+a*a}_circleAndRectCollide(e,t,i,n,r,s,o){const a=(s-n)/2,l=Math.abs(e-(n+a));if(l>a+i)return!1;const c=(o-r)/2,u=Math.abs(t-(r+c));if(u>c+i)return!1;if(l<=a||u<=c)return!0;const h=l-a,d=u-c;return h*h+d*d<=i*i}}const $e={unknown:0,flipRequired:1,flipNotRequired:2},Qe=Math.tan(85*Math.PI/180);function et(t,i,n,r,s,o,a){const l=e.create();if(n)if("globe"===o.name){const t=e.calculateGlobeLabelMatrix(s,i);e.multiply(l,l,t)}else{const t=v([],a);l[0]=t[0],l[1]=t[1],l[4]=t[2],l[5]=t[3],r||e.rotateZ(l,l,s.angle)}else e.multiply(l,s.labelPlaneMatrix,t);return l}function tt(e,t,i,n,r,s,o){const a=et(e,t,i,n,r,s,o);return"globe"===s.name&&i||(a[2]=a[6]=a[10]=a[14]=0),a}function it(t,i,n,r,s,o,a){if(n){if("globe"===o.name){const l=et(t,i,n,r,s,o,a);return e.invert(l,l),e.multiply(l,t,l),l}{const i=e.clone(t),n=e.identity([]);return n[0]=a[0],n[1]=a[1],n[4]=a[2],n[5]=a[3],e.multiply(i,i,n),r||e.rotateZ(i,i,-s.angle),i}}return s.glCoordMatrix}function nt(t,i,n,r){const s=[t,i,n,1];n?e.transformMat4$1(s,s,r):mt(s,s,r);const o=s[3];return s[0]/=o,s[1]/=o,s[2]/=o,s}function rt(e,t){return Math.min(.5+e/t*.5,1.5)}function st(e,t){const i=e[0]/e[3],n=e[1]/e[3];return i>=-t[0]&&i<=t[0]&&n>=-t[1]&&n<=t[1]}function ot(t,i,n,r,s,o,a,l,c,u){const h=n.transform,d=r?t.textSizeData:t.iconSizeData,p=e.evaluateSizeForZoom(d,n.transform.zoom),m="globe"===h.projection.name,f=[256/n.width*2+1,256/n.height*2+1],g=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let _=null;m&&(_=r?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const v=t.lineVertexArray,y=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=n.transform.width/n.transform.height;let x,w=!1;for(let E=0;E<y.length;E++){const r=y.get(E),{numGlyphs:m,writingMode:A}=r;if(A!==e.WritingMode.vertical||w||x===e.WritingMode.horizontal||(w=!0),x=A,(r.hidden||A===e.WritingMode.vertical)&&!w){pt(m,g);continue}w=!1;const T=new e.Point(r.tileAnchorX,r.tileAnchorY);let{x:D,y:S,z:C}=h.projection.projectTilePoint(T.x,T.y,u.canonical);if(c){const[e,t,i]=c(T);D+=e,S+=t,C+=i}const P=[D,S,C,1];if(e.transformMat4$1(P,P,i),!st(P,f)){pt(m,g);continue}const I=rt(n.transform.cameraToCenterDistance,P[3]),k=e.evaluateSizeForFeature(d,p,r),M=a?k/I:k*I,R=nt(D,S,C,s);if(R[3]<=0){pt(m,g);continue}let F={};const L=a?null:c,O=ct(r,M,!1,l,i,s,o,t.glyphOffsetArray,v,g,_,R,T,F,b,L,h.projection,u,a);w=O.useVertical,L&&O.needsFlipping&&(F={}),(O.notEnoughRoom||w||O.needsFlipping&&ct(r,M,!0,l,i,s,o,t.glyphOffsetArray,v,g,_,R,T,F,b,L,h.projection,u,a).notEnoughRoom)&&pt(m,g)}r?(t.text.dynamicLayoutVertexBuffer.updateData(g),_&&t.text.globeExtVertexBuffer.updateData(_)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),_&&t.icon.globeExtVertexBuffer.updateData(_))}function at(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f){const{lineStartIndex:g,glyphStartIndex:_,segment:v}=a,y=_+a.numGlyphs,b=g+a.lineLength,x=t.getoffsetX(_),w=t.getoffsetX(y-1),E=dt(e*x,i,n,r,s,o,v,g,b,l,c,u,h,d,!0,p,m,f);if(!E)return null;const A=dt(e*w,i,n,r,s,o,v,g,b,l,c,u,h,d,!0,p,m,f);return A?{first:E,last:A}:null}function lt(t,i,n,r){return t===e.WritingMode.horizontal&&Math.abs(r)>Math.abs(n)?{useVertical:!0}:t===e.WritingMode.vertical?r>0?{needsFlipping:!0}:null:i!==$e.unknown&&function(e,t){return 0===e||Math.abs(t/e)>Qe}(n,r)?i===$e.flipRequired?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function ct(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y){const b=i/24,x=t.lineOffsetX*b,w=t.lineOffsetY*b,{lineStartIndex:E,glyphStartIndex:A,numGlyphs:T,segment:D,writingMode:S,flipState:C}=t,P=E+t.lineLength,I=t=>{if(h){const[i,n,r]=t.up,s=u.length;e.updateGlobeVertexNormal(h,s+0,i,n,r),e.updateGlobeVertexNormal(h,s+1,i,n,r),e.updateGlobeVertexNormal(h,s+2,i,n,r),e.updateGlobeVertexNormal(h,s+3,i,n,r)}const[i,n,r]=t.point;e.addDynamicAttributes(u,i,n,r,t.angle)};if(T>1){const e=at(b,l,x,w,n,d,p,t,c,o,m,g,!1,_,v,y);if(!e)return{notEnoughRoom:!0};if(r&&!n){let[i,n,r]=e.first.point,[s,o,l]=e.last.point;[i,n]=nt(i,n,r,a),[s,o]=nt(s,o,l,a);const c=lt(S,C,(s-i)*f,o-n);if(t.flipState=c&&c.needsFlipping?$e.flipRequired:$e.flipNotRequired,c)return c}I(e.first);for(let t=A+1;t<A+T-1;t++){const e=dt(b*l.getoffsetX(t),x,w,n,d,p,D,E,P,c,o,m,g,!1,!1,_,v,y);if(!e)return u.length-=4*(t-A),{notEnoughRoom:!0};I(e)}I(e.last)}else{if(r&&!n){const i=nt(p.x,p.y,0,s),n=E+D+1,r=new e.Point(c.getx(n),c.gety(n)),o=nt(r.x,r.y,0,s),a=o[3]>0?o:ht(p,r,i,1,s,void 0,_,v.canonical),l=lt(S,C,(a[0]-i[0])*f,a[1]-i[1]);if(t.flipState=l&&l.needsFlipping?$e.flipRequired:$e.flipNotRequired,l)return l}const i=dt(b*l.getoffsetX(A),x,w,n,d,p,D,E,P,c,o,m,g,!1,!1,_,v,y);if(!i)return{notEnoughRoom:!0};I(i)}return{}}function ut(e,t,i,n,r){const{x:s,y:o,z:a}=n.projectTilePoint(e.x,e.y,t);if(!r)return nt(s,o,a,i);const[l,c,u]=r(e);return nt(s+l,o+c,a+u,i)}function ht(t,i,n,r,s,o,a,l){const c=ut(t.sub(i)._unit()._add(t),l,s,a,o);return e.sub(c,n,c),e.normalize(c,c),e.scaleAndAdd(c,n,c,r)}function dt(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_,v){const y=r?t-i:t+i;let b=y>0?1:-1,x=0;r&&(b*=-1,x=Math.PI),b<0&&(x+=Math.PI);let w=l+a+(b>0?0:1)|0,E=s,A=s,T=0,D=0;const S=Math.abs(y),C=[],P=[];let I=o,k=I;const M=()=>ht(k,I,A,S-T+1,h,p,g,_.canonical);for(;T+D<=S;){if(w+=b,w<l||w>=c)return null;if(A=E,k=I,C.push(A),m&&P.push(k),I=new e.Point(u.getx(w),u.gety(w)),E=d[w],!E){const e=ut(I,_.canonical,h,g,p);E=e[3]>0?d[w]=e:M()}T+=D,D=e.distance(A,E)}f&&p&&(d[w]&&(E=M(),D=e.distance(A,E)),d[w]=E);const R=(S-T)/D,F=I.sub(k)._mult(R)._add(k),L=e.sub([],E,A),O=e.scaleAndAdd([],A,L,R);let B=[0,0,1],z=L[0],N=L[1];if(v&&(B=g.upVector(_.canonical,F.x,F.y),0!==B[0]||0!==B[1]||1!==B[2])){const t=[B[2],0,-B[0]],i=e.cross([],B,t);e.normalize(t,t),e.normalize(i,i),z=e.dot(L,t),N=e.dot(L,i)}if(n){const t=e.cross([],B,L);e.normalize(t,t),e.scaleAndAdd(O,O,t,n*b)}const U=x+Math.atan2(N,z);return C.push(O),m&&P.push(F),{point:O,angle:U,path:C,tilePath:P,up:B}}function pt(e,t){const i=t.length,n=i+4*e;t.resize(n),t.float32.fill(-1/0,4*i,4*n)}function mt(e,t,i){const n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e[3]=i[3]*n+i[7]*r+i[15],e}const ft=100;class gt{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Je(e.width+200,e.height+200,25),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Je(e.width+200,e.height+200,25);this.transform=e,this.grid=i,this.ignoredGrid=n,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+ft,this.screenBottomBoundary=e.height+ft,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,i,n,r,s,o,a){let l=i.projectedAnchorX,c=i.projectedAnchorY,u=i.projectedAnchorZ;const h=i.elevation,d=i.tileID,p=e.getProjection();if(h&&d){const[e,t,n]=p.upVector(d.canonical,i.tileAnchorX,i.tileAnchorY),r=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=e*h*r,c+=t*h*r,u+=n*h*r}const m=this.projectAndGetPerspectiveRatio(o,l,c,u,i.tileID,"globe"===p.name||!!h||this.transform.pitch>0,p),f=s*m.perspectiveRatio,g=(i.x1*t+n.x-i.padding)*f+m.point.x,_=(i.y1*t+n.y-i.padding)*f+m.point.y,v=(i.x2*t+n.x+i.padding)*f+m.point.x,y=(i.y2*t+n.y+i.padding)*f+m.point.y,b=m.perspectiveRatio<=.55||m.occluded;return!this.isInsideGrid(g,_,v,y)||!r&&this.grid.hitTest(g,_,v,y,a)||b?{box:[],offscreen:!1,occluded:m.occluded}:{box:[g,_,v,y],offscreen:this.isOffscreen(g,_,v,y),occluded:!1}}placeCollisionCircles(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f){const g=[],_=this.transform.elevation,v=t.getProjection(),y=_?_.getAtTileOffsetFunc(f,this.transform.center.lat,this.transform.worldSize,v):null,b=new e.Point(n.tileAnchorX,n.tileAnchorY);let{x:x,y:w,z:E}=v.projectTilePoint(b.x,b.y,f.canonical);if(y){const[e,t,i]=y(b);x+=e,w+=t,E+=i}const A="globe"===v.name,T=this.projectAndGetPerspectiveRatio(a,x,w,E,f,A||!!_||this.transform.pitch>0,v),{perspectiveRatio:D}=T,S=(h?o/D:o*D)/e.ONE_EM,C=nt(x,w,E,l),P=T.signedDistanceFromCamera>0?at(S,s,n.lineOffsetX*S,n.lineOffsetY*S,!1,C,b,n,r,l,{},_&&!h?y:null,h&&!!_,v,f,h):null;let I=!1,k=!1,M=!0;if(P&&!T.occluded){const t=.5*p*D+m,n=new e.Point(-100,-100),r=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),s=new Ke,{first:o,last:a}=P,l=o.path.length;let h=[];for(let e=l-1;e>=1;e--)h.push(o.path[e]);for(let e=1;e<a.path.length;e++)h.push(a.path[e]);const f=2.5*t;c&&(h=h.map((e,t)=>{let[i,n,r]=e;return y&&!A&&(r=y(t<l-1?o.tilePath[l-1-t]:a.tilePath[t-l+2])[2]),nt(i,n,r,c)}),h.some(e=>e[3]<=0)&&(h=[]));let _=[];if(h.length>0){let t=1/0,i=-1/0,s=1/0,o=-1/0;for(const e of h)t=Math.min(t,e[0]),s=Math.min(s,e[1]),i=Math.max(i,e[0]),o=Math.max(o,e[1]);i>=n.x&&t<=r.x&&o>=n.y&&s<=r.y&&(_=[h.map(t=>new e.Point(t[0],t[1]))],(t<n.x||i>r.x||s<n.y||o>r.y)&&(_=e.clipLine(_,n.x,n.y,r.x,r.y)))}for(const e of _){s.reset(e,.25*t);let n=0;n=s.length<=.5*t?1:Math.ceil(s.paddedLength/f)+1;for(let e=0;e<n;e++){const r=e/Math.max(n-1,1),o=s.lerp(r),a=o.x+ft,l=o.y+ft;g.push(a,l,t,0);const c=a-t,h=l-t,p=a+t,m=l+t;if(M=M&&this.isOffscreen(c,h,p,m),k=k||this.isInsideGrid(c,h,p,m),!i&&this.grid.hitTestCircle(a,l,t,d)&&(I=!0,!u))return{circles:[],offscreen:!1,collisionDetected:I,occluded:!1}}}}return{circles:!u&&I||!k?[]:g,offscreen:M,collisionDetected:I,occluded:T.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let n=1/0,r=1/0,s=-1/0,o=-1/0;for(const u of t){const t=new e.Point(u.x+ft,u.y+ft);n=Math.min(n,t.x),r=Math.min(r,t.y),s=Math.max(s,t.x),o=Math.max(o,t.y),i.push(t)}const a=this.grid.query(n,r,s,o).concat(this.ignoredGrid.query(n,r,s,o)),l={},c={};for(const u of a){const t=u.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const n=[new e.Point(u.x1,u.y1),new e.Point(u.x2,u.y1),new e.Point(u.x2,u.y2),new e.Point(u.x1,u.y2)];e.polygonIntersectsPolygon(i,n)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,i,n,r){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:n,collisionGroupID:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,i,n,r){const s=t?this.ignoredGrid:this.grid,o={bucketInstanceId:i,featureIndex:n,collisionGroupID:r};for(let a=0;a<e.length;a+=4)s.insertCircle(o,e[a],e[a+1],e[a+2])}projectAndGetPerspectiveRatio(t,i,n,r,s,o,a){const l=[i,n,r,1];let c=!1;if(r||this.transform.pitch>0){if(e.transformMat4$1(l,l,t),this.fogState&&s&&"globe"!==a.name){const t=function(t,i,n,r,s,o){const a=o.calculateFogTileMatrix(s),l=[i,n,r];return e.transformMat4(l,l,a),T(t,l,o.pitch,o._fov)}(this.fogState,i,n,r,s.toUnwrapped(),this.transform);c=t>.9}}else mt(l,l,t);const u=l[3];return{point:new e.Point((l[0]/u+1)/2*this.transform.width+ft,(-l[1]/u+1)/2*this.transform.height+ft),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/u*.5,1.5),signedDistanceFromCamera:u,occluded:o&&l[2]>u||c}}isOffscreen(e,t,i,n){return i<ft||e>=this.screenRightBoundary||n<ft||t>this.screenBottomBoundary}isInsideGrid(e,t,i,n){return i>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}function _t(t,i,n){const r=i.createTileMatrix(t,t.worldSize,n.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,r)}function vt(e,t,i){if(t.projection.name===i.projection.name)return e.projMatrix;const n=i.clone();return n.setProjection(t.projection),_t(n,t.getProjection(),e)}function yt(e,t,i){return t.name===i.projection.name?e.projMatrix:_t(i,t,e)}class bt{constructor(e,t,i,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class xt{constructor(e,t,i,n,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.text=new bt(e?e.text:null,t,i,r),this.icon=new bt(e?e.icon:null,t,n,r),this.clipped=s}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wt{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.text=e,this.icon=t,this.skipFade=i,this.clipped=n}}class Et{constructor(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}}class At{constructor(e,t,i,n,r){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=r}}class Tt{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Dt(t,i,n,r,s){const{horizontalAlign:o,verticalAlign:a}=e.getAnchorAlignment(t),l=-(o-.5)*i,c=-(a-.5)*n,u=e.evaluateVariableOffset(t,r);return new e.Point(l+u[0]*s,c+u[1]*s)}function St(t,i,n,r,s){const o=new e.Point(t,i);return n&&o._rotate(r?s:-s),o}class Ct{constructor(e,t,i,n,r){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new gt(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new Tt(i),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,i,n,r){const s=n.getBucket(i),o=n.latestFeatureIndex;if(!s||!o||i.id!==s.layerIds[0])return;const a=s.layers[0].layout,l=n.collisionBoxArray,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),u=n.tileSize/e.EXTENT,h=n.tileID.toUnwrapped();this.transform.setProjection(s.projection);const d=(p=n.tileID,m=s.getProjection(),f=this.transform,m.name===this.projection?f.calculateProjMatrix(p.toUnwrapped()):_t(f,m,p));var p,m,f;const g="map"===a.get("text-pitch-alignment"),_="map"===a.get("text-rotation-alignment");i.compileFilter();const v=i.dynamicFilter(),y=i.dynamicFilterNeedsFeature(),b=this.transform.calculatePixelsToTileUnitsMatrix(n),x=tt(d,n.tileID.canonical,g,_,this.transform,s.getProjection(),b);let w=null;if(g){const t=it(d,n.tileID.canonical,g,_,this.transform,s.getProjection(),b);w=e.multiply([],this.transform.labelPlaneMatrix,t)}let E=null;v&&n.latestFeatureIndex&&(E={unwrappedTileID:h,dynamicFilter:v,dynamicFilterNeedsFeature:y,featureIndex:n.latestFeatureIndex}),this.retainedQueryData[s.bucketInstanceId]=new At(s.bucketInstanceId,o,s.sourceLayerIndex,s.index,n.tileID);const A={bucket:s,layout:a,posMatrix:d,textLabelPlaneMatrix:x,labelToScreenMatrix:w,clippingData:E,scale:c,textPixelRatio:u,holdingForFade:n.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(s.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(r)for(const e of s.sortKeyRanges){const{sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r}=e;t.push({sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r,parameters:A})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:A})}attemptAnchorPlacement(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_){const{textOffset0:v,textOffset1:y,crossTileID:b}=h,x=[v,y],w=Dt(e,i,n,x,r),E=this.collisionIndex.placeCollisionBox(p,r,t,St(w.x,w.y,s,o,this.transform.angle),u,a,l,c.predicate);if(f){const e=p.getSymbolInstanceIconSize(_,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,e,f,St(w.x,w.y,s,o,this.transform.angle),u,a,l,c.predicate).box.length)return}if(E.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[b]&&this.prevPlacement.placements[b]&&this.prevPlacement.placements[b].text&&(t=this.prevPlacement.variableOffsets[b].anchor),this.variableOffsets[b]={textOffset:x,width:i,height:n,anchor:e,textScale:r,prevAnchor:t},this.markUsedJustification(p,e,h,m),p.allowVerticalPlacement&&(this.markUsedOrientation(p,m,h),this.placedOrientations[b]=m),{shift:w,placedGlyphBoxes:E}}}placeLayerBucketPart(t,i,n,r){const{bucket:s,layout:o,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:u,textPixelRatio:h,holdingForFade:d,collisionBoxArray:p,partiallyEvaluatedTextSize:m,partiallyEvaluatedIconSize:f,collisionGroup:g}=t.parameters,_=o.get("text-optional"),v=o.get("icon-optional"),y=o.get("text-allow-overlap"),b=o.get("icon-allow-overlap"),x="map"===o.get("text-rotation-alignment"),w="map"===o.get("text-pitch-alignment"),E="none"!==o.get("icon-text-fit"),A="viewport-y"===o.get("symbol-z-order");this.transform.setProjection(s.projection);let T=y&&(b||!s.hasIconData()||v),D=b&&(y||!s.hasTextData()||_);!s.collisionArrays&&p&&s.deserializeCollisionBoxes(p),n&&r&&s.updateCollisionDebugBuffers(this.transform.zoom,p);const S=(t,r,p)=>{const{crossTileID:A,numVerticalGlyphVertices:S}=t;if(u){const n={zoom:this.transform.zoom,pitch:this.transform.pitch};let r=null;if(u.dynamicFilterNeedsFeature){const e=this.retainedQueryData[s.bucketInstanceId];r=u.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,u.dynamicFilter)(n,r,this.retainedQueryData[s.bucketInstanceId].tileID.canonical,new e.Point(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(u.unwrappedTileID)))return this.placements[A]=new wt(!1,!1,!1,!0),void i.add(A)}if(i.has(A))return;if(d)return void(this.placements[A]=new wt(!1,!1,!1));let C=!1,P=!1,I=!0,k=!1,M=!1,R=null,F={box:null,offscreen:null,occluded:null},L={box:null,offscreen:null,occluded:null},O=null,B=null,z=null,N=0,U=0,j=0;p.textFeatureIndex?N=p.textFeatureIndex:t.useRuntimeCollisionCircles&&(N=t.featureIndex),p.verticalTextFeatureIndex&&(U=p.verticalTextFeatureIndex);const V=e=>{e.tileID=this.retainedQueryData[s.bucketInstanceId].tileID;const t=this.transform.elevation;(t||e.elevation)&&(e.elevation=t?t.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0)},G=p.textBox;if(G){V(G);const i=i=>{let n=e.WritingMode.horizontal;if(s.allowVerticalPlacement&&!i&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[A];e&&(this.placedOrientations[A]=e,n=e,this.markUsedOrientation(s,n,t))}return n},n=(t,i)=>{if(s.allowVerticalPlacement&&S>0&&p.verticalTextBox){for(const n of s.writingModes)if(n===e.WritingMode.vertical?(F=i(),L=F):F=t(),F&&F.box&&F.box.length)break}else F=t()};if(o.get("text-variable-anchor")){let l=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[A]){const e=this.prevPlacement.variableOffsets[A];l.indexOf(e.anchor)>0&&(l=l.filter(t=>t!==e.anchor),l.unshift(e.anchor))}const c=(e,i,n)=>{const o=s.getSymbolInstanceTextSize(m,t,this.transform.zoom,r),c=(e.x2-e.x1)*o+2*e.padding,u=(e.y2-e.y1)*o+2*e.padding,d=E&&!b?i:null;d&&V(d);let p={box:[],offscreen:!1,occluded:!1};const _=y?2*l.length:l.length;for(let v=0;v<_;++v){const i=this.attemptAnchorPlacement(l[v%l.length],e,c,u,o,x,w,h,a,g,v>=l.length,t,r,s,n,d,m,f);if(i&&(p=i.placedGlyphBoxes,p&&p.box&&p.box.length)){C=!0,R=i.shift;break}}return p};n(()=>c(G,p.iconBox,e.WritingMode.horizontal),()=>{const t=p.verticalTextBox;return t&&V(t),s.allowVerticalPlacement&&!(F&&F.box&&F.box.length)&&S>0&&t?c(t,p.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),F&&(C=F.box,I=F.offscreen,k=F.occluded);const u=i(!(!F||!F.box));if(!C&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[A];e&&(this.variableOffsets[A]=e,this.markUsedJustification(s,e.anchor,t,u))}}else{const o=(i,n)=>{const o=s.getSymbolInstanceTextSize(m,t,this.transform.zoom,r),l=this.collisionIndex.placeCollisionBox(s,o,i,new e.Point(0,0),y,h,a,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(s,n,t),this.placedOrientations[A]=n),l};n(()=>o(G,e.WritingMode.horizontal),()=>{const t=p.verticalTextBox;return s.allowVerticalPlacement&&S>0&&t?(V(t),o(t,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),i(!!(F&&F.box&&F.box.length))}}if(O=F,C=O&&O.box&&O.box.length>0,I=O&&O.offscreen,k=O&&O.occluded,t.useRuntimeCollisionCircles){const i=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),r=e.evaluateSizeForFeature(s.textSizeData,m,i),u=o.get("text-padding");B=this.collisionIndex.placeCollisionCircles(s,y,i,s.lineVertexArray,s.glyphOffsetArray,r,a,l,c,n,w,g.predicate,t.collisionCircleDiameter*r/e.ONE_EM,u,this.retainedQueryData[s.bucketInstanceId].tileID),C=y||B.circles.length>0&&!B.collisionDetected,I=I&&B.offscreen,k=B.occluded}if(p.iconFeatureIndex&&(j=p.iconFeatureIndex),p.iconBox){const i=i=>{V(i);const n=E&&R?St(R.x,R.y,x,w,this.transform.angle):new e.Point(0,0),r=s.getSymbolInstanceIconSize(f,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(s,r,i,n,b,h,a,g.predicate)};L&&L.box&&L.box.length&&p.verticalIconBox?(z=i(p.verticalIconBox),P=z.box.length>0):(z=i(p.iconBox),P=z.box.length>0),I=I&&z.offscreen,M=z.occluded}const W=_||0===t.numHorizontalGlyphVertices&&0===S,H=v||0===t.numIconVertices;if(W||H?H?W||(P=P&&C):C=P&&C:P=C=P&&C,C&&O&&O.box&&this.collisionIndex.insertCollisionBox(O.box,o.get("text-ignore-placement"),s.bucketInstanceId,L&&L.box&&U?U:N,g.ID),P&&z&&this.collisionIndex.insertCollisionBox(z.box,o.get("icon-ignore-placement"),s.bucketInstanceId,j,g.ID),B&&(C&&this.collisionIndex.insertCollisionCircles(B.circles,o.get("text-ignore-placement"),s.bucketInstanceId,N,g.ID),n)){const e=s.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Et);for(let i=0;i<B.circles.length;i+=4)t.circles.push(B.circles[i+0]),t.circles.push(B.circles[i+1]),t.circles.push(B.circles[i+2]),t.circles.push(B.collisionDetected?1:0)}const X="globe"!==s.projection.name;T=T&&(X||!k),D=D&&(X||!M),this.placements[A]=new wt(C||T,P||D,I||s.justReloaded),i.add(A)};if(A){const e=s.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const i=e[t];S(s.symbolInstances.get(i),i,s.collisionArrays[i])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)S(s.symbolInstances.get(e),e,s.collisionArrays[e]);if(n&&s.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[s.bucketInstanceId];e.invert(t.invProjMatrix,a),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}markUsedJustification(t,i,n,r){const{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:c}=n,u=e.getAnchorJustification(i),h=r===e.WritingMode.vertical?l:"left"===u?s:"center"===u?o:"right"===u?a:-1;s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:c),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:c)}markUsedOrientation(t,i,n){const r=i===e.WritingMode.horizontal||i===e.WritingMode.horizontalOnly?i:0,s=i===e.WritingMode.vertical?i:0,{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=n,u=t.text.placedSymbolArray;o>=0&&(u.get(o).placedOrientation=r),a>=0&&(u.get(a).placedOrientation=r),l>=0&&(u.get(l).placedOrientation=r),c>=0&&(u.get(c).placedOrientation=s)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let i=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},s=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const a in this.placements){const e=this.placements[a],t=r[a];t?(this.opacities[a]=new xt(t,n,e.text,e.icon,null,e.clipped),i=i||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[a]=new xt(null,n,e.text,e.icon,e.skipFade,e.clipped),i=i||e.text||e.icon)}for(const a in r){const e=r[a];if(!this.opacities[a]){const t=new xt(e,n,!1,!1);t.isHidden()||(this.opacities[a]=t,i=i||e.text.placed||e.icon.placed)}}for(const a in s)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=s[a]);for(const a in o)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=o[a]);i?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const i=new Set;for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,i,n.collisionBoxArray)}}updateBucketOpacities(t,i,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const r=t.layers[0].layout,s=!!t.layers[0].dynamicFilter(),o=new xt(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=r.get("text-variable-anchor"),u="map"===r.get("text-rotation-alignment"),h="map"===r.get("text-pitch-alignment"),d="none"!==r.get("icon-text-fit"),p=new xt(null,0,a&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(a||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const m=(e,t,i)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(i)};let f=0;for(let g=0;g<t.symbolInstances.length;g++){const n=t.symbolInstances.get(g),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:l,numIconVertices:_}=n,v=i.has(l);let y=this.opacities[l];v?y=o:y||(y=p,this.opacities[l]=y),i.add(l);const b=r>0||a>0,x=_>0,w=this.placedOrientations[l],E=w===e.WritingMode.vertical,A=w===e.WritingMode.horizontal||w===e.WritingMode.horizontalOnly;if(!b&&!x||y.isHidden()||f++,b){const e=Bt(y.text);m(t.text,r,E?zt:e),m(t.text,a,A?zt:e);const i=y.text.isHidden(),{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:u}=n,h=t.text.placedSymbolArray,d=i||E?1:0;s>=0&&(h.get(s).hidden=d),o>=0&&(h.get(o).hidden=d),c>=0&&(h.get(c).hidden=d),u>=0&&(h.get(u).hidden=i||A?1:0);const p=this.variableOffsets[l];p&&this.markUsedJustification(t,p.anchor,n,w);const f=this.placedOrientations[l];f&&(this.markUsedJustification(t,"left",n,f),this.markUsedOrientation(t,f,n))}if(x){const e=Bt(y.icon),{placedIconSymbolIndex:i,verticalPlacedIconSymbolIndex:r}=n,s=t.icon.placedSymbolArray,o=y.icon.isHidden()?1:0;i>=0&&(m(t.icon,_,E?zt:e),s.get(i).hidden=o),r>=0&&(m(t.icon,n.numVerticalIconVertices,A?zt:e),s.get(r).hidden=o)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const i=t.collisionArrays[g];if(i){let n=new e.Point(0,0),r=!0;if(i.textBox||i.verticalTextBox){if(c){const e=this.variableOffsets[l];e?(n=Dt(e.anchor,e.width,e.height,e.textOffset,e.textScale),u&&n._rotate(h?this.transform.angle:-this.transform.angle)):r=!1}s&&(r=!y.clipped),i.textBox&&Pt(t.textCollisionBox.collisionVertexArray,y.text.placed,!r||E,n.x,n.y),i.verticalTextBox&&Pt(t.textCollisionBox.collisionVertexArray,y.text.placed,!r||A,n.x,n.y)}const o=r&&Boolean(!A&&i.verticalIconBox);i.iconBox&&Pt(t.iconCollisionBox.collisionVertexArray,y.icon.placed,o,d?n.x:0,d?n.y:0),i.verticalIconBox&&Pt(t.iconCollisionBox.collisionVertexArray,y.icon.placed,!o,d?n.x:0,d?n.y:0)}}}if(t.fullyClipped=0===f,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const i=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function Pt(e,t,i,n,r){e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0),e.emplaceBack(t?1:0,i?1:0,n||0,r||0)}const It=Math.pow(2,25),kt=Math.pow(2,24),Mt=Math.pow(2,17),Rt=Math.pow(2,16),Ft=Math.pow(2,9),Lt=Math.pow(2,8),Ot=Math.pow(2,1);function Bt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*It+t*kt+i*Mt+t*Rt+i*Ft+t*Lt+i*Ot+t}const zt=0;class Nt{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,t,i,n,r){const s=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(s,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort((e,t)=>e.sortKey-t.sortKey));this._currentPartIndex<s.length;){const e=s[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,i,0===e.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}class Ut{constructor(e,t,i,n,r,s,o,a){this.placement=new Ct(e,r,s,o,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(t,i,n){const r=e.exported.now(),s=()=>{const t=e.exported.now()-r;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const e=i[t[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=r)&&(!e.maxzoom||e.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Nt(e)),this._inProgressLayer.continuePlacement(n[e.source],this.placement,this._showCollisionBoxes,e,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const jt=512/e.EXTENT/2;class Vt{constructor(t,i,n){this.tileID=t,this.bucketInstanceId=n,this.index=new e.KDBush(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const r=t.canonical.x*e.EXTENT,s=t.canonical.y*e.EXTENT;for(let e=0;e<i.length;e++){const{key:t,crossTileID:n,tileAnchorX:o,tileAnchorY:a}=i.get(e),l=Math.floor((r+o)*jt),c=Math.floor((s+a)*jt);this.index.add(l,c),this.keys.push(t),this.crossTileIDs.push(n)}this.index.finish()}findMatches(t,i,n){const r=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),s=jt/Math.pow(2,i.canonical.z-this.tileID.canonical.z),o=i.canonical.x*e.EXTENT,a=i.canonical.y*e.EXTENT;for(let e=0;e<t.length;e++){const i=t.get(e);if(i.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=i,h=Math.floor((o+c)*s),d=Math.floor((a+u)*s),p=this.index.range(h-r,d-r,h+r,d+r);for(const e of p){const t=this.crossTileIDs[e];if(this.keys[e]===l&&!n.has(t)){n.add(t),i.crossTileID=t;break}}}}}class Gt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const i in this.indexes){const e=this.indexes[i],n={};for(const i in e){const r=e[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),n[r.tileID.key]=r}this.indexes[i]=n}this.lng=e}addBucket(e,t,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const s=i[r];s.tileID.isChildOf(e)&&s.findMatches(t.symbolInstances,e,n)}else{const s=i[e.scaledTo(Number(r)).key];s&&s.findMatches(t.symbolInstances,e,n)}}for(let r=0;r<t.symbolInstances.length;r++){const e=t.symbolInstances.get(r);e.crossTileID||(e.crossTileID=i.generate(),n.add(e.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Vt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const i of t.crossTileIDs)this.usedCrossTileIDs[e].delete(i)}removeStaleBuckets(e){let t=!1;for(const i in this.indexes){const n=this.indexes[i];for(const r in n)e[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],t=!0)}return t}}class Ht{constructor(){this.layerIndexes={},this.crossTileIDs=new Gt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,i,n){let r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new Wt);let s=!1;const o={};"globe"!==n.name&&r.handleWrapJump(i);for(const a of t){const t=a.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(a.tileID,t,this.crossTileIDs)&&(s=!0),o[t.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(s=!0),s}pruneUnusedLayers(e){const t={};e.forEach(e=>{t[e]=!0});for(const i in this.layerIndexes)t[i]||delete this.layerIndexes[i]}}const Xt=(t,i)=>e.emitValidationErrors(t,i&&i.filter(e=>"source.canvas"!==e.identifier)),qt=e.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zt=e.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),Yt={version:8,layers:[],sources:{}},Kt={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Jt extends e.Evented{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=t,this.dispatcher=new P(Ne(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new e.GlyphManager(t._requestManager,i.localFontFamily?e.LocalGlyphMode.all:i.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,i.localFontFamily||i.localIdeographFontFamily),this.crossTileSymbolIndex=new Ht,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());const n=this;this._rtlTextPluginCallback=Jt.registerForPluginStateChange(t=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(t,i)=>{if(e.triggerPluginCompletionEvent(t),i&&i.every(e=>e))for(const e in n._sourceCaches){const t=n._sourceCaches[e],i=t.getSource().type;"vector"!==i&&"geojson"!==i||t.reload()}})}),this.on("data",e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(const i in this._layers){const e=this._layers[i];e.source===t.id&&this._validateLayer(e)}})}loadURL(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"}));const n="boolean"==typeof i.validate?i.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,i.accessToken);const r=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(r,(t,i)=>{this._request=null,t?this.fire(new e.ErrorEvent(t)):i&&this._load(i,n)})}loadJSON(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame(()=>{this._request=null,this._load(t,!1!==i.validate)})}loadEmpty(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Yt,!1)}_updateLayerCount(e,t){const i=t?1:-1;e.is3D()&&(this._num3DLayers+=i),"circle"===e.type&&(this._numCircleLayers+=i),"symbol"===e.type&&(this._numSymbolLayers+=i)}_load(t,i){if(i&&Xt(this,e.validateStyle(t)))return;this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection();for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const n=je(this.stylesheet.layers);this._order=n.map(e=>e.id),this._layers={},this._serializedLayers={};for(const r of n){const t=e.createStyleLayer(r);t.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=t,this._serializedLayers[t.id]=t.serialize(),this._updateLayerCount(t,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(t,i,n){let r,s,o;const a=e.exported.devicePixelRatio>1?"@2x":"";let l=e.getJSON(i.transformRequest(i.normalizeSpriteURL(t,a,".json"),e.ResourceType.SpriteJSON),(e,t)=>{l=null,o||(o=e,r=t,u())}),c=e.getImage(i.transformRequest(i.normalizeSpriteURL(t,a,".png"),e.ResourceType.SpriteImage),(e,t)=>{c=null,o||(o=e,s=t,u())});function u(){if(o)n(o);else if(r&&s){const t=e.exported.getImageData(s),i={};for(const n in r){const{width:s,height:o,x:a,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=r[n],m=new e.RGBAImage({width:s,height:o});e.RGBAImage.copy(t,m,{x:a,y:l},{x:0,y:0},{width:s,height:o}),i[n]={data:m,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}n(null,i)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,(t,i)=>{if(this._spriteRequest=null,t)this.fire(new e.ErrorEvent(t));else if(i)for(const e in i)this.imageManager.addImage(e,i[e]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new e.Event("data",{dataType:"style"}))})}_validateLayer(t){const i=this.getSource(t.source);if(!i)return;const n=t.sourceLayer;n&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'.concat(n,'" does not exist on source "').concat(i.id,'" as specified by style layer "').concat(t.id,'"'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(e){const t=[];for(const i of e){const e=this._layers[i];"custom"!==e.type&&t.push(e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&("function"==typeof e.isLayerDraped?e.isLayerDraped():Kt[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const i=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(e.length||i.length)&&this._updateWorkerLayers(e,i);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const n in this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const n={};for(const e in this._sourceCaches){const t=this._sourceCaches[e];n[e]=t.used,t.used=!1}for(const e of this._order){const i=this._layers[e];if(i.recalculate(t,this._availableImages),!i.isHidden(t.zoom)){const e=this._getLayerSourceCache(i);e&&(e.used=!0)}const n=this.map.painter;if(n){const e=i.getProgramIds();if(!e)continue;const r=i.getProgramConfiguration(t.zoom);for(const t of e)n.useProgram(t,r)}}for(const r in n){const t=this._sourceCaches[r];n[r]!==t.used&&t.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new e.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Xt(this,e.validateStyle(i)))return!1;(i=e.clone$1(i)).layers=je(i.layers);const n=function(e,i){if(!e)return[{command:Ve.setStyle,args:[i]}];let n=[];try{if(!t(e.version,i.version))return[{command:Ve.setStyle,args:[i]}];t(e.center,i.center)||n.push({command:Ve.setCenter,args:[i.center]}),t(e.zoom,i.zoom)||n.push({command:Ve.setZoom,args:[i.zoom]}),t(e.bearing,i.bearing)||n.push({command:Ve.setBearing,args:[i.bearing]}),t(e.pitch,i.pitch)||n.push({command:Ve.setPitch,args:[i.pitch]}),t(e.sprite,i.sprite)||n.push({command:Ve.setSprite,args:[i.sprite]}),t(e.glyphs,i.glyphs)||n.push({command:Ve.setGlyphs,args:[i.glyphs]}),t(e.transition,i.transition)||n.push({command:Ve.setTransition,args:[i.transition]}),t(e.light,i.light)||n.push({command:Ve.setLight,args:[i.light]}),t(e.fog,i.fog)||n.push({command:Ve.setFog,args:[i.fog]}),t(e.projection,i.projection)||n.push({command:Ve.setProjection,args:[i.projection]});const r={},s=[];!function(e,i,n,r){let s;for(s in i=i||{},e=e||{})e.hasOwnProperty(s)&&(i.hasOwnProperty(s)||We(s,n,r));for(s in i){if(!i.hasOwnProperty(s))continue;const o=i[s];e.hasOwnProperty(s)?t(e[s],o)||("geojson"===e[s].type&&"geojson"===o.type&&Xe(e,i,s)?n.push({command:Ve.setGeoJSONSourceData,args:[s,o.data]}):He(s,i,n,r)):Ge(s,i,n)}}(e.sources,i.sources,s,r);const o=[];e.layers&&e.layers.forEach(e=>{e.source&&r[e.source]?n.push({command:Ve.removeLayer,args:[e.id]}):o.push(e)});let a=e.terrain;a&&r[a.source]&&(n.push({command:Ve.setTerrain,args:[void 0]}),a=void 0),n=n.concat(s),t(a,i.terrain)||n.push({command:Ve.setTerrain,args:[i.terrain]}),function(e,i,n){i=i||[];const r=(e=e||[]).map(Ze),s=i.map(Ze),o=e.reduce(Ye,{}),a=i.reduce(Ye,{}),l=r.slice(),c=Object.create(null);let u,h,d,p,m,f,g;for(u=0,h=0;u<r.length;u++)d=r[u],a.hasOwnProperty(d)?h++:(n.push({command:Ve.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<s.length;u++)d=s[s.length-1-u],l[l.length-1-u]!==d&&(o.hasOwnProperty(d)?(n.push({command:Ve.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,f=l[l.length-u],n.push({command:Ve.addLayer,args:[a[d],f]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<s.length;u++)if(d=s[u],p=o[d],m=a[d],!c[d]&&!t(p,m))if(t(p.source,m.source)&&t(p["source-layer"],m["source-layer"])&&t(p.type,m.type)){for(g in qe(p.layout,m.layout,n,d,null,Ve.setLayoutProperty),qe(p.paint,m.paint,n,d,null,Ve.setPaintProperty),t(p.filter,m.filter)||n.push({command:Ve.setFilter,args:[d,m.filter]}),t(p.minzoom,m.minzoom)&&t(p.maxzoom,m.maxzoom)||n.push({command:Ve.setLayerZoomRange,args:[d,m.minzoom,m.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?qe(p[g],m[g],n,d,g.slice(6),Ve.setPaintProperty):t(p[g],m[g])||n.push({command:Ve.setLayerProperty,args:[d,g,m[g]]}));for(g in m)m.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?qe(p[g],m[g],n,d,g.slice(6),Ve.setPaintProperty):t(p[g],m[g])||n.push({command:Ve.setLayerProperty,args:[d,g,m[g]]}))}else n.push({command:Ve.removeLayer,args:[d]}),f=l[l.lastIndexOf(d)+1],n.push({command:Ve.addLayer,args:[m,f]})}(o,i.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:Ve.setStyle,args:[i]}]}return n}(this.serialize(),i).filter(e=>!(e.command in Zt));if(0===n.length)return!1;const r=n.filter(e=>!(e.command in qt));if(r.length>0)throw new Error("Unimplemented: ".concat(r.map(e=>e.command).join(", "),"."));return n.forEach(e=>{"setTransition"!==e.command&&"setProjection"!==e.command&&this[e.command].apply(this,e.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(t,i){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,i),this._afterImageUpdated(t),this)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!i.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(i).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(e.validateSource,"sources.".concat(t),i,null,n))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const r=Ie(t,i,this.dispatcher,this);r.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:r.serialize(),sourceId:t}));const s=i=>{const n=(i?"symbol:":"other:")+t,s=this._sourceCaches[n]=new e.SourceCache(n,r,i);(i?this._symbolSourceCaches:this._otherSourceCaches)[t]=s,s.style=this,s.onAdd(this.map)};s(!1),"vector"!==i.type&&"geojson"!==i.type||s(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const i=this.getSource(t);if(!i)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(r,'" is using it.'))));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while terrain is using it.'))));const n=this._getSourceCaches(t);for(const r of n)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}getSource(e){const t=this._getSourceCache(e);return t&&t.getSource()}_getSources(){const e=[];for(const t in this._otherSourceCaches){const i=this._getSourceCache(t);i&&e.push(i.getSource())}return e}addLayer(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(r,'" already exists on this map'))));let s;if("custom"===t.type){if(Xt(this,e.validateCustomStyleLayer(t)))return;s=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=e.clone$1(t),t=e.extend(t,{source:r})),this._validate(e.validateLayer,"layers.".concat(r),t,{arrayIndex:-1},n))return;s=e.createStyleLayer(t),this._validateLayer(s),s.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}const o=i?this._order.indexOf(i):this._order.length;if(i&&-1===o)return void this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(i,'" does not exist on this map.'))));this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=s;const a=this._getLayerSourceCache(s);if(this._removedLayers[r]&&s.source&&a&&"custom"!==s.type){const e=this._removedLayers[r];delete this._removedLayers[r],e.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",a.pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,i){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be moved."))));if(t===i)return;const n=this._order.indexOf(t);this._order.splice(n,1);const r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(i,'" does not exist on this map.')))):(this._order.splice(r,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const i=this._layers[t];if(!i)return void this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be removed."))));i.setEventedParent(null),this._updateLayerCount(i,!1);const n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=i,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],i.onRemove&&i.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(e){return this._layers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(t,i,n){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===i&&r.maxzoom===n||(null!=i&&(r.minzoom=i),null!=n&&(r.maxzoom=n),this._updateLayer(r)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot have zoom extent."))))}setFilter(i,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const s=this.getLayer(i);if(s){if(!t(s.filter,n))return null==n?(s.filter=void 0,void this._updateLayer(s)):void(this._validate(e.validateFilter,"layers.".concat(s.id,".filter"),n,{layerType:s.type},r)||(s.filter=e.clone$1(n),this._updateLayer(s)))}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be filtered."))))}getFilter(t){const i=this.getLayer(t);return i&&e.clone$1(i.filter)}setLayoutProperty(i,n,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this.getLayer(i);o?t(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,s),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be styled."))))}getLayoutProperty(t,i){const n=this.getLayer(t);if(n)return n.getLayoutProperty(i);this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style."))))}setPaintProperty(i,n,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this.getLayer(i);o?t(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,s)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new e.ErrorEvent(new Error("The layer '".concat(i,"' does not exist in the map's style and cannot be styled."))))}getPaintProperty(e,t){const i=this.getLayer(e);return i&&i.getPaintProperty(t)}setFeatureState(t,i){this._checkLoaded();const n=t.source,r=t.sourceLayer,s=this.getSource(n);if(!s)return void this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))));const o=s.type;if("geojson"===o&&r)return void this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===o&&!r)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(n);for(const e of a)e.setFeatureState(r,t.id,i)}removeFeatureState(t,i){this._checkLoaded();const n=t.source,r=this.getSource(n);if(!r)return void this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))));const s=r.type,o="vector"===s?t.sourceLayer:void 0;if("vector"===s&&!o)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(n);for(const e of a)e.removeFeatureState(o,t.id,i)}getFeatureState(t){this._checkLoaded();const i=t.source,n=t.sourceLayer,r=this.getSource(i);if(r){if("vector"!==r.type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(i)[0].getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(i,"' does not exist in the map's style."))))}getTransition(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const e in this._sourceCaches){const i=this._sourceCaches[e].getSource();t[i.id]||(t[i.id]=i.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},e=>void 0!==e)}_updateLayer(e){this._updatedLayers[e.id]=!0;const t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,i={},n=[];for(let s=this._order.length-1;s>=0;s--){const r=this._order[s];if(t(r)){i[r]=s;for(const t of e){const e=t[r];if(e)for(const t of e)n.push(t)}}}n.sort((e,t)=>t.intersectionZ-e.intersectionZ);const r=[];for(let s=this._order.length-1;s>=0;s--){const o=this._order[s];if(t(o))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(i[t.layer.id]<s)break;r.push(t),n.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)r.push(t.feature)}}return r}queryRenderedFeatures(t,i,n){i&&i.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",i.filter,null,i);const r={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const t of i.layers){const i=this._layers[t];if(!i)return this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be queried for features.")))),[];r[i.source]=!0}}const s=[];i.availableImages=this._availableImages;const o=i&&i.layers?i.layers.some(e=>{const t=this.getLayer(e);return t&&t.is3D()}):this.has3DLayers(),a=k.createFromScreenPoints(t,n);for(const e in this._sourceCaches){const t=this._sourceCaches[e].getSource().id;i.layers&&!r[t]||s.push(Me(this._sourceCaches[e],this._layers,this._serializedLayers,a,i,n,o,!!this.map._showQueryGeometry))}return this.placement&&s.push(function(e,t,i,n,r,s,o){const a={},l=s.queryRenderedSymbols(n),c=[];for(const u of Object.keys(l).map(Number))c.push(o[u]);c.sort(Fe);for(const u of c){const i=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],t,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(const e in i){const t=a[e]=a[e]||[],n=i[e];n.sort((e,t)=>{const i=u.featureSortOrder;if(i){const n=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex});for(const e of n)t.push(e)}}for(const u in a)a[u].forEach(t=>{const n=t.feature,r=i(e[u]);if(!r)return;const s=r.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=s});return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(t,i){i&&i.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",i.filter,null,i);const n=this._getSourceCaches(t);let r=[];for(const e of n)r=r.concat(Re(e,i));return r}addSourceType(e,t,i){return Jt.getSourceType(e)?i(new Error('A source type called "'.concat(e,'" already exists.'))):(Jt.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const n=this.light.getLight();let r=!1;for(const o in e)if(!t(e[o],n[o])){r=!0;break}if(!r)return;const s=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,i),this.light.updateTransitions(s)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let r=i;if(1===n){if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.clone$1(r),r=e.extend(r,{source:t})}if(this._validate(e.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&n!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,n)}else{const i=this.terrain,n=i.get();for(const t of Object.keys(e.spec.terrain))!r.hasOwnProperty(t)&&e.spec.terrain[t].default&&(r[t]=e.spec.terrain[t].default);for(const e in r)if(!t(r[e],n[e])){i.set(r),this.stylesheet.terrain=r;const e=this._setTransitionParameters({duration:0});i.updateTransitions(e);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new C(e,this.map.transform);this.stylesheet.fog=e;const i=this._setTransitionParameters({duration:0});t.updateTransitions(i)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const e of this.map._markers)e._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog,n=i.get();0===Object.keys(e).length&&i.set(e);for(const r in e)if(!t(e[r],n[r])){i.set(e),this.stylesheet.fog=e;const t=this._setTransitionParameters({duration:0});i.updateTransitions(t);break}}else this._createFog(e);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=this._order.filter(e=>this.isLayerDraped(this._layers[e])),t=this._order.filter(e=>!this.isLayerDraped(this._layers[e]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const i=this.terrain=new A(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const n=this._setTransitionParameters({duration:0});i.updateTransitions(n)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,i,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!s||!1!==s.validate)&&Xt(this,t.call(e.validateStyle,e.extend({key:i,style:this.serialize(),value:n,styleSpec:e.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const t=this._getSourceCaches(e);for(const i of t)i.clearTiles()}_reloadSource(e){const t=this._getSourceCaches(e);for(const i of t)i.resume(),i.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const t in this._sourceCaches)this._sourceCaches[t].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,i,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1,a=!1;const l={};for(const e of this._order){const i=this._layers[e];if("symbol"!==i.type)continue;if(!l[i.source]){const e=this._getLayerSourceCache(i);if(!e)continue;l[i.source]=e.getRenderableIds(!0).map(t=>e.getTileByID(t)).sort((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(i,l[i.source],t.center.lng,t.projection);o=o||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new Ut(t,this._order,s,i,n,r,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,i){this.imageManager.getImages(t.icons,i),this._updateTilesForChangedImages();const n=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};n(this._otherSourceCaches[t.source]),n(this._symbolSourceCaches[t.source])}getGlyphs(e,t,i){this.glyphManager.getGlyphs(t.stacks,i)}getResource(t,i,n){return e.makeRequest(i,n)}_getSourceCache(e){return this._otherSourceCaches[e]}_getLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const i=this._getSourceCaches(t);return 0===i.length?(this.fire(new e.ErrorEvent(new Error("There is no source with ID '".concat(t,"'")))),!1):i.every(e=>e.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Jt.getSourceType=function(e){return Pe[e]},Jt.setSourceType=function(e,t){Pe[e]=t},Jt.registerForPluginStateChange=e.registerForPluginStateChange;var $t="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Qt="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ei="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",ti="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ii="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let ni={},ri={};const si=[];ui($t,si),ui(ei,si),ui(ti,si),ui(ii,si),ni=hi("",ei),ri=hi(ii,ti);const oi=hi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ai=$t,li="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ci={background:hi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxGradient:hi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxCapture:hi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ui(e,t){const i=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let n of i)if(n=n.trim(),"#"===n[0]&&n.includes("if")&&!n.includes("endif")){n=n.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=n.split(" ");for(const i of e)t.includes(i)||t.push(i)}}function hi(e,t){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),r={},s=[...si];return ui(e,s),ui(t,s),{fragmentSource:e=e.replace(i,(e,t,i,n,s)=>(r[s]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(s,"\nvarying ").concat(i," ").concat(n," ").concat(s,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(s,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(s,"\n    ").concat(i," ").concat(n," ").concat(s," = u_").concat(s,";\n#endif\n"))),vertexSource:t=t.replace(i,(e,t,i,n,s)=>{const o="float"===n?"vec2":"vec4",a=s.match(/color/)?"color":o;return r[s]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(s,"\nuniform lowp float u_").concat(s,"_t;\nattribute ").concat(i," ").concat(o," a_").concat(s,";\nvarying ").concat(i," ").concat(n," ").concat(s,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(s,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(s,"\n    ").concat(s," = a_").concat(s,";\n#else\n    ").concat(i," ").concat(n," ").concat(s," = u_").concat(s,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(s,"\n    ").concat(s," = unpack_mix_").concat(a,"(a_").concat(s,", u_").concat(s,"_t);\n#else\n    ").concat(i," ").concat(n," ").concat(s," = u_").concat(s,";\n#endif\n"):"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(s,"\nuniform lowp float u_").concat(s,"_t;\nattribute ").concat(i," ").concat(o," a_").concat(s,";\n#else\nuniform ").concat(i," ").concat(n," u_").concat(s,";\n#endif\n"):"vec4"===a?"\n#ifndef HAS_UNIFORM_u_".concat(s,"\n    ").concat(i," ").concat(n," ").concat(s," = a_").concat(s,";\n#else\n    ").concat(i," ").concat(n," ").concat(s," = u_").concat(s,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(s,"\n    ").concat(i," ").concat(n," ").concat(s," = unpack_mix_").concat(a,"(a_").concat(s,", u_").concat(s,"_t);\n#else\n    ").concat(i," ").concat(n," ").concat(s," = u_").concat(s,";\n#endif\n")}),staticAttributes:n,usedDefines:s}}class di{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,i,n,r,s,o){this.context=e;let a=this.boundPaintVertexBuffers.length!==n.length;for(let c=0;!a&&c<n.length;c++)this.boundPaintVertexBuffers[c]!==n[c]&&(a=!0);let l=this.boundDynamicVertexBuffers.length!==o.length;for(let c=0;!l&&c<o.length;c++)this.boundDynamicVertexBuffers[c]!==o[c]&&(l=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==i||a||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==s)this.freshBind(t,i,n,r,s,o);else{e.bindVertexArrayOES.set(this.vao);for(const e of o)e&&e.bind();r&&r.dynamicDraw&&r.bind()}}freshBind(e,t,i,n,r,s){let o;const a=e.numAttributes,l=this.context,c=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),o=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffers=s;else{o=l.currentNumAttributes||0;for(let e=a;e<o;e++)c.disableVertexAttribArray(e)}t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,r);for(const u of i)u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,r);for(const u of s)u&&(u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,r));n&&n.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function pi(t,i){const n=Math.pow(2,i.canonical.z),r=i.canonical.y;return[new e.MercatorCoordinate(0,r/n).toLngLat().lat,new e.MercatorCoordinate(0,(r+1)/n).toLngLat().lat]}function mi(t,i,n,r,s,o,a){const l=t.context,c=l.gl,u=n.fbo;if(!u)return;t.prepareDrawTile();const h=t.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const d=((e,t,i,n)=>{const r=i.paint.get("hillshade-shadow-color"),s=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color");let a=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(a-=e.transform.angle);const l=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:pi(0,t.tileID),u_light:[i.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:s,u_accent:o}})(t,n,r,t.terrain?i.projMatrix:null);t.prepareDrawProgram(l,h,i.toUnwrapped());const{tileBoundsBuffer:p,tileBoundsIndexBuffer:m,tileBoundsSegments:f}=t.getTileBoundsBuffers(n);h.draw(l,c.TRIANGLES,s,o,a,e.CullFaceMode.disabled,d,r.id,p,m,f)}function fi(t,i,n){if(!i.needsDEMTextureUpload)return;const r=t.context,s=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(n.stride);const o=n.getPixels();i.demTexture?i.demTexture.update(o,{premultiply:!1}):i.demTexture=new e.Texture(r,o,s.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function gi(t,i,n,r,s,o){const a=t.context,l=a.gl;if(!i.dem)return;const c=i.dem;if(a.activeTexture.set(l.TEXTURE1),fi(t,i,c),!i.demTexture)return;i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const u=c.dim;a.activeTexture.set(l.TEXTURE0);let h=i.fbo;if(!h){const t=new e.Texture(a,{width:u,height:u,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),h=i.fbo=a.createFramebuffer(u,u,!0),h.colorAttachment.set(t.texture)}a.bindFramebuffer.set(h.framebuffer),a.viewport.set([0,0,u,u]);const{tileBoundsBuffer:d,tileBoundsIndexBuffer:p,tileBoundsSegments:m}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,s,o,e.CullFaceMode.disabled,((t,i)=>{const n=i.stride,r=e.create();return e.ortho(r,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(r,r,[0,-e.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:i.unpackVector}})(i.tileID,c),n.id,d,p,m),i.needsHillshadePrepare=!1}const _i=t=>({u_matrix:new e.UniformMatrix4f(t),u_image0:new e.Uniform1i(t),u_skirt_height:new e.Uniform1f(t)}),vi=(e,t)=>({u_matrix:e,u_image0:0,u_skirt_height:t}),yi=(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(n),u_merc_matrix:i,u_zoom_transition:r,u_merc_center:s,u_image0:0,u_frustum_tl:o,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:h,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p});function bi(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const xi=new class{constructor(){this.operations={}}newMorphing(e,t,i,n,r){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==i.tileID.key&&(t.queued=i)}else this.operations[e]={startTime:n,phase:0,duration:r,from:t,to:i,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const i=this.operations[t];for(i.phase=(e-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},wi={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ei(e){return 6*Math.pow(1.5,22-e)}function Ai(e,t){const i=1<<e.z;return!t&&(0===e.x||e.x===i-1)||0===e.y||e.y===i-1}const Ti=e=>({u_matrix:e});function Di(t,i,n,r,s){if(s>0){const o=e.exported.now(),a=(o-t.timeAdded)/s,l=i?(o-i.timeAdded)/s:-1,c=n.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!i||Math.abs(i.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),d=h&&t.refreshedUponExpiration?1:e.clamp(h?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class Si extends e.SourceCache{constructor(e){const t={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new P(Ne(),null),n=Ie("mock-dem",t,i,e.style);super("mock-dem",n,!1),n.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class Ci extends e.SourceCache{constructor(e){const t=Ie("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new P(Ne(),null),e.style);super("proxy",t,!1),t.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,i,n){if(t.freezeTileCoverage)return;this.transform=t;const r=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((i,n)=>{if(i[n.key]="",!this._tiles[n.key]){const i=new e.Tile(n,this._source.tileSize*n.overscaleFactor(),t.tileZoom);i.state="loaded",this._tiles[n.key]=i}return i},{});for(const e in this._tiles)e in r||(this.freeFBO(e),this._tiles[e].unloadVectorData(),delete this._tiles[e])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const i=Object.values(t);this.renderCachePool.push(...i),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach(e=>e.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Pi extends e.OverscaledTileID{constructor(e,t,i){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=i}}class Ii extends e.Elevation{constructor(t,i){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[n,r,s]=function(){const t=new e.StructArrayLayout2i4,i=new e.StructArrayLayout3ui6,n=131;t.reserve(17161),i.reserve(33800);const r=e.EXTENT/128,s=e.EXTENT+r/2,o=s+r;for(let l=-r;l<o;l+=r)for(let i=-r;i<o;i+=r){const n=i<0||i>s||l<0||l>s?24575:0,r=e.clamp(Math.round(i),0,e.EXTENT),o=e.clamp(Math.round(l),0,e.EXTENT);t.emplaceBack(r+n,o)}const a=(e,t)=>{const r=t*n+e;i.emplaceBack(r+1,r,r+n),i.emplaceBack(r+n,r+n+1,r+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)a(t,e);return[0,129].forEach(e=>{for(let t=0;t<130;t++)a(t,e),a(e,t)}),[t,i,32768]}(),o=t.context;this.gridBuffer=o.createVertexBuffer(n,e.posAttributes.members),this.gridIndexBuffer=o.createIndexBuffer(r),this.gridSegments=e.SegmentVector.simpleSegment(0,0,n.length,r.length),this.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,n.length,s),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ci(i.map),this.orthoMatrix=e.create(),e.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.EXTENT,0,e.EXTENT,0,1);const a=o.gl;this._overlapStencilMode=new e.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Si(i.map)}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,i,n){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const r=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const s=()=>{this.sourceCache.used&&e.warnOnce("Raster DEM source '".concat(this.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));const t=this.getScaledDemTileSize();this.sourceCache.update(i,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,s(),this._initializing=!0),s(),i.updateElevation(!0,n),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce("Terrain render cache efficiency is not optimal (".concat(t.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(t.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(e=>e.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,n=this.painter.transform;this._initializing&&(this._initializing=0===n._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(n.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=i.getIds().map(e=>{const t=i.getTileByID(e).tileID;return t.projMatrix=n.calculateProjMatrix(t.toUnwrapped()),t});!function(t,i){const n=i.transform.pointCoordinate(i.transform.getCameraPoint()),r=new e.Point(n.x,n.y);t.sort((t,i)=>{if(i.overscaledZ-t.overscaledZ)return i.overscaledZ-t.overscaledZ;const n=new e.Point(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),s=new e.Point(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),o=r.mult(1<<t.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(n)-o.distSqr(s)})}(r,this.painter),this._previousZoom=n.zoom;const s=this.proxyToSource||{};this.proxyToSource={},r.forEach(e=>{this.proxyToSource[e.key]={}}),this.terrainTileForTile={};const o=this._style._sourceCaches;for(const e in o){const i=o[e];if(!i.used)continue;if(i!==this.sourceCache&&this.resetTileLookupCache(i.id),this._setupProxiedCoordsForOrtho(i,t[e],s),i.usedForTerrain)continue;const n=t[e];i.getSource().reparseOverscaled&&this._assignTerrainTiles(n)}this.proxiedCoords[i.id]=r.map(e=>new Pi(e,e.key,this.orthoMatrix)),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(s),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();const a={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const i=t.tileID.key;i in a||(this._visibleDemTiles.push(t),a[i]=i)}}_assignTerrainTiles(e){this._initializing||e.forEach(e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)})}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const i in this.terrainTileForTile){const n=this.terrainTileForTile[i],r=n.dem;!r||n.demTexture&&!n.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),fi(this.painter,n,r))}}_prepareDemTileUniforms(e,t,i,n){if(!t||null==t.demTexture)return!1;const r=e.tileID.canonical,s=Math.pow(2,t.tileID.canonical.z-r.z),o=n||"";return i["u_dem_tl".concat(o)]=[r.x*s%1,r.y*s%1],i["u_dem_scale".concat(o)]=s,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,i=t.gl;if(!this._emptyDepthBufferTexture){const n=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,n,i.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const t=this._visibleDemTiles.reduce((t,i)=>{if(!i.dem)return t;const n=i.dem.tree.minimums[0];return n>0&&e++,t+n},0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,i=t.gl;t.activeTexture.set(i.TEXTURE2);const n=this._getLoadedAreaMinimum(),r=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(n,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let s=this._emptyDEMTexture;return s?s.update(r,{premultiply:!1}):s=this._emptyDEMTexture=new e.Texture(t,r,i.RGBA,{premultiply:!1}),s}setupElevationDraw(t,i,n){const r=this.painter.context,s=r.gl,o=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;o.u_dem_size=this.sourceCache.getSource().tileSize,o.u_exaggeration=this.exaggeration();let l=null,c=null,u=1;if(n&&n.morphing&&this._useVertexMorphing){const e=n.morphing.srcDemTile,i=n.morphing.dstDemTile;u=n.morphing.phase,e&&i&&(this._prepareDemTileUniforms(t,e,o,"_prev")&&(c=e),this._prepareDemTileUniforms(t,i,o)&&(l=i))}if(c&&l?(r.activeTexture.set(s.TEXTURE2),l.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),r.activeTexture.set(s.TEXTURE4),c.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE,s.NEAREST),o.u_dem_lerp=u):(l=this.terrainTileForTile[t.tileID.key],r.activeTexture.set(s.TEXTURE2),(this._prepareDemTileUniforms(t,l,o)?l.demTexture:this.emptyDEMTexture).bind(s.NEAREST,s.CLAMP_TO_EDGE)),r.activeTexture.set(s.TEXTURE3),n&&n.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),this._depthFBO&&(o.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),o.u_depth_size_inv=[1,1]),n&&n.useMeterToDem&&l){const t=(1<<l.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;o.u_meter_to_dem=t}if(n&&n.labelPlaneMatrixInv&&(o.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),i.setTerrainUniformValues(r,o),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,n&&n.useDenormalizedUpVectorScale);i.setGlobeUniformValues(r,e)}}globeUniformValues(t,i,n){const r=t.projection;return{u_tile_tl_up:r.upVector(i,0,0),u_tile_tr_up:r.upVector(i,e.EXTENT,0),u_tile_br_up:r.upVector(i,e.EXTENT,e.EXTENT),u_tile_bl_up:r.upVector(i,0,e.EXTENT),u_tile_up_scale:n?e.globeMetersToEcef(1):r.upVectorScale(i,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const i=this.painter,n=this.painter.context;0!==t.length&&(n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,i,n,r,s){if("globe"===t.transform.projection.name)!function(t,i,n,r,s){const o=t.context,a=o.gl;let l,c;const u=t.options.showTerrainWireframe?2:0,h=t.transform,d=e.globeUseCustomAntiAliasing(t,o,h),p=(e,i)=>{if(c===e)return;const n=[wi[e],"PROJECTION_GLOBE_VIEW"];d&&n.push("CUSTOM_ANTIALIASING"),i&&n.push(wi[u]),l=t.useProgram("globeRaster",null,n),c=e},m=t.colorModeForRenderPass(),f=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);xi.update(s);const g=e.calculateGlobeMercatorMatrix(h),_=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],v=u?[!1,!0]:[!1],y=t.globeSharedBuffers,b=[h.width*e.exported.devicePixelRatio,h.height*e.exported.devicePixelRatio],x=Float32Array.from(h.globeMatrix),w={useDenormalizedUpVectorScale:!0};if(v.forEach(u=>{const h=t.transform,d=Ei(h.zoom)*i.exaggeration();c=-1;const v=u?a.LINES:a.TRIANGLES;for(const c of r){const r=n.getTile(c),E=e.StencilMode.disabled,A=i.prevTerrainTileForTile[c.key],T=i.terrainTileForTile[c.key];bi(A,T)&&xi.newMorphing(c.key,A,T,s,250),o.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const D=xi.getMorphValuesForProxy(c.key),S=D?1:0;D&&e.extend$1(w,{morphing:{srcDemTile:D.from,dstDemTile:D.to,phase:e.easeCubicInOut(D.phase)}});const C=e.tileCornersToBounds(c.canonical),P=e.getLatitudinalLod(C.getCenter().lat),I=e.getGridMatrix(c.canonical,C,P,h.worldSize/h._pixelsPerMercatorPixel),k=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),M=yi(h.projMatrix,x,g,k,e.globeToMercatorTransition(h.zoom),_,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,b,d,I);if(p(S,u),i.setupElevationDraw(r,l,w),t.prepareDrawProgram(o,l,c.toUnwrapped()),y){const[i,n,r]=u?y.getWirefameBuffers(t.context,P):y.getGridBuffers(P,0!==d);l.draw(o,v,f,E,m,e.CullFaceMode.backCCW,M,"globe_raster",i,n,r)}}}),y){const s=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];d&&s.push("CUSTOM_ANTIALIASING"),l=t.useProgram("globeRaster",null,s);for(const c of r){const{x:r,y:s,z:u}=c.canonical,d=0===s,p=s===(1<<u)-1,[g,v,x,E]=y.getPoleBuffers(u);if(E&&(d||p)){const s=n.getTile(c);o.activeTexture.set(a.TEXTURE0),s.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let y=e.globePoleMatrixForTile(u,r,h);const A=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),T=(t,i)=>t.draw(o,a.TRIANGLES,f,e.StencilMode.disabled,m,e.CullFaceMode.disabled,yi(h.projMatrix,y,y,A,0,_,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,b,0),"globe_pole_raster",i,x,E);i.setupElevationDraw(s,l,w),t.prepareDrawProgram(o,l,c.toUnwrapped()),d&&T(l,g),p&&(y=e.scale(e.create(),y,[1,-1,1]),T(l,v))}}}}(t,i,n,r,s);else{const o=t.context,a=o.gl;let l,c;const u=t.options.showTerrainWireframe?2:0,h=(e,i)=>{if(c===e)return;const n=[wi[e]];i&&n.push(wi[u]),l=t.useProgram("terrainRaster",null,n),c=e},d=t.colorModeForRenderPass(),p=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);xi.update(s);const m=t.transform,f=Ei(m.zoom)*i.exaggeration();(u?[!1,!0]:[!1]).forEach(u=>{c=-1;const g=u?a.LINES:a.TRIANGLES,[_,v]=u?i.getWirefameBuffer():[i.gridIndexBuffer,i.gridSegments];for(const c of r){const r=n.getTile(c),y=e.StencilMode.disabled,b=i.prevTerrainTileForTile[c.key],x=i.terrainTileForTile[c.key];bi(b,x)&&xi.newMorphing(c.key,b,x,s,250),o.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const w=xi.getMorphValuesForProxy(c.key),E=w?1:0;let A;w&&(A={morphing:{srcDemTile:w.from,dstDemTile:w.to,phase:e.easeCubicInOut(w.phase)}});const T=vi(c.projMatrix,Ai(c.canonical,m.renderWorldCopies)?f/10:f);h(E,u),i.setupElevationDraw(r,l,A),t.prepareDrawProgram(o,l,c.toUnwrapped()),l.draw(o,g,p,y,d,e.CullFaceMode.backCCW,T,"terrain_raster",i.gridBuffer,_,v)}})}}(i,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const i=this.painter,n=this.painter.context,r=this.proxySourceCache,s=this.proxiedCoords[r.id],o=this._drapedRenderBatches.shift(),a=[],l=i.style.order;let c=0;for(const u of s){const s=r.getTileByID(u.proxyTileKey),h=r.proxyCachedFBO[u.key]?r.proxyCachedFBO[u.key][t]:void 0,d=void 0!==h?r.renderCache[h]:this.pool[c++],p=void 0!==h;if(s.texture=d.tex,p&&!d.dirty){a.push(s.tileID);continue}let m;n.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(n.clear({color:e.Color.transparent,stencil:0}),d.dirty=!1);for(let e=o.start;e<=o.end;++e){const t=i.style._layers[l[e]];if(t.isHidden(i.transform.zoom))continue;const r=i.style._getLayerSourceCache(t),s=r?this.proxyToSource[u.key][r.id]:[u];if(!s)continue;const o=s;n.viewport.set([0,0,d.fb.width,d.fb.height]),m!==(r?r.id:null)&&(this._setupStencil(d,s,t,r),m=r?r.id:null),i.renderLayer(i,r,t,o)}this.renderedToTile?(d.dirty=!0,a.push(s.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),o.end+1}postRender(){}renderCacheEfficiency(e){const t=e.order.length;if(0===t)return{efficiency:100};let i,n=0,r=0,s=!1;for(let o=0;o<t;++o){const t=e._layers[e.order[o]];this._style.isLayerDraped(t)?(s&&++n,++r):s||(s=!0,i=t.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-n/r),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter(e=>e.dem).forEach(t=>{e=Math.min(e,t.dem.tree.minimums[0])}),0===e?e:(e-30)*this._exaggeration}raycast(e,t,i){if(!this._visibleDemTiles)return null;const n=this._visibleDemTiles.filter(e=>e.dem).map(n=>{const r=n.tileID,s=1<<r.overscaledZ,{x:o,y:a}=r.canonical,l=o/s,c=(o+1)/s,u=a/s,h=(a+1)/s;return{minx:l,miny:u,maxx:c,maxy:h,t:n.dem.tree.raycastRoot(l,u,c,h,e,t,i),tile:n}});n.sort((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE));for(const r of n){if(null==r.t)return null;const n=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,e,t,i);if(null!=n)return n}return null}_createFBO(){const t=this.painter.context,i=t.gl,n=this.drapeBufferSize;t.activeTexture.set(i.TEXTURE0);const r=new e.Texture(t,{width:n[0],height:n[1],data:null},i.RGBA);r.bind(i.LINEAR,i.CLAMP_TO_EDGE);const s=t.createFramebuffer(n[0],n[1],!1);return s.colorAttachment.set(r.texture),s.depthAttachment=new we(t,s.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,s.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):s.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:s,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some(e=>{const t=this._style._layers[e],i=t.isHidden(this.painter.transform.zoom);return"custom"===t.type?!i&&t.shouldRedrape():!i&&t.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style._getSources())if(e instanceof Te){t=!0;break}if(!t)return;const i={};for(let n=0;n<this._style.order.length;++n){const t=this._style._layers[this._style.order[n]],r=this._style._getLayerSourceCache(t);if(r&&!i[r.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.ZoomDependentExpression){i[r.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][r.id];if(t)for(const e of t)this._clearRenderCacheForTile(r.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i]._source instanceof De){e=!0;break}if(!e)return;const t={};for(let i=0;i<this._style.order.length;++i){const e=this._style._layers[this._style.order[i]],n=this._style._getLayerSourceCache(e);if(!n||t[n.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const r=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][n.id];if(e)for(const t of e){const e=Di(n.getTile(t),n.findLoadedParent(t,0),n,this.painter.transform,r);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(n.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,t=e.length;if(0===t)return;const i=[];let n,r=0,s=this._style._layers[e[r]];for(;!this._style.isLayerDraped(s)&&s.isHidden(this.painter.transform.zoom)&&++r<t;)s=this._style._layers[e[r]];for(;r<t;++r){const t=this._style._layers[e[r]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===n&&(n=r):void 0!==n&&(i.push({start:n,end:r-1}),n=void 0))}void 0!==n&&i.push({start:n,end:r-1}),this._drapedRenderBatches=i}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let i=0;i<e.length;++i){const n=Object.values(e[i]);t.renderCachePool.push(...n)}}return}this._clearRasterLayersFromRenderCache();const i=this.proxyCoords,n=this._tilesDirty;for(let s=i.length-1;s>=0;s--){const r=i[s];if(t.getTileByID(r.key),void 0!==t.proxyCachedFBO[r.key]){const i=e[r.key],s=this.proxyToSource[r.key];let o=0;for(const e in s){const t=s[e],r=i[e];if(!r||r.length!==t.length||t.some((t,i)=>t!==r[i]||n[e]&&n[e].hasOwnProperty(t.key))){o=-1;break}++o}for(const e in t.proxyCachedFBO[r.key])t.renderCache[t.proxyCachedFBO[r.key][e]].dirty=o<0||o!==Object.values(i).length}}const r=[...this._drapedRenderBatches];r.sort((e,t)=>t.end-t.start-(e.end-e.start));for(const s of r)for(const e of i){if(t.proxyCachedFBO[e.key])continue;let i=t.renderCachePool.pop();void 0===i&&t.renderCache.length<50&&(i=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==i&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][s.start]=i,t.renderCache[i].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,i,n){if(!n||!this._sourceTilesOverlap[n.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const r=this.painter.context,s=r.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let o;if(i.isTileClipped())o=t.length,this._overlapStencilMode.test={func:s.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:s.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}_renderTileClippingMasks(t,i){const n=this.painter,r=this.painter.context,s=r.gl;n._tileClippingMaskIDs={},r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const o=n.useProgram("clippingMask");for(const a of t){const t=n._tileClippingMaskIDs[a.key]=--i;o.draw(r,s.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:s.ALWAYS,mask:0},t,255,s.KEEP,s.KEEP,s.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Ti(a.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}pointCoordinate(t){const i=this.painter.transform;if(t.x<0||t.x>i.width||t.y<0||t.y>i.height)return null;const n=[t.x,t.y,1,1];e.transformMat4$1(n,n,i.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),n[0]/=i.worldSize,n[1]/=i.worldSize;const r=i._camera.position,s=e.mercatorZfromAltitude(1,i.center.lat),o=[r[0],r[1],r[2]/s,0],a=e.subtract([],n.slice(0,3),o);e.normalize(a,a);const l=this.raycast(o,a,this._exaggeration);return null!==l&&l?(e.scaleAndAdd(o,o,a,l),o[3]=o[2],o[2]*=s,o):null}drawDepth(){const t=this.painter,i=t.context,n=this.proxySourceCache,r=Math.ceil(t.width),s=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===s||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const t=i.gl,n=i.createFramebuffer(r,s,!0);i.activeTexture.set(t.TEXTURE0);const o=new e.Texture(i,{width:r,height:s,data:null},t.RGBA);o.bind(t.NEAREST,t.CLAMP_TO_EDGE),n.colorAttachment.set(o.texture);const a=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,r,s);n.depthAttachment.set(a),this._depthFBO=n,this._depthTexture=o}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,r,s]),function(t,i,n,r){if("globe"===t.transform.projection.name)return;const s=t.context,o=s.gl;s.clear({depth:1});const a=t.useProgram("terrainDepth"),l=new e.DepthMode(o.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D);for(const c of r){const t=n.getTile(c),r=vi(c.projMatrix,0);i.setupElevationDraw(t,a),a.draw(s,o.TRIANGLES,l,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,r,"terrain_depth",i.gridBuffer,i.gridIndexBuffer,i.gridNoSkirtSegments)}}(t,this,n,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,t,i){if(e.getSource()instanceof Ce)return this._setupProxiedCoordsForImageSource(e,t,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const n=this.proxiedCoords[e.id]=[],r=this.proxyCoords;for(let o=0;o<r.length;o++){const t=r[o],s=this._findTileCoveringTileID(t,e);if(s){const r=this._createProxiedId(t,s,i[t.key]&&i[t.key][e.id]);n.push(r),this.proxyToSource[t.key][e.id]=[r]}}let s=!1;for(let o=0;o<t.length;o++){const r=e.getTile(t[o]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const t=this.proxyToSource[a.tileID.key][e.id],o=this._createProxiedId(a.tileID,r,i[a.tileID.key]&&i[a.tileID.key][e.id]);t?t.splice(t.length-1,0,o):this.proxyToSource[a.tileID.key][e.id]=[o],n.push(o),s=!0}}this._sourceTilesOverlap[e.id]=s}_setupProxiedCoordsForImageSource(t,i,n){if(!t.getSource().loaded())return;const r=this.proxiedCoords[t.id]=[],s=this.proxyCoords,o=t.getSource(),a=new e.Point(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),l=o.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce((e,t)=>(e.min.x=Math.min(e.min.x,t.x-a.x),e.min.y=Math.min(e.min.y,t.y-a.y),e.max.x=Math.max(e.max.x,t.x-a.x),e.max.y=Math.max(e.max.y,t.y-a.y),e),{min:new e.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(t,i)=>{const n=t.wrap+t.canonical.x/(1<<t.canonical.z),r=t.canonical.y/(1<<t.canonical.z),s=e.EXTENT/(1<<t.canonical.z),o=i.wrap+i.canonical.x/(1<<i.canonical.z),a=i.canonical.y/(1<<i.canonical.z);return n+s<o+l.min.x||n>o+l.max.x||r+s<a+l.min.y||r>a+l.max.y};for(let e=0;e<s.length;e++){const o=s[e];for(let e=0;e<i.length;e++){const s=t.getTile(i[e]);if(!s||!s.hasData())continue;if(c(o,s.tileID))continue;const a=this._createProxiedId(o,s,n[o.key]&&n[o.key][t.id]),l=this.proxyToSource[o.key][t.id];l?l.push(a):this.proxyToSource[o.key][t.id]=[a],r.push(a)}}}_createProxiedId(t,i,n){let r=this.orthoMatrix;if(n){const e=n.find(e=>e.key===i.tileID.key);if(e)return e}if(i.tileID.key!==t.key){const n=t.canonical.z-i.tileID.canonical.z;let s,o,a;r=e.create();const l=i.tileID.wrap-t.wrap<<t.overscaledZ;n>0?(s=e.EXTENT>>n,o=s*((i.tileID.canonical.x<<n)-t.canonical.x+l),a=s*((i.tileID.canonical.y<<n)-t.canonical.y)):(s=e.EXTENT<<-n,o=e.EXTENT*(i.tileID.canonical.x-(t.canonical.x+l<<-n)),a=e.EXTENT*(i.tileID.canonical.y-(t.canonical.y<<-n))),e.ortho(r,0,s,0,s,0,1),e.translate(r,r,[o,a,0])}return new Pi(i.tileID,t.key,r)}_findTileCoveringTileID(t,i){let n=i.getTile(t);if(n&&n.hasData())return n;const r=this._findCoveringTileCache[i.id],s=r[t.key];if(n=s?i.getTileByID(s):null,n&&n.hasData()||null===s)return n;let o=n?n.tileID:t,a=o.overscaledZ;const l=i.getSource().minzoom,c=[];if(!s){const r=i.getSource().maxzoom;if(t.canonical.z>=r){const n=t.canonical.z-r;i.getSource().reparseOverscaled?(a=Math.max(t.canonical.z+2,i.transform.tileZoom),o=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>n,t.canonical.y>>n)):0!==n&&(a=r,o=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>n,t.canonical.y>>n))}o.key!==t.key&&(c.push(o.key),n=i.getTile(o))}const u=e=>{c.forEach(t=>{r[t]=e}),c.length=0};for(a-=1;a>=l&&(!n||!n.hasData());a--){n&&u(n.tileID.key);const e=o.calculateScaledKey(a);if(n=i.getTileByID(e),n&&n.hasData())break;const t=r[e];if(null===t)break;void 0===t?c.push(e):n=i.getTileByID(t)}return u(n?n.tileID.key:null),n&&n.hasData()?n:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[t.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(){let t=0;const i=new e.StructArrayLayout2ui4,n=131;for(let e=1;e<129;e++){for(let r=1;r<129;r++)t=e*n+r,i.emplaceBack(t,t+1),i.emplaceBack(t,t+n),i.emplaceBack(t+1,t+n),128===e&&i.emplaceBack(t+n,t+n+1);i.emplaceBack(t+1,t+1+n)}return i}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class ki{static cacheKey(e,t,i,n){let r="".concat(t).concat(n?n.cacheKey:"");for(const s of i)e.usedDefines.includes(s)&&(r+="/".concat(s));return r}constructor(t,i,n,r,s,o){const a=t.gl;this.program=a.createProgram();const l=function(e){const t=[];for(let i=0;i<e.length;i++){if(null===e[i])continue;const n=e[i].split(" ");t.push(n.pop())}return t}(n.staticAttributes),c=r?r.getBinderAttributes():[],u=l.concat(c);let h=r?r.defines():[];h=h.concat(o.map(e=>"#define ".concat(e)));const d=t.isWebGL2?"#version 300 es\n":"",p=d+h.concat(t.extStandardDerivatives&&0===d.length?"#extension GL_OES_standard_derivatives : enable\n".concat(li):li,li,ai,oi.fragmentSource,ri.fragmentSource,n.fragmentSource).join("\n"),m=d+h.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ai,oi.vertexSource,ri.vertexSource,ni.vertexSource,n.vertexSource).join("\n"),f=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(f,p),a.compileShader(f),a.attachShader(this.program,f);const g=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(g,m),a.compileShader(g),a.attachShader(this.program,g),this.attributes={},this.numAttributes=u.length;for(let e=0;e<this.numAttributes;e++)u[e]&&(a.bindAttribLocation(this.program,e,u[e]),this.attributes[u[e]]=e);a.linkProgram(this.program),a.deleteShader(g),a.deleteShader(f),this.fixedUniforms=s(t),this.binderUniforms=r?r.getUniforms(t):[],o.includes("TERRAIN")&&(this.terrainUniforms=(t=>({u_dem:new e.Uniform1i(t),u_dem_prev:new e.Uniform1i(t),u_dem_unpack:new e.Uniform4f(t),u_dem_tl:new e.Uniform2f(t),u_dem_scale:new e.Uniform1f(t),u_dem_tl_prev:new e.Uniform2f(t),u_dem_scale_prev:new e.Uniform1f(t),u_dem_size:new e.Uniform1f(t),u_dem_lerp:new e.Uniform1f(t),u_exaggeration:new e.Uniform1f(t),u_depth:new e.Uniform1i(t),u_depth_size_inv:new e.Uniform2f(t),u_meter_to_dem:new e.Uniform1f(t),u_label_plane_matrix_inv:new e.UniformMatrix4f(t)}))(t)),o.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.Uniform3f(t),u_tile_tr_up:new e.Uniform3f(t),u_tile_br_up:new e.Uniform3f(t),u_tile_bl_up:new e.Uniform3f(t),u_tile_up_scale:new e.Uniform1f(t)}))(t)),o.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.UniformMatrix4f(t),u_fog_range:new e.Uniform2f(t),u_fog_color:new e.Uniform4f(t),u_fog_horizon_blend:new e.Uniform1f(t),u_fog_temporal_offset:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_globe_transition:new e.Uniform1f(t),u_is_globe:new e.Uniform1i(t),u_viewport:new e.Uniform2f(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const i=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e]&&i[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)i[e].set(this.program,e,t[e])}}draw(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m){const f=e.gl;if(this.failedToCreate)return;e.program.set(this.program),e.setDepthMode(i),e.setStencilMode(n),e.setColorMode(r),e.setCullFace(s);for(const _ of Object.keys(this.fixedUniforms))this.fixedUniforms[_].set(this.program,_,o[_]);p&&p.setUniforms(this.program,e,this.binderUniforms,h,{zoom:d});const g={[f.LINES]:2,[f.TRIANGLES]:3,[f.LINE_STRIP]:1}[t];for(const _ of u.get()){const i=_.vaos||(_.vaos={});(i[a]||(i[a]=new di)).bind(e,this,l,p?p.getPaintVertexBuffers():[],c,_.vertexOffset,m||[]),f.drawElements(t,_.primitiveLength*g,f.UNSIGNED_SHORT,_.primitiveOffset*g*2)}}}function Mi(e,t){const i=Math.pow(2,t.tileID.overscaledZ),n=t.tileSize*Math.pow(2,e.transform.tileZoom)/i,r=n*(t.tileID.canonical.x+t.tileID.wrap*i),s=n*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/I(t,1,e.transform.tileZoom),u_pixel_coord_upper:[r>>16,s>>16],u_pixel_coord_lower:[65535&r,65535&s]}}const Ri=e.create(),Fi=(t,i,n,r,s,o,a,l,c,u,h)=>{const d=i.style.light,p=d.properties.get("position"),m=[p.x,p.y,p.z],f=e.create$1();"viewport"===d.properties.get("anchor")&&(e.fromRotation(f,-i.transform.angle),e.transformMat3(m,m,f));const g=d.properties.get("color"),_=i.transform,v={u_matrix:t,u_lightpos:m,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+n,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ri,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:s,u_edge_radius:o};return"globe"===_.projection.name&&(v.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],v.u_zoom_transition=c,v.u_inv_rot_matrix=h,v.u_merc_center=u,v.u_up_dir=_.projection.upVector(new e.CanonicalTileID(0,0,0),u[0]*e.EXTENT,u[1]*e.EXTENT),v.u_height_lift=l),v},Li=(t,i,n,r,s,o,a,l,c,u,h,d)=>{const p=Fi(t,i,n,r,s,o,a,c,u,h,d),m={u_height_factor:-Math.pow(2,a.overscaledZ)/l.tileSize/8};return e.extend(p,Mi(i,l),m)},Oi=e=>({u_matrix:e}),Bi=(t,i,n)=>e.extend(Oi(t),Mi(i,n)),zi=(e,t)=>({u_matrix:e,u_world:t}),Ni=(t,i,n,r)=>e.extend(Bi(t,i,n),{u_world:r}),Ui=e.create(),ji=(t,i,n,r,s,o)=>{const a=t.transform,l="globe"===a.projection.name;let c;if("map"===o.paint.get("circle-pitch-alignment"))if(l){const t=e.globePixelsToTileUnits(a.zoom,i.canonical)*a._pixelsPerMercatorPixel;c=Float32Array.from([t,0,0,t])}else c=a.calculatePixelsToTileUnitsMatrix(n);else c=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const u={u_camera_to_center_distance:a.cameraToCenterDistance,u_matrix:t.translatePosMatrix(i.projMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:c,u_inv_rot_matrix:Ui,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(l){u.u_inv_rot_matrix=r,u.u_merc_center=s,u.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],u.u_zoom_transition=e.globeToMercatorTransition(a.zoom);const t=s[0]*e.EXTENT,n=s[1]*e.EXTENT;u.u_up_dir=a.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return u},Vi=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},Gi=(t,i,n,r)=>{const s=e.EXTENT/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:i.getCameraToCenterDistance(r),u_extrude_scale:[i.pixelsToGLUnits[0]/s,i.pixelsToGLUnits[1]/s]}},Wi=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},Hi=e.create(),Xi=(t,i,n,r,s,o,a)=>{const l=t.transform,c="globe"===l.projection.name,u=c?e.globePixelsToTileUnits(l.zoom,i.canonical)*l._pixelsPerMercatorPixel:I(n,1,o),h={u_matrix:i.projMatrix,u_extrude_scale:u,u_intensity:a,u_inv_rot_matrix:Hi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=r,h.u_merc_center=s,h.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(l.zoom);const t=s[0]*e.EXTENT,n=s[1]*e.EXTENT;h.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return h},qi=(e,t,i,n,r,s,o)=>{const a=e.transform,l=a.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:Ki(e,t,i,n),u_pixels_to_tile_units:l,u_device_pixel_ratio:s,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:r,u_texsize:Ji(i)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Yi(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:o}},Zi=(e,t,i,n,r)=>{const s=e.transform;return{u_matrix:Ki(e,t,i,n),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:s.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:r,u_image:0,u_tile_units_to_pixels:Yi(t,s),u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Yi(e,t){return 1/I(e,1,t.tileZoom)}function Ki(e,t,i,n){return e.translatePosMatrix(n||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}function Ji(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const $i=(e,t,i,n,r,s)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:i,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Qi(r.paint.get("raster-hue-rotate")),u_perspective_transform:s};var o,a};function Qi(e){e*=Math.PI/180;const t=Math.sin(e),i=Math.cos(e);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}const en=e.create(),tn=(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g)=>{const _=s.transform,v={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:_.cameraToCenterDistance,u_rotate_symbol:+n,u_aspect_ratio:_.width/_.height,u_fade_change:s.options.fadeDuration?s.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+r,u_texsize:u,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:en,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:en,u_up_vector:[0,-1,0]};return"globe"===g.name&&(v.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],v.u_zoom_transition=d,v.u_inv_rot_matrix=m,v.u_merc_center=p,v.u_camera_forward=_._camera.forward(),v.u_ecef_origin=e.globeECEFOrigin(_.globeMatrix,h.toUnwrapped()),v.u_tile_matrix=Float32Array.from(_.globeMatrix),v.u_up_vector=f),v},nn=(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g,_)=>e.extend(tn(t,i,n,r,s,o,a,l,c,u,d,p,m,f,g,_),{u_gamma_scale:r?s.transform.cameraToCenterDistance*Math.cos(s.terrain?0:s.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+h}),rn=(t,i,n,r,s,o,a,l,c,u,h,d,p,m,f,g)=>e.extend(nn(t,i,n,r,s,o,a,l,!0,c,!0,h,d,p,m,f,g),{u_texsize_icon:u,u_texture_icon:1}),sn=(e,t,i)=>({u_matrix:e,u_opacity:t,u_color:i}),on=(t,i,n,r,s)=>e.extend(function(e,t,i){const n=t.imageManager.getPattern(e.toString()),{width:r,height:s}=t.imageManager.getPixelSize(),o=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,t.transform.tileZoom)/o,l=a*(i.tileID.canonical.x+i.tileID.wrap*o),c=a*i.tileID.canonical.y;return{u_image:0,u_pattern_tl:n.tl,u_pattern_br:n.br,u_texsize:[r,s],u_pattern_size:n.displaySize,u_tile_units_to_pixels:1/I(i,1,t.transform.tileZoom),u_pixel_coord_upper:[l>>16,c>>16],u_pixel_coord_lower:[65535&l,65535&c]}}(r,n,s),{u_matrix:t,u_opacity:i}),an={fillExtrusion:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t)}),fillExtrusionPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_height_factor:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t)}),fill:t=>({u_matrix:new e.UniformMatrix4f(t)}),fillPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),fillOutline:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t)}),fillOutlinePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),circle:t=>({u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),collisionBox:t=>({u_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.Uniform2f(t)}),collisionCircle:t=>({u_matrix:new e.UniformMatrix4f(t),u_inv_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_viewport_size:new e.Uniform2f(t)}),debug:t=>({u_color:new e.UniformColor(t),u_matrix:new e.UniformMatrix4f(t),u_overlay:new e.Uniform1i(t),u_overlay_scale:new e.Uniform1f(t)}),clippingMask:t=>({u_matrix:new e.UniformMatrix4f(t)}),heatmap:t=>({u_extrude_scale:new e.Uniform1f(t),u_intensity:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),heatmapTexture:t=>({u_image:new e.Uniform1i(t),u_color_ramp:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t)}),hillshade:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_latrange:new e.Uniform2f(t),u_light:new e.Uniform2f(t),u_shadow:new e.UniformColor(t),u_highlight:new e.UniformColor(t),u_accent:new e.UniformColor(t)}),hillshadePrepare:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_dimension:new e.Uniform2f(t),u_zoom:new e.Uniform1f(t),u_unpack:new e.Uniform4f(t)}),line:t=>({u_matrix:new e.UniformMatrix4f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_units_to_pixels:new e.Uniform2f(t),u_dash_image:new e.Uniform1i(t),u_gradient_image:new e.Uniform1i(t),u_image_height:new e.Uniform1f(t),u_texsize:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t),u_trim_offset:new e.Uniform2f(t)}),linePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_texsize:new e.Uniform2f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_units_to_pixels:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t)}),raster:t=>({u_matrix:new e.UniformMatrix4f(t),u_tl_parent:new e.Uniform2f(t),u_scale_parent:new e.Uniform1f(t),u_fade_t:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_image0:new e.Uniform1i(t),u_image1:new e.Uniform1i(t),u_brightness_low:new e.Uniform1f(t),u_brightness_high:new e.Uniform1f(t),u_saturation_factor:new e.Uniform1f(t),u_contrast_factor:new e.Uniform1f(t),u_spin_weights:new e.Uniform3f(t),u_perspective_transform:new e.Uniform2f(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_texture:new e.Uniform1i(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_is_halo:new e.Uniform1i(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texsize_icon:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_texture_icon:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_is_halo:new e.Uniform1i(t)}),background:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_color:new e.UniformColor(t)}),backgroundPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_pattern_tl:new e.Uniform2f(t),u_pattern_br:new e.Uniform2f(t),u_texsize:new e.Uniform2f(t),u_pattern_size:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),terrainRaster:_i,terrainDepth:_i,skybox:t=>({u_matrix:new e.UniformMatrix4f(t),u_sun_direction:new e.Uniform3f(t),u_cubemap:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxGradient:t=>({u_matrix:new e.UniformMatrix4f(t),u_color_ramp:new e.Uniform1i(t),u_center_direction:new e.Uniform3f(t),u_radius:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxCapture:t=>({u_matrix_3f:new e.UniformMatrix3f(t),u_sun_direction:new e.Uniform3f(t),u_sun_intensity:new e.Uniform1f(t),u_color_tint_r:new e.Uniform4f(t),u_color_tint_m:new e.Uniform4f(t),u_luminance:new e.Uniform1f(t)}),globeRaster:t=>({u_proj_matrix:new e.UniformMatrix4f(t),u_globe_matrix:new e.UniformMatrix4f(t),u_normalize_matrix:new e.UniformMatrix4f(t),u_merc_matrix:new e.UniformMatrix4f(t),u_zoom_transition:new e.Uniform1f(t),u_merc_center:new e.Uniform2f(t),u_image0:new e.Uniform1i(t),u_grid_matrix:new e.UniformMatrix3f(t),u_skirt_height:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_viewport:new e.Uniform2f(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_horizon:new e.Uniform1f(t),u_transition:new e.Uniform1f(t),u_fadeout_range:new e.Uniform1f(t),u_color:new e.Uniform4f(t),u_high_color:new e.Uniform4f(t),u_space_color:new e.Uniform4f(t),u_star_intensity:new e.Uniform1f(t),u_star_density:new e.Uniform1f(t),u_star_size:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t),u_horizon_angle:new e.Uniform1f(t),u_rotation_matrix:new e.UniformMatrix4f(t)})};let ln;function cn(t,i,n,r,s,o,a){const l=t.context,c=l.gl,u=t.transform,h=t.useProgram("collisionBox"),d=[];let p=0,m=0;for(let x=0;x<r.length;x++){const f=r[x],g=i.getTile(f),_=g.getBucket(n);if(!_)continue;const v=vt(f,_,u);let y=v;0===s[0]&&0===s[1]||(y=t.translatePosMatrix(v,g,s,o));const b=a?_.textCollisionBox:_.iconCollisionBox,w=_.collisionCircleArray;if(w.length>0){const t=e.create(),i=y;e.mul(t,_.placementInvProjMatrix,u.glCoordMatrix),e.mul(t,t,_.placementViewportMatrix),d.push({circleArray:w,circleOffset:m,transform:i,invTransform:t,projection:_.getProjection()}),p+=w.length/4,m=p}b&&(t.terrain&&t.terrain.setupElevationDraw(g,h),h.draw(l,c.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,Gi(y,u,g,_.getProjection()),n.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,null,u.zoom,null,[b.collisionVertexBuffer,b.collisionVertexBufferExt]))}if(!a||!d.length)return;const f=t.useProgram("collisionCircle"),g=new e.StructArrayLayout2f1f2i16;g.resize(4*p),g._trim();let _=0;for(const e of d)for(let t=0;t<e.circleArray.length/4;t++){const i=4*t,n=e.circleArray[i+0],r=e.circleArray[i+1],s=e.circleArray[i+2],o=e.circleArray[i+3];g.emplace(_++,n,r,s,o,0),g.emplace(_++,n,r,s,o,1),g.emplace(_++,n,r,s,o,2),g.emplace(_++,n,r,s,o,3)}(!ln||ln.length<2*p)&&(ln=function(t){const i=2*t,n=new e.StructArrayLayout3ui6;n.resize(i),n._trim();for(let e=0;e<i;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(p));const v=l.createIndexBuffer(ln,!0),y=l.createVertexBuffer(g,e.collisionCircleLayout.members,!0);for(const x of d){const i={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(b=u).getCameraToCenterDistance(x.projection),u_viewport_size:[b.width,b.height]};f.draw(l,c.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,i,n.id,y,v,e.SegmentVector.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,u.zoom)}var b;y.destroy(),v.destroy()}const un=e.create();function hn(t,i){let{width:n,height:r,anchor:s,textOffset:o,textScale:a}=t;const{horizontalAlign:l,verticalAlign:c}=e.getAnchorAlignment(s),u=-(l-.5)*n,h=-(c-.5)*r,d=e.evaluateVariableOffset(s,o);return new e.Point((u/a+d[0])*i,(h/a+d[1])*i)}function dn(t,i,n,r,s,o,a,l,c,u,h){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,m=t.icon.dynamicLayoutVertexArray,f={},g=t.getProjection(),_=yt(l,g,o),v=o.elevation,y=g.upVectorScale(l.canonical,o.center.lat,o.worldSize).metersToTile;p.clear();for(let b=0;b<d.length;b++){const m=d.get(b),{tileAnchorX:x,tileAnchorY:w,numGlyphs:E}=m,A=m.hidden||!m.crossTileID||t.allowVerticalPlacement&&!m.placedOrientation?null:r[m.crossTileID];if(A){let r=0,d=0,b=0;if(v){const e=v?v.getAtTileOffset(l,x,w):0,[t,i,n]=g.upVector(l.canonical,x,w);r=e*t*y,d=e*i*y,b=e*n*y}let[T,D,S,C]=nt(m.projectedAnchorX+r,m.projectedAnchorY+d,m.projectedAnchorZ+b,n?_:a);const P=rt(o.getCameraToCenterDistance(g),C);let I=s.evaluateSizeForFeature(t.textSizeData,u,m)*P/e.ONE_EM;n&&(I*=t.tilePixelRatio/c);const k=hn(A,I);n?(({x:T,y:D,z:S}=g.projectTilePoint(x+k.x,w+k.y,l.canonical)),[T,D,S]=nt(T+r,D+d,S+b,a)):(i&&k._rotate(-o.angle),T+=k.x,D+=k.y,S=0);const M=t.allowVerticalPlacement&&m.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(let t=0;t<E;t++)e.addDynamicAttributes(p,T,D,S,M);h&&m.associatedIconIndex>=0&&(f[m.associatedIconIndex]={x:T,y:D,z:S,angle:M})}else pt(E,p)}if(h){m.clear();const i=t.icon.placedSymbolArray;for(let t=0;t<i.length;t++){const n=i.get(t),{numGlyphs:r}=n,s=f[t];if(n.hidden||!s)pt(r,m);else{const{x:t,y:i,z:n,angle:o}=s;for(let s=0;s<r;s++)e.addDynamicAttributes(m,t,i,n,o)}}t.icon.dynamicLayoutVertexBuffer.updateData(m)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function pn(e,t,i){return i.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function mn(t,i,n,r,s,o,a,l,c,u,h,d){const p=t.context,m=p.gl,f=t.transform,g="map"===l,_="map"===c,v=g&&"point"!==n.layout.get("symbol-placement"),y=g&&!_&&!v,b=void 0!==n.layout.get("symbol-sort-key").constantOr(1);let x=!1;const w=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),E=[e.mercatorXfromLng(f.center.lng),e.mercatorYfromLat(f.center.lat)],A=n.layout.get("text-variable-anchor"),T="globe"===f.projection.name,D=[],S=[0,-1,0];let C=S;!T&&!f.mercatorFromTransition||g||(C=function(t){const i=t._camera.getWorldToCamera(t.worldSize,1),n=e.multiply([],i,t.globeMatrix);e.invert(n,n);const r=[0,0,0],s=[0,1,0,0];return e.transformMat4$1(s,s,n),r[0]=s[0],r[1]=s[1],r[2]=s[2],e.normalize(r,r),r}(f));for(const P of r){const r=i.getTile(P),l=r.getBucket(n);if(!l)continue;if("mercator"===l.projection.name&&T)continue;const c=s?l.text:l.icon;if(!c||l.fullyClipped||!c.segments.get().length)continue;const h=c.programConfigurations.get(n.id),d=s||l.sdfIcons,p=s?l.textSizeData:l.iconSizeData,w=_||0!==f.pitch,I=e.evaluateSizeForZoom(p,f.zoom);let k,M,R,F,L=[0,0],O=null;if(s)M=r.glyphAtlasTexture,R=m.LINEAR,k=r.glyphAtlasTexture.size,l.iconsInText&&(L=r.imageAtlasTexture.size,O=r.imageAtlasTexture,F=w||t.options.rotating||t.options.zooming||"composite"===p.kind||"camera"===p.kind?m.LINEAR:m.NEAREST);else{const e=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;M=r.imageAtlasTexture,R=d||t.options.rotating||t.options.zooming||e||w?m.LINEAR:m.NEAREST,k=r.imageAtlasTexture.size}const B="globe"===l.projection.name,z=B?C:S,N=B?e.globeToMercatorTransition(f.zoom):0,U=yt(P,l.getProjection(),f),j=f.calculatePixelsToTileUnitsMatrix(r),V=et(U,r.tileID.canonical,_,g,f,l.getProjection(),j),G=t.terrain&&_&&v?e.invert(e.create(),V):un,W=it(U,r.tileID.canonical,_,g,f,l.getProjection(),j),H=A&&l.hasTextData(),X="none"!==n.layout.get("icon-text-fit")&&H&&l.hasIconData();if(v){const e=f.elevation,i=e?e.getAtTileOffsetFunc(P,f.center.lat,f.worldSize,l.getProjection()):null,n=tt(U,r.tileID.canonical,_,g,f,l.getProjection(),j);ot(l,U,t,s,n,W,_,u,i,P)}const q=v||s&&A||X,Z=t.translatePosMatrix(U,r,o,a),Y=q?un:V,K=t.translatePosMatrix(W,r,o,a,!0),J=l.getProjection().createInversionMatrix(f,P.canonical),$=[];t.terrainRenderModeElevated()&&_&&$.push("PITCH_WITH_MAP_TERRAIN"),B&&$.push("PROJECTION_GLOBE_VIEW"),q&&$.push("PROJECTED_POS_ON_VIEWPORT");const Q=d&&0!==n.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1);let ee;ee=d?l.iconsInText?rn(p.kind,I,y,_,t,Z,Y,K,k,L,P,N,E,J,z,l.getProjection()):nn(p.kind,I,y,_,t,Z,Y,K,s,k,!0,P,N,E,J,z,l.getProjection()):tn(p.kind,I,y,_,t,Z,Y,K,s,k,P,N,E,J,z,l.getProjection());const te={program:t.useProgram(pn(d,s,l),h,$),buffers:c,uniformValues:ee,atlasTexture:M,atlasTextureIcon:O,atlasInterpolation:R,atlasInterpolationIcon:F,isSDF:d,hasHalo:Q,tile:r,labelPlaneMatrixInv:G};if(b&&l.canOverlap){x=!0;const t=c.segments.get();for(const i of t)D.push({segments:new e.SegmentVector([i]),sortKey:i.sortKey,state:te})}else D.push({segments:c.segments,sortKey:0,state:te})}x&&D.sort((e,t)=>e.sortKey-t.sortKey);for(const e of D){const i=e.state;if(t.terrain&&t.terrain.setupElevationDraw(i.tile,i.program,{useDepthForOcclusion:!T,labelPlaneMatrixInv:i.labelPlaneMatrixInv}),p.activeTexture.set(m.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,m.CLAMP_TO_EDGE),i.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),i.isSDF){const r=i.uniformValues;i.hasHalo&&(r.u_is_halo=1,fn(i.buffers,e.segments,n,t,i.program,w,h,d,r)),r.u_is_halo=0}fn(i.buffers,e.segments,n,t,i.program,w,h,d,i.uniformValues)}}function fn(t,i,n,r,s,o,a,l,c){const u=r.context,h=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer];s.draw(u,u.gl.TRIANGLES,o,a,l,e.CullFaceMode.disabled,c,n.id,t.layoutVertexBuffer,t.indexBuffer,i,n.paint,r.transform.zoom,t.programConfigurations.get(n.id),h)}function gn(t,i,n,r,s,o,a){const l=t.context.gl,c=n.paint.get("fill-pattern"),u=c&&c.constantOr(1);let h,d,p,m,f;a?(d=u&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=l.LINES):(d=u?"fillPattern":"fill",h=l.TRIANGLES);for(const g of r){const r=i.getTile(g);if(u&&!r.patternsLoaded())continue;const _=r.getBucket(n);if(!_)continue;t.prepareDrawTile();const v=_.programConfigurations.get(n.id),y=t.useProgram(d,v);u&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers());const b=c.constantOr(null);if(b&&r.imageAtlas){const e=r.imageAtlas.patternPositions[b.toString()];e&&v.setConstantPatternPositions(e)}const x=t.translatePosMatrix(g.projMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){m=_.indexBuffer2,f=_.segments2;const e=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];p="fillOutlinePattern"===d&&u?Ni(x,t,r,e):zi(x,e)}else m=_.indexBuffer,f=_.segments,p=u?Bi(x,t,r):Oi(x);t.prepareDrawProgram(t.context,y,g.toUnwrapped()),y.draw(t.context,h,s,t.stencilModeForClipping(g),o,e.CullFaceMode.disabled,p,n.id,_.layoutVertexBuffer,m,f,n.paint,t.transform.zoom,v)}}function _n(t,i,n,r,s,o,a){const l=t.context,c=l.gl,u=t.transform,h=n.paint.get("fill-extrusion-pattern"),d=h.constantOr(1),p=n.paint.get("fill-extrusion-opacity"),m=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),n.paint.get("fill-extrusion-ambient-occlusion-radius")],f=n.layout.get("fill-extrusion-edge-radius"),g=f>0&&!n.paint.get("fill-extrusion-rounded-roof"),_=g?0:f,v="globe"===u.projection.name?e.fillExtrusionHeightLift():0,y="globe"===u.projection.name,b=y?e.globeToMercatorTransition(u.zoom):0,x=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],w=[];y&&w.push("PROJECTION_GLOBE_VIEW"),m[0]>0&&w.push("FAUX_AO"),g&&w.push("ZERO_ROOF_RADIUS");for(const E of r){const r=i.getTile(E),f=r.getBucket(n);if(!f||f.projection.name!==u.projection.name)continue;const g=f.programConfigurations.get(n.id),A=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",g,w);if(t.terrain){const e=t.terrain;if(t.style.terrainSetForDrapingOnly())e.setupElevationDraw(r,A,{useMeterToDem:!0});else{if(!f.enableTerrain)continue;if(e.setupElevationDraw(r,A,{useMeterToDem:!0}),vn(l,i,E,f,n,e),!f.centroidVertexBuffer){const e=A.attributes.a_centroid_pos;void 0!==e&&c.vertexAttrib2f(e,0,0)}}}d&&(t.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),g.updatePaintBuffers());const T=h.constantOr(null);if(T&&r.imageAtlas){const e=r.imageAtlas.patternPositions[T.toString()];e&&g.setConstantPatternPositions(e)}const D=t.translatePosMatrix(E.projMatrix,r,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),S=u.projection.createInversionMatrix(u,E.canonical),C=n.paint.get("fill-extrusion-vertical-gradient"),P=d?Li(D,t,C,p,m,_,E,r,v,b,x,S):Fi(D,t,C,p,m,_,E,v,b,x,S);t.prepareDrawProgram(l,A,E.toUnwrapped());const I=[];t.terrain&&I.push(f.centroidVertexBuffer),y&&I.push(f.layoutVertexExtBuffer),A.draw(l,l.gl.TRIANGLES,s,o,a,e.CullFaceMode.backCCW,P,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,n.paint,t.transform.zoom,g,I)}}function vn(t,i,n,r,s,o){const a=[t=>{let i=t.canonical.x-1,n=t.wrap;return i<0&&(i=(1<<t.canonical.z)-1,n--),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},t=>{let i=t.canonical.x+1,n=t.wrap;return i===1<<t.canonical.z&&(i=0,n++),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,i,t.canonical.y)},t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)],l=e=>{const t=i.getSource().minzoom,n=e=>{const t=i.getTileByID(e);if(t&&t.hasData())return t.getBucket(s)},r=[0,-1,1];for(const i of r){if(e.overscaledZ+i<t)continue;const r=n(e.calculateScaledKey(e.overscaledZ+i));if(r)return r}},c=[0,0,0],u=(t,i)=>(c[0]=Math.min(t.min.y,i.min.y),c[1]=Math.max(t.max.y,i.max.y),c[2]=e.EXTENT-i.min.x>t.max.x?i.min.x-e.EXTENT:t.max.x,c),h=(t,i)=>(c[0]=Math.min(t.min.x,i.min.x),c[1]=Math.max(t.max.x,i.max.x),c[2]=e.EXTENT-i.min.y>t.max.y?i.min.y-e.EXTENT:t.max.y,c),d=[(e,t)=>u(e,t),(e,t)=>u(t,e),(e,t)=>h(e,t),(e,t)=>h(t,e)],p=new e.Point(0,0);let m,f,g;const _=(t,i,r,s,a)=>{const l=[[s?r:t,s?t:r,0],[s?r:i,s?i:r,0]],c=a<0?e.EXTENT+a:a,u=[s?c:(t+i)/2,s?(t+i)/2:c,0];return 0===r&&a<0||0!==r&&a>0?o.getForTilePoints(g,[u],!0,f):l.push(u),o.getForTilePoints(n,l,!0,m),Math.max(l[0][2],l[1][2],u[2])/o.exaggeration()};for(let v=0;v<4;v++){const t=(v<2?1:5)-v,i=r.borders[v];if(0===i.length)continue;const s=g=a[v](n),c=l(s);if(!(c&&c instanceof e.FillExtrusionBucket&&c.enableTerrain))continue;if(r.borderDoneWithNeighborZ[v]===c.canonical.z&&c.borderDoneWithNeighborZ[t]===r.canonical.z)continue;if(f=o.findDEMTileFor(s),!f||!f.dem)continue;if(!m){const e=o.findDEMTileFor(n);if(!e||!e.dem)return;m=e}const u=c.borders[t];let h=0;const y=c.borderDoneWithNeighborZ[t]!==r.canonical.z;if(r.canonical.z===c.canonical.z){for(let n=0;n<i.length;n++){const s=r.featuresOnBorder[i[n]],o=s.borders[v];let a;for(;h<u.length&&(a=c.featuresOnBorder[u[h]],!(a.borders[t][1]>o[0]+3));)y&&c.encodeCentroid(void 0,a,!1),h++;if(a&&h<u.length){const i=h;let n=0;for(;!(a.borders[t][0]>o[1]-3)&&(n++,++h!==u.length);)a=c.featuresOnBorder[u[h]];if(a=c.featuresOnBorder[u[i]],s.intersectsCount()>1||a.intersectsCount()>1||1!==n){1!==n&&(h=i),r.encodeCentroid(void 0,s,!1),y&&c.encodeCentroid(void 0,a,!1);continue}const l=d[v](s,a),m=v%2?e.EXTENT-1:0;p.x=_(l[0],Math.min(e.EXTENT-1,l[1]),m,v<2,l[2]),p.y=0,r.encodeCentroid(p,s,!1),y&&c.encodeCentroid(p,a,!1)}else r.encodeCentroid(void 0,s,!1)}r.borderDoneWithNeighborZ[v]=c.canonical.z,r.needsCentroidUpdate=!0,y&&(c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0)}else{for(const e of i)r.encodeCentroid(void 0,r.featuresOnBorder[e],!1);if(y){for(const e of u)c.encodeCentroid(void 0,c.featuresOnBorder[e],!1);c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[v]=c.canonical.z,r.needsCentroidUpdate=!0}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(t)}const yn=new e.Color(1,0,0,1),bn=new e.Color(0,1,0,1),xn=new e.Color(0,0,1,1),wn=new e.Color(1,0,1,1),En=new e.Color(0,1,1,1);function An(t,i,n){const r=t.context,s=t.transform,o=r.gl,a="globe"===s.projection.name,l=a?["PROJECTION_GLOBE_VIEW"]:null;let c=n.projMatrix;if(a&&e.globeToMercatorTransition(s.zoom)>0){const t=e.transitionTileAABBinECEF(n.canonical,s),i=e.globeDenormalizeECEF(t);c=e.multiply(new Float32Array(16),s.globeMatrix,i),e.multiply(c,s.projMatrix,c)}const u=t.useProgram("debug",null,l),h=i.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(h,u);const d=e.DepthMode.disabled,p=e.StencilMode.disabled,m=t.colorModeForRenderPass(),f="$debug";r.activeTexture.set(o.TEXTURE0),t.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),a?h._makeGlobeTileDebugBuffers(t.context,s):h._makeDebugTileBoundsBuffers(t.context,s.projection);const g=h._tileDebugBuffer||t.debugBuffer,_=h._tileDebugIndexBuffer||t.debugIndexBuffer,v=h._tileDebugSegments||t.debugSegments;u.draw(r,o.LINE_STRIP,d,p,m,e.CullFaceMode.disabled,Wi(c,e.Color.red),f,g,_,v,null,null,null,[h._globeTileDebugBorderBuffer]);const y=h.latestRawTileData,b=Math.floor((y&&y.byteLength||0)/1024),x=i.getTile(n).tileSize,w=512/Math.min(x,512)*(n.overscaledZ/s.zoom)*.5;let E=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(E+=" => ".concat(n.overscaledZ)),E+=" ".concat(b,"kb"),function(e,t){e.initDebugOverlayCanvas();const i=e.debugOverlayCanvas,n=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(i),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,E);const A=h._tileDebugTextBuffer||t.debugBuffer,T=h._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,D=h._tileDebugTextSegments||t.debugSegments;u.draw(r,o.TRIANGLES,d,p,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,Wi(c,e.Color.transparent,w),f,A,T,D,null,null,null,[h._globeTileDebugTextBuffer])}function Tn(e,t,i,n){Sn(e,0,t+i/2,e.transform.width,i,n)}function Dn(e,t,i,n){Sn(e,t-i/2,0,i,e.transform.height,n)}function Sn(t,i,n,r,s,o){const a=t.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*e.exported.devicePixelRatio,n*e.exported.devicePixelRatio,r*e.exported.devicePixelRatio,s*e.exported.devicePixelRatio),a.clear({color:o}),l.disable(l.SCISSOR_TEST)}const Cn=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Pn}=Cn;function In(e,t,i,n){e.emplaceBack(t,i,n)}class kn{constructor(t){this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,In(this.vertexArray,-1,-1,1),In(this.vertexArray,1,-1,1),In(this.vertexArray,-1,1,1),In(this.vertexArray,1,1,1),In(this.vertexArray,-1,-1,-1),In(this.vertexArray,1,-1,-1),In(this.vertexArray,-1,1,-1),In(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Pn),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}}function Mn(t,i,n,r,s,o){const a=t.gl,l=i.paint.get("sky-atmosphere-color"),c=i.paint.get("sky-atmosphere-halo-color"),u=i.paint.get("sky-atmosphere-sun-intensity"),h=((e,t,i,n,r)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:i,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(e.fromMat4(e.create$1(),r),s,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+o,i.skyboxTexture,0),n.draw(t,a.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,h,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Rn=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fn{constructor(t){const i=new e.StructArrayLayout5f20;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);const n=new e.StructArrayLayout3ui6;n.emplaceBack(0,1,2),n.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(i,Rn.members),this.indexBuffer=t.createIndexBuffer(n),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ln={symbol:function(t,i,n,r,s){if("translucent"!==t.renderPass)return;const o=e.StencilMode.disabled,a=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,i,n,r,s,o,a){const l=i.transform,c="map"===s,u="map"===o;for(const h of t){const t=r.getTile(h),i=t.getBucket(n);if(!i||!i.text||!i.text.segments.get().length)continue;const s=e.evaluateSizeForZoom(i.textSizeData,l.zoom),o=yt(h,i.getProjection(),l),d=l.calculatePixelsToTileUnitsMatrix(t),p=et(o,t.tileID.canonical,u,c,l,i.getProjection(),d),m="none"!==n.layout.get("icon-text-fit")&&i.hasIconData();if(s){const n=Math.pow(2,l.zoom-t.tileID.overscaledZ);dn(i,c,u,a,e.symbolSize,l,p,h,n,s,m)}}}(r,t,n,i,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),s),0!==n.paint.get("icon-opacity").constantOr(1)&&mn(t,i,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,a),0!==n.paint.get("text-opacity").constantOr(1)&&mn(t,i,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,a),i.map.showCollisionBoxes&&(cn(t,i,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),cn(t,i,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(t,i,n,r){if("translucent"!==t.renderPass)return;const s=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0===s.constantOr(1)&&(0===o.constantOr(1)||0===a.constantOr(1)))return;const c=t.context,u=c.gl,h=t.transform,d=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),p=e.StencilMode.disabled,m=t.colorModeForRenderPass(),f="globe"===h.projection.name,g=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],_=[];for(let y=0;y<r.length;y++){const s=r[y],o=i.getTile(s),a=o.getBucket(n);if(!a||a.projection.name!==h.projection.name)continue;const c=a.programConfigurations.get(n.id),u=Vi(n);f&&u.push("PROJECTION_GLOBE_VIEW");const d=t.useProgram("circle",c,u),p=a.layoutVertexBuffer,m=a.globeExtVertexBuffer,v=a.indexBuffer,b=h.projection.createInversionMatrix(h,s.canonical),x={programConfiguration:c,program:d,layoutVertexBuffer:p,globeExtVertexBuffer:m,indexBuffer:v,uniformValues:ji(t,s,o,b,g,n),tile:o};if(l){const t=a.segments.get();for(const i of t)_.push({segments:new e.SegmentVector([i]),sortKey:i.sortKey,state:x})}else _.push({segments:a.segments,sortKey:0,state:x})}l&&_.sort((e,t)=>e.sortKey-t.sortKey);const v={useDepthForOcclusion:!f};for(const y of _){const{programConfiguration:i,program:r,layoutVertexBuffer:s,globeExtVertexBuffer:o,indexBuffer:a,uniformValues:l,tile:f}=y.state,g=y.segments;t.terrain&&t.terrain.setupElevationDraw(f,r,v),t.prepareDrawProgram(c,r,f.tileID.toUnwrapped()),r.draw(c,u.TRIANGLES,d,p,m,e.CullFaceMode.disabled,l,n.id,s,a,g,n.paint,h.zoom,i,[o])}},heatmap:function(t,i,n,r){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const s=t.context,o=s.gl,a=e.StencilMode.disabled,l=new e.ColorMode([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,i,n){const r=e.gl,s=t.width*n,o=t.height*n;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,s,o]);let a=i.heatmapFbo;if(!a||a&&(a.width!==s||a.height!==o)){a&&a.destroy();const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),a=i.heatmapFbo=e.createFramebuffer(s,o,!1),function(e,t,i,n,r,s){const o=e.gl;o.texImage2D(o.TEXTURE_2D,0,e.isWebGL2&&e.extRenderToTextureHalfFloat?o.RGBA16F:o.RGBA,r,s,0,o.RGBA,e.extRenderToTextureHalfFloat?e.isWebGL2?o.HALF_FLOAT:e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(i)}(e,0,t,a,s,o)}else r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)}(s,t,n,"globe"===t.transform.projection.name?.5:.25),s.clear({color:e.Color.transparent});const c=t.transform,u="globe"===c.projection.name,h=u?["PROJECTION_GLOBE_VIEW"]:null,d=u?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,p=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)];for(let m=0;m<r.length;m++){const f=r[m];if(i.hasRenderableParent(f))continue;const g=i.getTile(f),_=g.getBucket(n);if(!_||_.projection.name!==c.projection.name)continue;const v=_.programConfigurations.get(n.id),y=t.useProgram("heatmap",v,h),{zoom:b}=t.transform;t.terrain&&t.terrain.setupElevationDraw(g,y),t.prepareDrawProgram(s,y,f.toUnwrapped());const x=c.projection.createInversionMatrix(c,f.canonical);y.draw(s,o.TRIANGLES,e.DepthMode.disabled,a,l,d,Xi(t,f,g,x,p,b,n.paint.get("heatmap-intensity")),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,n.paint,t.transform.zoom,v,u?[_.globeExtVertexBuffer]:null)}s.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,i){const n=t.context,r=n.gl,s=i.heatmapFbo;if(!s)return;n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,s.colorAttachment.get()),n.activeTexture.set(r.TEXTURE1);let o=i.colorRampTexture;o||(o=i.colorRampTexture=new e.Texture(n,i.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,r.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,((e,t)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,i),i.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,i.paint,t.transform.zoom)}(t,n))},line:function(t,i,n,r){if("translucent"!==t.renderPass)return;const s=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0===s.constantOr(1)||0===o.constantOr(1))return;const a=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),c=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,u=n.paint.get("line-dasharray"),h=u.constantOr(1),d=n.layout.get("line-cap"),p=n.paint.get("line-pattern"),m=p.constantOr(1),f=n.paint.get("line-gradient"),g=m?"linePattern":"line",_=t.context,v=_.gl,y=(e=>{const t=[];Ji(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=e.paint.get("line-trim-offset");0===i[0]&&0===i[1]||t.push("RENDER_LINE_TRIM_OFFSET");const n=e.paint.get("line-pattern").constantOr(1),r=1!==e.paint.get("line-opacity").constantOr(1);return!n&&r&&t.push("RENDER_LINE_ALPHA_DISCARD"),t})(n);let b=y.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(b=!1);for(const x of r){const r=i.getTile(x);if(m&&!r.patternsLoaded())continue;const s=r.getBucket(n);if(!s)continue;t.prepareDrawTile();const o=s.programConfigurations.get(n.id),w=t.useProgram(g,o,y),E=p.constantOr(null);if(E&&r.imageAtlas){const e=r.imageAtlas.patternPositions[E.toString()];e&&o.setConstantPatternPositions(e)}const A=u.constantOr(null),T=d.constantOr(null);if(!m&&A&&T&&r.lineAtlas){const e=r.lineAtlas.getDash(A,T);e&&o.setConstantPatternPositions(e)}let[D,S]=n.paint.get("line-trim-offset");if("round"===T||"square"===T){const e=1;D!==S&&(0===D&&(D-=e),1===S&&(S+=e))}const C=t.terrain?x.projMatrix:null,P=m?Zi(t,r,n,C,c):qi(t,r,n,C,s.lineClipsArray.length,c,[D,S]);if(f){const r=s.gradients[n.id];let o=r.texture;if(n.gradientVersion!==r.version){let a=256;if(n.stepInterpolant){const n=i.getSource().maxzoom,r=x.canonical.z===n?Math.ceil(1<<t.transform.maxZoom-x.canonical.z):1;a=e.clamp(e.nextPowerOfTwo(s.maxLineLength/e.EXTENT*1024*r),256,_.maxTextureSize)}r.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:s.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new e.Texture(_,r.gradient,v.RGBA),r.version=n.gradientVersion,o=r.texture}_.activeTexture.set(v.TEXTURE1),o.bind(n.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}h&&(_.activeTexture.set(v.TEXTURE0),r.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),o.updatePaintBuffers()),m&&(_.activeTexture.set(v.TEXTURE0),r.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),o.updatePaintBuffers()),t.prepareDrawProgram(_,w,x.toUnwrapped());const I=i=>{w.draw(_,v.TRIANGLES,a,i,l,e.CullFaceMode.disabled,P,n.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,n.paint,t.transform.zoom,o,[s.layoutVertexBuffer2])};if(b){const i=t.stencilModeForClipping(x).ref;0===i&&t.terrain&&_.clear({stencil:0});const n={func:v.EQUAL,mask:255};P.u_alpha_discard_threshold=.8,I(new e.StencilMode(n,i,255,v.KEEP,v.KEEP,v.INVERT)),P.u_alpha_discard_threshold=0,I(new e.StencilMode(n,i,255,v.KEEP,v.KEEP,v.KEEP))}else I(t.stencilModeForClipping(x))}b&&(t.resetStencilClippingMasks(),t.terrain&&_.clear({stencil:0}))},fill:function(t,i,n,r){const s=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0===o.constantOr(1))return;const a=t.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===s.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const s=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);gn(t,i,n,r,s,a,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){const s=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);gn(t,i,n,r,s,a,!0)}},"fill-extrusion":function(t,i,n,r){const s=n.paint.get("fill-extrusion-opacity");if(0!==s&&"translucent"===t.renderPass){const o=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==s||n.paint.get("fill-extrusion-pattern").constantOr(1))_n(t,i,n,r,o,e.StencilMode.disabled,e.ColorMode.disabled),_n(t,i,n,r,o,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{const s=t.colorModeForRenderPass();_n(t,i,n,r,o,e.StencilMode.disabled,s)}}},hillshade:function(t,i,n,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const s=t.context,o=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),a=t.colorModeForRenderPass(),l=t.terrain&&t.terrain.renderingToTexture,[c,u]="translucent"!==t.renderPass||l?[{},r]:t.stencilConfigForOverlap(r);for(const h of u){const r=i.getTile(h);if(r.needsHillshadePrepare&&"offscreen"===t.renderPass)gi(t,r,n,o,e.StencilMode.disabled,a);else if("translucent"===t.renderPass){const e=l&&t.terrain?t.terrain.stencilModeForRTTOverlap(h):c[h.overscaledZ];mi(t,h,r,n,o,e,a)}}s.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,i,n,r,s,o){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!r.length)return;const a=t.context,l=a.gl,c=i.getSource(),u=t.useProgram("raster"),h=t.colorModeForRenderPass(),d=t.terrain&&t.terrain.renderingToTexture,[p,m]=c instanceof Ce||d?[{},r]:t.stencilConfigForOverlap(r),f=m[m.length-1].overscaledZ,g=!t.options.moving;for(const _ of m){const r=d?e.DepthMode.disabled:t.depthModeForSublayer(_.overscaledZ-f,1===n.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,l.LESS),s=_.toUnwrapped(),m=i.getTile(_);if(d&&(!m||!m.hasData()))continue;const v=d?_.projMatrix:t.transform.calculateProjMatrix(s,g),y=t.terrain&&d?t.terrain.stencilModeForRTTOverlap(_):p[_.overscaledZ],b=o?0:n.paint.get("raster-fade-duration");m.registerFadeDuration(b);const x=i.findLoadedParent(_,0),w=Di(m,x,i,t.transform,b);let E,A;t.terrain&&t.terrain.prepareDrawTile();const T="nearest"===n.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),m.texture.bind(T,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),x?(x.texture.bind(T,l.CLAMP_TO_EDGE),E=Math.pow(2,x.tileID.overscaledZ-m.tileID.overscaledZ),A=[m.tileID.canonical.x*E%1,m.tileID.canonical.y*E%1]):m.texture.bind(T,l.CLAMP_TO_EDGE),m.texture.useMipmap&&a.extTextureFilterAnisotropic&&t.transform.pitch>20&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);const D=$i(v,A||[0,0],E||1,w,n,c instanceof Ce?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(a,u,s),c instanceof Ce)c.boundsBuffer&&c.boundsSegments&&u.draw(a,l.TRIANGLES,r,e.StencilMode.disabled,h,e.CullFaceMode.disabled,D,n.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{const{tileBoundsBuffer:i,tileBoundsIndexBuffer:s,tileBoundsSegments:o}=t.getTileBoundsBuffers(m);u.draw(a,l.TRIANGLES,r,y,h,e.CullFaceMode.disabled,D,n.id,i,s,o)}}t.resetStencilClippingMasks()},background:function(t,i,n,r){const s=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0===o)return;const a=t.context,l=a.gl,c=t.transform,u=c.tileSize,h=n.paint.get("background-pattern");if(t.isPatternMissing(h))return;const d=!h&&1===s.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==d)return;const p=e.StencilMode.disabled,m=t.depthModeForSublayer(0,"opaque"===d?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),f=t.colorModeForRenderPass(),g=t.useProgram(h?"backgroundPattern":"background");let _,v=r;v||(_=t.getBackgroundTiles(),v=Object.values(_).map(e=>e.tileID)),h&&(a.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));for(const y of v){const d=y.toUnwrapped(),v=r?y.projMatrix:t.transform.calculateProjMatrix(d);t.prepareDrawTile();const b=i?i.getTile(y):_?_[y.key]:new e.Tile(y,u,c.zoom,t),x=h?on(v,o,t,h,{tileID:y,tileSize:u}):sn(v,o,s);t.prepareDrawProgram(a,g,d);const{tileBoundsBuffer:w,tileBoundsIndexBuffer:E,tileBoundsSegments:A}=t.getTileBoundsBuffers(b);g.draw(a,l.TRIANGLES,m,p,f,e.CullFaceMode.disabled,x,n.id,w,E,A)}},sky:function(t,i,n){const r=t.transform,s="mercator"===r.projection.name||"globe"===r.projection.name?1:e.smoothstep(7,8,r.zoom),o=n.paint.get("sky-opacity")*s;if(0===o)return;const a=t.context,l=n.paint.get("sky-type"),c=new e.DepthMode(a.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),u=t.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===t.renderPass?n.needsSkyboxCapture(t)&&(function(t,i){const n=t.context,r=n.gl;let s=i.skyboxFbo;if(!s){s=i.skyboxFbo=n.createFramebuffer(32,32,!1),i.skyboxGeometry=new kn(n),i.skyboxTexture=n.gl.createTexture(),r.bindTexture(r.TEXTURE_CUBE_MAP,i.skyboxTexture),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,r.LINEAR);for(let e=0;e<6;++e)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,r.RGBA,32,32,0,r.RGBA,r.UNSIGNED_BYTE,null)}n.bindFramebuffer.set(s.framebuffer),n.viewport.set([0,0,32,32]);const o=i.getCenter(t,!0),a=t.useProgram("skyboxCapture"),l=new Float64Array(16);e.identity(l),e.rotateY(l,l,.5*-Math.PI),Mn(n,i,a,l,o,0),e.identity(l),e.rotateY(l,l,.5*Math.PI),Mn(n,i,a,l,o,1),e.identity(l),e.rotateX(l,l,.5*-Math.PI),Mn(n,i,a,l,o,2),e.identity(l),e.rotateX(l,l,.5*Math.PI),Mn(n,i,a,l,o,3),e.identity(l),Mn(n,i,a,l,o,4),e.identity(l),e.rotateY(l,l,Math.PI),Mn(n,i,a,l,o,5),n.viewport.set([0,0,t.width,t.height])}(t,n),n.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,i,n,r,s){const o=t.context,a=o.gl,l=t.transform,c=t.useProgram("skybox");o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,i.skyboxTexture);const u=((e,t,i,n,r)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:n,u_temporal_offset:r}))(l.skyboxMatrix,i.getCenter(t,!1),0,r,s);t.prepareDrawProgram(o,c),c.draw(o,a.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,u,"skybox",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,c,o,u):"gradient"===l&&"sky"===t.renderPass&&function(t,i,n,r,s){const o=t.context,a=o.gl,l=t.transform,c=t.useProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new kn(o)),o.activeTexture.set(a.TEXTURE0);let u=i.colorRampTexture;u||(u=i.colorRampTexture=new e.Texture(o,i.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((t,i,n,r,s)=>({u_matrix:t,u_color_ramp:0,u_center_direction:i,u_radius:e.degToRad(n),u_opacity:r,u_temporal_offset:s}))(l.skyboxMatrix,i.getCenter(t,!1),i.paint.get("sky-gradient-radius"),r,s);t.prepareDrawProgram(o,c),c.draw(o,a.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(t,n,c,o,u)},debug:function(e,t,i){for(let n=0;n<i.length;n++)An(e,t,i[n])},custom:function(t,i,n,r){const s=t.context,o=n.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&n.isLayerDraped()){if("offscreen"===t.renderPass){const i=o.prerender;if(i){if(t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const n=t.transform.pointMerc;i.call(o,s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[n.x,n.y],t.transform.pixelsPerMeterRatio)}else i.call(o,s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const i=o.renderToTile;if(i){const n=r[0].canonical,a=new e.MercatorCoordinate(n.x+r[0].wrap*(1<<n.z),n.y,n.z);s.setDepthMode(e.DepthMode.disabled),s.setStencilMode(e.StencilMode.disabled),s.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),i.call(o,s.gl,a),s.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),s.setColorMode(t.colorModeForRenderPass()),s.setStencilMode(e.StencilMode.disabled);const i="3d"===o.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);if(s.setDepthMode(i),"globe"===t.transform.projection.name){const i=t.transform.pointMerc;o.render(s.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[i.x,i.y],t.transform.pixelsPerMeterRatio)}else o.render(s.gl,t.transform.customLayerMatrix());s.setDirty(),t.setBaseState(),s.bindFramebuffer.set(null)}}else e.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class On{constructor(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context=new Ae(t,n),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(e,t){const i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ii(this,e));const n=this._terrain;this.transform.elevation=i?n:null,n.update(e,this.transform,t)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,n]=t.getFovAdjustedRange(this.transform._fov);if(i>n)return void(this.transform.fogCullDistSq=null);const r=i+.78*(n-i);this.transform.fogCullDistSq=r*r}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,i){if(this.width=t*e.exported.devicePixelRatio,this.height=i*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._layers[e].resize()}setup(){const t=this.context,i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);const n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);const r=new e.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);const s=new e.StructArrayLayout4i8;s.emplaceBack(0,0,0,0),s.emplaceBack(e.EXTENT,0,e.EXTENT,0),s.emplaceBack(0,e.EXTENT,0,e.EXTENT),s.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(s,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);const o=new e.StructArrayLayout3ui6;o.emplaceBack(0,1,2),o.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(o);const a=new e.StructArrayLayout1ui2;for(const e of[0,1,3,2,0])a.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(a),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();const l=this.context.gl;this.stencilClearMode=new e.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new Fn(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,i=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,i.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,Ti(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,i,n){if(!i||this.currentStencilSource===i.id||!t.isTileClipped()||!n||0===n.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of n)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=i.id;const r=this.context,s=r.gl;this.nextStencilID+n.length>256&&this.clearStencil(),r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of n){const t=i.getTile(a),n=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:c,tileBoundsSegments:u}=this.getTileBoundsBuffers(t);o.draw(r,s.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:s.ALWAYS,mask:0},n,255,s.KEEP,s.KEEP,s.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Ti(a.projMatrix),"$clipping",l,c,u)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,i=this.context.gl;return new e.StencilMode({func:i.NOTEQUAL,mask:255},t,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const i=this.context.gl;return new e.StencilMode({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(t){const i=this.context.gl,n=t.sort((e,t)=>t.overscaledZ-e.overscaledZ),r=n[n.length-1].overscaledZ,s=n[0].overscaledZ-r+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();const t={};for(let n=0;n<s;n++)t[n+r]=new e.StencilMode({func:i.GEQUAL,mask:255},n+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=s,[t,n]}return[{[r]:e.StencilMode.disabled},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}depthModeForSublayer(t,i,n){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(n||this.context.gl.LEQUAL,i,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,i){this.style=t,this.options=i,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();const n=this.style.order,r=this.style._sourceCaches;for(const e in r){const t=r[e];t.used&&t.prepare(this.context)}const s={},o={},a={};for(const e in r){const t=r[e];s[e]=t.getVisibleCoordinates(),o[e]=s[e].slice().reverse(),a[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<n.length;e++)if(this.style._layers[n[e]].is3D()){this.opaquePassCutoff=e;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),!e.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const e of n){const i=this.style._layers[e],n=t._getLayerSourceCache(i);if(!i.hasOffscreenPass()||i.isHidden(this.transform.zoom))continue;const r=n?o[n.id]:void 0;("custom"===i.type||i.isSky()||r&&r.length)&&this.renderLayer(this,n,i,r)}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon];const l=this.terrain;if(l&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&l.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:i.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);if(e.isSky())continue;const r=i?o[i.id]:void 0;this._renderTileClippingMasks(e,i,r),this.renderLayer(this,i,e,r)}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,i){const n=t.context,r=n.gl,s=t.transform,o=new e.DepthMode(r.LEQUAL,e.DepthMode.ReadOnly,[0,1]),a=t.useProgram("globeAtmosphere",null,"globe"===s.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=e.globeToMercatorTransition(s.zoom),c=i.properties.get("color").toArray01(),u=i.properties.get("high-color").toArray01(),h=i.properties.get("space-color").toArray01PremultipliedAlpha(),d=e.identity$1([]);e.rotateY$1(d,d,-e.degToRad(s._center.lng)),e.rotateX$1(d,d,e.degToRad(s._center.lat)),e.rotateZ$1(d,d,s.angle),e.rotateX$1(d,d,-s._pitch);const p=e.fromQuat(new Float32Array(16),d),m=e.mapValue(i.properties.get("star-intensity"),0,1,0,.25),f=5e-4,g=e.mapValue(i.properties.get("horizon-blend"),0,1,f,.25),_=e.globeUseCustomAntiAliasing(t,n,s)&&g===f?s.worldSize/(2*Math.PI*1.025)-1:s.globeRadius,v=t.frameCounter/1e3%1,y=e.length(s.globeCenterInViewSpace),b=Math.sqrt(Math.pow(y,2)-Math.pow(_,2)),x=Math.acos(b/y),w=((t,i,n,r,s,o,a,l,c,u,h,d,p,m)=>({u_frustum_tl:t,u_frustum_tr:i,u_frustum_br:n,u_frustum_bl:r,u_horizon:s,u_transition:o,u_fadeout_range:a,u_color:l,u_high_color:c,u_space_color:u,u_star_intensity:h,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:d,u_horizon_angle:p,u_rotation_matrix:m}))(s.frustumCorners.TL,s.frustumCorners.TR,s.frustumCorners.BR,s.frustumCorners.BL,s.frustumCorners.horizon,l,g,c,u,h,m,v,x,p);t.prepareDrawProgram(n,a);const E=t.atmosphereBuffer;E&&a.draw(n,r.TRIANGLES,o,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",E.vertexBuffer,E.indexBuffer,E.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,i,e,i?o[i.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;){const e=this.style._layers[n[this.currentLayer]],i=t._getLayerSourceCache(e);if(e.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=i?("symbol"===e.type?a:o)[i.id]:void 0;this._renderTileClippingMasks(e,i,i?s[i.id]:void 0),this.renderLayer(this,i,e,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let i=null;e.values(this.style._layers).forEach(e=>{const n=t._getLayerSourceCache(e);n&&!e.isHidden(this.transform.zoom)&&(!i||i.getSource().maxzoom<n.getSource().maxzoom)&&(i=n)}),i&&this.options.showTileBoundaries&&Ln.debug(this,i,i.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Tn(e,e.transform.height-(t.top||0),3,yn),Tn(e,t.bottom||0,3,bn),Dn(e,t.left||0,3,xn),Dn(e,e.transform.width-(t.right||0),3,wn);const i=e.transform.centerPoint;!function(e,t,i,n){Sn(e,t-1,i-10,2,20,n),Sn(e,t-10,i-1,20,2,n)}(e,i.x,e.transform.height-i.y,En)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}renderLayer(e,t,i,n){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||n&&n.length)&&(this.id=i.id,this.gpuTimingStart(i),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(i.type)||e.terrain&&"custom"===i.type)&&Ln[i.type](e,t,i,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;let i=this.gpuTimers[e.id];i||(i=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),i.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const i in e){const n=e[i],r=this.context.extTimerQuery,s=r.getQueryObjectEXT(n.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n.query),t[i]=s}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.extTimerQuery;let i=0;for(const n of e)i+=t.getQueryObjectEXT(n,t.QUERY_RESULT_EXT)/1e6,t.deleteQueryEXT(n);return i}translatePosMatrix(t,i,n,r,s){if(!n[0]&&!n[1])return t;const o=s?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){const e=Math.sin(o),t=Math.cos(o);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}const a=[s?n[0]:I(i,n[0],this.transform.zoom),s?n[1]:I(i,n[1],this.transform.zoom),0],l=new Float32Array(16);return e.translate(l,t,a),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){return null===e||void 0!==e&&!this.imageManager.getPattern(e.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const e=this.terrain&&this.terrain.renderingToTexture,t=this.terrain&&0===this.terrain.exaggeration(),i=this.style&&this.style.fog,n=[];return this.terrainRenderModeElevated()&&n.push("TERRAIN"),"globe"===this.transform.projection.name&&n.push("GLOBE"),t&&n.push("ZERO_EXAGGERATION"),i&&!e&&0!==i.getOpacity(this.transform.pitch)&&n.push("FOG"),e&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}useProgram(e,t,i){this.cache=this.cache||{};const n=i||[],r=this.currentGlobalDefines().concat(n),s=ki.cacheKey(ci[e],e,r,t);return this.cache[s]||(this.cache[s]=new ki(this.context,e,ci[e],t,an[e],r)),this.cache[s]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,i,n){if(this.terrain&&this.terrain.renderingToTexture)return;const r=this.style.fog;if(r){const s=r.getOpacity(this.transform.pitch),o=((t,i,n,r,s,o,a,l,c,u,h)=>{const d=t.transform,p=i.properties.get("color").toArray01();p[3]=r;const m=t.frameCounter/1e3%1;return{u_fog_matrix:n?d.calculateFogTileMatrix(n):t.identityMat,u_fog_range:i.getFovAdjustedRange(d._fov),u_fog_color:p,u_fog_horizon_blend:i.properties.get("horizon-blend"),u_fog_temporal_offset:m,u_frustum_tl:s,u_frustum_tr:o,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:h,u_globe_transition:e.globeToMercatorTransition(d.zoom),u_is_globe:+("globe"===d.projection.name)}})(this,r,n,s,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);i.setFogUniformValues(t,o)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,i=this._backgroundTiles={},n=this.transform.coveringTiles({tileSize:512});for(const r of n)i[r.key]=t[r.key]||new e.Tile(r,512,this.transform.tileZoom,this);return i}clearBackgroundTiles(){this._backgroundTiles={}}}class Bn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(i)||i<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=i,this.right=n}interpolate(t,i,n){return null!=i.top&&null!=t.top&&(this.top=e.number(t.top,i.top,n)),null!=i.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,i.bottom,n)),null!=i.left&&null!=t.left&&(this.left=e.number(t.left,i.left,n)),null!=i.right&&null!=t.right&&(this.right=e.number(t.right,i.right,n)),this}getCenter(t,i){const n=e.clamp((this.left+t-this.right)/2,0,t),r=e.clamp((this.top+i-this.bottom)/2,0,i);return new e.Point(n,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Bn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zn(t,i){const n=e.getColumn(t,3);e.fromQuat(t,i),e.setColumn(t,3,n)}function Nn(t,i){const n=e.identity$1([]);return e.rotateZ$1(n,n,-i),e.rotateX$1(n,n,-t),n}function Un(t,i){const n=[t[0],t[1],0],r=[i[0],i[1],0];if(e.length(n)>=1e-15){const t=e.normalize([],n);e.scale$2(r,t,e.dot(r,t)),i[0]=r[0],i[1]=r[1]}const s=e.cross([],i,t);if(e.len(s)<1e-15)return null;const o=Math.atan2(-s[1],s[0]);return Nn(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),o)}class jn{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const i=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(i.x=e.wrap(i.x,0,1)),this._position=i}else this._position=null}lookAtPoint(t,i){if(this.orientation=null,!this.position)return;const n=this.position,r=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,s=e.MercatorCoordinate.fromLngLat(t,r),o=[s.x-n.x,s.y-n.y,s.z-n.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=Un(o,i)}setPitchBearing(t,i){this.orientation=Nn(e.degToRad(t),e.degToRad(-i))}}class Vn{constructor(t,i){this._transform=e.identity([]),this.orientation=i,this.position=t}get mercatorPosition(){const t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var i;t&&e.setColumn(this._transform,3,[(i=t)[0],i[1],i[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.identity$1([]),t&&zn(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Nn(e,t),zn(this._transform,this._orientation)}forward(){const t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,i){const n=new Float64Array(16);return e.invert(n,this.getWorldToCamera(t,i)),n}getWorldToCameraPosition(t,i,n){const r=this.position;e.scale$2(r,r,-t);const s=new Float64Array(16);return e.fromScaling(s,[n,n,n]),e.translate(s,s,r),s[10]*=i,s}getWorldToCamera(t,i){const n=new Float64Array(16),r=new Float64Array(4),s=this.position;return e.conjugate(r,this._orientation),e.scale$2(s,s,-t),e.fromQuat(n,r),e.translate(n,n,s),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i,n}getCameraToClipPerspective(t,i,n,r){const s=new Float64Array(16);return e.perspective(s,t,i,n,r),s}getDistanceToElevation(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=0===t?0:e.mercatorZfromAltitude(t,i?e.latFromMercatorY(this.position[1]):this.position[1]),r=this.forward();return(n-this.position[2])/r[2]}clone(){return new Vn([...this.position],[...this.orientation])}}function Gn(t,i){const n=Hn(t.projection,t.zoom,t.width,t.height),r=function(t,i,n,r,s){const o=new e.LngLat(n.lng-180*Xn,n.lat),a=new e.LngLat(n.lng+180*Xn,n.lat),l=t.project(o.lng,o.lat),c=t.project(a.lng,a.lat),u=-Math.atan2(c.y-l.y,c.x-l.x),h=e.MercatorCoordinate.fromLngLat(n);h.y=e.clamp(h.y,-1+Xn,1-Xn);const d=h.toLngLat(),p=t.project(d.lng,d.lat),m=e.MercatorCoordinate.fromLngLat(d);m.x+=Xn;const f=m.toLngLat(),g=t.project(f.lng,f.lat),_=Zn(g.x-p.x,g.y-p.y,u),v=e.MercatorCoordinate.fromLngLat(d);v.y+=Xn;const y=v.toLngLat(),b=t.project(y.lng,y.lat),x=Zn(b.x-p.x,b.y-p.y,u),w=Math.abs(_.x)/Math.abs(x.y),E=e.identity([]);e.rotateZ(E,E,-u*(1-(s?0:r)));const A=e.identity([]);return e.scale(A,A,[1,1-(1-w)*r,1]),A[4]=-x.x/x.y*r,e.rotateZ(A,A,u),e.multiply(A,E,A),A}(t.projection,0,t.center,n,i),s=Wn(t);return e.scale(r,r,[s,s,1]),r}function Wn(t){const i=t.projection,n=Hn(t.projection,t.zoom,t.width,t.height),r=qn(i,t.center),s=qn(i,e.LngLat.convert(i.center));return Math.pow(2,r*n+(1-n)*s)}function Hn(t,i,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=t.range;if(!o)return 0;const a=Math.min(s,Math.max(n,r)),l=Math.log(a/1024)/Math.LN2;return e.smoothstep(o[0]+l,o[1]+l,i)}const Xn=1/4e4;function qn(t,i){const n=e.clamp(i.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),r=new e.LngLat(i.lng-180*Xn,n),s=new e.LngLat(i.lng+180*Xn,n),o=t.project(r.lng,n),a=t.project(s.lng,n),l=e.MercatorCoordinate.fromLngLat(r),c=e.MercatorCoordinate.fromLngLat(s),u=a.x-o.x,h=a.y-o.y,d=c.x-l.x,p=c.y-l.y,m=Math.sqrt((d*d+p*p)/(u*u+h*h));return Math.log(m)/Math.LN2}function Zn(e,t,i){const n=Math.cos(i),r=Math.sin(i);return{x:e*n-t*r,y:e*r+t*n}}class Yn{constructor(t,i,n,r,s,o,a){this.tileSize=512,this._renderWorldCopies=void 0===s||s,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=null==n?0:n,this._maxPitch=null==r?60:r,this.setProjection(o),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Vn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const e=new Yn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||i)&&this._updateCameraOnTerrain(),(e||i)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);const r=!t(n,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.getProjection({name:"mercator"});const i=t!==this.projection.name;return i&&this._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.Point(this.width,this.height)}get bearing(){return e.wrap(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const i=-t*Math.PI/180;var n;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=(n=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(i),l=Math.cos(i);e[0]=n*l+s*a,e[1]=r*l+o*a,e[2]=n*-a+s*l,e[3]=r*-a+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop();let r=0,s=0;for(let o=0;o<i.length;o++){const a=new e.Point(i[o][0]*this.width,n+i[o][1]*(this.height-n)),l=t.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*c,s+=c}return 0===s?NaN:r/s}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*t,n=this._mercatorZfromZoom(e),r=this._mercatorZfromZoom(this._maxZoom),s=Math.max(n-i,r);this._setZoom(this._zoomFromMercatorZ(s))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let n;n=t.z<this._camera.position[2]?[i.x,i.y,i.z]:[t.x,t.y,t.z];const r=e.length(e.sub([],this._camera.position,n));return e.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let i=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(t.orientation)),t.position){const n=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,i=new jn;return i.position=new e.MercatorCoordinate(t[0],t[1],t[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);const i=e.transformQuat([],[0,0,-1],t),n=e.transformQuat([],[0,-1,0],t);if(n[2]<0)return!1;const r=Un(i,n);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(t){const i=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;t[2]=e.clamp(t[2],r/n,r/i),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,i){this._unmodified=!1,this._edgeInsets.interpolate(e,t,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const i=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const n=this.pointCoordinate(new e.Point(0,0)),r=this.pointCoordinate(new e.Point(this.width,0)),s=this.pointCoordinate(new e.Point(this.width,this.height)),o=this.pointCoordinate(new e.Point(0,this.height)),a=Math.floor(Math.min(n.x,r.x,s.x,o.x)),l=Math.floor(Math.max(n.x,r.x,s.x,o.x)),c=1;for(let u=a-c;u<=l+c;u++)0!==u&&i.push(new e.UnwrappedTileID(u,t))}return i}coveringTiles(t){let i=this.coveringZoomLevel(t);const n=i,r=this.elevation&&!t.isTerrainDEM,s="mercator"===this.projection.name;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);const o=this.locationCoordinate(this.center),a=this.center.lat,l=1<<i,c=[l*o.x,l*o.y,0],u="globe"===this.projection.name,h=!u,d=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,h),p=u?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=l*e.mercatorZfromAltitude(1,this.center.lat),f=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),g=[l*p.x,l*p.y,f*(h?1:m)],_=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?i:0,y=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,b=t.isTerrainDEM?-y:this._elevation?this._elevation.getMinElevationBelowMSL():0,x=this.projection.isReprojectedInTileSpace?Wn(this):1,w=t=>{const i=1/4e4,n=new e.MercatorCoordinate(t.x+i,t.y,t.z),r=new e.MercatorCoordinate(t.x,t.y+i,t.z),s=t.toLngLat(),o=n.toLngLat(),a=r.toLngLat(),l=this.locationCoordinate(s),c=this.locationCoordinate(o),u=this.locationCoordinate(a),h=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(h*d)*x/i},E=t=>{const i=y,n=b;return{aabb:e.tileAABB(this,l,0,0,0,t,n,i,this.projection),zoom:0,x:0,y:0,minZ:n,maxZ:i,wrap:t,fullyVisible:!1}},A=[];let T=[];const D=i,S=t.reparseOverscaled?n:i,C=e=>e*e,P=C((f-this._centerAltitude)*m),I=e=>{if(!this._elevation||!e.tileID||!s)return;const t=this._elevation.getMinMaxForTile(e.tileID),i=e.aabb;t?(i.min[2]=t.min,i.max[2]=t.max,i.center[2]=(i.min[2]+i.max[2])/2):(e.shouldSplit=k(e),e.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=this._centerAltitude))},k=t=>{if(t.zoom<v)return!0;if(t.zoom===D)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const i=t.aabb.distanceX(g),s=t.aabb.distanceY(g);let o=P,l=1;if(u){o=C(t.aabb.distanceZ(g));const i=Math.pow(2,t.zoom),n=e.latFromMercatorY((t.y+1)/i),r=e.latFromMercatorY(t.y/i),s=Math.min(Math.max(a,n),r),c=e.circumferenceAtLatitude(s)/e.circumferenceAtLatitude(a);if(l=s===a?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,c/this._mercatorScaleRatio),this.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===D-1&&c>=.9)return!0}else if(r&&(o=C(t.aabb.distanceZ(g)*m)),this.projection.isReprojectedInTileSpace&&n<=5){const i=Math.pow(2,t.zoom),n=w(new e.MercatorCoordinate((t.x+.5)/i,(t.y+.5)/i));l=n>.85?1:n}const c=i*i+s*s+o,h=C((1<<D-t.zoom)*_*l*((e,t)=>{if(t*C(.707)<e)return 1;const i=Math.sqrt(t/e);return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(o,P),c));return c<h};if(this.renderWorldCopies)for(let e=1;e<=3;e++)A.push(E(-e)),A.push(E(e));for(A.push(E(0));A.length>0;){const n=A.pop(),o=n.x,a=n.y;let h=n.fullyVisible;if(!h){const e=n.aabb.intersects(d);if(0===e)continue;h=2===e}if(n.zoom!==D&&k(n))for(let t=0;t<4;t++){const i=(o<<1)+t%2,c=(a<<1)+(t>>1),d={aabb:s?n.aabb.quadrant(t):e.tileAABB(this,l,n.zoom+1,i,c,n.wrap,n.minZ,n.maxZ,this.projection),zoom:n.zoom+1,x:i,y:c,wrap:n.wrap,fullyVisible:h,tileID:void 0,shouldSplit:void 0,minZ:n.minZ,maxZ:n.maxZ};r&&!u&&(d.tileID=new e.OverscaledTileID(n.zoom+1===D?S:n.zoom+1,n.wrap,n.zoom+1,i,c),I(d)),A.push(d)}else{const r=n.zoom===D?S:n.zoom;if(t.minzoom&&t.minzoom>r)continue;const s=c[0]-(.5+o+(n.wrap<<n.zoom))*(1<<i-n.zoom),l=c[1]-.5-a,u=n.tileID?n.tileID:new e.OverscaledTileID(r,n.wrap,n.zoom,o,a);T.push({tileID:u,distanceSq:s*s+l*l})}}if(this.fogCullDistSq){const i=this.fogCullDistSq,n=this.horizonLineFromTop();T=T.filter(r=>{const s=[0,0,0,1],o=[e.EXTENT,e.EXTENT,0,1],a=this.calculateFogTileMatrix(r.tileID.toUnwrapped());e.transformMat4$1(s,s,a),e.transformMat4$1(o,o,a);const l=e.getAABBPointSquareDist(s,o);if(0===l)return!0;let c=!1;const u=this._elevation;if(u&&l>i&&0!==n){const i=this.calculateProjMatrix(r.tileID.toUnwrapped());let s;t.isTerrainDEM||(s=u.getMinMaxForTile(r.tileID)),s||(s={min:b,max:y});const o=e.furthestTileCorner(this.rotation),a=[o[0]*e.EXTENT,o[1]*e.EXTENT,s.max];e.transformMat4(a,a,i),c=(1-a[1])*this.height*.5<n}return l<i||c})}return T.sort((e,t)=>e.distanceSq-t.distanceSq).map(e=>e.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const i=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),n=this.projection.project(t.lng,i);return new e.Point(n.x*this.worldSize,n.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,i){let n,r;const s=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;n=(i.x-s.x)/e,r=(i.y-s.y)/e}else{const e=this.pointCoordinate(i),t=this.pointCoordinate(s);n=e.x-t.x,r=e.y-t.y}const o=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(o.x-n,o.y-r))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,i){const n=i?e.mercatorZfromAltitude(i,t.lat):void 0,r=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(r.x,r.y,n)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,i){const n=null!=i?i:this._centerAltitude,r=[t.x,t.y,0,1],s=[t.x,t.y,1,1];e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(s,s,this.pixelMatrixInverse);const o=s[3];e.scale$1(r,r,1/r[3]),e.scale$1(s,s,1/o);const a=r[2],l=s[2];return{p0:r,p1:s,t:a===l?0:(n-a)/(l-a)}}screenPointToMercatorRay(t){const i=[t.x,t.y,0,1],n=[t.x,t.y,1,1];return e.transformMat4$1(i,i,this.pixelMatrixInverse),e.transformMat4$1(n,n,this.pixelMatrixInverse),e.scale$1(i,i,1/i[3]),e.scale$1(n,n,1/n[3]),i[2]=e.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,e.scale$1(i,i,1/this.worldSize),e.scale$1(n,n,1/this.worldSize),new e.Ray([i[0],i[1],i[2]],e.normalize([],e.sub([],n,i)))}rayIntersectionCoordinate(t){const{p0:i,p1:n,t:r}=t,s=e.mercatorZfromAltitude(i[2],this._center.lat),o=e.mercatorZfromAltitude(n[2],this._center.lat);return new e.MercatorCoordinate(e.number(i[0],n[0],r)/this.worldSize,e.number(i[1],n[1],r)/this.worldSize,e.number(s,o,r))}pointCoordinate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let i=this.projection.pointCoordinate3D(this,t.x,t.y);if(i)return new e.MercatorCoordinate(i[0],i[1],i[2]);let n=0,r=this.horizonLineFromTop();if(t.y>r)return this.pointCoordinate(t);const s=.02*r,o=t.clone();for(let a=0;a<10&&r-n>s;a++){o.y=e.number(n,r,.66);const t=this.projection.pointCoordinate3D(this,o.x,o.y);t?(r=o.y,i=t):n=o.y}return i?new e.MercatorCoordinate(i[0],i[1],i[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(t);const i=this.pointCoordinate(t);return i.y>=0&&i.y<=1}_coordinatePoint(t,i){const n=i&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,r=[t.x*this.worldSize,t.y*this.worldSize,n+t.toAltitude(),1];return e.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new e.Point(r[0]/r[3],r[1]/r[3]):new e.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:i}=this._edgeInsets,n=this.height-this._edgeInsets.bottom,r=this.width-this._edgeInsets.right,s=this.pointLocation3D(new e.Point(i,t)),o=this.pointLocation3D(new e.Point(r,t)),a=this.pointLocation3D(new e.Point(r,n)),l=this.pointLocation3D(new e.Point(i,n));let c=Math.min(s.lng,o.lng,a.lng,l.lng),u=Math.max(s.lng,o.lng,a.lng,l.lng),h=Math.min(s.lat,o.lat,a.lat,l.lat),d=Math.max(s.lat,o.lat,a.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,m="globe"===this.projection.name?1:4,f=(t,i,n,r,s)=>{const o=(t+n)/2,a=(i+r)/2,l=new e.Point(o,a),{lng:g,lat:_}=this.pointLocation3D(l),v=Math.max(0,c-g,h-_,g-u,_-d);c=Math.min(c,g),u=Math.max(u,g),h=Math.min(h,_),d=Math.max(d,_),(s<m||v>p)&&(f(t,i,o,a,s+1),f(o,a,n,r,s+1))};if(f(i,t,r,t,1),f(r,t,r,n,1),f(r,n,i,n,1),f(i,n,i,t,1),"globe"===this.projection.name){const[t,i]=e.polesInViewport(this);t?(d=90,u=180,c=-180):i&&(h=-90,u=180,c=-180)}return new e.LngLatBounds(new e.LngLat(c,h),new e.LngLat(u,d))}_getBoundsRectangular(t,i){const{top:n,left:r}=this._edgeInsets,s=this.height-this._edgeInsets.bottom,o=this.width-this._edgeInsets.right,a=new e.Point(r,n),l=new e.Point(o,n),c=new e.Point(o,s),u=new e.Point(r,s);let h=this.pointCoordinate(a,t),d=this.pointCoordinate(l,t);const p=this.pointCoordinate(c,i),m=this.pointCoordinate(u,i),f=(e,t)=>(t.y-e.y)/(t.x-e.x);return h.y>1&&d.y>=0?h=new e.MercatorCoordinate((1-m.y)/f(m,h)+m.x,1):h.y<0&&d.y<=1&&(h=new e.MercatorCoordinate(-m.y/f(m,h)+m.x,0)),d.y>1&&h.y>=0?d=new e.MercatorCoordinate((1-p.y)/f(p,d)+p.x,1):d.y<0&&h.y<=1&&(d=new e.MercatorCoordinate(-p.y/f(p,d)+p.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(m)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce((e,t)=>{if(t.dem){const i=t.dem.tree;e.min=Math.min(e.min,i.minimums[0]),e.max=Math.max(e.max,i.maximums[0])}return e},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const i=t.key,n=this._distanceTileDataCache;if(n[i])return n[i];const r=t.canonical,s=1/this.height,o=this.cameraWorldSize,a=o/this.zoomScale(r.z),l=(r.x+Math.pow(2,r.z)*t.wrap)*a,c=r.y*a,u=this.point;u.x*=o/this.worldSize,u.y*=o/this.worldSize;const h=this.angle,d=Math.sin(-h),p=-Math.cos(-h);return n[i]={bearing:[d,p],center:[(u.x-l)*s,(u.y-c)*s],scale:a/e.EXTENT*s},n[i]}calculateFogTileMatrix(t){const i=t.key,n=this._fogTileMatrixCache;if(n[i])return n[i];const r=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.multiply(r,this.worldToFogMatrix,r),n[i]=new Float32Array(r),n[i]}calculateProjMatrix(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.key,r=i?this._alignedProjMatrixCache:this._projMatrixCache;if(r[n])return r[n];const s=this.calculatePosMatrix(t,this.worldSize);return e.multiply(s,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:i?this.alignedProjMatrix:this.projMatrix,s),r[n]=new Float32Array(s),r[n]}calculatePixelsToTileUnitsMatrix(t){const i=t.tileID.key,n=this._pixelsToTileUnitsCache;if(n[i])return n[i];const r=function(t,i){const{scale:n}=t.tileTransform,r=n*e.EXTENT/(t.tileSize*Math.pow(2,i.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return s=new Float32Array(4),l=(o=i.inverseAdjustmentMatrix)[1],c=o[2],u=o[3],d=(a=[r,r])[1],s[0]=o[0]*(h=a[0]),s[1]=l*h,s[2]=c*d,s[3]=u*d,s;var s,o,a,l,c,u,h,d}(t,this);return n[i]=r,n[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,i=e.fromScaling([],[t,t,t]);return e.multiply(i,i,this.globeMatrix),i}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(i),r=this._camera.forward(),s=e.mercatorZfromAltitude(1,this._center.lat);n[2]/=s,r[2]/=s,e.normalize(r,r);const o=t.raycast(n,r,t.exaggeration());if(o){const t=e.scaleAndAdd([],n,r,o),i=new e.MercatorCoordinate(t[0],t[1],e.mercatorZfromAltitude(t[2],e.latFromMercatorY(t[1]))),a=(i.z+e.length([i.x-n[0],i.y-n[1],i.z-n[2]*s]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=i.toAltitude(),this._center=this.coordinateLocation(i),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._elevation)return;const i=this._elevation,n=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(n),s=i.getAtPointOrZero(new e.MercatorCoordinate(...r)),o=this.pixelsPerMeter/this.worldSize*s,a=this._minimumHeightOverTerrain(),l=r[2]-o;if(l<=a)if(l<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),i=[r[0],r[1],t.z-r[2]],n=e.length(i);i[2]-=(a-l)/this._pixelsPerMercatorPixel;const s=e.length(i);if(0===s)return;e.scale$2(i,i,n/s*this._pixelsPerMercatorPixel),this._camera.position=[r[0],r[1],t.z*this._pixelsPerMercatorPixel-i[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const i=this.center;return i.lat=e.clamp(i.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(i.lng=e.clamp(i.lng,this.minLng,this.maxLng)),this.center=i,void(this._constraining=!1)}const i=this._unmodified,{x:n,y:r}=this.point;let s=0,o=n,a=r;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(r-c<u&&(a=u+c),r+c>h&&(a=h-c),h-u<this.height&&(s=Math.max(s,this.height/(h-u)),a=(h+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,i=this.worldSize/2-(e+t)/2;o=(n+i+this.worldSize)%this.worldSize-i,o-l<e&&(o=e+l),o+l>t&&(o=t-l),t-e<this.width&&(s=Math.max(s,this.width/(t-e)),o=(t+e)/2)}o===n&&a===r||(this.center=this.unproject(new e.Point(o,a))),s&&(this.zoom+=this.scaleZoom(s)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.mercatorZfromAltitude(1,this.center.lat)/e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE));const n=Hn(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,n),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const r="meters"===this.projection.zAxisUnit?i:1,s=this._camera.getWorldToCamera(this.worldSize,r),o=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);o[8]=2*-t.x/this.width,o[9]=2*t.y/this.height;let a=e.mul([],o,s);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),i=e.identity([]);e.translate(i,i,[t.x*this.worldSize,t.y*this.worldSize,0]),e.multiply(i,i,Gn(this)),e.translate(i,i,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.multiply(a,a,i),this.inverseAdjustmentMatrix=function(e){const t=Gn(e,!0);return v([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],a,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=a,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);const l=e.invert([],o);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(l,this.horizonLineFromTop(),this.height);const c=new Float32Array(16);e.identity(c),e.scale(c,c,[1,-1,1]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle);const u=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),h=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;u[8]=2*-t.x/this.width,u[9]=2*(t.y+h)/this.height,this.skyboxMatrix=e.multiply(c,u,c);const d=this.point,p=d.x,m=d.y,f=this.width%2/2,g=this.height%2/2,_=Math.cos(this.angle),y=Math.sin(this.angle),b=p-Math.round(p)+_*f+y*g,x=m-Math.round(m)+_*g+y*f,w=new Float64Array(a);if(e.translate(w,w,[b>.5?b-1:b,x>.5?x-1:x,0]),this.alignedProjMatrix=w,a=e.create(),e.scale(a,a,[this.width/2,-this.height/2,1]),e.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=e.create(),e.scale(a,a,[1,-1,1]),e.translate(a,a,[-1,-1,0]),e.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},a=e.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=a,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(t,t,s),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=a;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,i=this.cameraPixelsPerMeter,n=this._camera.position,r=1/this.height/this._pixelsPerMercatorPixel,s=[t,t,i];e.scale$2(s,s,r),e.scale$2(n,n,-1),e.multiply$2(n,n,s);const o=e.create();e.translate(o,o,n),e.scale(o,o,s),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,i,r)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),n=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[n.x/this.worldSize-i[0]*r,n.y/this.worldSize-i[1]*r,e/this.worldSize*this._centerAltitude-i[2]*r]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=this._camera.position[2],r=t[2];let s=1;this.projection.wrap&&(this.center=this.center.wrap()),r>0&&(s=Math.min((i-n)/r,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,s),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,i=this._camera.forward(),{pitch:n,bearing:r}=this._camera.getPitchBearing(),s=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,o=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),a=Math.max((t[2]-s)/Math.cos(n),o),l=this._zoomFromMercatorZ(a);e.scaleAndAdd(t,t,i,a),this._pitch=e.clamp(n,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(r,-Math.PI,Math.PI),this._setZoom(e.clamp(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let i=0,n=e.GLOBE_ZOOM_THRESHOLD_MAX,r=0,s=1/0;for(;n-i>1e-6&&n>i;){const e=i+.5*(n-i),o=this.tileSize*Math.pow(2,e),a=this.getCameraToCenterDistance(this.projection,e,o),l=this.scaleZoom(a/(t*this.tileSize)),c=Math.abs(e-l);c<s&&(s=c,r=e),e<l?i=e:n=e}return r}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,i){const n=Math.min(t.x,i.x),r=Math.max(t.x,i.x),s=Math.min(t.y,i.y),o=Math.max(t.y,i.y);if(s<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new e.Point(n,s),new e.Point(r,o),new e.Point(n,o),new e.Point(r,s)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of a){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const i=this.rayIntersectionCoordinate(t);if(i.x<l||i.y<0||i.x>c||i.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.Point(0,0),new e.Point(this.width,this.height))}zoomDeltaToMovement(t,i){const n=e.length(e.sub([],this._camera.position,t)),r=this._zoomFromMercatorZ(n)+i;return n-this._mercatorZfromZoom(r)}getCameraPoint(){if("globe"===this.projection.name){const t=function(t,i){let[n,r,s]=t;const o=[n,r,s,1];e.transformMat4$1(o,o,i);const a=o[3]=Math.max(o[3],1e-6);return o[0]/=a,o[1]/=a,o[2]/=a,o}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.Point(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))}}getCameraToCenterDistance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize;const n=Hn(e,t,this.width,this.height,1024),r=e.pixelSpaceConversion(this.center.lat,i,n);return.5/Math.tan(.5*this._fov)*this.height*r}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.multiply(t,t,this.globeMatrix),t}}function Kn(e,t){let i=!1,n=null;const r=()=>{n=null,i&&(e(),n=setTimeout(r,t),i=!1)};return()=>(i=!0,n||r(),n)}class Jn{constructor(t){this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Kn(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const i=$n(t);if(this._hashName){const t=this._hashName;let n=!1;const r=e.window.location.hash.slice(1).split("&").map(e=>{const r=e.split("=")[0];return r===t?(n=!0,"".concat(r,"=").concat(i)):e}).filter(e=>e);return n||r.push("".concat(t,"=").concat(i)),"#".concat(r.join("&"))}return"#".concat(i)}_getCurrentHash(){const t=e.window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map(e=>e.split("=")).forEach(t=>{t[0]===this._hashName&&(e=t)}),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some(e=>isNaN(e))){const i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:i,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}function $n(e,t){const i=e.getCenter(),n=Math.round(100*e.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,r),o=Math.round(i.lng*s)/s,a=Math.round(i.lat*s)/s,l=e.getBearing(),c=e.getPitch();let u=t?"/".concat(o,"/").concat(a,"/").concat(n):"".concat(n,"/").concat(a,"/").concat(o);return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/".concat(Math.round(c))),u}const Qn={linearity:.3,easing:e.bezier(0,0,.3,1)},er=e.extend({deceleration:2500,maxSpeed:1400},Qn),tr=e.extend({deceleration:20,maxSpeed:1400},Qn),ir=e.extend({deceleration:1e3,maxSpeed:360},Qn),nr=e.extend({deceleration:1e3,maxSpeed:90},Qn);class rr{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,i=e.exported.now();for(;t.length>0&&i-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)i.zoom+=e.zoomDelta||0,i.bearing+=e.bearingDelta||0,i.pitch+=e.pitchDelta||0,e.panDelta&&i.pan._add(e.panDelta),e.around&&(i.around=e.around),e.pinchAround&&(i.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(i.pan.mag()){const s=or(i.pan.mag(),n,e.extend({},er,t||{}));r.offset=i.pan.mult(s.amount/i.pan.mag()),r.center=this._map.transform.center,sr(r,s)}if(i.zoom){const e=or(i.zoom,n,tr);r.zoom=this._map.transform.zoom+e.amount,sr(r,e)}if(i.bearing){const t=or(i.bearing,n,ir);r.bearing=this._map.transform.bearing+e.clamp(t.amount,-179,179),sr(r,t)}if(i.pitch){const e=or(i.pitch,n,nr);r.pitch=this._map.transform.pitch+e.amount,sr(r,e)}if(r.zoom||r.bearing){const e=void 0===i.pinchAround?i.around:i.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),r.noMoveStart=!0,r}}function sr(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function or(t,i,n){const{maxSpeed:r,linearity:s,deceleration:o}=n,a=e.clamp(t*s/(i/1e3),-r,r),l=Math.abs(a)/(o*s);return{easing:n.easing,duration:1e3*l,amount:a*(l/2)}}class ar extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=m(i.getCanvasContainer(),n),o=i.unproject(s);super(t,e.extend({point:s,lngLat:o,originalEvent:n},r)),this._defaultPrevented=!1,this.target=i}}class lr extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,n){const r="touchend"===t?n.changedTouches:n.touches,s=f(i.getCanvasContainer(),r),o=s.map(e=>i.unproject(e)),a=s.reduce((e,t,i,n)=>e.add(t.div(n.length)),new e.Point(0,0));super(t,{points:s,point:a,lngLats:o,lngLat:i.unproject(a),originalEvent:n}),this._defaultPrevented=!1}}class cr extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}}class ur{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new cr(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new ar(e.type,this._map,e))}mouseup(e){this._map.fire(new ar(e.type,this._map,e))}preclick(t){const i=e.extend({},t);i.type="preclick",this._map.fire(new ar(i.type,this._map,i))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new ar(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new ar(e.type,this._map,e))}mouseover(e){this._map.fire(new ar(e.type,this._map,e))}mouseout(e){this._map.fire(new ar(e.type,this._map,e))}touchstart(e){return this._firePreventable(new lr(e.type,this._map,e))}touchmove(e){this._map.fire(new lr(e.type,this._map,e))}touchend(e){this._map.fire(new lr(e.type,this._map,e))}touchcancel(e){this._map.fire(new lr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new ar(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new ar(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dr{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(u(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const i=t,n=this._startPos,r=this._lastPos;if(!n||!r||r.equals(i)||!this._box&&i.dist(n)<this._clickTolerance)return;this._lastPos=i,this._box||(this._box=s("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const o=Math.min(n.x,i.x),a=Math.max(n.x,i.x),l=Math.min(n.y,i.y),c=Math.max(n.y,i.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform="translate(".concat(o,"px,").concat(l,"px)"),this._box.style.width=a-o+"px",this._box.style.height=c-l+"px")})}mouseupWindow(t,i){if(!this._active)return;const n=this._startPos,r=i;if(n&&0===t.button){if(this.reset(),p(),n.x!==r.x||n.y!==r.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(n,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),h(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new e.Event(t,{originalEvent:i}))}}function pr(e,t){const i={};for(let n=0;n<e.length;n++)i[e[n].identifier]=t[n];return i}class mr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){const i=new e.Point(0,0);for(const e of t)i._add(e);return i.div(t.length)}(i),this.touches=pr(n,i)))}touchmove(e,t,i){if(this.aborted||!this.centroid)return;const n=pr(i,t);for(const r in this.touches){const e=n[r];(!e||e.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(e,t,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class fr{constructor(e){this.singleTap=new mr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,i){this.singleTap.touchstart(e,t,i)}touchmove(e,t,i){this.singleTap.touchmove(e,t,i)}touchend(e,t,i){const n=this.singleTap.touchend(e,t,i);if(n){const t=e.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(t&&i||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class gr{constructor(){this._zoomIn=new fr({numTouches:1,numTaps:2}),this._zoomOut=new fr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,i){this._zoomIn.touchstart(e,t,i),this._zoomOut.touchstart(e,t,i)}touchmove(e,t,i){this._zoomIn.touchmove(e,t,i),this._zoomOut.touchmove(e,t,i)}touchend(e,t,i){const n=this._zoomIn.touchend(e,t,i),r=this._zoomOut.touchend(e,t,i);return n?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}):r?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(r)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _r={0:1,2:2};class vr{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const i=g(e);this._correctButton(e,i)&&(this._lastPoint=t,this._eventButton=i)}mousemoveWindow(e,t){const i=this._lastPoint;if(i)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const i=_r[t];return void 0===e.buttons||(e.buttons&i)!==i}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(i,t)}mouseupWindow(e){this._lastPoint&&g(e)===this._eventButton&&(this._moved&&p(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yr extends vr{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class br extends vr{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=.8*(t.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(e){e.preventDefault()}}class xr extends vr{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const i=-.5*(t.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(e){e.preventDefault()}}class wr{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)}touchstart(e,t,i){return this._calculateTransform(e,t,i)}touchmove(t,i,n){if(this._active&&!(n.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===n.length&&!e.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,i,n)}}touchend(e,t,i){this._calculateTransform(e,t,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,n){n.length>0&&(this._active=!0);const r=pr(n,i),s=new e.Point(0,0),o=new e.Point(0,0);let a=0;for(const e in r){const t=r[e],i=this._touches[e];i&&(s._add(t),o._add(t.sub(i)),a++,r[e]=t)}if(this._touches=r,a<this._minTouches||!o.mag())return;const l=o.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=s("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Er{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,i){return{}}touchstart(e,t,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,i){const n=this._firstTwoTouches;if(!n)return;e.preventDefault();const[r,s]=n,o=Ar(i,t,r),a=Ar(i,t,s);if(!o||!a)return;const l=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],l,e)}touchend(e,t,i){if(!this._firstTwoTouches)return;const[n,r]=this._firstTwoTouches,s=Ar(i,t,n),o=Ar(i,t,r);s&&o||(this._active&&p(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ar(e,t,i){for(let n=0;n<e.length;n++)if(e[n].identifier===i)return t[n]}function Tr(e,t){return Math.log(e/t)/Math.LN2}class Dr extends Er{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Tr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tr(this._distance,i),pinchAround:t}}}function Sr(e,t){return 180*e.angleWith(t)/Math.PI}class Cr extends Er{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const i=this._vector;if(this._vector=e[0].sub(e[1]),i&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Sr(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,i=this._startVector;if(!i)return!1;const n=Sr(e,i);return Math.abs(n)<t}}function Pr(e){return Math.abs(e.y)>Math.abs(e.x)}class Ir extends Er{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,Pr(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,i,n){const r=this._lastPoints;if(!r)return;const s=t[0].sub(r[0]),o=t[1].sub(r[1]);return this._map._cooperativeGestures&&!e.isFullscreen()&&n.touches.length<3||(this._valid=this.gestureBeginsVertically(s,o,n.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(s.y+o.y)/2*-.5})}gestureBeginsVertically(e,t,i){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,r=t.mag()>=2;if(!n&&!r)return;if(!n||!r)return null==this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const s=e.y>0==t.y>0;return Pr(e)&&Pr(t)&&s}}const kr={panStep:100,bearingStep:15,pitchStep:10};class Mr{constructor(){const e=kr;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,i=0,n=0,r=0,s=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),s=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),s=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:o=>{const a=o.getZoom();o.easeTo({duration:300,easeId:"keyboardHandler",easing:Rr,zoom:t?Math.round(a)+t*(e.shiftKey?2:1):a,bearing:o.getBearing()+i*this._bearingStep,pitch:o.getPitch()+n*this._pitchStep,offset:[-r*this._panStep,-s*this._panStep],center:o.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Rr(e){return e*(2-e)}const Fr=4.000244140625;class Lr{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let i=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=e.exported.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==i&&i%Fr==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=m(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Fr?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);const r=i(),s=Math.pow(2,r),o="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(o*n))),"wheel"===this._type&&(this._startZoom=r,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:i(),r=this._startZoom,s=this._easing;let o,a=!1;if("wheel"===this._type&&r&&s){const t=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),i=s(t);o=e.number(r,n,i),t<1?this._frameId||(this._frameId=!0):a=!0}else o=n,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-i(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=e.ease;if(this._prevEase){const t=this._prevEase,n=(e.exported.now()-t.start)/t.duration,r=t.easing(n+.01)-t.easing(n),s=.27/Math.sqrt(r*r+1e-4)*.01,o=Math.sqrt(.0729-s*s);i=e.bezier(s,o,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:i},i}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=s("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Or{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Br{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zr{constructor(){this._tap=new fr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=t[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,t,i))}touchmove(e,t,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const n=t[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,i)}touchend(e,t,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(e,t,i)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nr{constructor(e,t,i){this._el=e,this._mousePan=t,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ur{constructor(e,t,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jr{constructor(e,t,i,n){this._el=e,this._touchZoom=t,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vr=e=>e.zoom||e.drag||e.pitch||e.rotate;class Gr extends e.Event{}class Wr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,i){const n=e.sub([],i,t);this.radius=e.length(n[2]<0?e.div([],n,this.constants):[n[0],n[1],0])}projectRay(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);const i=e.scale$2([],t,this.radius);if(i[2]>0){const t=e.scale$2([],[0,0,1],e.dot(i,[0,0,1])),n=e.scale$2([],e.normalize([],[i[0],i[1],0]),this.radius),r=e.add([],i,e.scale$2([],e.sub([],e.add([],n,t),i),2));i[0]=r[0],i[1]=r[1]}return i}}function Hr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Xr{constructor(t,i){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rr(t),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Wr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),e.bindAll(["handleEvent","handleWindowEvent"],this);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[e.window,"blur",void 0]];for(const[r,s,o]of this._listeners)r.addEventListener(s,r===e.window.document?this.handleWindowEvent:this.handleEvent,o)}destroy(){for(const[t,i,n]of this._listeners)t.removeEventListener(i,t===e.window.document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,i=t.getCanvasContainer();this._add("mapEvent",new ur(t,e));const n=t.boxZoom=new dr(t,e);this._add("boxZoom",n);const r=new gr,s=new Br;t.doubleClickZoom=new Or(s,r),this._add("tapZoom",r),this._add("clickZoom",s);const o=new zr;this._add("tapDragZoom",o);const a=t.touchPitch=new Ir(t);this._add("touchPitch",a);const l=new br(e),c=new xr(e);t.dragRotate=new Ur(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new yr(e),h=new wr(t,e);t.dragPan=new Nr(i,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new Cr,p=new Dr;t.touchZoomRotate=new jr(i,p,d,o),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hr(t));const m=t.scrollZoom=new Lr(t,this);this._add("scrollZoom",m,["mousePan"]);const f=t.keyboard=new Mr;this._add("keyboard",f);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,i){this._handlers.push({handlerName:e,handler:t,allowed:i}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,i){for(const n in e)if(n!==i&&(!t||t.indexOf(n)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,"".concat(e.type,"Window"))}_getMapTouches(e){const t=[];for(const i of e)this._el.contains(i.target)&&t.push(i);return t}handleEvent(e,t){this._updatingCamera=!0;const i="renderFrame"===e.type,n=i?void 0:e,r={needsRenderFrame:!1},s={},o={},a=e.touches?this._getMapTouches(e.touches):void 0,l=a?f(this._el,a):i?void 0:m(this._el,e);for(const{handlerName:h,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let i;this._blockedByActive(o,p,h)?d.reset():d[t||e.type]&&(i=d[t||e.type](e,l,a),this.mergeHandlerResult(r,s,i,h,n),i&&i.needsRenderFrame&&this._triggerRenderFrame()),(i||d.isActive())&&(o[h]=d)}const c={};for(const h in this._previousActiveHandlers)o[h]||(c[h]=n);this._previousActiveHandlers=o,(Object.keys(c).length||Hr(r))&&(this._changes.push([r,s,c]),this._triggerRenderFrame()),(Object.keys(o).length||Hr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=r;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(t,i,n,r,s){if(!n)return;e.extend(t,n);const o={handlerName:r,originalEvent:n.originalEvent||s};void 0!==n.zoomDelta&&(i.zoom=o),void 0!==n.panDelta&&(i.drag=o),void 0!==n.pitchDelta&&(i.pitch=o),void 0!==n.bearingDelta&&(i.rotate=o)}_applyChanges(){const t={},i={},n={};for(const[r,s,o]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.aroundCoord&&(t.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.extend(i,s),e.extend(n,o);this._updateMapTransform(t,i,n),this._changes=[]}_updateMapTransform(t,i,n){const r=this._map,s=r.transform,o=e=>[e.x,e.y,e.z];if((()=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Hr(t)){const e=s.zoom;s.cameraElevationReference="sea",s.recenterOnTerrain(),s.cameraElevationReference="ground",e!==s.zoom&&this._map._update(!0)}if(s._isCameraConstrained&&r._stop(!0),!Hr(t))return void this._fireEvents(i,n,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=t;s._isCameraConstrained&&(l>0&&(l=0),s._isCameraConstrained=!1),void 0!==p&&(h=p),(l||(e=>i[e]&&!this._eventsInProgress[e])("drag"))&&h&&(this._dragOrigin=o(s.pointCoordinate3D(h)),this._trackingEllipsoid.setup(s._camera.position,this._dragOrigin)),s.cameraElevationReference="sea",r._stop(!0),h=h||r.transform.centerPoint,c&&(s.bearing+=c),u&&(s.pitch+=u),s._updateCameraState();const m=[0,0,0];if(a)if("mercator"===s.projection.name){const e=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(h).dir),t=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(h.sub(a)).dir);m[0]=t[0]-e[0],m[1]=t[1]-e[1]}else{const t=s.pointCoordinate(h);if("globe"===s.projection.name){a=a.rotate(-s.angle);const i=s._pixelsPerMercatorPixel/s.worldSize;m[0]=-a.x*e.mercatorScale(e.latFromMercatorY(t.y))*i,m[1]=-a.y*e.mercatorScale(s.center.lat)*i}else{const e=s.pointCoordinate(h.sub(a));t&&e&&(m[0]=e.x-t.x,m[1]=e.y-t.y)}}const f=s.zoom,g=[0,0,0];if(l){const t=o(d||s.pointCoordinate3D(h)),i={dir:e.normalize([],e.sub([],t,s._camera.position))};if(i.dir[2]<0){const n=s.zoomDeltaToMovement(t,l);e.scale$2(g,i.dir,n)}}const _=e.add(m,m,g);s._translateCameraConstrained(_),l&&Math.abs(s.zoom-f)>1e-4&&s.recenterOnTerrain(),s.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(i,n,!0)}_fireEvents(t,i,n){const r=Vr(this._eventsInProgress),s=Vr(t),o={};for(const e in t){const{originalEvent:i}=t[e];this._eventsInProgress[e]||(o["".concat(e,"start")]=i),this._eventsInProgress[e]=t[e]}!r&&s&&this._fireEvent("movestart",s.originalEvent);for(const e in o)this._fireEvent(e,o[e]);s&&this._fireEvent("move",s.originalEvent);for(const e in t){const{originalEvent:i}=t[e];this._fireEvent(e,i)}const a={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=i[t]||n,a["".concat(e,"end")]=l)}for(const e in a)this._fireEvent(e,a[e]);const c=Vr(this._eventsInProgress);if(n&&(r||s)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(i(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new e.Event("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new e.Event(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{this._frameId=void 0,this.handleEvent(new Gr("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const qr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zr extends e.Evented{constructor(t,i){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=i.bearingSnap,this._respectPrefersReducedMotion=!1!==i.respectPrefersReducedMotion,e.bindAll(["_renderFrameCallback"],this)}getCenter(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,i,n){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},i),n)}panTo(t,i,n){return this.easeTo(e.extend({center:t},i),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,i,n){return this.easeTo(e.extend({zoom:t},i),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,i,n){return this.easeTo(e.extend({bearing:t},i),n)}resetNorth(t,i){return this.rotateTo(0,e.extend({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,i){t=e.LngLatBounds.convert(t);const n=i&&i.bearing||0,r=i&&i.pitch||0,s=t.getNorthWest(),o=t.getSouthEast();return this._cameraForBounds(this.transform,s,o,n,r,i)}_extendCameraOptions(t){const i={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const e=t.padding;t.padding={top:e,bottom:e,right:e,left:e}}return t.padding=e.extend(i,t.padding),t}_minimumAABBFrustumDistance(e,t){const i=t.max[0]-t.min[0],n=t.max[1]-t.min[1];return i/n>e.aspect?i/(2*Math.tan(.5*e.fovX)*e.aspect):n/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,i,n,r,s,o){const a=t.clone(),l=this._extendCameraOptions(o);a.bearing=r,a.pitch=s;const c=e.LngLat.convert(i),u=e.LngLat.convert(n),h=.5*(c.lat+u.lat),d=.5*(c.lng+u.lng),p=e.latLngToECEF(h,d),m=e.normalize([],p),f=e.normalize([],e.cross([],m,[0,1,0])),g=e.cross([],f,m),_=[f[0],f[1],f[2],0,g[0],g[1],g[2],0,m[0],m[1],m[2],0,0,0,0,1],v=[p,e.latLngToECEF(c.lat,c.lng),e.latLngToECEF(u.lat,c.lng),e.latLngToECEF(u.lat,u.lng),e.latLngToECEF(c.lat,u.lng),e.latLngToECEF(h,c.lng),e.latLngToECEF(h,u.lng),e.latLngToECEF(c.lat,d),e.latLngToECEF(u.lat,d)];let y=e.Aabb.fromPoints(v.map(t=>[e.dot(f,t),e.dot(g,t),e.dot(m,t)]));const b=e.transformMat4([],y.center,_);0===e.squaredLength(b)&&e.set(b,0,0,1),e.normalize(b,b),e.scale$2(b,b,e.GLOBE_RADIUS),a.center=e.ecefToLatLng(b);const x=a.getWorldToCameraMatrix(),w=e.invert(new Float64Array(16),x);y=e.Aabb.applyTransform(y,e.multiply([],x,_)),e.transformMat4(b,b,x);const E=.5*(y.max[2]-y.min[2]),A=this._minimumAABBFrustumDistance(a,y),T=e.scale$2([],[0,0,1],E),D=e.add(T,b,T),S=A+(0===a.pitch?0:e.distance(b,D)),C=a.globeCenterInViewSpace,P=e.sub([],b,[C[0],C[1],C[2]]);e.normalize(P,P),e.scale$2(P,P,S);const I=e.add([],b,P);e.transformMat4(I,I,w);const k=e.earthRadius/e.GLOBE_RADIUS,M=e.length(I),R=e.mercatorZfromAltitude(Math.max(M*k-e.earthRadius,Number.EPSILON),0),F=Math.min(a.zoomFromMercatorZAdjusted(R),l.maxZoom);return F>.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"mercator"}),a.zoom=F,this._cameraForBounds(a,i,n,r,s,o)):{center:a.center,zoom:F,bearing:r,pitch:s}}queryTerrainElevation(t,i){const n=this.transform.elevation;return n?(i=e.extend({},{exaggerated:!0},i),n.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,i.exaggerated)):null}_cameraForBounds(t,i,n,r,s,o){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,i,n,r,s,o);const a=t.clone(),l=this._extendCameraOptions(o),c=a.padding;a.bearing=r,a.pitch=s;const u=e.LngLat.convert(i),h=e.LngLat.convert(n),d=new e.LngLat(u.lng,h.lat),p=new e.LngLat(h.lng,u.lat),m=a.project(u),f=a.project(h),g=this.queryTerrainElevation(u),_=this.queryTerrainElevation(h),v=this.queryTerrainElevation(d),y=this.queryTerrainElevation(p),b=[[m.x,m.y,Math.min(g||0,_||0,v||0,y||0)],[f.x,f.y,Math.max(g||0,_||0,v||0,y||0)]];let x=e.Aabb.fromPoints(b);const w=a.getWorldToCameraMatrix(),E=e.invert(new Float64Array(16),w);x=e.Aabb.applyTransform(x,w);const A=e.sub([],x.max,x.min),T=c.left||0,D=c.right||0,S=c.bottom||0,C=c.top||0,{left:P,right:I,top:k,bottom:M}=l.padding,R=.5*(T+D),F=.5*(C+S),L=Math.min(a.scaleZoom(a.scale*Math.min((a.width-(T+D+P+I))/A[0],(a.height-(S+C+M+k))/A[1])),l.maxZoom),O=a.scale/a.zoomScale(L);x=new e.Aabb([x.min[0]-(P+R)*O,x.min[1]-(M+F)*O,x.min[2]],[x.max[0]+(I+R)*O,x.max[1]+(k+F)*O,x.max[2]]);const B=.5*A[2],z=this._minimumAABBFrustumDistance(a,x),N=[0,0,1,0];e.transformMat4$1(N,N,w),e.normalize$2(N,N);const U=e.scale$2([],N,z+B),j=e.add([],x.center,U),V=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new e.Point(l.offset.x,l.offset.y):e.Point.convert(l.offset)).rotate(-e.degToRad(r));x.center[0]-=V.x*O,x.center[1]+=V.y*O,e.transformMat4(x.center,x.center,E),e.transformMat4(j,j,E);const G=[x.center[0],x.center[1],j[2]*a.pixelsPerMeter];e.scale$2(G,G,1/a.worldSize);const W=e.lngFromMercatorX(G[0]),H=e.latFromMercatorY(G[1]),X=Math.min(a._zoomFromMercatorZ(G[2]),l.maxZoom),q=new e.LngLat(W,H);return a.mercatorFromTransition&&X<.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"globe"}),a.zoom=X,this._cameraForBounds(a,i,n,r,s,o)):{center:q,zoom:X,bearing:r,pitch:s}}fitBounds(e,t,i){const n=this.cameraForBounds(e,t);return this._fitInternal(n,t,i)}fitScreenCoordinates(t,i,n,r,s){const o=e.Point.convert(t),a=e.Point.convert(i),l=new e.Point(Math.min(o.x,a.x),Math.min(o.y,a.y)),c=new e.Point(Math.max(o.x,a.x),Math.max(o.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(o,a))return this;const u=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new e.Point(l.x,c.y)),p=this.transform.pointLocation3D(new e.Point(c.x,l.y)),m=[Math.min(u.lng,h.lng,d.lng,p.lng),Math.min(u.lat,h.lat,d.lat,p.lat)],f=[Math.max(u.lng,h.lng,d.lng,p.lng),Math.max(u.lat,h.lat,d.lat,p.lat)],g=r&&r.pitch?r.pitch:this.getPitch(),_=this._cameraForBounds(this.transform,m,f,n,g,r);return this._fitInternal(_,r,s)}_fitInternal(t,i,n){return t?(delete(i=e.extend(t,i)).padding,i.linear?this.easeTo(i,n):this.flyTo(i,n)):this}jumpTo(t,i){this.stop();const n=t.preloadOnly?this.transform.clone():this.transform;let r=!1,s=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(r=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(s=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),t.preloadOnly?(this._preloadTiles(n),this):(this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),r&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),s&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),o&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.warnOnce(qr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,i){const n=this.transform;if(!n.projection.supportsFreeCamera)return e.warnOnce(qr),this;this.stop();const r=n.zoom,s=n.pitch,o=n.bearing;n.setFreeCameraOptions(t);const a=r!==n.zoom,l=s!==n.pitch,c=o!==n.bearing;return this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i)),a&&this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i)),c&&this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i)),l&&this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i)),this.fire(new e.Event("moveend",i)),this}easeTo(t,i){this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const n=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?+t.zoom:r,c="bearing"in t?this._normalizeBearing(t.bearing,s):s,u="pitch"in t?+t.pitch:o,h="padding"in t?t.padding:n.padding,d=e.Point.convert(t.offset);let p,m,f;if("globe"===n.projection.name){const i=e.MercatorCoordinate.fromLngLat(n.center),r=d.rotate(-n.angle);i.x+=r.x/n.worldSize,i.y+=r.y/n.worldSize;const s=i.toLngLat(),o=e.LngLat.convert(t.center||s);this._normalizeCenter(o),p=n.centerPoint.add(r),m=new e.Point(i.x,i.y).mult(n.worldSize),f=new e.Point(e.mercatorXfromLng(o.lng),e.mercatorYfromLat(o.lat)).mult(n.worldSize).sub(m)}else{p=n.centerPoint.add(d);const i=n.pointLocation(p),r=e.LngLat.convert(t.center||i);this._normalizeCenter(r),m=n.project(i),f=n.project(r).sub(m)}const g=n.zoomScale(l-r);let _,v;t.around&&(_=e.LngLat.convert(t.around),v=n.locationPoint(_));const y=this._zooming||l!==r,b=this._rotating||s!==c,x=this._pitching||u!==o,w=!n.isPaddingEqual(h),E=n=>E=>{if(y&&(n.zoom=e.number(r,l,E)),b&&(n.bearing=e.number(s,c,E)),x&&(n.pitch=e.number(o,u,E)),w&&(n.interpolatePadding(a,h,E),p=n.centerPoint.add(d)),_)n.setLocationAtPoint(_,v);else{const e=n.zoomScale(n.zoom-r),t=l>r?Math.min(2,g):Math.max(.5,g),i=Math.pow(t,1-E),s=n.unproject(m.add(f.mult(E*i)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?s.wrap():s,p)}return t.preloadOnly||this._fireMoveEvents(i),n};if(t.preloadOnly){const e=this._emulate(E,t.duration,n);return this._preloadTiles(e),this}const A={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=y,this._rotating=b,this._pitching=x,this._padding=w,this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,A),this._ease(E(n),e=>{n.recenterOnTerrain(),this._afterEase(i,e)},t),this}_prepareEase(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",i||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const n=this._zooming,r=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),s&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}flyTo(t,i){if(this._prefersReducedMotion(t)){const n=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,i)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);const n=this.transform,r=this.getZoom(),s=this.getBearing(),o=this.getPitch(),a=this.getPadding(),l="zoom"in t?e.clamp(+t.zoom,n.minZoom,n.maxZoom):r,c="bearing"in t?this._normalizeBearing(t.bearing,s):s,u="pitch"in t?+t.pitch:o,h="padding"in t?t.padding:n.padding,d=n.zoomScale(l-r),p=e.Point.convert(t.offset);let m=n.centerPoint.add(p);const f=n.pointLocation(m),g=e.LngLat.convert(t.center||f);this._normalizeCenter(g);const _=n.project(f),v=n.project(g).sub(_);let y=t.curve;const b=Math.max(n.width,n.height),x=b/d,w=v.mag();if("minZoom"in t){const i=e.clamp(Math.min(t.minZoom,r,l),n.minZoom,n.maxZoom),s=b/n.zoomScale(i-r);y=Math.sqrt(s/w*2)}const E=y*y;function A(e){const t=(x*x-b*b+(e?-1:1)*E*E*w*w)/(2*(e?x:b)*E*w);return Math.log(Math.sqrt(t*t+1)-t)}function T(e){return(Math.exp(e)-Math.exp(-e))/2}function D(e){return(Math.exp(e)+Math.exp(-e))/2}const S=A(0);let C=function(e){return D(S)/D(S+y*e)},P=function(e){return b*((D(S)*(T(t=S+y*e)/D(t))-T(S))/E)/w;var t},I=(A(1)-S)/y;if(Math.abs(w)<1e-6||!isFinite(I)){if(Math.abs(b-x)<1e-6)return this.easeTo(t,i);const e=x<b?-1:1;I=Math.abs(Math.log(x/b))/y,P=function(){return 0},C=function(t){return Math.exp(e*y*t)}}t.duration="duration"in t?+t.duration:1e3*I/("screenSpeed"in t?+t.screenSpeed/y:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const k=s!==c,M=u!==o,R=!n.isPaddingEqual(h),F=n=>d=>{const f=d*I,y=1/C(f);n.zoom=1===d?l:r+n.scaleZoom(y),k&&(n.bearing=e.number(s,c,d)),M&&(n.pitch=e.number(o,u,d)),R&&(n.interpolatePadding(a,h,d),m=n.centerPoint.add(p));const b=1===d?g:n.unproject(_.add(v.mult(P(f))).mult(y));return n.setLocationAtPoint(n.renderWorldCopies?b.wrap():b,m),n._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(i),n};if(t.preloadOnly){const e=this._emulate(F,t.duration,n);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=k,this._pitching=M,this._padding=R,this._prepareEase(i,!1),this._ease(F(n),()=>this._afterEase(i),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,i,n){!1===n.animate||0===n.duration?(t(1),i()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,i){t=e.wrap(t,-180,180);const n=Math.abs(t-i);return Math.abs(t-360-i)<n&&(t-=360),Math.abs(t+360-i)<n&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.maxBounds)return;const i=e.lng-t.center.lng;e.lng+=i>180?-360:i<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&e.exported.prefersReducedMotion&&!(t&&t.essential)}_emulate(e,t,i){const n=Math.ceil(15*t/1e3),r=[],s=e(i.clone());for(let o=0;o<=n;o++){const e=s(o/n);r.push(e.clone())}return r}}class Yr{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact;return this._map=e,this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=s("button","mapboxgl-ctrl-attrib-button",this._container),s("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const i=this._map._getUIString("AttributionControl.".concat(t));e.setAttribute("aria-label",i),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){const n=i.reduce((e,t,n)=>(t.value&&(e+="".concat(t.key,"=").concat(t.value).concat(n<i.length-1?"&":"")),e),"?");t.href="".concat(e.config.FEEDBACK_URL,"/").concat(n,"#").concat($n(this._map,!0)),t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._sourceCaches;for(const n in t){const i=t[n];if(i.used){const t=i.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort((e,t)=>e.length-t.length),e=e.filter((t,i)=>{for(let n=i+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kr{constructor(){e.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=s("div","mapboxgl-ctrl");const t=s("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const i=e[t].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class Jr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,i=t?this._queue.concat(t):this._queue;for(const n of i)if(n.id===e)return void(n.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this._currentlyRunning=this._queue;this._queue=[];for(const i of t)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $r(t,i,n){if(t=new e.LngLat(t.lng,t.lat),i){const r=new e.LngLat(t.lng-360,t.lat),s=new e.LngLat(t.lng+360,t.lat),o=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),a=n.locationPoint(t).distSqr(i),l=i.x<0||i.y<0||i.x>n.width||i.y>n.height;n.locationPoint(r).distSqr(i)<a&&(l||Math.abs(r.lng-n.center.lng)<o)?t=r:n.locationPoint(s).distSqr(i)<a&&(l||Math.abs(s.lng-n.center.lng)<o)&&(t=s)}for(;Math.abs(t.lng-n.center.lng)>180;){const e=n.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=n.width&&e.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const Qr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class es extends e.Evented{constructor(t,i){if(super(),(t instanceof e.window.HTMLElement||i)&&(t=e.extend({element:t},i)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=s("div");const i=41,n=27,r=o("svg",{display:"block",height:i*this._scale+"px",width:n*this._scale+"px",viewBox:"0 0 ".concat(n," ").concat(i)},this._element),a=o("radialGradient",{id:"shadowGradient"},o("defs",{},r));o("stop",{offset:"10%","stop-opacity":.4},a),o("stop",{offset:"100%","stop-opacity":.05},a),o("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},r),o("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},r),o("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},r),o("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},r),this._offset=e.Point.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",e=>{e.preventDefault()}),this._element.addEventListener("mousedown",e=>{e.preventDefault()});const n=this._element.classList;for(const e in Qr)n.remove("mapboxgl-marker-anchor-".concat(e));n.add("mapboxgl-marker-anchor-".concat(this._anchor)),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,i=13.5,n=Math.sqrt(Math.pow(i,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-i+n)],"bottom-right":[-n,-1*(t-i+n)],left:[i,-1*(t-i)],right:[-i,-1*(t-i)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,i=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==i&&13!==i||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,i=this._element;this._popup&&(t===i||i.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const i=e.unproject(t),n=e.getFreeCameraOptions();if(!n.position)return!1;const r=n.position.toLngLat();return r.distanceTo(i)<.9*r.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const i=this._pos;if(!i||i.x<0||i.x>t.transform.width||i.y<0||i.y>t.transform.height)return void this._clearFadeTimer();const n=t.unproject(i);let r;t._showingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?r=0:(r=1-t._queryFogOpacity(n),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(r*=this._occludedOpacity)),this._element.style.opacity="".concat(r),this._element.style.pointerEvents=r>0?"auto":"none",this._popup&&this._popup._setOpacity(r),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(e.x,"px,").concat(e.y,"px)\n            ").concat(Qr[this._anchor],"\n            ").concat(this._calculateXYTransform()," ").concat(this._calculateZTransform(),"\n            translate(").concat(t.x,"px,").concat(t.y,"px)\n        ")}_calculateXYTransform(){const t=this._pos,i=this._map,n=this.getPitchAlignment();if(!i||!t||"map"!==n)return"";if(!i._showingGlobe()){const e=i.getPitch();return e?"rotateX(".concat(e,"deg)"):""}const r=e.radToDeg(e.globeTiltAtLngLat(i.transform,this._lngLat)),s=t.sub(e.globeCenterToScreenPoint(i.transform)),o=Math.abs(s.x)+Math.abs(s.y);if(0===o)return"";const a=r/o;return"rotateX(".concat(-s.y*a,"deg) rotateY(").concat(s.x*a,"deg)")}_calculateZTransform(){const t=this._pos,i=this._map;if(!i||!t)return"";let n=0;const r=this.getRotationAlignment();if("map"===r)if(i._showingGlobe()){const t=i.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),r=i.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);n=e.radToDeg(Math.atan2(r.y,r.x))-90}else n=-i.getBearing();else if("horizon"===r){const r=e.smoothstep(4,6,i.getZoom()),s=e.globeCenterToScreenPoint(i.transform);s.y+=r*i.transform.height;const o=t.sub(s),a=e.radToDeg(Math.atan2(o.y,o.x));n=(a>90?a-270:a+90)*(1-r)}return n+=this._rotation,n?"rotateZ(".concat(n,"deg)"):""}_update(t){e.window.cancelAnimationFrame(this._updateFrameId);const i=this._map;i&&(i.transform.renderWorldCopies&&(this._lngLat=$r(this._lngLat,this._pos,i.transform)),this._pos=i.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),i._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(i._showingGlobe()||i.getTerrain()||i.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=e.Point.convert(t),this._update(),this}_onMove(t){const i=this._map;if(!i)return;const n=this._pointerdownPos,r=this._positionDelta;if(n&&r){if(!this._isDragging){const e=this._clickTolerance||i._clickTolerance;if(t.point.dist(n)<e)return;this._isDragging=!0}this._pos=t.point.sub(r),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,i=this._pos;t&&i&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(i),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ts={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},is=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.Point(0,0),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof t){const n=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(i){case"top":return new e.Point(0,t);case"top-left":return new e.Point(n,n);case"top-right":return new e.Point(-n,n);case"bottom":return new e.Point(0,-t);case"bottom-left":return new e.Point(n,-n);case"bottom-right":return new e.Point(-n,-n);case"left":return new e.Point(t,0);case"right":return new e.Point(-t,0)}return new e.Point(0,0)}return t instanceof e.Point||Array.isArray(t)?e.Point.convert(t):e.Point.convert(t[i]||[0,0])}class rs{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const i=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,i){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+i}}const ss={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},os={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},as={showCompass:!0,showZoom:!0,visualizePitch:!1};class ls{constructor(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._clickTolerance=10,this.element=i,this.mouseRotate=new br({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,n&&(this.mousePitch=new xr({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),u()}move(e,t){const i=this.map,n=this.mouseRotate.mousemoveWindow(e,t),r=n&&n.bearingDelta;if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){const n=this.mousePitch.mousemoveWindow(e,t),r=n&&n.pitchDelta;r&&i.setPitch(i.getPitch()+r)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){h(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),m(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,m(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=f(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=f(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const cs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},us={maxWidth:100,unit:"metric"},hs={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ds={version:e.version,supported:i,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:class extends Zr{constructor(t){if(e.LivePerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},os,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Yn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new Jr,this._domRenderTaskQueue=new Jr,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ss,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new rs(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error("Container '".concat(t.container,"' not found."))}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1),e.window.addEventListener("orientationchange",this._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xr(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),this._hash=t.hash&&new Jn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),t.attributionControl&&this.addControl(new Yr({customAttribution:t.customAttribution})),this._logoControl=new Kr,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new e.Event("".concat(t.dataType,"data"),t))}),this.on("dataloading",t=>{this.fire(new e.Event("".concat(t.dataType,"dataloading"),t))})}_getMapId(){return this._mapId}addControl(t,i){if(void 0===i&&(i=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[i];return-1!==i.indexOf("bottom")?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(t);return i>-1&&this._controls.splice(i,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),i&&this.fire(new e.Event("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?e.window.navigator.language:Array.isArray(t)?0===t.length?void 0:t.map(t=>"auto"===t?e.window.navigator.language:t):t}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,i=t.projection.name;let n;"globe"===i&&t.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(t.setMercatorFromTransition(),n=!0):"mercator"===i&&t.zoom<e.GLOBE_ZOOM_THRESHOLD_MAX&&(t.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let i;if(i="globe"===t.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const e in this.style._sourceCaches)this.style._sourceCaches[e].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}unproject(t){return this.transform.pointLocation3D(e.Point.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,i){if("mouseenter"===e||"mouseover"===e){let n=!1;const r=r=>{const s=t.filter(e=>this.getLayer(e)),o=s.length?this.queryRenderedFeatures(r.point,{layers:s}):[];o.length?n||(n=!0,i.call(this,new ar(e,this,r.originalEvent,{features:o}))):n=!1},s=()=>{n=!1};return{layers:new Set(t),listener:i,delegates:{mousemove:r,mouseout:s}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const r=r=>{const s=t.filter(e=>this.getLayer(e));(s.length?this.queryRenderedFeatures(r.point,{layers:s}):[]).length?n=!0:n&&(n=!1,i.call(this,new ar(e,this,r.originalEvent)))},s=t=>{n&&(n=!1,i.call(this,new ar(e,this,t.originalEvent)))};return{layers:new Set(t),listener:i,delegates:{mousemove:r,mouseout:s}}}{const n=e=>{const n=t.filter(e=>this.getLayer(e)),r=n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];r.length&&(e.features=r,i.call(this,e),delete e.features)};return{layers:new Set(t),listener:i,delegates:{[e]:n}}}}on(e,t,i){if(void 0===i)return super.on(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const r in n.delegates)this.on(r,n.delegates[r]);return this}once(e,t,i){if(void 0===i)return super.once(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,i);for(const r in n.delegates)this.once(r,n.delegates[r]);return this}off(e,t,i){if(void 0===i)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);const n=(e,t)=>{if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0},r=this._delegatedListeners?this._delegatedListeners[e]:void 0;return r&&(e=>{for(let r=0;r<e.length;r++){const s=e[r];if(s.listener===i&&n(s.layers,t)){for(const e in s.delegates)this.off(e,s.delegates[e]);return e.splice(r,1),this}}})(r),this}queryRenderedFeatures(t,i){return this.style?(void 0!==i||void 0===t||t instanceof e.Point||Array.isArray(t)||(i=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}isPointOnSurface(t){const{name:i}=this.transform.projection;return"globe"!==i&&"mercator"!==i&&e.warnOnce("".concat(i," projection does not support isPointOnSurface, this API may behave unexpectedly.")),this.transform.isPointOnSurface(e.Point.convert(t))}setStyle(t,i){return!1!==(i=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(t,i))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new Jt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,i){if("string"==typeof t){const n=this._requestManager.normalizeStyleURL(t),r=this._requestManager.transformRequest(n,e.ResourceType.Style);e.getJSON(r,(t,n)=>{t?this.fire(new e.ErrorEvent(t)):n&&this._updateDiff(n,i)})}else"object"==typeof t&&this._updateDiff(t,i)}_updateDiff(t,i){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce("Unable to perform style diff: ".concat(n.message||n.error||n,".  Rebuilding the style from scratch.")),this._updateStyle(t,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const i=e[t]._tiles;for(const e in i){const t=i[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,i){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,i)}removeSource(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,i){let{pixelRatio:n=1,sdf:r=!1,stretchX:s,stretchY:o,content:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._lazyInitEmptyStyle(),i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap){const{width:l,height:c,data:u}=e.exported.getImageData(i);this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},u),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=i,u=i;this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},new Uint8Array(u.data)),pixelRatio:n,stretchX:s,stretchY:o,content:a,sdf:r,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}}updateImage(t,i){const n=this.style.getImage(t);if(!n)return void this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap?e.exported.getImageData(i):i,{width:s,height:o}=r;void 0!==s&&void 0!==o?s===n.data.width&&o===n.data.height?(n.data.replace(r.data,!(i instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&i instanceof e.window.ImageBitmap)),this.style.updateImage(t,n)):this.fire(new e.ErrorEvent(new Error("The width and height of the updated image (".concat(s,", ").concat(o,")\n                must be that same as the previous version of the image\n                (").concat(n.data.width,", ").concat(n.data.height,")")))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,i){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),(t,n)=>{i(t,n instanceof e.window.HTMLImageElement?e.exported.getImageData(n):n)})}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}setLayerZoomRange(e,t,i){return this.style.setLayerZoomRange(e,t,i),this._update(!0)}setFilter(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,i),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,i,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,i,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setLight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let n,r,s,o=this._container;for(;o&&(!r||!s);){const t=e.window.getComputedStyle(o).transform;t&&"none"!==t&&(n=t.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&"0"!==n[0]&&"1"!==n[0]&&(r=n[0]),n[3]&&"0"!==n[3]&&"1"!==n[3]&&(s=n[3])),o=o.parentElement}this._containerWidth=r?Math.abs(t/r):t,this._containerHeight=s?Math.abs(i/s):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=s("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=s("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=s("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const i=this._controlContainer=s("div","mapboxgl-control-container",e),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(e=>{n[e]=s("div","mapboxgl-ctrl-".concat(e),i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,i){const n=e.exported.devicePixelRatio||1;this._canvas.width=n*Math.ceil(t),this._canvas.height=n*Math.ceil(i),this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(i,"px")}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.extend({},i.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",t),r=n||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);r?(this._useWebGL2&&!n&&e.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),e.storeAuthState(r,!0),this.painter=new On(r,this.transform,!!n),this.on("data",e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)}),e.exported$1.testSupport(r)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let i;const n=this.painter.context.extTimerQuery,r=e.exported.now();if(this.listens("gpu-timing-frame")&&(i=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],e.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],e.window.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,i=this.transform.pitch,n=e.exported.now(),r=new e.EvaluationParameters(t,{now:n,fadeDuration:s,pitch:i,transition:this.style.getTransition()});this.style.update(r)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let o=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),o=this._updateAverageElevation(r),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):o=this._updateAverageElevation(r),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const t=e.exported.now()-r;n.endQueryEXT(n.TIME_ELAPSED_EXT,i),setTimeout(()=>{const s=n.getQueryObjectEXT(i,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(i),this.fire(new e.Event("gpu-timing-frame",{cpuTime:t,gpuTime:s})),e.window.performance.mark("frame-gpu",{startTime:r,detail:{gpuTime:s}})},50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout(()=>{const i=this.painter.queryGpuTimers(t);this.fire(new e.Event("gpu-timing-layer",{layerTimes:i}))},50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const i=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:i}))},50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(a||this._repaint)this.triggerRepaint();else{const t=!this.isMoving()&&this.loaded();if(t&&(o=this._updateAverageElevation(r,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&e.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);if((t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let n=this.transform.sampleAverageElevation(),r=!1;this.transform.elevation&&(r=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(n)?n=0:this._averageElevationLastSampledAt=e;const s=Math.abs(t-n);if(s>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(n),i(n);this._averageElevation.easeTo(n,e,300)}else if(s>1e-4)return this._averageElevation.jumpTo(n),i(n)}return!!this._averageElevation.isEasing(e)&&i(this._averageElevation.getValue(e))}_authenticate(){e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,t=>{if(t&&(t.message===e.AUTH_ERR_MSG||401===t.status)){const t=this.painter.context.gl;e.storeAuthState(t,!1),this._logoControl instanceof Kr&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const i=this.painter.context.gl,n=i.createFramebuffer();function r(e){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0);const t=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,t),t}return i.bindFramebuffer(i.FRAMEBUFFER,n),this._canvasPixelComparison(r(e),t.canvasCopies.map(r),t.timeStamps)}_canvasPixelComparison(e,t,i){let n=i[1]-i[0];const r=e.length/4;for(let s=0;s<t.length;s++){const o=t[s];let a=0;for(let t=0;t<o.length;t+=4)o[t]===e[t]&&o[t+1]===e[t+1]&&o[t+2]===e[t+2]&&o[t+3]===e[t+3]&&(a+=1);n+=(i[s+2]-i[s+1])*(1-a/r)}return n}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1),e.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame(e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)}))}_preloadTiles(t){const i=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(i,(e,i)=>e._preloadTiles(t,i),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===e.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(t,i){e.setCacheLimits(t,i)}get version(){return e.version}},NavigationControl:class{constructor(t){this.options=e.extend({},as,t),this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",e=>{this._map&&this._map.zoomIn({},{originalEvent:e})}),s("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",e=>{this._map&&this._map.zoomOut({},{originalEvent:e})}),s("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))}),this._compassIcon=s("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),i=t===e.getMaxZoom(),n=t===e.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(e.transform.pitch,"deg) rotateZ(").concat(e.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(e.transform.angle*(180/Math.PI),"deg)");e._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ls(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const i=s("button",e,this._container);return i.type="button",i.addEventListener("click",t),i}_setButtonTitle(e,t){if(!this._map)return;const i=this._map._getUIString("NavigationControl.".concat(t));e.setAttribute("aria-label",i),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}},GeolocateControl:class extends e.Evented{constructor(t){super(),this.options=e.extend({geolocation:e.window.navigator.geolocation},cs,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Kn(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){var i=this;const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!i.options.geolocation;i._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(e=>n("denied"!==e.state)).catch(()=>n()):n()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),i=e.coords;return!!t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}_updateCamera(t){const i=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=this._map.getBearing(),s=e.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(n),s,{geolocateSource:!0})}_updateMarker(t){if(t){const i=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,i=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,n=Math.ceil(2*this._accuracy*i);this._circleElement.style.width="".concat(n,"px"),this._circleElement.style.height="".concat(n,"px")}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=s("button","mapboxgl-ctrl-geolocate",this._container),s("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s("div","mapboxgl-user-location"),this._dotElement.appendChild(s("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(s("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new es({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=s("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new es({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.Event("trackuserlocationend")))})}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(e=>{"granted"===e&&t()}).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Yr,ScaleControl:class{constructor(t){this.options=e.extend({},us,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,i=t._containerHeight/2,n=t._containerWidth/2-e/2,r=t.unproject([n,i]),s=t.unproject([n+e,i]),o=r.distanceTo(s);if("imperial"===this.options.unit){const t=3.2808*o;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,o/1852,"nautical-mile"):o>=1e3?this._setScale(e,o/1e3,"kilometer"):this._setScale(e,o,"meter")}_setScale(e,t,i){this._map._requestDomTask(()=>{const n=function(e){const t=Math.pow(10,"".concat(Math.floor(e)).length-1);let i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(i),t*i}(t),r=n/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==i?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:i}).format(n):"".concat(n,"&nbsp;").concat(hs[i]),this._container.style.width=e*r+"px"})}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=s("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=s("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=s("button","mapboxgl-ctrl-fullscreen",this._controlContainer);s("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.Evented{constructor(t){super(),this.options=e.extend(Object.create(ts),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(e.window.document.createTextNode(t))}setHTML(t){const i=e.window.document.createDocumentFragment(),n=e.window.document.createElement("body");let r;for(n.innerHTML=t;r=n.firstChild,r;)i.appendChild(r);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=s("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=s("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.setAttribute("aria-hidden","true"),e.innerHTML="&#215;",e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,i=this._container,n=this._pos;if(!t||!i||!n)return"bottom";const r=i.offsetWidth,s=i.offsetHeight,o=n.x<r/2,a=n.x>t.transform.width-r/2;if(n.y+e<s)return o?"top-left":a?"top-right":"top";if(n.y>t.transform.height-s){if(o)return"bottom-left";if(a)return"bottom-right"}return o?"left":a?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push("mapboxgl-popup-anchor-".concat(this._anchor)),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const i=this._map,n=this._content;if(!i||!this._lngLat&&!this._trackPointer||!n)return;let r=this._container;if(r||(r=this._container=s("div","mapboxgl-popup",i.getContainer()),this._tip=s("div","mapboxgl-popup-tip",r),r.appendChild(n)),this.options.maxWidth&&r.style.maxWidth!==this.options.maxWidth&&(r.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$r(this._lngLat,this._pos,i.transform)),!this._trackPointer||t){const e=this._pos=this._trackPointer&&t?t:i.project(this._lngLat),n=ns(this.options.offset),r=this._anchor=this._getAnchor(n.y),s=ns(this.options.offset,r),o=e.add(s).round();i._requestDomTask(()=>{this._container&&r&&(this._container.style.transform="".concat(Qr[r]," translate(").concat(o.x,"px,").concat(o.y,"px)"))})}if(!this._marker&&i._showingGlobe()){const t=e.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(is);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity="".concat(e)),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:es,Style:Jt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:jn,Evented:e.Evented,config:e.config,prewarm:function(){Ne().acquire(Oe)},clearPrewarmedResources:function(){const e=ze;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Oe),ze=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Be.workerCount},set workerCount(e){Be.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return ds}),i}()},895:(e,t,i)=>{var n;!function(r,s,o,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=s.createElement("div"),h=Math.round,d=Math.abs,p=Date.now;function m(e,t,i){return setTimeout(x(e,i),t)}function f(e,t,i){return!!Array.isArray(e)&&(g(e,i[t],i),!0)}function g(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==a)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function _(e,t,i){var n="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=r.console&&(r.console.warn||r.console.log);return s&&s.call(r.console,n,i),e.apply(this,arguments)}}l="function"!==typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==a&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var v=_(function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&e[n[r]]===a)&&(e[n[r]]=t[n[r]]),r++;return e},"extend","Use `assign`."),y=_(function(e,t){return v(e,t,!0)},"merge","Use `assign`.");function b(e,t,i){var n,r=t.prototype;(n=e.prototype=Object.create(r)).constructor=e,n._super=r,i&&l(n,i)}function x(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function E(e,t){return e===a?t:e}function A(e,t,i){g(C(t),function(t){e.addEventListener(t,i,!1)})}function T(e,t,i){g(C(t),function(t){e.removeEventListener(t,i,!1)})}function D(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function S(e,t){return e.indexOf(t)>-1}function C(e){return e.trim().split(/\s+/g)}function P(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function I(e){return Array.prototype.slice.call(e,0)}function k(e,t,i){for(var n=[],r=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];P(r,o)<0&&n.push(e[s]),r[s]=o,s++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function M(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),s=0;s<c.length;){if((n=(i=c[s])?i+r:t)in e)return n;s++}return a}var R=1;function F(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var L="ontouchstart"in r,O=M(r,"PointerEvent")!==a,B=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z="touch",N="mouse",U=24,j=["x","y"],V=["clientX","clientY"];function G(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&i.handler(t)},this.init()}function W(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=1&t&&n-r===0,o=12&t&&n-r===0;i.isFirst=!!s,i.isFinal=!!o,s&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=H(t));r>1&&!i.firstMultiple?i.firstMultiple=H(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,l=o?o.center:s.center,c=t.center=X(n);t.timeStamp=p(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=K(l,c),t.distance=Y(l,c),function(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};1!==t.eventType&&4!==s.eventType||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y});t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}(i,t),t.offsetDirection=Z(t.deltaX,t.deltaY);var u=q(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,t.scale=o?(h=o.pointers,m=n,Y(m[0],m[1],V)/Y(h[0],h[1],V)):1,t.rotation=o?function(e,t){return K(t[1],t[0],V)+K(e[1],e[0],V)}(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,n,r,s,o=e.lastInterval||t,l=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(l>25||o.velocity===a)){var c=t.deltaX-o.deltaX,u=t.deltaY-o.deltaY,h=q(l,c,u);n=h.x,r=h.y,i=d(h.x)>d(h.y)?h.x:h.y,s=Z(c,u),e.lastInterval=t}else i=o.velocity,n=o.velocityX,r=o.velocityY,s=o.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=s}(i,t);var h,m;var f=e.element;D(t.srcEvent.target,f)&&(f=t.srcEvent.target);t.target=f}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function H(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:h(e.pointers[i].clientX),clientY:h(e.pointers[i].clientY)},i++;return{timeStamp:p(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var i=0,n=0,r=0;r<t;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:h(i/t),y:h(n/t)}}function q(e,t,i){return{x:t/e||0,y:i/e||0}}function Z(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Y(e,t,i){i||(i=j);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function K(e,t,i){i||(i=j);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}G.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(F(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},$="mousedown",Q="mousemove mouseup";function ee(){this.evEl=$,this.evWin=Q,this.pressed=!1,G.apply(this,arguments)}b(ee,G,{handler:function(e){var t=J[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:N,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ie={2:z,3:"pen",4:N,5:"kinect"},ne="pointerdown",re="pointermove pointerup pointercancel";function se(){this.evEl=ne,this.evWin=re,G.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(ne="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),b(se,G,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=te[n],s=ie[e.pointerType]||e.pointerType,o=s==z,a=P(t,e.pointerId,"pointerId");1&r&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):12&r&&(i=!0),a<0||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(a,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,G.apply(this,arguments)}function le(e,t){var i=I(e.touches),n=I(e.changedTouches);return 12&t&&(i=k(i.concat(n),"identifier",!0)),[i,n]}b(ae,G,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var i=le.call(this,e,t);12&t&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:e})}}});var ce={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function he(){this.evTarget=ue,this.targetIds={},G.apply(this,arguments)}function de(e,t){var i=I(e.touches),n=this.targetIds;if(3&t&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=I(e.changedTouches),a=[],l=this.target;if(s=i.filter(function(e){return D(e.target,l)}),1===t)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),12&t&&delete n[o[r].identifier],r++;return a.length?[k(s.concat(a),"identifier",!0),a]:void 0}b(he,G,{handler:function(e){var t=ce[e.type],i=de.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:e})}});function pe(){G.apply(this,arguments);var e=x(this.handler,this);this.touch=new he(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function me(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,fe.call(this,t)):12&e&&fe.call(this,t)}function fe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)},2500)}}function ge(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),o=Math.abs(i-r.y);if(s<=25&&o<=25)return!0}return!1}b(pe,G,{handler:function(e,t,i){var n=i.pointerType==z,r=i.pointerType==N;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)me.call(this,t,i);else if(r&&ge.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=M(u.style,"touchAction"),ve=_e!==a,ye="compute",be="auto",xe="manipulation",we="none",Ee="pan-x",Ae="pan-y",Te=function(){if(!ve)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){e[i]=!t||r.CSS.supports("touch-action",i)}),e}();function De(e,t){this.manager=e,this.set(t)}De.prototype={set:function(e){e==ye&&(e=this.compute()),ve&&this.manager.element.style&&Te[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(S(e,we))return we;var t=S(e,Ee),i=S(e,Ae);if(t&&i)return we;if(t||i)return t?Ee:Ae;if(S(e,xe))return xe;return be}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,r=S(n,we)&&!Te[we],s=S(n,Ae)&&!Te[Ae],o=S(n,Ee)&&!Te[Ee];if(r){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!o||!s)return r||s&&6&i||o&&i&U?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Se=32;function Ce(e){this.options=l({},this.defaults,e||{}),this.id=R++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Pe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ie(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ke(e,t){var i=t.manager;return i?i.get(e):e}function Me(){Ce.apply(this,arguments)}function Re(){Me.apply(this,arguments),this.pX=null,this.pY=null}function Fe(){Me.apply(this,arguments)}function Le(){Ce.apply(this,arguments),this._timer=null,this._input=null}function Oe(){Me.apply(this,arguments)}function Be(){Me.apply(this,arguments)}function ze(){Ce.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ne(e,t){return(t=t||{}).recognizers=E(t.recognizers,Ne.defaults.preset),new Ue(e,t)}Ce.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(f(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ke(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return f(e,"dropRecognizeWith",this)||(e=ke(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(f(e,"requireFailure",this))return this;var t=this.requireFail;return-1===P(t,e=ke(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(f(e,"dropRequireFailure",this))return this;e=ke(e,this);var t=P(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function n(i){t.manager.emit(i,e)}i<8&&n(t.options.event+Pe(i)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),i>=8&&n(t.options.event+Pe(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Se},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=Se);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Me,Ce,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=6&t,r=this.attrTest(e);return n&&(8&i||!r)?16|t:n||r?4&i?8|t:2&t?4|t:2:Se}}),b(Re,Me,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ae),e&U&&t.push(Ee),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(6&t.direction?(r=0===s?1:s<0?2:4,i=s!=this.pX,n=Math.abs(e.deltaX)):(r=0===o?1:o<0?8:16,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return Me.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ie(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(Fe,Me,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Le,Ce,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[be]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=m(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Se},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),b(Oe,Me,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(Be,Me,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Re.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return 30&i?t=e.overallVelocity:6&i?t=e.overallVelocityX:i&U&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ie(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(ze,Ce,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&r&&i){if(4!=e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Y(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Se},failTimeout:function(){return this._timer=m(function(){this.state=Se},this.options.interval,this),Se},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ne.VERSION="2.0.7",Ne.defaults={domEvents:!1,touchAction:ye,enable:!0,inputTarget:null,inputClass:null,preset:[[Oe,{enable:!1}],[Fe,{enable:!1},["rotate"]],[Be,{direction:6}],[Re,{direction:6},["swipe"]],[ze],[ze,{event:"doubletap",taps:2},["tap"]],[Le]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ue(e,t){var i;this.options=l({},Ne.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(O?se:B?he:L?pe:ee))(i,W),this.touchAction=new De(this,this.options.touchAction),je(this,!0),g(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function je(e,t){var i,n=e.element;n.style&&(g(e.options.cssProps,function(r,s){i=M(n.style,s),t?(e.oldCssProps[i]=n.style[i],n.style[i]=r):n.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={}))}Ue.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var n=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],2===t.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&14&i.state&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof Ce)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(f(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(f(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=P(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var i=this.handlers;return g(C(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==a){var i=this.handlers;return g(C(e),function(e){t?i[e]&&i[e].splice(P(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var i=s.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&je(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Ne,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Se,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:U,DIRECTION_ALL:30,Manager:Ue,Input:G,TouchAction:De,TouchInput:he,MouseInput:ee,PointerEventInput:se,TouchMouseInput:pe,SingleTouchInput:ae,Recognizer:Ce,AttrRecognizer:Me,Tap:ze,Pan:Re,Swipe:Be,Pinch:Fe,Rotate:Oe,Press:Le,on:A,off:T,each:g,merge:y,extend:v,assign:l,inherit:b,bindFn:x,prefixed:M}),("undefined"!==typeof r?r:"undefined"!==typeof self?self:{}).Hammer=Ne,(n=function(){return Ne}.call(t,i,t,e))===a||(e.exports=n)}(window,document)},927:(e,t,i)=>{"use strict";i.d(t,{X:()=>o});var n=i(379),r=i(467),s=i(804);class o extends s.F{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,o.defaultProps)}}(0,r.A)(o,"defaultProps",(0,n.A)((0,n.A)({},s.F.defaultProps),{},{format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}))},950:(e,t,i)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(730)}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.m=e,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var s=Object.create(null);i.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;("object"==typeof a||"function"==typeof a)&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>o[e]=()=>n[e]);return o.default=()=>n,i.d(s,o),s}})(),i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,n)=>(i.f[n](e,t),t),[])),i.u=e=>"static/js/"+e+".d44c9a46.chunk.js",i.miniCssF=e=>{},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="simulation_vis:";i.l=(n,r,s,o)=>{if(e[n])e[n].push(r);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+s),a.src=n),e[n]=[r];var d=(t,i)=>{a.onerror=a.onload=null,clearTimeout(p);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach(e=>e(i)),t)return t(i)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/final/",(()=>{var e={792:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise((i,n)=>r=e[t]=[i,n]);n.push(r[2]=s);var o=i.p+i.u(t),a=new Error;i.l(o,n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,s,[o,a,l]=n,c=0;if(o.some(t=>0!==e[t])){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(l)l(i)}for(t&&t(n);c<o.length;c++)s=o[c],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunksimulation_vis=self.webpackChunksimulation_vis||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=i(43),t=i.t(e,2),n=i(391),r=i(379),s=i(467);let o=1,a=1;class l{constructor(){(0,s.A)(this,"time",0),(0,s.A)(this,"channels",new Map),(0,s.A)(this,"animations",new Map),(0,s.A)(this,"playing",!1),(0,s.A)(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:n=1,repeat:r=1}=e,s=o++,a={time:0,delay:t,duration:i,rate:n,repeat:r};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const n of t)this._setChannelTime(n,this.time);const i=this.animations.values();for(const n of i){const{animation:e,channel:t}=n;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=a++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const c={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"===typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function u(e){let t=h(e);if("object"!==t)return(0,r.A)((0,r.A)({value:e},c[t]),{},{type:t});if("object"===typeof e)return e?void 0!==e.type?(0,r.A)((0,r.A)((0,r.A)({},e),c[e.type]),{},{type:e.type}):void 0===e.value?{type:"object",value:e}:(t=h(e.value),(0,r.A)((0,r.A)((0,r.A)({},e),c[t]),{},{type:t})):{type:"object",value:null};throw new Error("props")}function h(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const d={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},p=/void\s+main\s*\([^)]*\)\s*\{\n?/,m=/}\n?[^{}]*$/,f=[],g="__LUMA_INJECT_DECLARATIONS__";function _(e){const t={vertex:{},fragment:{}};for(const i in e){let n=e[i];"string"===typeof n&&(n={order:0,injection:n}),t[v(i)][i]=n}return t}function v(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="vertex"===t;for(const s in i){const t=i[s];t.sort((e,t)=>e.order-t.order),f.length=t.length;for(let e=0,i=t.length;e<i;++e)f[e]=t[e].injection;const n="".concat(f.join("\n"),"\n");switch(s){case"vs:#decl":r&&(e=e.replace(g,n));break;case"vs:#main-start":r&&(e=e.replace(p,e=>e+n));break;case"vs:#main-end":r&&(e=e.replace(m,e=>n+e));break;case"fs:#decl":r||(e=e.replace(g,n));break;case"fs:#main-start":r||(e=e.replace(p,e=>e+n));break;case"fs:#main-end":r||(e=e.replace(m,e=>n+e));break;default:e=e.replace(s,e=>e+n)}}return e=e.replace(g,""),n&&(e=e.replace(/\}\s*$/,e=>e+d[t])),e}function b(e){e.map(e=>x(e))}function x(e){if(e.instance)return;b(e.dependencies||[]);const{propTypes:t={},deprecations:i=[],inject:n={}}=e,s={normalizedInjections:_(n),parsedDeprecations:E(i)};t&&(s.propValidators=function(e){const t={};for(const[i,n]of Object.entries(e))t[i]=u(n);return t}(t)),e.instance=s;let o={};t&&(o=Object.entries(t).reduce((e,t)=>{let[i,n]=t;const r=null===n||void 0===n?void 0:n.value;return r&&(e[i]=r),e},{})),e.defaultUniforms=(0,r.A)((0,r.A)({},e.defaultUniforms),o)}function w(e,t,i){var n;null===(n=e.deprecations)||void 0===n||n.forEach(e=>{var n;null!==(n=e.regex)&&void 0!==n&&n.test(t)&&(e.deprecated?i.deprecated(e.old,e.new)():i.removed(e.old,e.new)())})}function E(e){return e.forEach(e=>{if("function"===e.type)e.regex=new RegExp("\\b".concat(e.old,"\\("));else e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}),e}function A(e){b(e);const t={},i={};T({modules:e,level:0,moduleMap:t,moduleDepth:i});const n=Object.keys(i).sort((e,t)=>i[t]-i[e]).map(e=>t[e]);return b(n),n}function T(e){const{modules:t,level:i,moduleMap:n,moduleDepth:r}=e;if(i>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)n[s.name]=s,(void 0===r[s.name]||r[s.name]<i)&&(r[s.name]=i);for(const s of t)s.dependencies&&T({modules:s.dependencies,level:i+1,moduleMap:n,moduleDepth:r})}const D=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],S=[...D,[I("attribute"),"in $1"],[I("varying"),"out $1"]],C=[...D,[I("varying"),"in $1"]];function P(e,t){for(const[i,n]of t)e=e.replace(i,n);return e}function I(e){return new RegExp("\\b".concat(e,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}function k(e,t){let i="";for(const n in e){const r=e[n];if(i+="void ".concat(r.signature," {\n"),r.header&&(i+="  ".concat(r.header)),t[n]){const e=t[n];e.sort((e,t)=>e.order-t.order);for(const t of e)i+="  ".concat(t.injection,"\n")}r.footer&&(i+="  ".concat(r.footer)),i+="}\n"}return i}function M(e){const t={vertex:{},fragment:{}};for(const i of e){let e,n;"string"!==typeof i?(e=i,n=e.hook):(e={},n=i),n=n.trim();const[r,s]=n.split(":"),o=n.replace(/\(.+/,""),a=Object.assign(e,{signature:s});switch(r){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(r)}}return t}function R(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return i?i[1]:t}function L(e){let t=100;const i=e.match(/[^\s]+/g);if(i&&i.length>=2&&"#version"===i[0]){const e=parseInt(i[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error("Invalid GLSL version ".concat(t));return t}const O="\n\n".concat(g,"\n");function B(e,t){const{source:i,stage:n,modules:r,hookFunctions:s=[],inject:o={},log:a}=t;R("string"===typeof i,"shader source must be a string");const l=i;let c="";const u=M(s),h={},d={},p={};for(const g in o){const e="string"===typeof o[g]?{injection:o[g],order:0}:o[g],t=/^(v|f)s:(#)?([\w-]+)$/.exec(g);if(t){const i=t[2],n=t[3];i?"decl"===n?d[g]=[e]:p[g]=[e]:h[g]=[e]}else p[g]=[e]}const m=r;for(const g of m){var f;a&&w(g,l,a);c+=U(g,"wgsl");const e=(null===(f=g.injections)||void 0===f?void 0:f[n])||{};for(const t in e){const i=/^(v|f)s:#([\w-]+)$/.exec(t);if(i){const n="decl"===i[2]?d:p;n[t]=n[t]||[],n[t].push(e[t])}else h[t]=h[t]||[],h[t].push(e[t])}}return c+=O,c=y(c,n,d),c+=k(u[n],h),c+=l,c=y(c,n,p),c}function z(e,t){const{source:i,stage:n,language:r="glsl",modules:s,defines:o={},hookFunctions:a=[],inject:l={},prologue:c=!0,log:u}=t;R("string"===typeof i,"shader source must be a string");const h="glsl"===r?function(e,t){return{name:F(e,t),language:"glsl",version:L(e)}}(i).version:-1,d=e.shaderLanguageVersion,p=100===h?"#version 100":"#version 300 es",m=i.split("\n").slice(1).join("\n"),f={};s.forEach(e=>{Object.assign(f,e.defines)}),Object.assign(f,o);let g="";switch(r){case"wgsl":break;case"glsl":g=c?"".concat(p,"\n\n// ----- PROLOGUE -------------------------\n","#define SHADER_TYPE_".concat(n.toUpperCase()),"\n\n").concat(function(e){switch(null===e||void 0===e?void 0:e.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e),"\n").concat("fragment"===n?"precision highp float;\n":"","\n\n// ----- APPLICATION DEFINES -------------------------\n\n").concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(const i in e){const n=e[i];(n||Number.isFinite(n))&&(t+="#define ".concat(i.toUpperCase()," ").concat(e[i],"\n"))}return t}(f),"\n\n"):"".concat(p,"\n")}const _=M(a),v={},b={},x={};for(const y in l){const e="string"===typeof l[y]?{injection:l[y],order:0}:l[y],t=/^(v|f)s:(#)?([\w-]+)$/.exec(y);if(t){const i=t[2],n=t[3];i?"decl"===n?b[y]=[e]:x[y]=[e]:v[y]=[e]}else x[y]=[e]}for(const y of s){var E;u&&w(y,m,u);g+=U(y,n);const e=(null===(E=y.instance)||void 0===E?void 0:E.normalizedInjections[n])||{};for(const t in e){const i=/^(v|f)s:#([\w-]+)$/.exec(t);if(i){const n="decl"===i[2]?b:x;n[t]=n[t]||[],n[t].push(e[t])}else v[t]=v[t]||[],v[t].push(e[t])}}return g+="// ----- MAIN SHADER SOURCE -------------------------",g+=O,g=y(g,n,b),g+=k(_[n],v),g+=m,g=y(g,n,x),"glsl"===r&&h!==d&&(g=function(e,t){var i;if(300!==Number((null===(i=e.match(/^#version[ \t]+(\d+)/m))||void 0===i?void 0:i[1])||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return P(e,S);case"fragment":return P(e,C);default:throw new Error(t)}}(g,n)),g.trim()}function N(e){return function(t){const i={};for(const r of e){var n;const e=null===(n=r.getUniforms)||void 0===n?void 0:n.call(r,t,i);Object.assign(i,e)}return i}}function U(e,t){let i;switch(t){case"vertex":i=e.vs||"";break;case"fragment":i=e.fs||"";break;case"wgsl":i=e.source||"";break;default:R(!1)}if(!e.name)throw new Error("Shader module must have a name");const n=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let r="// ----- MODULE ".concat(e.name," ---------------\n\n");return"wgsl"!==t&&(r+="#define MODULE_".concat(n,"\n")),r+="".concat(i,"\n"),r}const j=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,V=/^\s*\#\s*endif\s*$/;class G{constructor(){(0,s.A)(this,"_hookFunctions",[]),(0,s.A)(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return G.defaultShaderAssembler=G.defaultShaderAssembler||new G,G.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===("string"===typeof e?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),i=this._hookFunctions,{source:n,getUniforms:s}=function(e){const t=A(e.modules||[]);return{source:B(e.platformInfo,(0,r.A)((0,r.A)({},e),{},{source:e.source,stage:"vertex",modules:t})),getUniforms:N(t)}}((0,r.A)((0,r.A)({},e),{},{source:e.source,modules:t,hookFunctions:i})),o="wgsl"===e.platformInfo.shaderLanguage?function(e,t){const i=e.split("\n"),n=[];let r=!0,s=null;for(const a of i){const e=a.match(j),i=a.match(V);var o;e?(s=e[1],r=Boolean(null===t||void 0===t||null===(o=t.defines)||void 0===o?void 0:o[s])):i?r=!0:r&&n.push(a)}return n.join("\n")}(n):n;return{source:o,getUniforms:s,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),i=this._hookFunctions,n=function(e){const{vs:t,fs:i}=e,n=A(e.modules||[]);return{vs:z(e.platformInfo,(0,r.A)((0,r.A)({},e),{},{source:t,stage:"vertex",modules:n})),fs:z(e.platformInfo,(0,r.A)((0,r.A)({},e),{},{source:i,stage:"fragment",modules:n})),getUniforms:N(n)}}((0,r.A)((0,r.A)({},e),{},{vs:e.vs,fs:e.fs,modules:t,hookFunctions:i}));return(0,r.A)((0,r.A)({},n),{},{modules:t})}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),i={};let n=0;for(let r=0,s=this._defaultModules.length;r<s;++r){const e=this._defaultModules[r],s=e.name;t[n++]=e,i[s]=!0}for(let r=0,s=e.length;r<s;++r){const s=e[r],o=s.name;i[o]||(t[n++]=s,i[o]=!0)}return t.length=n,b(t),t}}(0,s.A)(G,"defaultShaderAssembler",void 0);const W="#define SMOOTH_EDGE_RADIUS 0.5",H={name:"geometry",source:"const SMOOTH_EDGE_RADIUS: f32 = 0.5;\n\nstruct VertexGeometry {\n  position: vec4<f32>,\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\nvar<private> geometry_: VertexGeometry = VertexGeometry(\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec2<f32>(0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0)\n);\n\nstruct FragmentGeometry {\n  uv: vec2<f32>,\n};\n\nvar<private> fragmentGeometry: FragmentGeometry;\n\nfn smoothedge(edge: f32, x: f32) -> f32 {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n",vs:"".concat(W,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"".concat(W,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},X=[H],q=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],Z=[];function Y(e){const t=G.getDefaultShaderAssembler();for(const n of X)t.addDefaultModule(n);t._hookFunctions.length=0;const i="glsl"===e?q:Z;for(const n of i)t.addShaderHook(n);return t}const K="uniform layerUniforms {\n  uniform float opacity;\n} layer;\n",J={name:"layer",vs:K,fs:K,getUniforms:e=>({opacity:Math.pow(e.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},$="Awaiting state",Q="Matched. State transferred from previous layer",ee="Initialized",te="Discarded. Awaiting garbage collection",ie="No longer matched. Awaiting garbage collection",ne="Finalized! Awaiting garbage collection",re=Symbol.for("component"),se=Symbol.for("propTypes"),oe=Symbol.for("deprecatedProps"),ae=Symbol.for("asyncPropDefaults"),le=Symbol.for("asyncPropOriginal"),ce=Symbol.for("asyncPropResolved");var ue=i(795);const he=new ue.t({id:"deck"});let de={};function pe(e){de=e}function me(e,t,i,n){he.level>0&&de[e]&&de[e].call(null,t,i,n)}function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?ge(e,t,[]):t(e)?[e]:[]}function ge(e,t,i){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?ge(r,t,i):t(r)&&i.push(r)}return i}function _e(e){let{target:t,source:i,start:n=0,count:r=1}=e;const s=i.length,o=r*s;let a=0;for(let l=n;a<s;a++)t[l++]=i[a];for(;a<o;)a<o-a?(t.copyWithin(n+a,n,n+a),a*=2):(t.copyWithin(n+a,n,n+o-a),a=o);return t}var ve=i(453);const ye=e=>"boolean"===typeof e,be=e=>"function"===typeof e,xe=e=>null!==e&&"object"===typeof e,we=e=>xe(e)&&e.constructor==={}.constructor,Ee=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,Ae=e=>"undefined"!==typeof Blob&&e instanceof Blob,Te=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||xe(e)&&be(e.tee)&&be(e.cancel)&&be(e.getReader))(e)||(e=>xe(e)&&be(e.read)&&be(e.pipe)&&ye(e.readable))(e);function De(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Se(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null===(t=e)||void 0===t?void 0:t.extensions)}function Ce(e){var t,i;let n;return De(e,"null loader"),De(Se(e),"invalid loader"),Array.isArray(e)&&(n=e[1],e=e[0],e=(0,r.A)((0,r.A)({},e),{},{options:(0,r.A)((0,r.A)({},e.options),n)})),(null!==(t=e)&&void 0!==t&&t.parseTextSync||null!==(i=e)&&void 0!==i&&i.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let Pe="";const Ie={};class ke extends Error{constructor(e,t){super(e),(0,s.A)(this,"reason",void 0),(0,s.A)(this,"url",void 0),(0,s.A)(this,"response",void 0),this.reason=t.reason,this.url=t.url,this.response=t.response}}const Me=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Re=/^([-\w.]+\/[-\w.+]+)/;function Fe(e,t){return e.toLowerCase()===t.toLowerCase()}function Le(e){const t=Me.exec(e);return t?t[1]:""}const Oe=/\?.*/;function Be(e){return e.replace(Oe,"")}function ze(e){if(Ee(e)){return e.url}if(Ae(e)){return e.name||""}return"string"===typeof e?e:""}function Ne(e){if(Ee(e)){const t=e,i=t.headers.get("content-type")||"",n=Be(t.url);return function(e){const t=Re.exec(e);return t?t[1]:e}(i)||Le(n)}if(Ae(e)){return e.type||""}return"string"===typeof e?Le(e):""}async function Ue(e){if(Ee(e))return e;const t={},i=function(e){if(Ee(e))return e.headers["content-length"]||-1;if(Ae(e))return e.size;return"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);i>=0&&(t["content-length"]=String(i));const n=ze(e),r=Ne(e);r&&(t["content-type"]=r);const s=await async function(e){const t=5;if("string"===typeof e)return"data:,".concat(e.slice(0,t));if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const i=new FileReader;i.onload=t=>{var i;return e(null===t||void 0===t||null===(i=t.target)||void 0===i?void 0:i.result)},i.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const i=function(e){let t="";const i=new Uint8Array(e);for(let n=0;n<i.byteLength;n++)t+=String.fromCharCode(i[n]);return btoa(t)}(e.slice(0,t));return"data:base64,".concat(i)}return null}(e);s&&(t["x-first-bytes"]=s),"string"===typeof e&&(e=(new TextEncoder).encode(e));const o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:n}),o}async function je(e){if(!e.ok){const t=await async function(e){const i=function(e){if(e.length<50)return e;const t=e.slice(e.length-15),i=e.substr(0,32);return"".concat(i,"...").concat(t)}(e.url);let n="Failed to fetch resource (".concat(e.status,") ").concat(e.statusText,": ").concat(i);n=n.length>100?"".concat(n.slice(0,100),"..."):n;const r={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");r.reason=!e.bodyUsed&&null!==t&&void 0!==t&&t.includes("application/json")?await e.json():await e.text()}catch(t){}return new ke(n,r)}(e);throw t}}async function Ve(e,t){if("string"===typeof e){const r=function(e){for(const t in Ie)if(e.startsWith(t)){const i=Ie[t];e=e.replace(t,i)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(Pe).concat(e)),e}(e);var i,n;if(function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(r))if(null!==(i=globalThis.loaders)&&void 0!==i&&i.fetchNode)return null===(n=globalThis.loaders)||void 0===n?void 0:n.fetchNode(r,t);return await fetch(r,t)}return await Ue(e)}const Ge=new ue.t({id:"loaders.gl"});class We{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof i.g&&i.g,"undefined"!==typeof document&&document;const He=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),Xe="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),qe=(Xe&&parseFloat(Xe[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,s.A)(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:He,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),Ze={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Ye(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function Ke(){const e=Ye();return e.globalOptions=e.globalOptions||(0,r.A)({},qe),e.globalOptions}function Je(e,t,i,n){return i=i||[],function(e,t){$e(e,null,qe,Ze,t);for(const i of t){const n=e&&e[i.id]||{},r=i.options&&i.options[i.id]||{},s=i.deprecatedOptions&&i.deprecatedOptions[i.id]||{};$e(n,i.id,r,s,t)}}(e,i=Array.isArray(i)?i:[i]),et(t,e,n)}function $e(e,t,i,n,r){const s=t||"Top level",o=t?"".concat(t,"."):"";for(const a in e){const l=!t&&xe(e[a]);if(!(a in i)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in n)Ge.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(n[a],"'"))();else if(!l){const e=Qe(a,r);Ge.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(e))()}}}function Qe(e,t){const i=e.toLowerCase();let n="";for(const r of t)for(const t in r.options){if(e===t)return"Did you mean '".concat(r.id,".").concat(t,"'?");const s=t.toLowerCase();(i.startsWith(s)||s.startsWith(i))&&(n=n||"Did you mean '".concat(r.id,".").concat(t,"'?"))}return n}function et(e,t,i){const n=e.options||{},s=(0,r.A)({},n);return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(s,i),null===s.log&&(s.log=new We),tt(s,Ke()),tt(s,t),s}function tt(e,t){for(const i in t)if(i in t){const n=t[i];we(n)&&we(e[i])?e[i]=(0,r.A)((0,r.A)({},e[i]),t[i]):e[i]=t[i]}}function it(e,t){const i=Ke(),n=e||i;return"function"===typeof n.fetch?n.fetch:xe(n.fetch)?e=>Ve(e,n.fetch):null!==t&&void 0!==t&&t.fetch?null===t||void 0===t?void 0:t.fetch:Ve}function nt(e,t){return rt(e||{},t)}function rt(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(i>3)return t;const n=(0,r.A)({},e);for(const[r,s]of Object.entries(t))s&&"object"===typeof s&&!Array.isArray(s)?n[r]=rt(n[r]||{},t[r],i+1):n[r]=t[r];return n}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof i.g&&i.g,"undefined"!==typeof document&&document;const st="object"!==typeof process||"[object process]"!==String(process)||process.browser,ot="undefined"!==typeof window&&"undefined"!==typeof window.orientation,at="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);at&&parseFloat(at[1]);class lt{terminate(){}}function ct(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const ut=new Map;function ht(e){ct(e.source&&!e.url||!e.source&&e.url);let t=ut.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return dt((t=e,"try {\n  importScripts('".concat(t,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var t}(e.url),ut.set(e.url,t)),e.source&&(t=dt(e.source),ut.set(e.source,t))),ct(t),t}function dt(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function pt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;const n=i||new Set;if(e){if(mt(e))n.add(e);else if(mt(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const r in e)pt(e[r],t,n)}else;return void 0===i?Array.from(n):[]}function mt(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const ft=()=>{};class gt{static isSupported(){return"undefined"!==typeof Worker&&st||"undefined"!==typeof lt&&!st}constructor(e){(0,s.A)(this,"name",void 0),(0,s.A)(this,"source",void 0),(0,s.A)(this,"url",void 0),(0,s.A)(this,"terminated",!1),(0,s.A)(this,"worker",void 0),(0,s.A)(this,"onMessage",void 0),(0,s.A)(this,"onError",void 0),(0,s.A)(this,"_loadableURL","");const{name:t,source:i,url:n}=e;ct(i||n),this.name=t,this.source=i,this.url=n,this.onMessage=ft,this.onError=e=>console.log(e),this.worker=st?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ft,this.onError=ft,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||pt(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=ht({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new lt(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new lt(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}class _t{constructor(e,t){(0,s.A)(this,"name",void 0),(0,s.A)(this,"workerThread",void 0),(0,s.A)(this,"isRunning",!0),(0,s.A)(this,"result",void 0),(0,s.A)(this,"_resolve",()=>{}),(0,s.A)(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){ct(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ct(this.isRunning),this.isRunning=!1,this._reject(e)}}class vt{static isSupported(){return gt.isSupported()}constructor(e){(0,s.A)(this,"name","unnamed"),(0,s.A)(this,"source",void 0),(0,s.A)(this,"url",void 0),(0,s.A)(this,"maxConcurrency",1),(0,s.A)(this,"maxMobileConcurrency",1),(0,s.A)(this,"onDebug",()=>{}),(0,s.A)(this,"reuseWorkers",!0),(0,s.A)(this,"props",{}),(0,s.A)(this,"jobQueue",[]),(0,s.A)(this,"idleQueue",[]),(0,s.A)(this,"count",0),(0,s.A)(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=(0,r.A)((0,r.A)({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,i)=>e.done(i),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const n=new Promise(n=>(this.jobQueue.push({name:e,onMessage:t,onError:i,onStart:n}),this));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new _t(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}catch(i){console.error("Worker exception: ".concat(i))}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!st||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new gt({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ot?this.maxMobileConcurrency:this.maxConcurrency}}const yt={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class bt{static isSupported(){return gt.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return bt._workerFarm=bt._workerFarm||new bt({}),bt._workerFarm.setProps(e),bt._workerFarm}constructor(e){(0,s.A)(this,"props",void 0),(0,s.A)(this,"workerPools",new Map),this.props=(0,r.A)({},yt),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props=(0,r.A)((0,r.A)({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:n}=e;let r=this.workerPools.get(t);return r||(r=new vt({name:t,source:i,url:n}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(0,s.A)(bt,"_workerFarm",void 0);const xt=function(){var e;return null!==(e=globalThis._loadersgl_)&&void 0!==e&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}();async function wt(e,t,i,n,r){const s=e.id,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t[e.id]||{},n="".concat(e.id,st?"-worker.js":"-worker-node.js");let r=i.workerUrl;if(r||"compression"!==e.id||(r=t.workerUrl),"test"===t._workerType&&(r=st?"modules/".concat(e.module,"/dist/").concat(n):"modules/".concat(e.module,"/src/workers/").concat(e.id,"-worker-node.ts")),!r){let t=e.version;"latest"===t&&(t="latest");const i=t?"@".concat(t):"";r="https://unpkg.com/@loaders.gl/".concat(e.module).concat(i,"/dist/").concat(n)}return ct(r),r}(e,i),a=bt.getWorkerFarm(i).getWorkerPool({name:s,url:o});i=JSON.parse(JSON.stringify(i)),n=JSON.parse(JSON.stringify(n||{}));const l=await a.startJob("process-on-worker",Et.bind(null,r));l.postMessage("process",{input:t,options:i,context:n});const c=await l.result;return await c.result}async function Et(e,t,i,n){switch(i){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:s,input:o,options:a}=n;try{const i=await e(o,a);t.postMessage("done",{id:s,result:i})}catch(r){const e=r instanceof Error?r.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn("parse-with-worker unknown message ".concat(i))}}function At(e){var t,i,n,r=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,n=Symbol.iterator);r--;){if(i&&null!=(t=e[i]))return t.call(e);if(n&&null!=(t=e[n]))return new Tt(t.call(e));i="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Tt(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Tt=function(e){this.s=e,this.n=e.next},Tt.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?Promise.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?Promise.reject(e):t(i.apply(this.s,arguments))}},new Tt(e)}function Dt(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){const t=e.map(e=>e instanceof ArrayBuffer?new Uint8Array(e):e),i=t.reduce((e,t)=>e+t.byteLength,0),n=new Uint8Array(i);let r=0;for(const s of t)n.set(s,r),r+=s.byteLength;return n.buffer}(t)}const St=262144;function Ct(e,t){this.v=e,this.k=t}function Pt(e){return new Ct(e,0)}function It(e){return function(){return new kt(e.apply(this,arguments))}}function kt(e){var t,i;function n(t,i){try{var s=e[t](i),o=s.value,a=o instanceof Ct;Promise.resolve(a?o.v:o).then(function(i){if(a){var l="return"===t?"return":"next";if(!o.k||i.done)return n(l,i);i=e[l](i).value}r(s.done?"return":"normal",i)},function(e){n("throw",e)})}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?n(t.key,t.arg):i=null}this._invoke=function(e,r){return new Promise(function(s,o){var a={key:e,arg:r,resolve:s,reject:o,next:null};i?i=i.next=a:(t=i=a,n(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}kt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},kt.prototype.next=function(e){return this._invoke("next",e)},kt.prototype.throw=function(e){return this._invoke("throw",e)},kt.prototype.return=function(e){return this._invoke("return",e)};function Mt(){return(Mt=It(function*(e,t){const i=(null===t||void 0===t?void 0:t.chunkSize)||1048576;let n=0;for(;n<e.size;){const t=n+i,r=yield Pt(e.slice(n,t).arrayBuffer());n=t,yield r}})).apply(this,arguments)}function Rt(e){if((t=e)&&"object"===typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Ft(e,t){return He?function(e,t){return Lt.apply(this,arguments)}(e,t):function(e,t){return Ot.apply(this,arguments)}(e,t)}function Lt(){return(Lt=It(function*(e,t){const i=e.getReader();let n;try{for(;;){const e=n||i.read();null!==t&&void 0!==t&&t._streamReadAhead&&(n=i.read());const{done:r,value:s}=yield Pt(e);if(r)return;yield Rt(s)}}catch(r){i.releaseLock()}})).apply(this,arguments)}function Ot(){return(Ot=It(function*(e,t){var i,n=!1,r=!1;try{for(var s,o=At(e);n=!(s=yield Pt(o.next())).done;n=!1){const e=s.value;yield Rt(e)}}catch(a){r=!0,i=a}finally{try{n&&null!=o.return&&(yield Pt(o.return()))}finally{if(r)throw i}}})).apply(this,arguments)}function Bt(e,t){if("string"===typeof e)return function*(e,t){const i=(null===t||void 0===t?void 0:t.chunkSize)||262144;let n=0;const r=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,i),s=e.slice(n,n+t);n+=t,yield r.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:i=St}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,i),r=new ArrayBuffer(t),s=new Uint8Array(e,n,t);new Uint8Array(r).set(s),n+=t,yield r}}()}(e,t);if(Ae(e))return function(e,t){return Mt.apply(this,arguments)}(e,t);if(Te(e))return Ft(e,t);if(Ee(e)){return Ft(e.body,t)}throw new Error("makeIterator")}const zt="Cannot convert supplied data type";async function Nt(e,t,i){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||n)return function(e,t){if(t.text&&"string"===typeof e)return e;if((e=>e&&"object"===typeof e&&e.isBuffer)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const i=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let i=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===i.byteLength||(i=i.slice(e.byteOffset,e.byteOffset+n)),i}throw new Error(zt)}(e,t);if(Ae(e)&&(e=await Ue(e)),Ee(e)){const i=e;return await je(i),t.binary?await i.arrayBuffer():await i.text()}if(Te(e)&&(e=Bt(e,i)),(e=>Boolean(e)&&"function"===typeof e[Symbol.iterator])(e)||(e=>e&&"function"===typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];var i,n=!1,r=!1;try{for(var s,o=At(e);n=!(s=await o.next()).done;n=!1){const e=s.value;t.push(e)}}catch(a){r=!0,i=a}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw i}}return Dt(...t)}(e);throw new Error(zt)}function Ut(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function jt(e,t,i){if(i)return i;const n=(0,r.A)({fetch:it(t,e)},e);if(n.url){const e=Be(n.url);n.baseUrl=e,n.queryString=function(e){const t=e.match(Oe);return t&&t[0]}(n.url),n.filename=Ut(e),n.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}const Vt="4.3.3",Gt=Vt[0]>="0"&&Vt[0]<="9"?"v".concat(Vt):"";const Wt=function(){const e=new ue.t({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=Gt,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}(),Ht=()=>{const e=Ye();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const Xt=/\.([^.]+)$/;function qt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Zt(e))return null;if(t&&!Array.isArray(t))return Ce(t);let r=[];t&&(r=r.concat(t)),null!==i&&void 0!==i&&i.ignoreRegisteredLoaders||r.push(...Ht()),function(e){for(const t of e)Ce(t)}(r);const s=function(e,t,i,n){const r=ze(e),s=Ne(e),o=Be(r)||(null===n||void 0===n?void 0:n.url);let a=null,l="";null!==i&&void 0!==i&&i.mimeType&&(a=Kt(t,null===i||void 0===i?void 0:i.mimeType),l="match forced by supplied MIME type ".concat(null===i||void 0===i?void 0:i.mimeType));a=a||function(e,t){const i=t&&Xt.exec(t),n=i&&i[1];return n?function(e,t){t=t.toLowerCase();for(const i of e)for(const e of i.extensions)if(e.toLowerCase()===t)return i;return null}(e,n):null}(t,o),l=l||(a?"matched url ".concat(o):""),a=a||Kt(t,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||function(e,t){if(!t)return null;for(const i of e)if("string"===typeof t){if(Jt(t,i))return i}else if(ArrayBuffer.isView(t)){if($t(t.buffer,t.byteOffset,i))return i}else if(t instanceof ArrayBuffer){if($t(t,0,i))return i}return null}(t,e),l=l||(a?"matched initial data ".concat(Qt(e)):""),null!==i&&void 0!==i&&i.fallbackMimeType&&(a=a||Kt(t,null===i||void 0===i?void 0:i.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""));var c;l&&Wt.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,"."));return a}(e,r,i,n);if(!s&&(null===i||void 0===i||!i.nothrow))throw new Error(Yt(e));return s}function Zt(e){return!(e instanceof Response&&204===e.status)}function Yt(e){const t=ze(e),i=Ne(e);let n="No valid loader found (";n+=t?"".concat(Ut(t),", "):"no url provided, ",n+="MIME type: ".concat(i?'"'.concat(i,'"'):"not provided",", ");const r=e?Qt(e):"";return n+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",n+=")",n}function Kt(e,t){for(const n of e){var i;if(null!==(i=n.mimeTypes)&&void 0!==i&&i.some(e=>Fe(t,e)))return n;if(Fe(t,"application/x.".concat(n.id)))return n}return null}function Jt(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function $t(e,t,i){return(Array.isArray(i.tests)?i.tests:[i.tests]).some(i=>function(e,t,i,n){if(n instanceof ArrayBuffer)return function(e,t,i){if(i=i||e.byteLength,e.byteLength<i||t.byteLength<i)return!1;const n=new Uint8Array(e),r=new Uint8Array(t);for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0}(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===ei(e,t,n.length);default:return!1}}(e,t,0,i))}function Qt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return ei(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return ei(e,0,t)}return""}function ei(e,t,i){if(e.byteLength<t+i)return"";const n=new DataView(e);let r="";for(let s=0;s<i;s++)r+=String.fromCharCode(n.getUint8(t+s));return r}async function ti(e,t,i,n){!t||Array.isArray(t)||Se(t)||(n=void 0,i=t,t=void 0),i=i||{};const s=ze(e=await e),o=function(e,t){if(e&&!Array.isArray(e))return e;let i;if(e&&(i=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];i=i?[...i,...e]:e}return i&&i.length?i:void 0}(t,n),a=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!Zt(e))return null;let s=qt(e,t,(0,r.A)((0,r.A)({},i),{},{nothrow:!0}),n);if(s)return s;if(Ae(e)&&(s=qt(e=await e.slice(0,10).arrayBuffer(),t,i,n)),!s&&(null===i||void 0===i||!i.nothrow))throw new Error(Yt(e));return s}(e,o,i);return a?(n=jt({url:s,_parse:ti,loaders:o},i=Je(i,a,o,s),n||null),await async function(e,t,i,n){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt;ct(e,"no worker provided");const i=e.version}(e),i=nt(e.options,i),Ee(t)){const e=t,{ok:i,redirected:r,status:s,statusText:o,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());n.response={headers:c,ok:i,redirected:r,status:s,statusText:o,type:a,url:l}}t=await Nt(t,e,i);const r=e;if(r.parseTextSync&&"string"===typeof t)return r.parseTextSync(t,i,n);if(function(e,t){return!!bt.isSupported()&&!!(st||null!==t&&void 0!==t&&t._nodeWorkers)&&e.worker&&(null===t||void 0===t?void 0:t.worker)}(e,i))return await wt(e,t,i,n,ti);if(r.parseText&&"string"===typeof t)return await r.parseText(t,i,n);if(r.parse)return await r.parse(t,i,n);throw ct(!r.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"))}(a,e,i,n)):null}async function ii(e,t,i,n){let r,s;Array.isArray(t)||Se(t)?(r=t,s=i):(r=[],s=t);const o=it(s);let a=e;return"string"===typeof e&&(a=await o(e)),Ae(e)&&(a=await o(e)),Array.isArray(r),await ti(a,r,s)}class ni{constructor(e,t,i){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=i,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let n=e;"string"===typeof e&&(n=ii(e)),n instanceof Promise?(this.isLoaded=!1,this._loader=n.then(e=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=e)}).catch(e=>{this._loadCount===i&&(this.isLoaded=!0,this._error=e||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const r of this._subscribers)r.onChange(this.getData())}}class ri{constructor(e){var t;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:null===(t=e.device)||void 0===t?void 0:t.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:i,forceUpdate:n=!1,persistent:r=!0}=e,s=this._resources[t];s?s.setData(i,n):(s=new ni(t,i,this._context),this._resources[t]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const i=this._consumers[t];if(i){for(const e in i){const t=i[e],n=this._resources[t.resourceId];n&&n.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:i,consumerId:n,requestId:r="default"}=e;const{_resources:s,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),s[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=s[t];if(this._track(n,r,a,i),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,n){const r=this._consumers,s=r[e]=r[e]||{};let o=s[t];const a=o&&o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),i&&(o?(o.onChange=n,o.resourceId=i.id):o={onChange:n,resourceId:i.id},s[t]=o,i.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const si=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,i){let{size:n=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}=i;const c=r||e&&e.constructor||Float32Array,u=t*n+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h=1/0;l&&(h=l*n+s);const d=this._allocate(c,u,a,h);return e&&o?d.set(e):a||d.fill(0,0,4),this._release(e),d}release(e){this._release(e)}_allocate(e,t,i,n){let r=Math.max(Math.ceil(t*this.opts.overAlloc),1);r>n&&(r=n);const s=this._pool,o=e.BYTES_PER_ELEMENT*r,a=s.findIndex(e=>e.byteLength>=o);if(a>=0){const t=new e(s.splice(a,1)[0],0,r);return i&&t.fill(0),t}return new e(r)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:n}=i,r=t.findIndex(e=>e.byteLength>=n);r<0?t.push(i):(r>0||t.length<this.opts.poolSize)&&t.splice(r,0,i),t.length>this.opts.poolSize&&t.shift()}};Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:(0,r.A)({},{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1})};const oi=globalThis.mathgl.config;function ai(e){let{precision:t=oi.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/oi.EPSILON)*oi.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function li(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ci(e,t,i){return di(e,e=>Math.max(t,Math.min(i,e)))}function ui(e,t,i){return li(e)?e.map((e,n)=>ui(e,t[n],i)):i*t+(1-i)*e}function hi(e,t,i){const n=oi.EPSILON;i&&(oi.EPSILON=i);try{if(e===t)return!0;if(li(e)&&li(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!hi(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=oi.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{oi.EPSILON=n}}function di(e,t,i){if(li(e)){const n=e;i=i||function(e){return e.clone?e.clone():new Array(e.length)}(n);for(let r=0;r<i.length&&r<n.length;++r){const n="number"===typeof e?e:e[r];i[r]=t(n,r,i)}return i}return t(e)}class pi extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:li(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(oi)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+ai(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!hi(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){if(void 0===i)return this.lerp(this,e,t);for(let n=0;n<this.ELEMENTS;++n){const r=e[n],s="number"===typeof t?t:t[n];this[n]=r+i*(s-r)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(const n of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=n[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(const n of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=n[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(oi.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}get elements(){return this}}function mi(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(JSON.stringify(e)));return e}function fi(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(oi.debug&&!function(e,t){if(e.length!==t)return!1;for(let i=0;i<e.length;++i)if(!Number.isFinite(e[i]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(i," some fields set to invalid numbers'"));return e}function gi(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class _i extends pi{get x(){return this[0]}set x(e){this[0]=mi(e)}get y(){return this[1]}set y(e){this[1]=mi(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const n=this[i]-e[i];t+=n*n}return mi(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return mi(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(const n of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=n[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(const n of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=n[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return gi(e>=0&&e<this.ELEMENTS,"index is out of range"),mi(this[e])}setComponent(e,t){return gi(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const vi=1e-6;let yi="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function bi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function xi(e,t,i){const n=t[0],r=t[1],s=t[2];let o=i[3]*n+i[7]*r+i[11]*s+i[15];return o=o||1,e[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/o,e[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/o,e[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/o,e}const wi=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e};!function(){const e=function(){const e=new yi(3);return yi!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function Ei(e,t,i){const n=t[0],r=t[1],s=t[2],o=i[3]*n+i[7]*r+i[11]*s||1;return e[0]=(i[0]*n+i[4]*r+i[8]*s)/o,e[1]=(i[1]*n+i[5]*r+i[9]*s)/o,e[2]=(i[2]*n+i[6]*r+i[10]*s)/o,e}const Ai=[0,0,0];let Ti;class Di extends _i{static get ZERO(){return Ti||(Ti=new Di(0,0,0),Object.freeze(Ti)),Ti}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&li(e)?this.copy(e):(oi.debug&&(mi(e),mi(t),mi(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return oi.debug&&(mi(e.x),mi(e.y),mi(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=mi(e)}angle(e){return function(e,t){const i=e[0],n=e[1],r=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt((i*i+n*n+r*r)*(s*s+o*o+a*a)),c=l&&bi(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return function(e,t,i){const n=t[0],r=t[1],s=t[2],o=i[0],a=i[1],l=i[2];e[0]=r*l-s*a,e[1]=s*o-n*l,e[2]=n*a-r*o}(this,this,e),this.check()}rotateX(e){let{radians:t,origin:i=Ai}=e;return function(e,t,i,n){const r=[],s=[];r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],s[0]=r[0],s[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),s[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2]}(this,this,i,t),this.check()}rotateY(e){let{radians:t,origin:i=Ai}=e;return function(e,t,i,n){const r=[],s=[];r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],s[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),s[1]=r[1],s[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2]}(this,this,i,t),this.check()}rotateZ(e){let{radians:t,origin:i=Ai}=e;return function(e,t,i,n){const r=[],s=[];r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],s[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),s[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),s[2]=r[2],e[0]=s[0]+i[0],e[1]=s[1]+i[1],e[2]=s[2]+i[2]}(this,this,i,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return xi(this,this,e),this.check()}transformAsVector(e){return Ei(this,this,e),this.check()}transformByMatrix3(e){return function(e,t,i){const n=t[0],r=t[1],s=t[2];e[0]=n*i[0]+r*i[3]+s*i[6],e[1]=n*i[1]+r*i[4]+s*i[7],e[2]=n*i[2]+r*i[5]+s*i[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,i){const n=t[0],r=t[1];e[0]=i[0]*n+i[2]*r,e[1]=i[1]*n+i[3]*r,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,i){const n=i[0],r=i[1],s=i[2],o=i[3],a=t[0],l=t[1],c=t[2];let u=r*c-s*l,h=s*a-n*c,d=n*l-r*a,p=r*d-s*h,m=s*u-n*d,f=n*h-r*u;const g=2*o;u*=g,h*=g,d*=g,p*=2,m*=2,f*=2,e[0]=a+u+p,e[1]=l+h+m,e[2]=c+d+f}(this,this,e),this.check()}}const Si=new Di;function Ci(e,t,i,n){Si.set(e,t,i);const r=Si.len();return{distance:n/r,normal:new Di(-e/r,-t/r,-i/r)}}function Pi(e){return e-Math.fround(e)}let Ii;function ki(e,t){const{size:i=1,startIndex:n=0}=t,r=void 0!==t.endIndex?t.endIndex:e.length,s=(r-n)/i;Ii=si.allocate(Ii,s,{type:Float32Array,size:2*i});let o=n,a=0;for(;o<r;){for(let t=0;t<i;t++){const n=e[o++];Ii[a+t]=n,Ii[a+t+i]=Pi(n)}a+=2*i}return Ii.subarray(0,s*i*2)}function Mi(e){let t=null,i=!1;for(const n of e)n&&(t?(i||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],i=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}class Ri extends pi{toString(){let e="[";if(oi.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=mi(i),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const i=e*this.RANK;for(let n=0;n<this.RANK;++n)t[n]=this[i+n];return t}setColumn(e,t){const i=e*this.RANK;for(let n=0;n<this.RANK;++n)this[i+n]=t[n];return this}}function Fi(e,t){const i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],v=i*a-n*o,y=i*l-r*o,b=i*c-s*o,x=n*l-r*a,w=n*c-s*a,E=r*c-s*l,A=u*f-h*m,T=u*g-d*m,D=u*_-p*m,S=h*g-d*f,C=h*_-p*f,P=d*_-p*g;let I=v*P-y*C+b*S+x*D-w*T+E*A;return I?(I=1/I,e[0]=(a*P-l*C+c*S)*I,e[1]=(r*C-n*P-s*S)*I,e[2]=(f*E-g*w+_*x)*I,e[3]=(d*w-h*E-p*x)*I,e[4]=(l*D-o*P-c*T)*I,e[5]=(i*P-r*D+s*T)*I,e[6]=(g*b-m*E-_*y)*I,e[7]=(u*E-d*b+p*y)*I,e[8]=(o*C-a*D+c*A)*I,e[9]=(n*D-i*C-s*A)*I,e[10]=(m*w-f*b+_*v)*I,e[11]=(h*b-u*w-p*v)*I,e[12]=(a*T-o*S-l*A)*I,e[13]=(i*S-n*T+r*A)*I,e[14]=(f*y-m*x-g*v)*I,e[15]=(u*x-h*y+d*v)*I,e):null}function Li(e,t,i){const n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],_=t[14],v=t[15];let y=i[0],b=i[1],x=i[2],w=i[3];return e[0]=y*n+b*a+x*h+w*f,e[1]=y*r+b*l+x*d+w*g,e[2]=y*s+b*c+x*p+w*_,e[3]=y*o+b*u+x*m+w*v,y=i[4],b=i[5],x=i[6],w=i[7],e[4]=y*n+b*a+x*h+w*f,e[5]=y*r+b*l+x*d+w*g,e[6]=y*s+b*c+x*p+w*_,e[7]=y*o+b*u+x*m+w*v,y=i[8],b=i[9],x=i[10],w=i[11],e[8]=y*n+b*a+x*h+w*f,e[9]=y*r+b*l+x*d+w*g,e[10]=y*s+b*c+x*p+w*_,e[11]=y*o+b*u+x*m+w*v,y=i[12],b=i[13],x=i[14],w=i[15],e[12]=y*n+b*a+x*h+w*f,e[13]=y*r+b*l+x*d+w*g,e[14]=y*s+b*c+x*p+w*_,e[15]=y*o+b*u+x*m+w*v,e}function Oi(e,t,i){const n=i[0],r=i[1],s=i[2];let o,a,l,c,u,h,d,p,m,f,g,_;return t===e?(e[12]=t[0]*n+t[4]*r+t[8]*s+t[12],e[13]=t[1]*n+t[5]*r+t[9]*s+t[13],e[14]=t[2]*n+t[6]*r+t[10]*s+t[14],e[15]=t[3]*n+t[7]*r+t[11]*s+t[15]):(o=t[0],a=t[1],l=t[2],c=t[3],u=t[4],h=t[5],d=t[6],p=t[7],m=t[8],f=t[9],g=t[10],_=t[11],e[0]=o,e[1]=a,e[2]=l,e[3]=c,e[4]=u,e[5]=h,e[6]=d,e[7]=p,e[8]=m,e[9]=f,e[10]=g,e[11]=_,e[12]=o*n+u*r+m*s+t[12],e[13]=a*n+h*r+f*s+t[13],e[14]=l*n+d*r+g*s+t[14],e[15]=c*n+p*r+_*s+t[15]),e}function Bi(e,t,i){const n=i[0],r=i[1],s=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function zi(e,t,i){const n=Math.sin(i),r=Math.cos(i),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*n,e[5]=o*r+u*n,e[6]=a*r+h*n,e[7]=l*r+d*n,e[8]=c*r-s*n,e[9]=u*r-o*n,e[10]=h*r-a*n,e[11]=d*r-l*n,e}function Ni(e,t,i){const n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*n,e[1]=o*r+u*n,e[2]=a*r+h*n,e[3]=l*r+d*n,e[4]=c*r-s*n,e[5]=u*r-o*n,e[6]=h*r-a*n,e[7]=d*r-l*n,e}const Ui=function(e,t,i,n,r){const s=1/Math.tan(t/2);if(e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0){const t=1/(n-r);e[10]=(r+n)*t,e[14]=2*r*n*t}else e[10]=-1,e[14]=-2*n;return e};const ji=function(e,t,i,n,r,s,o){const a=1/(t-i),l=1/(n-r),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(r+n)*l,e[14]=(o+s)*c,e[15]=1,e};function Vi(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function Gi(e,t,i,n){const r=t[0],s=t[1];return e[0]=r+n*(i[0]-r),e[1]=s+n*(i[1]-s),e}!function(){const e=function(){const e=new yi(2);return yi!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function Wi(e,t,i){const n=t[0],r=t[1],s=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,e}!function(){const e=function(){const e=new yi(4);return yi!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();var Hi;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(Hi||(Hi={}));const Xi=45*Math.PI/180,qi=1,Zi=.1,Yi=500,Ki=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ji extends Ri{static get IDENTITY(){return function(){Qi||(Qi=new Ji,Object.freeze(Qi));return Qi}()}static get ZERO(){return function(){$i||($i=new Ji([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze($i));return $i}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Hi}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f){return this[0]=e,this[1]=t,this[2]=i,this[3]=n,this[4]=r,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=p,this[14]=m,this[15]=f,this.check()}setRowMajor(e,t,i,n,r,s,o,a,l,c,u,h,d,p,m,f){return this[0]=e,this[1]=r,this[2]=l,this[3]=d,this[4]=t,this[5]=s,this[6]=c,this[7]=p,this[8]=i,this[9]=o,this[10]=u,this[11]=m,this[12]=n,this[13]=a,this[14]=h,this[15]=f,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Ki)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const i=t[0],n=t[1],r=t[2],s=t[3],o=i+i,a=n+n,l=r+r,c=i*o,u=n*o,h=n*a,d=r*o,p=r*a,m=r*l,f=s*o,g=s*a,_=s*l;e[0]=1-h-m,e[1]=u+_,e[2]=d-g,e[3]=0,e[4]=u-_,e[5]=1-c-m,e[6]=p+f,e[7]=0,e[8]=d+g,e[9]=p-f,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:i,bottom:n,top:r,near:s=Zi,far:o=Yi}=e;return o===1/0?function(e,t,i,n,r,s){const o=2*s/(i-t),a=2*s/(r-n),l=(i+t)/(i-t),c=(r+n)/(r-n),u=-1,h=-1,d=-2*s;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,i,n,r,s):function(e,t,i,n,r,s,o){const a=1/(i-t),l=1/(r-n),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(i+t)*a,e[9]=(r+n)*l,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,t,i,n,r,s,o),this.check()}lookAt(e){const{eye:t,center:i=[0,0,0],up:n=[0,1,0]}=e;return function(e,t,i,n){let r,s,o,a,l,c,u,h,d,p;const m=t[0],f=t[1],g=t[2],_=n[0],v=n[1],y=n[2],b=i[0],x=i[1],w=i[2];Math.abs(m-b)<vi&&Math.abs(f-x)<vi&&Math.abs(g-w)<vi?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(h=m-b,d=f-x,p=g-w,r=1/Math.sqrt(h*h+d*d+p*p),h*=r,d*=r,p*=r,s=v*p-y*d,o=y*h-_*p,a=_*d-v*h,r=Math.sqrt(s*s+o*o+a*a),r?(r=1/r,s*=r,o*=r,a*=r):(s=0,o=0,a=0),l=d*a-p*o,c=p*s-h*a,u=h*o-d*s,r=Math.sqrt(l*l+c*c+u*u),r?(r=1/r,l*=r,c*=r,u*=r):(l=0,c=0,u=0),e[0]=s,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=c,e[6]=d,e[7]=0,e[8]=a,e[9]=u,e[10]=p,e[11]=0,e[12]=-(s*m+o*f+a*g),e[13]=-(l*m+c*f+u*g),e[14]=-(h*m+d*f+p*g),e[15]=1)}(this,t,i,n),this.check()}ortho(e){const{left:t,right:i,bottom:n,top:r,near:s=Zi,far:o=Yi}=e;return ji(this,t,i,n,r,s,o),this.check()}orthographic(e){const{fovy:t=Xi,aspect:i=qi,focalDistance:n=1,near:r=Zi,far:s=Yi}=e;en(t);const o=t/2,a=n*Math.tan(o),l=a*i;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:i=1,near:n=.1,far:r=500}=e;return en(t),Ui(this,t,i,n,r),this.check()}determinant(){return function(e){const t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],m=e[13],f=e[14],g=t*o-i*s,_=t*a-n*s,v=i*a-n*o,y=c*m-u*p,b=c*f-h*p,x=u*f-h*m;return l*(t*x-i*b+n*y)-r*(s*x-o*b+a*y)+e[15]*(c*v-u*_+h*g)-d*(p*v-m*_+f*g)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),n=1/i[0],r=1/i[1],s=1/i[2];return e[0]=this[0]*n,e[1]=this[1]*r,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*r,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*r,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),n=1/i[0],r=1/i[1],s=1/i[2];return e[0]=this[0]*n,e[1]=this[1]*r,e[2]=this[2]*s,e[3]=this[4]*n,e[4]=this[5]*r,e[5]=this[6]*s,e[6]=this[8]*n,e[7]=this[9]*r,e[8]=this[10]*s,e}transpose(){return function(e,t){if(e===t){const i=t[1],n=t[2],r=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=r,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return Fi(this,this),this.check()}multiplyLeft(e){return Li(this,e,this),this.check()}multiplyRight(e){return Li(this,this,e),this.check()}rotateX(e){return zi(this,this,e),this.check()}rotateY(e){return function(e,t,i){const n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r-c*n,e[1]=o*r-u*n,e[2]=a*r-h*n,e[3]=l*r-d*n,e[8]=s*n+c*r,e[9]=o*n+u*r,e[10]=a*n+h*r,e[11]=l*n+d*r}(this,this,e),this.check()}rotateZ(e){return Ni(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,i,n){let r,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A,T,D,S,C=n[0],P=n[1],I=n[2],k=Math.sqrt(C*C+P*P+I*I);k<vi||(k=1/k,C*=k,P*=k,I*=k,s=Math.sin(i),r=Math.cos(i),o=1-r,a=t[0],l=t[1],c=t[2],u=t[3],h=t[4],d=t[5],p=t[6],m=t[7],f=t[8],g=t[9],_=t[10],v=t[11],y=C*C*o+r,b=P*C*o+I*s,x=I*C*o-P*s,w=C*P*o-I*s,E=P*P*o+r,A=I*P*o+C*s,T=C*I*o+P*s,D=P*I*o-C*s,S=I*I*o+r,e[0]=a*y+h*b+f*x,e[1]=l*y+d*b+g*x,e[2]=c*y+p*b+_*x,e[3]=u*y+m*b+v*x,e[4]=a*w+h*E+f*A,e[5]=l*w+d*E+g*A,e[6]=c*w+p*E+_*A,e[7]=u*w+m*E+v*A,e[8]=a*T+h*D+f*S,e[9]=l*T+d*D+g*S,e[10]=c*T+p*D+_*S,e[11]=u*T+m*D+v*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return Bi(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Oi(this,this,e),this.check()}transform(e,t){return 4===e.length?(fi(t=Wi(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;let n;switch(i){case 2:n=function(e,t,i){const n=t[0],r=t[1];return e[0]=i[0]*n+i[4]*r+i[12],e[1]=i[1]*n+i[5]*r+i[13],e}(t||[-0,-0],e,this);break;case 3:n=xi(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return fi(n,e.length),n}transformAsVector(e,t){let i;switch(e.length){case 2:i=function(e,t,i){const n=t[0],r=t[1],s=i[3]*n+i[7]*r||1;return e[0]=(i[0]*n+i[4]*r)/s,e[1]=(i[1]*n+i[5]*r)/s,e}(t||[-0,-0],e,this);break;case 3:i=Ei(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return fi(i,e.length),i}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}}let $i,Qi;function en(e){if(e>2*Math.PI)throw Error("expected radians")}function tn(e,t){const i=Wi([],t,e);return function(e,t,i){e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i}(i,i,1/i[3]),i}function nn(e,t){const i=e%t;return i<0?t+i:i}function rn(e,t,i){return e<t?t:e>i?i:e}const sn=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function on(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const an=Math.PI,ln=an/4,cn=an/180,un=180/an,hn=512,dn=4003e4,pn=85.051129,mn=1.5;function fn(e){const[t,i]=e;on(Number.isFinite(t)),on(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");const n=i*cn;return[hn*(t*cn+an)/(2*an),hn*(an+Math.log(Math.tan(ln+.5*n)))/(2*an)]}function gn(e){const[t,i]=e,n=t/hn*(2*an)-an,r=2*(Math.atan(Math.exp(i/hn*(2*an)-an))-ln);return[n*un,r*un]}function _n(e){const{latitude:t}=e;on(Number.isFinite(t));const i=Math.cos(t*cn);return function(e){return sn(e)}(dn*i)-9}function vn(e){return 12790407194604047e-21/Math.cos(e*cn)}function yn(e){const{latitude:t,longitude:i,highPrecision:n=!1}=e;on(Number.isFinite(t)&&Number.isFinite(i));const r=hn,s=Math.cos(t*cn),o=r/360,a=o/s,l=12790407194604047e-21/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(n){const e=cn*Math.tan(t*cn)/s,i=o*e/2,n=12790407194604047e-21*e,r=n/a*l;c.unitsPerDegree2=[0,i,n],c.unitsPerMeter2=[r,0,r]}return c}function bn(e,t){const[i,n,r]=e,[s,o,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=yn({longitude:i,latitude:n,highPrecision:!0}),u=fn(e);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=gn(u),d=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],d]:h}function xn(e){const{width:t,height:i,altitude:n,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=wn(mn)}=e;void 0!==n&&(u=wn(n));const h=u*cn,d=r*cn,p=En(u);let m=p;o&&(m+=o[2]*a/Math.cos(d)/i);const f=h*(.5+(s?s[1]:0)/i),g=Math.sin(f)*m/Math.sin(rn(Math.PI/2-d-f,.01,Math.PI-.01)),_=Math.sin(d)*g+m,v=10*m;return{fov:h,aspect:t/i,focalDistance:p,near:l,far:Math.min(_*c,v)}}function wn(e){return 2*Math.atan(.5/e)*un}function En(e){return.5/Math.tan(.5*e*cn)}function An(e,t){const[i,n,r=0]=e;return on(Number.isFinite(i)&&Number.isFinite(n)&&Number.isFinite(r)),tn(t,[i,n,r,1])}function Tn(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[n,r,s]=e;if(on(Number.isFinite(n)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s)){return tn(t,[n,r,s,1])}const o=tn(t,[n,r,0,1]),a=tn(t,[n,r,1,1]),l=o[2],c=a[2];return Gi([],o,a,l===c?0:((i||0)-l)/(c-l))}function Dn(e){const{width:t,height:i,bounds:n,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[c,u]]=n,h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return on(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),d=fn([a,rn(u,-85.051129,pn)]),p=fn([c,rn(l,-85.051129,pn)]),m=[Math.max(Math.abs(p[0]-d[0]),r),Math.max(Math.abs(p[1]-d[1]),r)],f=[t-h.left-h.right-2*Math.abs(o[0]),i-h.top-h.bottom-2*Math.abs(o[1])];on(f[0]>0&&f[1]>0);const g=f[0]/m[0],_=f[1]/m[1],v=(h.right-h.left)/2/g,y=(h.top-h.bottom)/2/_,b=gn([(p[0]+d[0])/2+v,(p[1]+d[1])/2+y]),x=Math.min(s,sn(Math.abs(Math.min(g,_))));return on(Number.isFinite(x)),{longitude:b[0],latitude:b[1],zoom:x}}const Sn=Math.PI/180;function Cn(e,t,i){const{pixelUnprojectionMatrix:n}=e,r=tn(n,[t,0,1,1]),s=tn(n,[t,e.height,1,1]),o=gn(Gi([],r,s,(i*e.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return o.push(i),o}var Pn,In,kn;!function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"}(Pn||(Pn={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"}(In||(In={})),function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"}(kn||(kn={}));const Mn="auto",Rn="manipulation",Fn="none",Ln="pan-x",On="pan-y";class Bn{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){"compute"===e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return function(e){if(e.includes(Fn))return Fn;const t=e.includes(Ln),i=e.includes(On);return t&&i?Fn:t||i?t?Ln:On:e.includes(Rn)?Rn:Mn}(e.join(" "))}}function zn(e){return e.trim().split(/\s+/g)}function Nn(e,t,i){if(e)for(const n of zn(t))e.addEventListener(n,i,!1)}function Un(e,t,i){if(e)for(const n of zn(t))e.removeEventListener(n,i,!1)}function jn(e){return(e.ownerDocument||e).defaultView}function Vn(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let i=0,n=0,r=0;for(;r<t;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:Math.round(i/t),y:Math.round(n/t)}}function Gn(e){const t=[];let i=0;for(;i<e.pointers.length;)t[i]={clientX:Math.round(e.pointers[i].clientX),clientY:Math.round(e.pointers[i].clientY)},i++;return{timeStamp:Date.now(),pointers:t,center:Vn(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Wn(e,t){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}function Hn(e,t){const i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)}function Xn(e,t){const i=t.clientX-e.clientX,n=t.clientY-e.clientY;return 180*Math.atan2(n,i)/Math.PI}function qn(e,t){return e===t?In.None:Math.abs(e)>=Math.abs(t)?e<0?In.Left:In.Right:t<0?In.Up:In.Down}function Zn(e,t,i){return{x:t/e||0,y:i/e||0}}function Yn(e,t){const{session:i}=e,{pointers:n}=t,{length:r}=n;i.firstInput||(i.firstInput=Gn(t)),r>1&&!i.firstMultiple?i.firstMultiple=Gn(t):1===r&&(i.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=i,a=o?o.center:s.center,l=t.center=Vn(n);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=function(e,t){const i=t.x-e.x,n=t.y-e.y;return 180*Math.atan2(n,i)/Math.PI}(a,l),t.distance=Wn(a,l);const{deltaX:c,deltaY:u}=function(e,t){const i=t.center;let n=e.offsetDelta,r=e.prevDelta;const s=e.prevInput;return t.eventType!==Pn.Start&&(null===s||void 0===s?void 0:s.eventType)!==Pn.End||(r=e.prevDelta={x:(null===s||void 0===s?void 0:s.deltaX)||0,y:(null===s||void 0===s?void 0:s.deltaY)||0},n=e.offsetDelta={x:i.x,y:i.y}),{deltaX:r.x+(i.x-n.x),deltaY:r.y+(i.y-n.y)}}(i,t);t.deltaX=c,t.deltaY=u,t.offsetDirection=qn(t.deltaX,t.deltaY);const h=Zn(t.deltaTime,t.deltaX,t.deltaY);var d,p;t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=Math.abs(h.x)>Math.abs(h.y)?h.x:h.y,t.scale=o?(d=o.pointers,Hn((p=n)[0],p[1])/Hn(d[0],d[1])):1,t.rotation=o?function(e,t){return Xn(t[1],t[0])-Xn(e[1],e[0])}(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length;let m=e.element;return function(e,t){let i=e;for(;i;){if(i===t)return!0;i=i.parentNode}return!1}(t.srcEvent.target,m)&&(m=t.srcEvent.target),t.target=m,function(e,t){const i=e.lastInterval||t,n=t.timeStamp-i.timeStamp;let r,s,o,a;if(t.eventType!==Pn.Cancel&&(n>25||void 0===i.velocity)){const l=t.deltaX-i.deltaX,c=t.deltaY-i.deltaY,u=Zn(n,l,c);s=u.x,o=u.y,r=Math.abs(u.x)>Math.abs(u.y)?u.x:u.y,a=qn(l,c),e.lastInterval=t}else r=i.velocity,s=i.velocityX,o=i.velocityY,a=i.direction;t.velocity=r,t.velocityX=s,t.velocityY=o,t.direction=a}(i,t),t}class Kn{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){!function(e,t,i){const n=i.pointers.length,r=i.changedPointers.length,s=t&Pn.Start&&n-r===0,o=t&(Pn.End|Pn.Cancel)&&n-r===0;i.isFirst=Boolean(s),i.isFinal=Boolean(o),s&&(e.session={}),i.eventType=t;const a=Yn(e,i);e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}(this.manager,e,t)}init(){Nn(this.element,this.evEl,this.domHandler),Nn(this.target,this.evTarget,this.domHandler),Nn(jn(this.element),this.evWin,this.domHandler)}destroy(){Un(this.element,this.evEl,this.domHandler),Un(this.target,this.evTarget,this.domHandler),Un(jn(this.element),this.evWin,this.domHandler)}}const Jn={pointerdown:Pn.Start,pointermove:Pn.Move,pointerup:Pn.End,pointercancel:Pn.Cancel,pointerout:Pn.Cancel};class $n extends Kn{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let i=!1;const n=Jn[e.type],r=e.pointerType,s="touch"===r;let o=t.findIndex(t=>t.pointerId===e.pointerId);n&Pn.Start&&(e.buttons||s)?o<0&&(t.push(e),o=t.length-1):n&(Pn.End|Pn.Cancel)&&(i=!0),o<0||(t[o]=e,this.callback(n,{pointers:t,changedPointers:[e],eventType:n,pointerType:r,srcEvent:e}),i&&t.splice(o,1))}}const Qn=["","webkit","Moz","MS","ms","o"];function er(e,t){const i=t[0].toUpperCase()+t.slice(1);for(const n of Qn){const r=n?n+i:t;if(r in e)return r}}const tr={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class ir{constructor(e,t){this.options=(0,r.A)((0,r.A)((0,r.A)({},tr),t),{},{cssProps:(0,r.A)((0,r.A)({},tr.cssProps),t.cssProps),inputTarget:t.inputTarget||e}),this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new $n(this),this.touchAction=new Bn(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let i;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:n}=this;let{curRecognizer:r}=t;(!r||r&&r.state&kn.Recognized)&&(r=t.curRecognizer=null);let s=0;for(;s<n.length;)i=n[s],2===t.stopped||r&&i!==r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&i.state&(kn.Began|kn.Changed|kn.Ended)&&(r=t.curRecognizer=i),s++}get(e){const{recognizers:t}=this;for(let i=0;i<t.length;i++)if(t[i].options.event===e)return t[i];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"===typeof e?this.get(e):e;if(t){const{recognizers:e}=this,i=e.indexOf(t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:i}=this;for(const n of zn(e))i[n]=i[n]||[],i[n].push(t)}off(e,t){if(!e)return;const{handlers:i}=this;for(const n of zn(e))t?i[n]&&i[n].splice(i[n].indexOf(t),1):delete i[n]}emit(e,t){const i=this.handlers[e]&&this.handlers[e].slice();if(!i||!i.length)return;const n=t;n.type=e,n.preventDefault=function(){t.srcEvent.preventDefault()};let r=0;for(;r<i.length;)i[r](n),r++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[i,n]of Object.entries(this.options.cssProps)){const r=er(t.style,i);e?(this.oldCssProps[r]=t.style[r],t.style[r]=n):t.style[r]=this.oldCssProps[r]||""}e||(this.oldCssProps={})}}}let nr=1;function rr(e){return e&kn.Cancelled?"cancel":e&kn.Ended?"end":e&kn.Changed?"move":e&kn.Began?"start":""}class sr{constructor(e){this.options=e,this.id=nr++,this.state=kn.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error("Cannot find recognizer ".concat(e))}else t=e;const{simultaneous:i}=this;return i[t.id]||(i[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"===typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error("Cannot find recognizer ".concat(e))}else t=e;const{requireFail:i}=this;return-1===i.indexOf(t)&&(i.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"===typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(e=>e.options.enable))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<kn.Ended&&this.manager.emit(this.options.event+rr(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=kn.Ended&&this.manager.emit(this.options.event+rr(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=kn.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(kn.Failed|kn.Possible)))return!1;e++}return!0}recognize(e){const t=(0,r.A)({},e);if(!this.options.enable)return this.reset(),void(this.state=kn.Failed);this.state&(kn.Recognized|kn.Cancelled|kn.Failed)&&(this.state=kn.Possible),this.state=this.process(t),this.state&(kn.Began|kn.Changed|kn.Ended|kn.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class or extends sr{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:i}=e,n=t&(kn.Began|kn.Changed),r=this.attrTest(e);return n&&(i&Pn.Cancel||!r)?t|kn.Cancelled:n||r?i&Pn.End?t|kn.Ended:t&kn.Began?t|kn.Changed:kn.Began:kn.Failed}}class ar extends sr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((0,r.A)({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e)),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Rn]}process(e){const{options:t}=this,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&Pn.Start&&0===this.count)return this.failTimeout();if(n&&r&&i){if(e.eventType!==Pn.End)return this.failTimeout();const i=!this.pTime||e.timeStamp-this.pTime<t.interval,n=!this.pCenter||Wn(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,n&&i?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=kn.Recognized,this.tryEmit(this._input)},t.interval),kn.Began):kn.Recognized}return kn.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=kn.Failed},this.options.interval),kn.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===kn.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const lr=["","start","move","end","cancel","up","down","left","right"];class cr extends or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((0,r.A)({enable:!0,pointers:1,event:"pan",threshold:10,direction:In.All},e)),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&In.Horizontal&&t.push(On),e&In.Vertical&&t.push(Ln),t}getEventNames(){return lr.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let i=!0,{distance:n}=e,{direction:r}=e;const s=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&In.Horizontal?(r=0===s?In.None:s<0?In.Left:In.Right,i=s!==this.pX,n=Math.abs(e.deltaX)):(r=0===o?In.None:o<0?In.Up:In.Down,i=o!==this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&Boolean(r&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&kn.Began)||!(this.state&kn.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=In[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const ur=["","start","move","end","cancel","in","out"];class hr{constructor(e,t,i){this.element=e,this.callback=t,this.options=i}}const dr="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",pr=("undefined"!==typeof window?window:i.g,"undefined"!==typeof i.g?i.g:window,"undefined"!==typeof document&&document,-1!==dr.indexOf("firefox")),mr=4.000244140625;class fr extends hr{constructor(e,t,i){super(e,t,(0,r.A)({enable:!0},i)),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(pr&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%mr===0&&(t=Math.floor(t/mr)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const gr=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class _r extends hr{constructor(e,t,i){super(e,t,(0,r.A)({enable:!0},i)),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:n}=this.options;this.enableMoveEvent=n,this.enableLeaveEvent=n,this.enableEnterEvent=n,this.enableOutEvent=n,this.enableOverEvent=n,gr.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){gr.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const vr=["keydown","keyup"];class yr extends hr{constructor(e,t,i){super(e,t,(0,r.A)({enable:!0,tabIndex:0},i)),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",vr.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){vr.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}class br extends hr{constructor(e,t,i){super(e,t,i),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}const xr={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const wr={srcElement:"root",priority:0};class Er{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:o,handlersByElement:a}=this,l=(0,r.A)((0,r.A)({},wr),i);let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:t,srcElement:l.srcElement,priority:l.priority};n&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let h=c.length-1;for(;h>=0&&!(c[h].priority>=u.priority);)h--;c.splice(h+1,0,u)}remove(e,t){const{handlers:i,handlersByElement:n}=this;for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.type===e&&s.handler===t){i.splice(r,1);const e=n.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&n.delete(s.srcElement)}}this._active=i.some(e=>!e.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let t=!1;const n=()=>{e.handled=!0},s=()=>{e.handled=!0,t=!0},o=[];for(let a=0;a<i.length;a++){const{type:l,handler:c,once:u}=i[a];if(c((0,r.A)((0,r.A)({},e),{},{type:l,stopPropagation:n,stopImmediatePropagation:s})),u&&o.push(i[a]),t)break}for(let e=0;e<o.length;e++){const{type:t,handler:i}=o[e];this.remove(t,i)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},e),function(e){const t=xr[e.srcEvent.type];if(!t)return null;const{buttons:i,button:n}=e.srcEvent;let r=!1,s=!1,o=!1;return 2===t?(r=Boolean(1&i),s=Boolean(4&i),o=Boolean(2&i)):(r=0===n,s=1===n,o=2===n),{leftButton:r,middleButton:s,rightButton:o}}(e)),function(e,t){const i=e.center;if(!i)return null;const n=t.getBoundingClientRect(),r=n.width/t.offsetWidth||1,s=n.height/t.offsetHeight||1;return{center:i,offsetCenter:{x:(i.x-n.left-t.clientLeft)/r,y:(i.y-n.top-t.clientTop)/s}}}(e,t)),{},{preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t})}}function Ar(e){if("recognizer"in e)return e;let t;const i=Array.isArray(e)?[...e]:[e];if("function"===typeof i[0]){t=new(i.shift())(i.shift()||{})}else t=i.shift();return{recognizer:t,recognizeWith:"string"===typeof i[0]?[i[0]]:i[0],requireFailure:"string"===typeof i[1]?[i[1]]:i[1]}}class Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options=(0,r.A)({recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{}},t),this.events=new Map,this.element=e,e){this.manager=new ir(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:i,requireFailure:n}=Ar(e);this.manager.add(t),i&&t.recognizeWith(i),n&&t.requireFailure(n)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new fr(e,this._onOtherEvent,{enable:!1}),this.moveInput=new _r(e,this._onOtherEvent,{enable:!1}),this.keyInput=new yr(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new br(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){var i,n,r,s;const{manager:o}=this;if(!o)return;const a=o.get(e);a&&(a.set({enable:t}),o.touchAction.update()),null===(i=this.wheelInput)||void 0===i||i.enableEventType(e,t),null===(n=this.moveInput)||void 0===n||n.enableEventType(e,t),null===(r=this.keyInput)||void 0===r||r.enableEventType(e,t),null===(s=this.contextmenuInput)||void 0===s||s.enableEventType(e,t)}_addEventHandler(e,t,i,n,r){if("string"!==typeof e){i=t;for(const[t,s]of Object.entries(e))this._addEventHandler(t,s,i,n,r);return}const{manager:s,events:o}=this;if(!s)return;let a=o.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new Er(this,t),o.set(e,a),s&&s.on(e,a.handleEvent)}a.add(e,t,i,n,r),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const[t,i]of Object.entries(e))this._removeEventHandler(t,i);return}const{events:i}=this,n=i.get(e);if(n&&(n.remove(e,t),n.isEmpty())){const{recognizerName:e}=n;let t=!1;for(const n of i.values())if(n.recognizerName===e&&!n.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){var t;return null===(t=this.manager.recognizers.find(t=>t.getEventNames().includes(e)))||void 0===t?void 0:t.options.event}}const Dr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Dr,"IDENTITY",{get:()=>(he.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Sr={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Cr={common:0,meters:1,pixels:2},Pr={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},Ir={multipan:[cr,{threshold:10,direction:In.Vertical,pointers:2}],pinch:[class extends or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((0,r.A)({enable:!0,event:"pinch",threshold:0,pointers:2},e))}getTouchAction(){return[Fn]}getEventNames(){return ur.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&kn.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}},{},null,["multipan"]],pan:[cr,{threshold:1},["pinch"],["multipan"]],dblclick:[ar,{event:"dblclick",taps:2}],click:[ar,{event:"click"},null,["dblclick"]]},kr=Math.PI/180,Mr=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Rr=[0,0,0],Fr={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Lr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Fr,this.focalDistance=e.focalDistance||1,this.position=e.position||Rr,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Sr.WEB_MERCATOR:Sr.WEB_MERCATOR_AUTO_OFFSET:Sr.IDENTITY}equals(e){return e instanceof Lr&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&hi(e.projectionMatrix,this.projectionMatrix)&&hi(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=An(this.projectPosition(e),this.pixelProjectionMatrix),[n,r]=i,s=t?r:this.height-r;return 2===e.length?[n,s]:[n,s,i[2]]}unproject(e){let{topLeft:t=!0,targetZ:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[n,r,s]=e,o=t?r:this.height-r,a=i&&i*this.distanceScales.unitsPerMeter[2],l=Tn([n,o,s],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(s)?[c,u,h]:Number.isFinite(i)?[c,u,i]:[c,u]}projectPosition(e){const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=fn(e);return t[1]=ci(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?gn(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),i=this.unproject([this.width,0],e),n=this.unproject([0,this.height],e),r=this.unproject([this.width,this.height],e);return[Math.min(t[0],i[0],n[0],r[0]),Math.min(t[1],i[1],n[1],r[1]),Math.max(t[0],i[0],n[0],r[0]),Math.max(t[1],i[1],n[1],r[1])]}getDistanceScales(e){return e&&this.isGeospatial?yn({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:i,width:n=1,height:r=1}=e;return t<this.x+this.width&&this.x<t+n&&i<this.y+this.height&&this.y<i+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Ci((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:Ci(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:Ci(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:Ci(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:Ci(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:Ci(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=_n({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||yn({latitude:i,longitude:t}));const n=Math.pow(2,this.zoom);this.scale=n;const{position:r,modelMatrix:s}=e;let o=Rr;if(r&&(o=s?new Ji(s).transformAsVector(r,[]):r),this.isGeospatial){const e=this.projectPosition([t,i,0]);this.center=new Di(o).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=Mr,projectionMatrix:i=null,orthographic:n=!1,fovyRadians:r,fovy:s=75,near:o=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new Ji).multiplyRight(t).translate(new Di(this.center).negate()),this.projectionMatrix=i||function(e){let{width:t,height:i,orthographic:n,fovyRadians:r,focalDistance:s,padding:o,near:a,far:l}=e;const c=t/i,u=n?(new Ji).orthographic({fovy:r,aspect:c,focalDistance:s,near:a,far:l}):(new Ji).perspective({fovy:r,aspect:c,near:a,far:l});if(o){const{left:e=0,right:n=0,top:r=0,bottom:s=0}=o,a=ci((e+t-n)/2,0,t)-t/2,l=ci((r+i-s)/2,0,i)-i/2;u[8]-=2*a/t,u[9]+=2*l/i}return u}({width:this.width,height:this.height,orthographic:n,fovyRadians:r||s*kr,focalDistance:c,padding:l,near:o,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;Li(u,u,this.projectionMatrix),Li(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=Fi([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Bi(d,d,[this.width/2,-this.height/2,1]),Oi(d,d,[1,-1,0]),Li(p,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=Fi([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||he.warn("Pixel project matrix not invertible")()}}Lr.displayName="Viewport";const Or=Lr;class Br{constructor(e,t){var i;this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{me("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:n,stats:r,viewport:s,timeline:o}=t||{};this.layers=[],this.resourceManager=new ri({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:null===e||void 0===e?void 0:e.gl,deck:n,shaderAssembler:Y((null===e||void 0===e||null===(i=e.info)||void 0===i?void 0:i.shadingLanguage)||"glsl"),defaultShaderModules:[J],renderPass:void 0,stats:r||new ve.A({id:"deck.gl"}),viewport:s||new Or({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new l,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const n=i.getNeedsRedraw(e);t=t||n}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter(t=>e.find(e=>0===t.id.indexOf(e))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){me("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const i=fe(e,Boolean);for(const n of i)n.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(t=>t.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,i=t.findIndex(t=>t.name===e.name);i>=0&&(t.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const s of e)i[s.id]?he.warn("Multiple old layers with same id ".concat(s.id))():i[s.id]=s;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const n=[];this._updateSublayersRecursively(t,i,n),this._finalizeOldLayers(i);let r=!1;for(const s of n)if(s.hasUniformTransition()){r="Uniform transition in ".concat(s);break}this._needsUpdate=r,this.layers=n}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const e=t[r.id];null===e&&he.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let s=null;try{this._debug&&e!==r&&r.validateProps(),e?(this._transferLayerState(e,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),s=r.isComposite?r.getSubLayers():null}catch(n){this._handleError("matching",n,r)}s&&this._updateSublayersRecursively(s,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=ee}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=Q,t!==e&&(e.lifecycle=te)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=ie;try{e._finalize(),e.lifecycle=ne}catch(t){this._handleError("finalization",t,e)}}}function zr(e,t,i){if(e===t)return!0;if(!i||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!zr(e[n],t[n],i-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){if(!t.hasOwnProperty(s))return!1;if(!zr(e[s],t[s],i-1))return!1}return!0}return!1}class Nr{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"===typeof e?this.getView(e):e,i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),n={x:e[0],y:e[1]};for(let r=i.length-1;r>=0;--r){const s=i[r];if(s.containsPixel(n)){const i=e.slice();return i[0]-=s.x,i[1]-=s.y,s.unproject(i,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=fe(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!zr(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else he.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>{var i;return null===(i=this.getView(e.id))||void 0===i?void 0:i.makeViewport({viewState:t,width:this.width,height:this.height})}})}_updateController(e,t,i,n){const s=e.controller;if(s&&i){const o=(0,r.A)((0,r.A)((0,r.A)({},t),s),{},{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height});return n&&n.constructor===s.type||(n=this._createController(e,o)),n&&n.setProps(o),n}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let n=e.length;n--;){const r=e[n],s=this.getViewState(r),o=r.makeViewport({viewState:s,width:this.width,height:this.height});let a=t[r.id];const l=Boolean(r.controller);l&&!a&&(i=!0),!i&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,s,o,a),o&&this._viewports.unshift(o)}for(const n in t){const e=t[n];e&&!this.controllers[n]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,n)=>!e[n].equals(t[n]))}}const Ur=/([0-9]+\.?[0-9]*)(%|px)/;function jr(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=Ur.exec(e);if(t&&t.length>=3){const e="%"===t[2],i=parseFloat(t[1]);return{position:e?i/100:i,relative:e}}default:throw new Error("Could not parse position string ".concat(e))}}function Vr(e,t){return e.relative?Math.round(e.position*t):e.position}class Gr{constructor(e){const{id:t,x:i=0,y:n=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=t||this.constructor.displayName||"view",this.props=(0,r.A)((0,r.A)({},e),{},{id:this.id}),this._x=jr(i),this._y=jr(n),this._width=jr(s),this._height=jr(o),this._padding=a&&{left:jr(a.left||0),right:jr(a.right||0),top:jr(a.top||0),bottom:jr(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.constructor===e.constructor&&zr(this.props,e.props,2)}clone(e){return new(0,this.constructor)((0,r.A)((0,r.A)({},this.props),e))}makeViewport(e){let{width:t,height:i,viewState:n}=e;n=this.filterViewState(n);const s=this.getDimensions({width:t,height:i});if(!s.height||!s.width)return null;return new(this.getViewportType(n))((0,r.A)((0,r.A)((0,r.A)({},n),this.props),s))}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=(0,r.A)({},e);for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:i}=e;const n={x:Vr(this._x,t),y:Vr(this._y,i),width:Vr(this._width,t),height:Vr(this._height,i)};return this._padding&&(n.padding={left:Vr(this._padding.left,t),top:Vr(this._padding.top,i),right:Vr(this._padding.right,t),bottom:Vr(this._padding.bottom,i)}),n}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:(0,r.A)({type:this.ControllerType},e):null}}class Wr extends Or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:i=0,zoom:n=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:h=!1,projectionMatrix:d,repeat:p=!1,worldOffset:m=0,position:f,padding:g,legacyMeterSizes:_=!1}=e;let{width:v,height:y,altitude:b=1.5}=e;const x=Math.pow(2,n);let w;v=v||1,y=y||1;let E=null;if(d)b=d[5]/2,w=wn(b);else{let i;if(e.fovy?(w=e.fovy,b=En(w)):w=wn(b),g){const{top:e=0,bottom:t=0}=g;i=[0,ci((e+y-t)/2,0,y)-y/2]}E=xn({width:v,height:y,scale:x,center:f&&[0,0,f[2]*vn(t)],offset:i,pitch:s,fovy:w,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(E.near=c),Number.isFinite(u)&&(E.far=u)}let A=function(e){const{height:t,pitch:i,bearing:n,altitude:r,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Oi(a,a,[0,0,-r]),zi(a,a,-i*cn),Ni(a,a,n*cn);const l=s/t;return Bi(a,a,[l,l,l]),o&&Oi(a,a,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),a}({height:y,pitch:s,bearing:o,scale:x,altitude:b});if(m){A=(new Ji).translate([512*m,0,0]).multiplyLeft(A)}super((0,r.A)((0,r.A)((0,r.A)({},e),{},{width:v,height:y,viewMatrix:A,longitude:i,latitude:t,zoom:n},E),{},{fovy:w,focalDistance:b})),this.latitude=t,this.longitude=i,this.zoom=n,this.pitch=s,this.bearing=o,this.altitude=b,this.fovy=w,this.orthographic=h,this._subViewports=p?[]:null,this._pseudoMeters=_,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let n=t;n<=i;n++){const e=n?new Wr((0,r.A)((0,r.A)({},this),{},{worldOffset:n})):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*vn(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)/vn(i)]}addMetersToLngLat(e,t){return bn(e,t)}panByPosition(e,t){const i=Tn(t,this.pixelUnprojectionMatrix),n=Vi([],this.projectFlat(e),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],i)),r=Vi([],this.center,n),[s,o]=this.unprojectFlat(r);return{longitude:s,latitude:o}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:i,height:n,unproject:r}=e,s={targetZ:t},o=r([0,n],s),a=r([i,n],s);let l,c;return(e.fovy?.5*e.fovy*Sn:Math.atan(.5/e.altitude))>(90-e.pitch)*Sn-.01?(l=Cn(e,0,t),c=Cn(e,i,t)):(l=r([0,0],s),c=r([i,0],s)),[o,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:i,height:n}=this,{longitude:s,latitude:o,zoom:a}=Dn((0,r.A)({width:i,height:n,bounds:e},t));return new Wr({width:i,height:n,longitude:s,latitude:o,zoom:a})}}Wr.displayName="WebMercatorViewport";const Hr=Wr;class Xr{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var t,i;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(i=this.settings).onStart)||void 0===t||t.call(i,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const qr=()=>{},Zr=2,Yr=3,Kr=e=>e,Jr=1;class $r{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:i,startProps:n,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(n,s,l);this.propsInTransition=this.getControllerState((0,r.A)((0,r.A)({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Xr(e.timeline),this.onViewStateChange=e.onViewStateChange||qr,this.onStateChange=e.onStateChange||qr}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let n=i;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;n=(0,r.A)((0,r.A)({},i),e===Zr?t:this.propsInTransition||i)}this._triggerTransition(n,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===Yr||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=this.getControllerState(e),n=this.getControllerState(t).shortestPathFrom(i),r=t.transitionInterpolator,s=r.getDuration?r.getDuration(e,t):t.transitionDuration;if(0===s)return;const o=r.initializeProps(e,n);this.propsInTransition={};const a={duration:s,easing:t.transitionEasing||Kr,interpolator:r,interruption:t.transitionInterruption||Jr,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null===e||void 0===e||e(t)}}}function Qr(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class es{constructor(e){const{compare:t,extract:i,required:n}=e;this._propsToCompare=t,this._propsToExtract=i||t,this._requiredProps=n}arePropsEqual(e,t){for(const i of this._propsToCompare)if(!(i in e)||!(i in t)||!hi(e[i],t[i]))return!1;return!0}initializeProps(e,t){const i={},n={};for(const r of this._propsToExtract)(r in e||r in t)&&(i[r]=e[r],n[r]=t[r]);return this._checkRequiredProps(i),this._checkRequiredProps(n),{start:i,end:n}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const i=e[t];Qr(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}const ts=["longitude","latitude","zoom","bearing","pitch"],is=["longitude","latitude","zoom"];class ns extends es{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:ts,required:is},super(i.transitionProps),this.opts=i}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:n,around:r}=this.opts;if(n&&r){const s=n(e),o=n(t),a=s.unproject(r);i.start.around=r,Object.assign(i.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const n={};for(const r of this._propsToExtract)n[r]=ui(e[r]||0,t[r]||0,i);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport((0,r.A)((0,r.A)({},t),n));Object.assign(n,s.panByPosition(t.aroundPosition,ui(e.around,t.around,i)))}return n}}const rs={transitionDuration:0},ss=e=>1-(1-e)*(1-e),os=["wheel"],as=["panstart","panmove","panend"],ls=["pinchstart","pinchmove","pinchend"],cs=["multipanstart","multipanmove","multipanend"],us=["dblclick"],hs=["keydown"],ds={};class ps{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new $r((0,r.A)((0,r.A)({},e),{},{getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return!t&&this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState((0,r.A)((0,r.A)({makeViewport:this.makeViewport},this.props),this.state)),this._controllerState}getCenter(e){const{x:t,y:i}=this.props,{offsetCenter:n}=e;return[n.x-t,n.y-i]}isPointInBounds(e,t){const{width:i,height:n}=this.props;if(t&&t.handled)return!1;const r=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=n;return r&&t&&t.stopPropagation(),r}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:i=!0,dragPan:n=!0,dragRotate:r=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(os,c&&i),this.toggleEvents(as,c),this.toggleEvents(ls,c&&(o||a)),this.toggleEvents(cs,c&&a),this.toggleEvents(us,c&&s),this.toggleEvents(hs,c&&l),this.scrollZoom=i,this.dragPan=n,this.dragRotate=r,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))})}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=(0,r.A)((0,r.A)({},e.getViewportProps()),t),s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:n,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange((0,r.A)((0,r.A)({},e),{},{interactionState:this._interactionState,viewId:this.props.id}))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const n=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(n,rs,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,rs,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),n=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],s=this.controllerState.pan({pos:n}).panEnd();this.updateViewport(s,(0,r.A)((0,r.A)({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:ss}),{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,rs,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),n=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],s=this.controllerState.rotate({pos:n}).rotateEnd();this.updateViewport(s,(0,r.A)((0,r.A)({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:ss}),{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:n=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=n?(0,r.A)((0,r.A)({},this._getTransitionProps({around:t})),{},{transitionDuration:250}):rs,l=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(l,a,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,rs,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,rs,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),n=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:n});this.updateViewport(s,(0,r.A)((0,r.A)({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:ss}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return ds._startPinchRotation=e.rotation,ds._lastPinchEvent=e,this.updateViewport(i,rs,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,n=this.getCenter(e);t=t.zoom({pos:n,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:ds._startPinchRotation-i})}return this.updateViewport(t,rs,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ds._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:i}=ds;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const n=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:n,scale:l}).zoomEnd(),this.updateViewport(s,(0,r.A)((0,r.A)({},this._getTransitionProps({around:n})),{},{transitionDuration:t,transitionEasing:ss}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ds._startPinchRotation=null,ds._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),n=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(n,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:n,rotateSpeedX:r,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(i).zoomOut(i):o.zoomOut(i),l.isZooming=!0;break;case"Equal":a=t?o.zoomIn(i).zoomIn(i):o.zoomIn(i),l.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(r),l.isRotating=!0):(a=o.moveLeft(n),l.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(r),l.isRotating=!0):(a=o.moveRight(n),l.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(s),l.isRotating=!0):(a=o.moveUp(n),l.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(s),l.isRotating=!0):(a=o.moveDown(n),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?(0,r.A)((0,r.A)({},t),{},{transitionInterpolator:new ns((0,r.A)((0,r.A)((0,r.A)({},e),t.transitionInterpolator.opts),{},{makeViewport:this.controllerState.makeViewport}))}):t:rs}}class ms{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class fs extends ms{constructor(e){const{width:t,height:i,latitude:n,longitude:r,zoom:s,bearing:o=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:h=0,maxPitch:d=60,minPitch:p=0,startPanLngLat:m,startZoomLngLat:f,startRotatePos:g,startBearing:_,startPitch:v,startZoom:y,normalize:b=!0}=e;Qr(Number.isFinite(r)),Qr(Number.isFinite(n)),Qr(Number.isFinite(s)),super({width:t,height:i,latitude:n,longitude:r,zoom:s,bearing:o,pitch:a,altitude:l,maxZoom:u,minZoom:h,maxPitch:d,minPitch:p,normalize:b,position:c},{startPanLngLat:m,startZoomLngLat:f,startRotatePos:g,startBearing:_,startPitch:v,startZoom:y}),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:i}=e;const n=this.getState().startPanLngLat||this._unproject(i);if(!n)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:i=0,deltaAngleY:n=0}=e;const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||void 0===s||void 0===o)return this;let a;return a=t?this._getNewRotation(t,r,o,s):{bearing:s+i,pitch:o+n},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:i,scale:n}=e,{startZoom:s,startZoomLngLat:o}=this.getState();if(o||(s=this.getViewportProps().zoom,o=this._unproject(i)||this._unproject(t)),!o)return this;const{maxZoom:a,minZoom:l}=this.getViewportProps();let c=s+Math.log2(n);c=ci(c,l,a);const u=this.makeViewport((0,r.A)((0,r.A)({},this.getViewportProps()),{},{zoom:c}));return this._getUpdatedState((0,r.A)({zoom:c},u.panByPosition(o,t)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=(0,r.A)({},this.getViewportProps()),{bearing:n,longitude:s}=i;return Math.abs(n-t.bearing)>180&&(i.bearing=n<0?n+360:n-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:n}=e;e.zoom=ci(n,i,t);const{maxPitch:r,minPitch:s,pitch:o}=e;e.pitch=ci(o,s,r);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:i,pitch:n=0}=e;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=e;(r<-180||r>180)&&(r=nn(r+180,360)-180),(a<-180||a>180)&&(a=nn(a+180,360)-180);const l=sn(i/512);if(o<=l)o=l,s=0;else{const e=i/2/Math.pow(2,o),t=gn([0,e])[1];if(s<t)s=t;else{const t=gn([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:i,longitude:r,latitude:s,zoom:o,pitch:n,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor((0,r.A)((0,r.A)((0,r.A)({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),e))}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,i,n){const r=e[0]-t[0],s=e[1]-t[1],o=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=r/l;let h=0;s>0?Math.abs(c-a)>5&&(h=s/(a-c)*1.2):s<0&&a>5&&(h=1-o/a),h=ci(h,-1,1);const{minPitch:d,maxPitch:p}=this.getViewportProps();let m=i;return h>0?m=i+h*(p-i):h<0&&(m=i-h*(d-i)),{pitch:m,bearing:n+180*u}}}class gs extends ps{constructor(){super(...arguments),this.ControllerState=fs,this.transition={transitionDuration:300,transitionInterpolator:new ns({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState((0,r.A)((0,r.A)({makeViewport:this.makeViewport},e),this.state)))}}class _s extends Gr{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getViewportType(){return Hr}get ControllerType(){return gs}}_s.displayName="MapView";const vs=_s,ys=[255,255,255],bs=1;let xs=0;class ws{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="ambient";const{color:t=ys}=e,{intensity:i=bs}=e;this.id=e.id||"ambient-".concat(xs++),this.color=t,this.intensity=i}}const Es=[255,255,255],As=1,Ts=[0,0,-1];let Ds=0;class Ss{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="directional";const{color:t=Es}=e,{intensity:i=As}=e,{direction:n=Ts}=e,{_shadow:r=!1}=e;this.id=e.id||"directional-".concat(Ds++),this.color=t,this.intensity=i,this.type="directional",this.direction=new Di(n).normalize().toArray(),this.shadow=r}getProjectedLight(e){return this}}class Cs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};const{id:i}=t;this.id=i,this.device=e,this.props=(0,r.A)({},t)}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Ps extends Cs{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){var t,i,n;const[r,s]=this.device.canvasContext.getDrawingBufferSize(),o=null===(t=e.clearCanvas)||void 0===t||t,a=null!==(i=e.clearColor)&&void 0!==i?i:!!o&&[0,0,0,0],l=!!o&&1,c=!!o&&0,u=null!==(n=e.colorMask)&&void 0!==n?n:15,h={viewport:[0,0,r,s]};e.colorMask&&(h.colorMask=u),e.scissorRect&&(h.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:h,clearColor:a,clearDepth:l,clearStencil:c});try{return this._drawLayers(d,e)}finally{d.end(),this.device.submit()}}_drawLayers(e,t){const{target:i,shaderModuleProps:n,viewports:r,views:s,onViewportActive:o,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const l=[];for(const c of r){const r=s&&s[c.id];null===o||void 0===o||o(c);const a=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const s of u){const o=this._drawLayersInViewport(e,{target:i,shaderModuleProps:n,viewport:s,view:r,pass:t.pass,layers:t.layers},a);l.push(o)}}return l}_getDrawLayerParams(e,t){let{layers:i,pass:n,isPicking:s=!1,layerFilter:o,cullRect:a,effects:l,shaderModuleProps:c}=t,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const h=[],d=Is(this._lastRenderIndex+1),p={layer:i[0],viewport:e,isPicking:s,renderPass:n,cullRect:a},m={};for(let g=0;g<i.length;g++){const t=i[g],s=this._shouldDrawLayer(t,p,o,m),a={shouldDrawLayer:s};var f;if(s&&!u)a.shouldDrawLayer=!0,a.layerRenderIndex=d(t,s),a.shaderModuleProps=this._getShaderModuleProps(t,l,n,c),a.layerParameters=(0,r.A)((0,r.A)({},null===(f=t.context.deck)||void 0===f?void 0:f.props.parameters),this.getLayerParameters(t,g,e));h[g]=a}return h}_drawLayersInViewport(e,t,i){let{layers:n,shaderModuleProps:r,pass:s,target:o,viewport:a,view:l}=t;const c=function(e,t){var i,n;let{shaderModuleProps:r,target:s,viewport:o}=t;const a=null!==(i=null===r||void 0===r||null===(n=r.project)||void 0===n?void 0:n.devicePixelRatio)&&void 0!==i?i:e.canvasContext.cssToDeviceRatio(),[,l]=e.canvasContext.getDrawingBufferSize(),c=s?s.height:l,u=o;return[u.x*a,c-(u.y+u.height)*a,u.width*a,u.height*a]}(this.device,{shaderModuleProps:r,target:o,viewport:a});if(l){const{clear:e,clearColor:t,clearDepth:i,clearStencil:n}=l.props;if(e){let e=[0,0,0,0],r=1,s=0;Array.isArray(t)?e=[...t.slice(0,3),t[3]||255].map(e=>e/255):!1===t&&(e=!1),void 0!==i&&(r=i),void 0!==n&&(s=n);this.device.beginRenderPass({framebuffer:o,parameters:{viewport:c,scissorRect:c},clearColor:e,clearDepth:r,clearStencil:s}).end()}}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let d=0;d<n.length;d++){const t=n[d],r=i[d],{shouldDrawLayer:o}=r;if(o&&t.props.pickable&&u.pickableCount++,t.isComposite&&u.compositeCount++,t.isDrawable&&r.shouldDrawLayer){const{layerRenderIndex:i,shaderModuleProps:n,layerParameters:o}=r;u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,i),n.project&&(n.project.viewport=a),t.context.renderPass=e;try{t._drawLayer({renderPass:e,shaderModuleProps:n,uniforms:{layerIndex:i},parameters:o})}catch(h){t.raiseError(h,"drawing ".concat(t," to ").concat(s))}}}return u}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,i){return null}getLayerParameters(e,t,i){return e.props.parameters}_shouldDrawLayer(e,t,i,n){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let r=e.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(t))return!1;t.layer=r,r=r.parent}if(i){const e=t.layer.id;if(e in n||(n[e]=i(t)),!n[e])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,i,n){var r;const s=this.device.canvasContext.cssToDeviceRatio(),o=(null===(r=e.internalState)||void 0===r?void 0:r.propsInTransition)||e.props,a={layer:o,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:o.modelMatrix,coordinateSystem:o.coordinateSystem,coordinateOrigin:o.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const c of t){var l;ks(a,null===(l=c.getShaderModuleProps)||void 0===l?void 0:l.call(c,e,a))}return ks(a,this.getShaderModuleProps(e,t,a),n)}}function Is(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={},n=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in t)&&n(r.parent,!1),l in i){const e=i[l]=i[l]||Is(t[l],t);c=e(r,s),i[a]=e}else Number.isFinite(o)?(c=o+(t[l]||0),i[a]=null):c=e;return s&&c>=e&&(e=c+1),t[a]=c,c};return n}function ks(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(const r of i)if(r)for(const t in r)e[t]?Object.assign(e[t],r[t]):e[t]=r[t];return e}class Ms extends Ps{constructor(e,t){super(e,t);const i=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),n=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[i],depthStencilAttachment:n})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),n=e.viewports[0],s=n.width*i,o=n.height*i;s===t.width&&o===t.height||t.resize({width:s,height:o}),super.render((0,r.A)((0,r.A)({},e),{},{clearColor:[1,1,1,1],target:t,pass:"shadow"}))}getLayerParameters(e,t,i){return(0,r.A)((0,r.A)({},e.props.parameters),{},{blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getShaderModuleProps(e,t,i){return{shadow:{project:i.project,drawToShadowMap:!0}}}}const Rs={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"};function Fs(e,t){if(e===t)return!0;if(Array.isArray(e)){const i=e.length;if(!t||t.length!==i)return!1;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}return!1}function Ls(e){let t,i={};return n=>{for(const r in n)if(!Fs(n[r],i[r])){t=e(n),i=n;break}return t}}const Os=[0,0,0,0],Bs=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],zs=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ns=[0,0,0],Us=[0,0,0],js=Ls(function(e){let{viewport:t,devicePixelRatio:i,coordinateSystem:n,coordinateOrigin:r}=e;const{projectionCenter:s,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(e,t,i){const{viewMatrixUncentered:n,projectionMatrix:r}=e;let{viewMatrix:s,viewProjectionMatrix:o}=e,a=Os,l=Os,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=Vs(e,t,i);d&&(l=e.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Wi([],l,o),s=n||s,o=Li([],r,s),o=Li([],o,Bs));return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(t,n,r),h=t.getDistanceScales(),d=[t.width*i,t.height*i],p=Wi([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,m={coordinateSystem:n,projectionMode:t.projectionMode,coordinateOrigin:c,commonOrigin:a.slice(0,3),center:s,pseudoMeters:Boolean(t._pseudoMeters),viewportSize:d,devicePixelRatio:i,focalDistance:p,commonUnitsPerMeter:h.unitsPerMeter,commonUnitsPerWorldUnit:h.unitsPerMeter,commonUnitsPerWorldUnit2:Ns,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:zs,cameraPosition:l};if(u){const e=t.getDistanceScales(u);switch(n){case Dr.METER_OFFSETS:m.commonUnitsPerWorldUnit=e.unitsPerMeter,m.commonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case Dr.LNGLAT:case Dr.LNGLAT_OFFSETS:t._pseudoMeters||(m.commonUnitsPerMeter=e.unitsPerMeter),m.commonUnitsPerWorldUnit=e.unitsPerDegree,m.commonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case Dr.CARTESIAN:m.commonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],m.commonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return m});function Vs(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Us;i.length<3&&(i=[i[0],i[1],0]);let n,r=i,s=!0;switch(n=t===Dr.LNGLAT_OFFSETS||t===Dr.METER_OFFSETS?i:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case Sr.WEB_MERCATOR:t!==Dr.LNGLAT&&t!==Dr.CARTESIAN||(n=[0,0,0],s=!1);break;case Sr.WEB_MERCATOR_AUTO_OFFSET:t===Dr.LNGLAT?r=n:t===Dr.CARTESIAN&&(r=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],n=e.unprojectPosition(r),r[0]-=i[0],r[1]-=i[1],r[2]-=i[2]);break;case Sr.IDENTITY:r=e.position.map(Math.fround),r[2]=r[2]||0;break;case Sr.GLOBE:s=!1,n=null;break;default:s=!1}return{geospatialOrigin:n,shaderCoordinateOrigin:r,offsetMode:s}}const Gs=Object.keys(Dr).map(e=>"const COORDINATE_SYSTEM_".concat(e,": i32 = ").concat(Dr[e],";")).join(""),Ws=Object.keys(Sr).map(e=>"const PROJECTION_MODE_".concat(e,": i32 = ").concat(Sr[e],";")).join(""),Hs=Object.keys(Cr).map(e=>"const UNIT_".concat(e.toUpperCase(),": i32 = ").concat(Cr[e],";")).join(""),Xs="".concat(Gs,"\n").concat(Ws,"\n").concat(Hs,'\n\nconst TILE_SIZE: f32 = 512.0;\nconst PI: f32 = 3.1415926536;\nconst WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);\nconst ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\nconst EARTH_RADIUS: f32 = 6370972.0; // meters\nconst GLOBE_RADIUS: f32 = 256.0;\n\n// -----------------------------------------------------------------------------\n// Uniform block (converted from GLSL uniform block)\n// -----------------------------------------------------------------------------\nstruct ProjectUniforms {\n  wrapLongitude: i32,\n  coordinateSystem: i32,\n  commonUnitsPerMeter: vec3<f32>,\n  projectionMode: i32,\n  scale: f32,\n  commonUnitsPerWorldUnit: vec3<f32>,\n  commonUnitsPerWorldUnit2: vec3<f32>,\n  center: vec4<f32>,\n  modelMatrix: mat4x4<f32>,\n  viewProjectionMatrix: mat4x4<f32>,\n  viewportSize: vec2<f32>,\n  devicePixelRatio: f32,\n  focalDistance: f32,\n  cameraPosition: vec3<f32>,\n  coordinateOrigin: vec3<f32>,\n  commonOrigin: vec3<f32>,\n  pseudoMeters: i32,\n};\n\n@group(0) @binding(0)\nvar<uniform> project: ProjectUniforms;\n\n// -----------------------------------------------------------------------------\n// Geometry data\n// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,\n// you might supply this via vertex attributes or a uniform. Here we define a\n// uniform struct for demonstration.)\n// -----------------------------------------------------------------------------\n\n// Structure to carry additional geometry data used by deck.gl filters.\nstruct Geometry {\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  position: vec4<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\n// @group(0) @binding(1)\nvar<private> geometry: Geometry;\n'),qs="".concat(Xs,'\n\n// -----------------------------------------------------------------------------\n// Functions\n// -----------------------------------------------------------------------------\n\n// Returns an adjustment factor for commonUnitsPerMeter\nfn _project_size_at_latitude(lat: f32) -> f32 {\n  let y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\n// Overloaded version: scales a value in meters at a given latitude.\nfn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);\n}\n\n// Computes a non-linear scale factor based on geometry.\n// (Note: This function relies on "geometry" being provided.)\nfn project_size() -> f32 {\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n      project.pseudoMeters == 0) {\n    if (geometry.position.w == 0.0) {\n      return _project_size_at_latitude(geometry.worldPosition.y);\n    }\n    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    let y2 = y * y;\n    let y4 = y2 * y2;\n    let y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\n// Overloads to scale offsets (meters to world units)\nfn project_size_float(meters: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * project_size();\n}\n\nfn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {\n  return meters * project.commonUnitsPerMeter.xy * project_size();\n}\n\nfn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {\n  return meters * project.commonUnitsPerMeter * project_size();\n}\n\nfn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {\n  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\n\n// Returns a rotation matrix aligning the z\u2011axis with the given up vector.\nfn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {\n  let uz = normalize(up);\n  let ux = select(\n    vec3<f32>(1.0, 0.0, 0.0),\n    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),\n    abs(uz.z) == 1.0\n  );\n  let uy = cross(uz, ux);\n  return mat3x3<f32>(ux, uy, uz);\n}\n\n// Since WGSL does not support "out" parameters, we return a struct.\nstruct RotationResult {\n  needsRotation: bool,\n  transform: mat3x3<f32>,\n};\n\nfn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    return RotationResult(true, project_get_orientation_matrix(commonPosition));\n  } else {\n    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed\n  };\n}\n\n// Projects a normal vector from the current coordinate system to world space.\nfn project_normal(vector: vec3<f32>) -> vec3<f32> {\n  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);\n  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\n  let rotResult = project_needs_rotation(geometry.position.xyz);\n  if (rotResult.needsRotation) {\n    n = rotResult.transform * n;\n  }\n  return n;\n}\n\n// Applies a scale offset based on y-offset (dy)\nfn project_offset_(offset: vec4<f32>) -> vec4<f32> {\n  let dy: f32 = offset.y;\n  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\n  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n// Projects lng/lat coordinates to a unit tile [0,1]\nfn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {\n  var x = lnglat.x;\n  if (project.wrapLongitude != 0) {\n    x = ((x + 180.0) % 360.0) - 180.0;\n  }\n  let y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2<f32>(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// Projects lng/lat/z coordinates for a globe projection.\nfn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {\n  let lambda = radians(lnglatz.x);\n  let phi = radians(lnglatz.y);\n  let cosPhi = cos(phi);\n  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n  return vec3<f32>(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n// Projects positions (with an optional 64-bit low part) from the input\n// coordinate system to the common space.\nfn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {\n  var position_world = project.modelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug:\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_mercator_(position_world.xy),\n        _project_size_at_latitude_m(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\n        return vec4<f32>(\n          project_mercator_(position_world.xy) - project.commonOrigin.xy,\n          project_size_float(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);\n  }\n\n  return project_offset_(position_world) +\n         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));\n}\n\n// Overloaded versions for different input types.\nfn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {\n  return project_position_vec4_f64(position, ZERO_64_LOW);\n}\n\nfn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nfn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nfn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\n// Transforms a common space position to clip space.\nfn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {\n  return viewProjectionMatrix * position + center;\n}\n\n// Uses the project viewProjectionMatrix and center.\nfn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {\n  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);\n}\n\n// Returns a clip space offset corresponding to a given number of screen pixels.\nfn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {\n  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\n  return offset * project.focalDistance;\n}\n\nfn project_meter_size_to_pixel(meters: f32) -> f32 {\n  return project_size_float(meters) * project.scale;\n}\n\nfn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {\n  if (unit == UNIT_METERS) {\n    return project_meter_size_to_pixel(size);\n  } else if (unit == UNIT_COMMON) {\n    return size * project.scale;\n  }\n  // UNIT_PIXELS: no scaling applied.\n  return size;\n}\n\nfn project_pixel_size_float(pixels: f32) -> f32 {\n  return pixels / project.scale;\n}\n\nfn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {\n  return pixels / project.scale;\n}\n'),Zs=Object.keys(Dr).map(e=>"const int COORDINATE_SYSTEM_".concat(e," = ").concat(Dr[e],";")).join(""),Ys=Object.keys(Sr).map(e=>"const int PROJECTION_MODE_".concat(e," = ").concat(Sr[e],";")).join(""),Ks=Object.keys(Cr).map(e=>"const int UNIT_".concat(e.toUpperCase()," = ").concat(Cr[e],";")).join(""),Js="".concat(Zs,"\n").concat(Ys,"\n").concat(Ks,"\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n"),$s={};const Qs={name:"project",dependencies:[Rs,H],source:qs,vs:Js,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$s;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:i=1,modelMatrix:n=null,coordinateSystem:r=Dr.DEFAULT,coordinateOrigin:s=Us,autoWrapLongitude:o=!1}=e;r===Dr.DEFAULT&&(r=t.isGeospatial?Dr.LNGLAT:Dr.CARTESIAN);const a=js({viewport:t,devicePixelRatio:i,coordinateSystem:r,coordinateOrigin:s});return a.wrapLongitude=o,a.modelMatrix=n||zs,a}(e):{}},uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},eo="\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n",to="\n".concat(eo,"\n").concat("\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n","\n"),io="\n".concat(eo,"\n").concat("\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n","\n"),no=Ls(function(e){let{viewport:t,center:i}=e;return new Ji(t.viewProjectionMatrix).invert().transform(i)}),ro=Ls(function(e){let{viewport:t,shadowMatrices:i}=e;const n=[],r=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,o=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(e=>function(e,t){const[i,n,r]=e,s=Tn([i,n,r],t);if(Number.isFinite(r))return s;return[s[0],s[1],0]}(e,r));for(const a of i){const e=a.clone().translate(new Di(t.center).negate()),i=o.map(t=>e.transform(t)),r=(new Ji).ortho({left:Math.min(...i.map(e=>e[0])),right:Math.max(...i.map(e=>e[0])),bottom:Math.min(...i.map(e=>e[1])),top:Math.max(...i.map(e=>e[1])),near:Math.min(...i.map(e=>-e[2])),far:Math.max(...i.map(e=>-e[2]))});n.push(r.multiplyRight(a))}return n}),so=[0,0,0,1],oo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const ao={name:"shadow",dependencies:[Qs],vs:to,fs:io,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(e){const{shadowEnabled:t=!0,project:i}=e;if(!t||!i||!e.shadowMatrices||!e.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const n=Qs.getUniforms(i),r=no({viewport:i.viewport,center:n.center}),s=[],o=ro({shadowMatrices:e.shadowMatrices,viewport:i.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){const e=o[l],t=e.clone().translate(new Di(i.viewport.center).negate());n.coordinateSystem===Dr.LNGLAT&&n.projectionMode===Sr.WEB_MERCATOR?(o[l]=t,s[l]=r):(o[l]=e.clone().multiplyRight(oo),s[l]=t.transform(r))}const a={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,color:e.shadowColor||so,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let l=0;l<o.length;l++)a["viewProjectionMatrix".concat(l)]=o[l],a["projectCenter".concat(l)]=s[l];for(let l=0;l<2;l++)a["shadow_uShadowMap".concat(l)]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return a},uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},lo={color:[255,255,255],intensity:1},co=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],uo=[0,0,0,200/255];class ho{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id="lighting-effect",this.shadowColor=uo,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:i}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),i._addDefaultShaderModule(ao),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.context&&this.setup(this.context),this.props=e}preRender(e){let{layers:t,layerFilter:i,viewports:n,onViewportActive:r,views:s}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:t,layerFilter:i,viewports:n,onViewportActive:r,views:s,shaderModuleProps:{shadow:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}}getShaderModuleProps(e,t){const i=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(e=>e.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},n={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(t=>t.getProjectedLight({layer:e})),pointLights:this.pointLights.map(t=>t.getProjectedLight({layer:e}))},r=e.props.material;return{shadow:i,lighting:n,phongMaterial:r,gouraudMaterial:r}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(ao))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const i=(new Ji).lookAt({eye:new Di(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new Ms(e);this.shadowPasses[t]=i}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;e||0!==t.length||0!==i.length||(this.ambientLight=new ws(lo),this.directionalLights.push(new Ss(co[0]),new Ss(co[1])))}}const po=new ho;class mo{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(t=>t.id===e.id)){const i=t.findIndex(t=>function(e,t){var i,n;return(null!==(i=e.order)&&void 0!==i?i:1/0)-(null!==(n=t.order)&&void 0!==n?n:1/0)}(t,e)>0);i<0?t.push(e):t.splice(i,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(zr(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const n of this.effects)t[n.id]=n;const i=[];for(const n of e){const e=t[n.id];let r=n;e&&e!==n?e.setProps?(e.setProps(n.props),r=e):e.cleanup(this._context):e||n.setup(this._context),i.push(r),delete t[n.id]}for(const n in t)t[n].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(e=>e instanceof ho)||this._resolvedEffects.push(po),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class fo extends Ps{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const go={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class _o extends Ps{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:i,views:n,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:d,pass:p="picking",pickZ:m,shaderModuleProps:f}=e;this.pickZ=m;const g=this._resetColorEncoder(m),_=[a,l,c,u],v=super.render({target:o,layers:t,layerFilter:i,views:n,viewports:r,onViewportActive:s,cullRect:h,effects:null===d||void 0===d?void 0:d.filter(e=>e.useInPicking),pass:p,isPicking:!0,shaderModuleProps:f,clearColor:[0,0,0,0],colorMask:15,scissorRect:_});this._colorEncoderState=null;return{decodePickingColor:g&&vo.bind(null,g),stats:v}}shouldDrawLayer(e){const{pickable:t,operation:i}=e.props;return t&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getShaderModuleProps(e,t,i){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,i){const n=(0,r.A)({},e.props.parameters),{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?n.blend=!1:s&&o.includes("draw")&&(Object.assign(n,go),n.blend=!0,n.blendColor=function(e,t,i){const{byLayer:n,byAlpha:r}=e;let s,o=n.get(t);o?(o.viewports.push(i),s=o.a):(s=n.size+1,s<=255?(o={a:s,layer:t,viewports:[i]},n.set(t,o),r[s]=o):(he.warn("Too many pickable layers, only picking the first 255")(),s=0));return[0,0,0,s/255]}(this._colorEncoderState,e,i)),n}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function vo(e,t){const i=e.byAlpha[t[3]];return i&&{pickedLayer:i.layer,pickedViewports:i.viewports,pickedObjectIndex:i.layer.decodePickingColor(t)}}class yo{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new fo(e),this.pickLayersPass=new _o(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i=(0,r.A)({layerFilter:this.layerFilter,isPicking:this.drawPickingColors},e);i.effects&&this._preRender(i.effects,i);const n=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);const s=t.render((0,r.A)((0,r.A)({},i),{},{target:n}));i.effects&&(this.lastPostProcessEffect&&(i.clearCanvas=void 0===e.clearCanvas||e.clearCanvas),this._postRender(i.effects,i)),this.renderCount++,me("deckRenderer.renderLayers",this,s,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const i of e)t.preRenderStats[i.id]=i.preRender(t),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize(),[i,n]=t;0===e.length&&[0,1].map(t=>{const r=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:i,height:n});e.push(this.device.createFramebuffer({id:"deck-renderbuffer-".concat(t),colorAttachments:[r]}))});for(const r of e)r.resize(t)}_postRender(e,t){const{renderBuffers:i}=this,n=(0,r.A)((0,r.A)({},t),{},{inputBuffer:i[0],swapBuffer:i[1]});for(const r of e)if(r.postRender){n.target=r.id===this.lastPostProcessEffect?t.target:void 0;const e=r.postRender(n);n.inputBuffer=e,n.swapBuffer=e===i[0]?i[1]:i[0]}}}const bo={pickedColor:null,pickedObjectIndex:-1};function xo(e){let{pickedColors:t,decodePickingColor:i,deviceX:n,deviceY:s,deviceRadius:o,deviceRect:a}=e;const{x:l,y:c,width:u,height:h}=a;let d=o*o,p=-1,m=0;for(let r=0;r<h;r++){const e=r+c-s,i=e*e;if(i>d)m+=4*u;else for(let r=0;r<u;r++){if(t[m+3]-1>=0){const e=r+l-n,t=e*e+i;t<=d&&(d=t,p=m)}m+=4}}if(p>=0){const e=t.slice(p,p+4),n=i(e);if(n){const t=Math.floor(p/4/u),i=p/4-t*u;return(0,r.A)((0,r.A)({},n),{},{pickedColor:e,pickedX:l+i,pickedY:c+t})}he.error("Picked non-existent layer. Is picking buffer corrupt?")()}return bo}function wo(e){let{pickedColors:t,decodePickingColor:i}=e;const n=new Map;if(t)for(let s=0;s<t.length;s+=4){if(t[s+3]-1>=0){const e=t.slice(s,s+4),o=e.join(",");if(!n.has(o)){const t=i(e);t?n.set(o,(0,r.A)((0,r.A)({},t),{},{color:e})):he.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Eo(e){let t,{pickInfo:i,viewports:n,pixelRatio:r,x:s,y:o,z:a}=e,l=n[0];if(n.length>1&&(l=function(e,t){for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.containsPixel(t))return n}return e[0]}((null===i||void 0===i?void 0:i.pickedViewports)||n,{x:s,y:o})),l){const e=[s-l.x,o-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:t,devicePixel:i&&"pickedX"in i?[i.pickedX,i.pickedY]:void 0,pixelRatio:r}}function Ao(e){const{pickInfo:t,lastPickedInfo:i,mode:n,layers:s}=e,{pickedColor:o,pickedLayer:a,pickedObjectIndex:l}=t,c=a?[a]:[];if("hover"===n){const e=i.index,t=i.layerId,n=a?a.props.id:null;if(n!==t||l!==e){if(n!==t){const e=s.find(e=>e.props.id===t);e&&c.unshift(e)}i.layerId=n,i.index=l,i.info=null}}const u=Eo(e),h=new Map;return h.set(null,u),c.forEach(e=>{let t=(0,r.A)({},u);e===a&&(t.color=o,t.index=l,t.picked=!0),t=To({layer:e,info:t,mode:n});const s=t.layer;e===a&&"hover"===n&&(i.info=t),h.set(s.id,t),"hover"===n&&s.updateAutoHighlight(t)}),h}function To(e){let{layer:t,info:i,mode:n}=e;for(;t&&i;){const e=i.layer||null;i.sourceLayer=e,i.layer=t,i=t.getPickingInfo({info:i,mode:n,sourceLayer:e}),t=t.parent}return i}class Do{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new _o(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:i,layers:n,viewports:s}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const a=o&&o.layer&&o.layer.id,l=o&&o.viewport&&o.viewport.id,c=a?n.find(e=>e.id===a):null,u=l&&s.find(e=>e.id===l)||s[0],h=u&&u.unproject([t-u.x,i-u.y]),d={x:t,y:i,viewport:u,coordinate:h,layer:c};return(0,r.A)((0,r.A)({},o),d)}_resizeBuffer(){var e,t;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:i}=this.device.getDefaultCanvasContext();null===(e=this.pickingFBO)||void 0===e||e.resize({width:i.width,height:i.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:i.width,height:i.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite);return t.length?t:null}async _pickClosestObjectAsync(e){let{layers:t,views:i,viewports:n,x:s,y:o,radius:a=0,depth:l=1,mode:c="query",unproject3D:u,onViewportActive:h,effects:d}=e;const p=this.device.canvasContext.cssToDeviceRatio(),m=this._getPickable(t);if(!m||0===n.length)return{result:[],emptyInfo:Eo({viewports:n,x:s,y:o,pixelRatio:p})};this._resizeBuffer();const f=this.device.canvasContext.cssToDevicePixels([s,o],!0),g=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],_=Math.round(a*p),{width:v,height:y}=this.pickingFBO,b=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceWidth:v,deviceHeight:y}),x={x:s-a,y:o-a,width:2*a+1,height:2*a+1};let w;const E=[],A=new Set;for(let T=0;T<l;T++){let e,t;if(b){const t=this._drawAndSample({layers:m,views:i,viewports:n,onViewportActive:h,deviceRect:b,cullRect:x,effects:d,pass:"picking:".concat(c)});e=xo((0,r.A)((0,r.A)({},t),{},{deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceRect:b}))}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&u&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:i,viewports:n,onViewportActive:h,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:x,effects:d,pass:"picking:".concat(c,":z")},!0);r[3]&&(t=r[0])}e.pickedLayer&&T+1<l&&(A.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=Ao({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:c,layers:m,viewports:n,x:s,y:o,z:t,pixelRatio:p});for(const i of w.values())i.layer&&E.push(i);if(!e.pickedColor)break}for(const r of A)r.restorePickingColors();return{result:E,emptyInfo:w.get(null)}}_pickClosestObject(e){let{layers:t,views:i,viewports:n,x:s,y:o,radius:a=0,depth:l=1,mode:c="query",unproject3D:u,onViewportActive:h,effects:d}=e;const p=this.device.canvasContext.cssToDeviceRatio(),m=this._getPickable(t);if(!m||0===n.length)return{result:[],emptyInfo:Eo({viewports:n,x:s,y:o,pixelRatio:p})};this._resizeBuffer();const f=this.device.canvasContext.cssToDevicePixels([s,o],!0),g=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],_=Math.round(a*p),{width:v,height:y}=this.pickingFBO,b=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceWidth:v,deviceHeight:y}),x={x:s-a,y:o-a,width:2*a+1,height:2*a+1};let w;const E=[],A=new Set;for(let T=0;T<l;T++){let e,t;if(b){const t=this._drawAndSample({layers:m,views:i,viewports:n,onViewportActive:h,deviceRect:b,cullRect:x,effects:d,pass:"picking:".concat(c)});e=xo((0,r.A)((0,r.A)({},t),{},{deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceRect:b}))}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&u&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:i,viewports:n,onViewportActive:h,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:x,effects:d,pass:"picking:".concat(c,":z")},!0);r[3]&&(t=r[0])}e.pickedLayer&&T+1<l&&(A.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=Ao({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:c,layers:m,viewports:n,x:s,y:o,z:t,pixelRatio:p});for(const i of w.values())i.layer&&E.push(i);if(!e.pickedColor)break}for(const r of A)r.restorePickingColors();return{result:E,emptyInfo:w.get(null)}}async _pickVisibleObjectsAsync(e){let{layers:t,views:i,viewports:n,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=e;const d=this._getPickable(t);if(!d||0===n.length)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),m=this.device.canvasContext.cssToDevicePixels([r,s],!0),f=m.x,g=m.y+m.height,_=this.device.canvasContext.cssToDevicePixels([r+o,s+a],!0),v=_.x+_.width,y=_.y,b={x:f,y:y,width:v-f,height:g-y},x=wo(this._drawAndSample({layers:d,views:i,viewports:n,onViewportActive:u,deviceRect:b,cullRect:{x:r,y:s,width:o,height:a},effects:h,pass:"picking:".concat(l)})),w=new Map,E=[],A=Number.isFinite(c);for(let D=0;D<x.length;D++){var T;if(A&&E.length>=c)break;const e=x[D];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:p};t=To({layer:e.pickedLayer,info:t,mode:l});const i=t.layer.id;w.has(i)||w.set(i,new Set);const n=w.get(i),o=null!==(T=t.object)&&void 0!==T?T:t.index;n.has(o)||(n.add(o),E.push(t))}return E}_pickVisibleObjects(e){let{layers:t,views:i,viewports:n,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=e;const d=this._getPickable(t);if(!d||0===n.length)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),m=this.device.canvasContext.cssToDevicePixels([r,s],!0),f=m.x,g=m.y+m.height,_=this.device.canvasContext.cssToDevicePixels([r+o,s+a],!0),v=_.x+_.width,y=_.y,b={x:f,y:y,width:v-f,height:g-y},x=wo(this._drawAndSample({layers:d,views:i,viewports:n,onViewportActive:u,deviceRect:b,cullRect:{x:r,y:s,width:o,height:a},effects:h,pass:"picking:".concat(l)})),w=new Map,E=[],A=Number.isFinite(c);for(let D=0;D<x.length;D++){var T;if(A&&E.length>=c)break;const e=x[D];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:p};t=To({layer:e.pickedLayer,info:t,mode:l});const i=t.layer.id;w.has(i)||w.set(i,new Set);const n=w.get(i),o=null!==(T=t.object)&&void 0!==T?T:t.index;n.has(o)||(n.add(o),E.push(t))}return E}async _drawAndSampleAsync(e){let{layers:t,views:i,viewports:n,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,h={layers:t,layerFilter:this.layerFilter,views:i,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{},isPicking:!0};for(const v of a)v.useInPicking&&(h.preRenderStats[v.id]=v.preRender(h));const{decodePickingColor:d}=this.pickLayersPass.render(h),{x:p,y:m,width:f,height:g}=s,_=new(c?Float32Array:Uint8Array)(f*g*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:p,sourceY:m,sourceWidth:f,sourceHeight:g,target:_}),{pickedColors:_,decodePickingColor:d}}_drawAndSample(e){let{layers:t,views:i,viewports:n,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,h={layers:t,layerFilter:this.layerFilter,views:i,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{},isPicking:!0};for(const v of a)v.useInPicking&&(h.preRenderStats[v.id]=v.preRender(h));const{decodePickingColor:d}=this.pickLayersPass.render(h),{x:p,y:m,width:f,height:g}=s,_=new(c?Float32Array:Uint8Array)(f*g*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:p,sourceY:m,sourceWidth:f,sourceHeight:g,target:_}),{pickedColors:_,decodePickingColor:d}}_getPickingRect(e){let{deviceX:t,deviceY:i,deviceRadius:n,deviceWidth:r,deviceHeight:s}=e;const o=Math.max(0,t-n),a=Math.max(0,i-n),l=Math.min(r,t+n+1)-o,c=Math.min(s,i+n+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const So={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},Co="top-left",Po="__root";class Io{constructor(e){let{deck:t,parentElement:i}=e;this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,null===i||void 0===i||i.classList.add("deck-widget-container"),this.parentElement=i}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!zr(e.widgets,this.widgets,1)){const t=e.widgets.filter(Boolean);this._setWidgets(t)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw(e){let{viewports:t,layers:i}=e;const n=t.reduce((e,t)=>(e[t.id]=t,e),{});for(const o of this.getWidgets()){const{viewId:e}=o;if(e){const t=n[e];var r;if(t)o.onViewportChange&&o.onViewportChange(t),null===(r=o.onRedraw)||void 0===r||r.call(o,{viewports:[t],layers:i})}else{var s;if(o.onViewportChange)for(const e of t)o.onViewportChange(e);null===(s=o.onRedraw)||void 0===s||s.call(o,{viewports:t,layers:i})}}this.lastViewports=n,this._updateContainers()}onHover(e,t){for(const r of this.getWidgets()){var i;const{viewId:s}=r;var n;if(!s||s===(null===(i=e.viewport)||void 0===i?void 0:i.id))null===(n=r.onHover)||void 0===n||n.call(r,e,t)}}onEvent(e,t){const i=Pr[t.type];if(i)for(const s of this.getWidgets()){var n;const{viewId:o}=s;var r;if(!o||o===(null===(n=e.viewport)||void 0===n?void 0:n.id))null===(r=s[i])||void 0===r||r.call(s,e,t)}}_setWidgets(e){const t={};for(const i of this.resolvedWidgets)t[i.id]=i;this.resolvedWidgets.length=0;for(const i of this.defaultWidgets)t[i.id]=null,this.resolvedWidgets.push(i);for(let i of e){const e=t[i.id];e?e.viewId!==i.viewId||e.placement!==i.placement?(this._removeWidget(e),this._addWidget(i)):i!==e&&(e.setProps(i.props),i=e):this._addWidget(i),t[i.id]=null,this.resolvedWidgets.push(i)}for(const i in t){const e=t[i];e&&this._removeWidget(e)}this.widgets=e}_addWidget(e){const{viewId:t=null,placement:i=Co}=e;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:t}),e.rootElement&&this._getContainer(t,i).append(e.rootElement),e.updateHTML()}_removeWidget(e){var t;null===(t=e.onRemove)||void 0===t||t.call(e),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,t){const i=e||Po;let n=this.containers[i];var r;n||(n=document.createElement("div"),n.style.pointerEvents="none",n.style.position="absolute",n.style.overflow="hidden",null===(r=this.parentElement)||void 0===r||r.append(n),this.containers[i]=n);let s=n.querySelector(".".concat(t));return s||(s=globalThis.document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,So[t]),n.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const i in this.containers){const n=this.lastViewports[i]||null,r=i===Po||n,s=this.containers[i];r?(s.style.display="block",s.style.left="".concat(n?n.x:0,"px"),s.style.top="".concat(n?n.y:0,"px"),s.style.width="".concat(n?n.width:e,"px"),s.style.height="".concat(n?n.height:t,"px")):s.style.display="none"}}}function ko(e,t){t&&Object.entries(t).map(t=>{let[i,n]=t;i.startsWith("--")?e.style.setProperty(i,n):e.style[i]=n})}class Mo{constructor(e){this.viewId=null,this.props=(0,r.A)((0,r.A)({},this.constructor.defaultProps),e),this.id=this.props.id}setProps(e){const t=this.props,i=this.rootElement;i&&t.className!==e.className&&(t.className&&i.classList.remove(t.className),e.className&&i.classList.add(e.className)),i&&!zr(t.style,e.style,1)&&(!function(e,t){t&&Object.keys(t).map(t=>{t.startsWith("--")?e.style.removeProperty(t):e.style[t]=""})}(i,t.style),ko(i,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(e=>"string"===typeof e&&e.length>0).forEach(e=>t.classList.add(e)),ko(t,this.props.style),t}_onAdd(e){var t;return null!==(t=this.onAdd(e))&&void 0!==t?t:this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}Mo.defaultProps={id:"widget",style:{},className:""};const Ro={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Fo extends Mo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,Ro),e}onRenderHTML(e){}onViewportChange(e){var t;this.isVisible&&e.id===(null===(t=this.lastViewport)||void 0===t?void 0:t.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,i=t&&t.props.getTooltip;if(!i)return;const n=i(e);this.lastViewport=e.viewport,this.setTooltip(n,e.x,e.y)}setTooltip(e,t,i){const n=this.rootElement;if(n){if("string"===typeof e)n.innerText=e;else{if(!e)return this.isVisible=!1,void(n.style.display="none");e.text&&(n.innerText=e.text),e.html&&(n.innerHTML=e.html),e.className&&(n.className=e.className)}this.isVisible=!0,n.style.display="block",n.style.transform="translate(".concat(t,"px, ").concat(i,"px)"),e&&"object"===typeof e&&"style"in e&&Object.assign(n.style,e.style)}}}Fo.defaultProps=(0,r.A)({},Mo.defaultProps);var Lo;const Oo=null===(Lo=globalThis.loaders)||void 0===Lo?void 0:Lo.parseImageNode,Bo="undefined"!==typeof Image,zo="undefined"!==typeof ImageBitmap,No=Boolean(Oo),Uo=!!He||No;function jo(e){const t=Go(e);if(!t)throw new Error("Not an image");return t}function Vo(e){switch(jo(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),i=t.getContext("2d");if(!i)throw new Error("getImageData");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0),i.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Go(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const Wo=/^data:image\/svg\+xml/,Ho=/\.svg((\?|#).*)?$/;function Xo(e){return e&&(Wo.test(e)||Ho.test(e))}function qo(e,t){if(Xo(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function Zo(e,t,i){const n=function(e,t){if(Xo(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(i){throw new Error(i.message)}return"data:image/svg+xml;base64,".concat(btoa(t))}return qo(e,t)}(e,i),r=self.URL||self.webkitURL,s="string"!==typeof n&&r.createObjectURL(n);try{return await async function(e,t){const i=new Image;if(i.src=e,t.image&&t.image.decode&&i.decode)return await i.decode(),i;return await new Promise((e,t)=>{try{i.onload=()=>e(i),i.onerror=e=>{const i=e instanceof Error?e.message:"error";t(new Error(i))}}catch(n){t(n)}})}(s||n,t)}finally{s&&r.revokeObjectURL(s)}}const Yo={};let Ko=!0;async function Jo(e,t,i){let n;if(Xo(i)){n=await Zo(e,t,i)}else n=qo(e,i);const r=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||Yo)return!1;return!0}(t)&&Ko||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(i){console.warn(i),Ko=!1}return await createImageBitmap(e)}(n,r)}function $o(e){return function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=(r=t,[...r].map(e=>e.charCodeAt(0)));var r;for(let s=0;s<n.length;++s)if(n[s]!==e[s+i])return!1;return!0}(e,"ftyp",4)?0===(96&e[8])?null:function(e){switch((t=e,i=8,n=12,String.fromCharCode(...t.slice(i,n))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,i,n}(e):null}const Qo=!1,ea=!0;function ta(e){const t=ia(e);return function(e){const t=ia(e),i=t.byteLength>=24&&2303741511===t.getUint32(0,Qo);if(!i)return null;return{mimeType:"image/png",width:t.getUint32(16,Qo),height:t.getUint32(20,Qo)}}(t)||function(e){const t=ia(e),i=t.byteLength>=3&&65496===t.getUint16(0,Qo)&&255===t.getUint8(2);if(!i)return null;const{tableMarkers:n,sofMarkers:r}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let i=65504;i<65520;++i)e.add(i);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,Qo);if(r.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Qo),width:t.getUint16(s+7,Qo)};if(!n.has(e))return null;s+=2,s+=t.getUint16(s,Qo)}return null}(t)||function(e){const t=ia(e),i=t.byteLength>=10&&1195984440===t.getUint32(0,Qo);if(!i)return null;return{mimeType:"image/gif",width:t.getUint16(6,ea),height:t.getUint16(8,ea)}}(t)||function(e){const t=ia(e),i=t.byteLength>=14&&16973===t.getUint16(0,Qo)&&t.getUint32(2,ea)===t.byteLength;if(!i)return null;return{mimeType:"image/bmp",width:t.getUint32(18,ea),height:t.getUint32(22,ea)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),i=$o(t);if(!i)return null;return{mimeType:i.mimeType,width:0,height:0}}(t)}function ia(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const na={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.3",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,i){const n=((t=t||{}).image||{}).type||"auto",{url:r}=i||{};let s;switch(function(e){switch(e){case"auto":case"data":return function(){if(zo)return"imagebitmap";if(Bo)return"image";if(Uo)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return zo||Bo||Uo;case"imagebitmap":return zo;case"image":return Bo;case"data":return Uo;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}(n)){case"imagebitmap":s=await Jo(e,t,r);break;case"image":s=await Zo(e,t,r);break;case"data":s=await async function(e){var t;const{mimeType:i}=ta(e)||{},n=null===(t=globalThis.loaders)||void 0===t?void 0:t.parseImageNode;return De(n),await n(e,i)}(e);break;default:De(!1)}return"data"===n&&(s=Vo(s)),s},tests:[e=>Boolean(ta(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const ra={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],i=e[e.length-1];return"{"===t&&"}"===i||"["===t&&"]"===i},parseTextSync:JSON.parse};const sa=function(){const e="9.2.2",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(e));return t||(he.log(1,"deck.gl ".concat(e))(),globalThis.deck=(0,r.A)((0,r.A)({},globalThis.deck),{},{VERSION:e,version:e,log:he,_registerLoggers:pe}),function(e){const t=Ht();e=Array.isArray(e)?e:[e];for(const i of e){const e=Ce(i);t.find(t=>e===t)||t.unshift(e)}}([ra,[na,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}();var oa=i(382),aa=i(263),la=i(96);const ca="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class ua{constructor(){if((0,s.A)(this,"stats",aa.d),(0,s.A)(this,"log",la.R),(0,s.A)(this,"VERSION","9.2.4"),(0,s.A)(this,"spector",void 0),(0,s.A)(this,"preregisteredAdapters",new Map),globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw la.R.error("Found luma.gl ".concat(globalThis.luma.VERSION," while initialzing ").concat(this.VERSION))(),la.R.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");la.R.error("This version of luma.gl has already been initialized")()}la.R.log(1,"".concat(this.VERSION," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=this}async createDevice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,r.A)((0,r.A)({},ua.defaultProps),e),i=this.selectAdapter(t.type,t.adapters);if(!i)throw new Error(ca);return t.waitForPageLoad&&await i.pageLoaded,await i.create(t)}async attachDevice(e,t){var i;const n=this._getTypeFromHandle(e,t.adapters),r=n&&this.selectAdapter(n,t.adapters);if(!r)throw new Error(ca);return await(null===r||void 0===r||null===(i=r.attach)||void 0===i?void 0:i.call(r,e,t))}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this._getAdapterMap(e);return Array.from(t).map(e=>{let[,t]=e;return t}).filter(e=>{var t;return null===(t=e.isSupported)||void 0===t?void 0:t.call(e)}).map(e=>e.type)}getBestAvailableAdapterType(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=["webgpu","webgl","null"],i=this._getAdapterMap(e);for(const s of t){var n,r;if(null!==(n=i.get(s))&&void 0!==n&&null!==(r=n.isSupported)&&void 0!==r&&r.call(n))return s}return null}selectAdapter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e;"best-available"===e&&(i=this.getBestAvailableAdapterType(t));const n=this._getAdapterMap(t);return i&&n.get(i)||null}enforceWebGL2(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=this._getAdapterMap(i).get("webgl");n||la.R.warn("enforceWebGL2: webgl adapter not found")(),null===n||void 0===n||null===(e=n.enforceWebGL2)||void 0===e||e.call(n,t)}setDefaultDeviceProps(e){Object.assign(ua.defaultProps,e)}_getAdapterMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Map(this.preregisteredAdapters);for(const i of e)t.set(i.type,i);return t}_getTypeFromHandle(e){return e instanceof WebGL2RenderingContext?"webgl":"undefined"!==typeof GPUDevice&&e instanceof GPUDevice||null!==e&&void 0!==e&&e.queue?"webgpu":null===e?"null":(e instanceof WebGLRenderingContext?la.R.warn("WebGL1 is not supported",e)():la.R.warn("Unknown handle type",e)(),null)}}(0,s.A)(ua,"defaultProps",(0,r.A)((0,r.A)({},oa.pF.defaultProps),{},{type:"best-available",adapters:void 0,waitForPageLoad:!0}));const ha=new ua;var da=i(228);class pa{get pageLoaded(){return function(){ga||(ga=fa()||"undefined"===typeof window?Promise.resolve():new Promise(e=>window.addEventListener("load",()=>e())));return ga}()}}const ma=(0,da.B)()&&"undefined"!==typeof document,fa=()=>ma&&"complete"===document.readyState;let ga=null;const _a={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},va=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),ya=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),ba=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(){return e.drawArraysInstanced(...arguments)},drawElementsInstancedANGLE(){return e.drawElementsInstanced(...arguments)},vertexAttribDivisorANGLE(){return e.vertexAttribDivisor(...arguments)}});function xa(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t=(0,r.A)((0,r.A)({},_a),{},{WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:va(e),OES_vertex_array_object:ya(e),ANGLE_instanced_arrays:ba(e)}),i=e.getExtension;e.getExtension=function(n){const r=i.call(e,n);return r||(n in t?t[n]:null)};const n=e.getSupportedExtensions;e.getSupportedExtensions=function(){const i=n.apply(e)||[];return null===i||void 0===i?void 0:i.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}var wa=i(354),Ea=i(513);const Aa=new class extends pa{constructor(){super(),(0,s.A)(this,"type","webgl"),oa.pF.defaultProps=(0,r.A)((0,r.A)({},oa.pF.defaultProps),wa.ic)}enforceWebGL2(e){xa(e)}isSupported(){return"undefined"!==typeof WebGL2RenderingContext}isDeviceHandle(e){return"undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||("undefined"!==typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext&&la.R.warn("WebGL1 is not supported",e)(),!1)}async attach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{WebGLDevice:n}=await Promise.resolve().then(i.bind(i,841));if(e instanceof n)return e;if((null===e||void 0===e?void 0:e.device)instanceof n)return e.device;if(!function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");const s=!0===t.createCanvasContext?{}:t.createCanvasContext;return new n((0,r.A)((0,r.A)({},t),{},{_handle:e,createCanvasContext:(0,r.A)({canvas:e.canvas,autoResize:!1},s)}))}async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{WebGLDevice:t}=await Promise.resolve().then(i.bind(i,841));la.R.groupCollapsed(1,"WebGLDevice created")();try{const i=[];(e.debugWebGL||e.debug)&&i.push((0,Ea.$)()),e.debugSpectorJS&&i.push((0,wa._G)(e));const n=await Promise.allSettled(i);for(const e of n)"rejected"===e.status&&la.R.error("Failed to initialize debug libraries ".concat(e.reason))();const r=new t(e),s="".concat(r._reused?"Reusing":"Created"," device with WebGL2 ").concat(r.props.debug?"debug ":"","context: ").concat(r.info.vendor,", ").concat(r.info.renderer," for canvas: ").concat(r.canvasContext.id);return la.R.probe(1,s)(),la.R.table(1,r.info)(),r}finally{la.R.groupEnd(1)()}}};let Ta=0;class Da{constructor(e){if((0,s.A)(this,"device",null),(0,s.A)(this,"canvas",null),(0,s.A)(this,"props",void 0),(0,s.A)(this,"animationProps",null),(0,s.A)(this,"timeline",null),(0,s.A)(this,"stats",void 0),(0,s.A)(this,"cpuTime",void 0),(0,s.A)(this,"gpuTime",void 0),(0,s.A)(this,"frameRate",void 0),(0,s.A)(this,"display",void 0),(0,s.A)(this,"needsRedraw","initialized"),(0,s.A)(this,"_initialized",!1),(0,s.A)(this,"_running",!1),(0,s.A)(this,"_animationFrameId",null),(0,s.A)(this,"_nextFramePromise",null),(0,s.A)(this,"_resolveNextFrame",null),(0,s.A)(this,"_cpuStartTime",0),(0,s.A)(this,"_error",null),this.props=(0,r.A)((0,r.A)({},Da.defaultAnimationLoopProps),e),!(e=this.props).device)throw new Error("No device provided");this.stats=e.stats||new ve.A({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return null!==(e=this.device)&&void 0!==e&&e.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){var t;this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),null===(t=this.device)||void 0===t||t.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){var e;const t=null===(e=this.device)||void 0===e?void 0:e.getDefaultCanvasContext();if(!this.device||!t)throw new Error("loop");const i=null===t||void 0===t?void 0:t.canvas,n=t.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:t,canvas:i,useDevicePixels:n,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:i}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){var e,t;if(!this.device)return{width:1,height:1,aspect:1};const[i,n]=(null===(e=this.device)||void 0===e?void 0:e.getDefaultCanvasContext().getDevicePixelSize())||[1,1];let r=1;const s=null===(t=this.device)||void 0===t?void 0:t.getDefaultCanvasContext().canvas;return s&&s.clientHeight?r=s.clientWidth/s.clientHeight:i>0&&n>0&&(r=i/n),{width:i,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}function Sa(){}(0,s.A)(Da,"defaultAnimationLoopProps",{device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:ha.stats.get("animation-loop-".concat(Ta++)),autoResizeViewport:!1});const Ca={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Sa,onWebGLInitialized:Sa,onResize:Sa,onViewStateChange:Sa,onInteractionStateChange:Sa,onBeforeRender:Sa,onAfterRender:Sa,onLoad:Sa,onError:e=>he.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class Pa{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new ve.A({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=Pr[e.type],i=e.offsetCenter;if(!t||!i||!this.layerManager)return;const n=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:n,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:s}=r,o=s&&(s[t]||s.props[t]),a=this.props[t];let l=!1;o&&(l=o.call(s,r,e)),l||(null===a||void 0===a||a(r,e),this.widgetManager.onEvent(r,e))},this._onPointerDown=e=>{var t;if("webgpu"===(null===(t=this.device)||void 0===t?void 0:t.type))return;const i=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props=(0,r.A)((0,r.A)({},Ca),e),(e=this.props).viewState&&e.initialViewState&&he.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&he.error("WebGL1 context not supported.")(),t=Aa.attach(e.gl,this.props.deviceProps)),t||(t=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&si.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,i,n,r,s,o,a,l,c;(null===(e=this.animationLoop)||void 0===e||e.stop(),null===(t=this.animationLoop)||void 0===t||t.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(i=this.layerManager)||void 0===i||i.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(r=this.effectManager)||void 0===r||r.finalize(),this.effectManager=null,null===(s=this.deckRenderer)||void 0===s||s.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(a=this.eventManager)||void 0===a||a.destroy(),this.eventManager=null,null===(l=this.widgetManager)||void 0===l||l.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas)||(null===(c=this.canvas.parentElement)||void 0===c||c.removeChild(this.canvas),this.canvas=null)}setProps(e){var t,i,n;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&he.removed("onLayerHover","onHover")(),"onLayerClick"in e&&he.removed("onLayerClick","onClick")(),e.initialViewState&&!zr(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);if(Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==(null===(t=this.device)||void 0===t?void 0:t.id)){var s,o,a,l;if(null===(s=this.animationLoop)||void 0===s||s.stop(),this.canvas!==(null===(o=e.device.canvasContext)||void 0===o?void 0:o.canvas))null===(a=this.canvas)||void 0===a||a.remove(),null===(l=this.eventManager)||void 0===l||l.destroy(),this.canvas=null;he.log("recreating animation loop for new device! id=".concat(e.device.id))(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()}if(null===(i=this.animationLoop)||void 0===i||i.setProps(r),void 0!==e.useDevicePixels&&(null===(n=this.device)||void 0===n||null===(n=n.canvasContext)||void 0===n?void 0:n.canvas)instanceof HTMLCanvasElement){this.device.canvasContext.props.useDevicePixels=e.useDevicePixels;const t=this.device.canvasContext.canvas,i={target:t,contentBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}],devicePixelContentBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}],borderBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}]};this.device.canvasContext._handleResize([i])}this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),n=this.layerManager.needsRedraw(e),r=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return t=t||i||n||r||s,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Qr(this.viewManager),this.viewManager.views}getViewports(e){return Qr(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var t;null===(t=this.layerManager)||void 0===t||t.removeDefaultShaderModule(e)}_pick(e,t,i){Qr(this.deckPicker);const{stats:n}=this;n.get("Pick Count").incrementCount(),n.get(t).timeStart();const s=this.deckPicker[e]((0,r.A)({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects()},i));return n.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),Qr(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",e.width&&"number"===typeof e.width&&(t.width=e.width),e.height&&"number"===typeof e.height&&(t.height=e.height);(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||0===t){const e=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=e}if(i||0===i){var n;const t=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=(null===(n=e.style)||void 0===n?void 0:n.position)||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){var e,t;const{canvas:i}=this;if(!i)return;const n=null!==(e=i.clientWidth)&&void 0!==e?e:i.width,r=null!==(t=i.clientHeight)&&void 0!==t?t:i.height;var s,o;n===this.width&&r===this.height||(this.width=n,this.height=r,null===(s=this.viewManager)||void 0===s||s.setProps({width:n,height:r}),null===(o=this.layerManager)||void 0===o||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,t){const{gl:i,onError:n}=t;return new Da({device:e,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:n})}_createDevice(e){var t,i;const n=null===(t=this.props.deviceProps)||void 0===t?void 0:t.createCanvasContext,s="object"===typeof n?n:void 0,o=(0,r.A)({adapters:[]},e.deviceProps);o.adapters.includes(Aa)||o.adapters.push(Aa);const a={alphaMode:"webgpu"===(null===(i=this.props.deviceProps)||void 0===i?void 0:i.type)?"premultiplied":void 0};return ha.createDevice((0,r.A)((0,r.A)({_reuseDevices:!0,type:"webgl"},o),{},{createCanvasContext:(0,r.A)((0,r.A)((0,r.A)({},a),s),{},{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0})}))}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new vs({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var e;if("webgpu"===(null===(e=this.device)||void 0===e?void 0:e.type))return;const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:s}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=e.length>0;let o=s,a=!1;for(const n of e){var i;o=n,a=(null===(i=n.layer)||void 0===i?void 0:i.onHover(n,t.event))||a}var n,r;if(!a)null===(n=(r=this.props).onHover)||void 0===n||n.call(r,o,t.event),this.widgetManager.onHover(o,t.event);t.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var t,i;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=null===(i=this.device.canvasContext)||void 0===i?void 0:i.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild));"webgl"===this.device.type&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),"webgl"===this.device.type&&this.props.onWebGLInitialized(this.device.gl);const n=new l;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Tr(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(Ir).map(e=>{var t;const[i,n,s,o]=Ir[e],a=null===(t=this.props.eventRecognizerOptions)||void 0===t?void 0:t[e];return{recognizer:new i((0,r.A)((0,r.A)((0,r.A)({},n),a),{},{event:e})),recognizeWith:s,requestFailure:o}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Pr)this.eventManager.on(r,this._onEvent);this.viewManager=new Nr({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const s=this.viewManager.getViewports()[0];this.layerManager=new Br(this.device,{deck:this,stats:this.stats,viewport:s,timeline:n}),this.effectManager=new mo({deck:this,device:this.device}),this.deckRenderer=new yo(this.device),this.deckPicker=new Do(this.device),this.widgetManager=new Io({deck:this,parentElement:null===(t=this.canvas)||void 0===t?void 0:t.parentElement}),this.widgetManager.addDefault(new Fo),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){var i;const{device:n,gl:s}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:s});const o=(0,r.A)({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects()},t);null===(i=this.deckRenderer)||void 0===i||i.renderLayers(o),"screen"===o.pass&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:n,gl:s})}_onRenderFrame(){var e;this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),he.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),"webgpu"!==(null===(e=this.device)||void 0===e?void 0:e.type)&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=(0,r.A)((0,r.A)({},this.viewState),{},{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=ha.stats.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}Pa.defaultProps=Ca,Pa.VERSION=sa;const Ia=Pa,ka="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function Ma(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}var Ra=i(794),Fa=i(841),La=i(775);const Oa=La.h1;function Ba(e,t,i){const n="webgpu"===i&&"uint8"===t.type?"unorm8":t.type;return{attribute:e,format:t.size>1?"".concat(n,"x").concat(t.size):t.type,byteOffset:t.offset||0}}function za(e){return e.stride||e.size*e.bytesPerElement}function Na(e,t){t.offset&&he.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const i=za(e),n=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*i+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return(0,r.A)((0,r.A)({},t),{},{offset:n,stride:i})}class Ua{constructor(e,t,i){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const n=t.logicalType||t.type,s="float64"===n;let o,{defaultValue:a}=t;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0),o=s?"float32":!n&&t.isIndexed?"uint32":n||"float32";let l=function(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return(0,La.Ak)(e)}}(n||o);this.doublePrecision=s,s&&!1===t.fp64&&(l=Float32Array),this.value=null,this.settings=(0,r.A)((0,r.A)({},t),{},{defaultType:l,defaultValue:a,logicalType:n,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT}),this.state=(0,r.A)((0,r.A)({},i),{},{externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1})}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*za(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),si.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i={};if(this.state.constant){const n=this.value;if(t){const r=Na(this.getAccessor(),t),s=r.offset/n.BYTES_PER_ELEMENT,o=r.size||this.size;i[e]=n.subarray(s,s+o)}else i[e]=n}else i[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i["".concat(e,"64Low")]=i[e]:i["".concat(e,"64Low")]=new Float32Array(this.size)),i}_getBufferLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=this.getAccessor(),n=[],s={name:this.id,byteStride:za(i),attributes:n};if(this.doublePrecision){const s=function(e,t){const i=Na(e,t);return{high:i,low:(0,r.A)((0,r.A)({},i),{},{offset:i.offset+4*e.size})}}(i,t||{});n.push(Ba(e,(0,r.A)((0,r.A)({},i),s.high),this.device.type),Ba("".concat(e,"64Low"),(0,r.A)((0,r.A)({},i),s.low),this.device.type))}else if(t){const s=Na(i,t);n.push(Ba(e,(0,r.A)((0,r.A)({},i),s),this.device.type))}else n.push(Ba(e,i,this.device.type));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:i,size:n}=this,r=i*n;if(t&&r&&t.length>=r){const i=new Array(n).fill(1/0),s=new Array(n).fill(-1/0);for(let e=0;e<r;)for(let r=0;r<n;r++){const n=t[e++];n<i[r]&&(i[r]=n),n>s[r]&&(s[r]=n)}e=[i,s]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let i;i=ArrayBuffer.isView(e)?{value:e}:e instanceof Ra.h?{buffer:e}:e;const n=(0,r.A)((0,r.A)({},this.settings),i);if(ArrayBuffer.isView(i.value)){if(!i.type){if(this.doublePrecision&&i.value instanceof Float64Array)n.type="float32";else{const e=Oa(i.value);n.type=n.normalized?e.replace("int","norm"):e}}n.bytesPerElement=i.value.BYTES_PER_ELEMENT,n.stride=za(n)}if(t.bounds=null,i.constant){let e=i.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(i.buffer){const e=i.buffer;t.externalBuffer=e,t.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let e=i.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:r}=this;const s=za(n),o=(n.vertexOffset||0)*s;if(this.doublePrecision&&e instanceof Float64Array&&(e=ki(e,n)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const a=e.byteLength+o+2*s;(!r||r.byteLength<a)&&(r=this._createBuffer(a)),r.write(e,o)}return this.setAccessor(n),!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:i=0,endOffset:n}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?ki(t,{size:this.size,startIndex:i,endIndex:n}):t.subarray(i,n),i*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:i}=this,n=i.allocatedValue,r=si.allocate(n,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=r;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<r.byteLength+s)&&(o=this._createBuffer(r.byteLength+s),t&&n&&o.write(n instanceof Float64Array?ki(n,this):n,s)),i.allocatedValue=r,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let n=!1;if(this.doublePrecision&&(n=t.BYTES_PER_ELEMENT<4),n)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof i||!this.settings.normalized||"normalized"in e||he.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(e=>(e+128)/255*2-1);case"snorm16":return new Float32Array(e).map(e=>(e+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(e=>e/255);case"unorm16":return new Float32Array(e).map(e=>e/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:n,size:r}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e){let e=r;for(;--e>=0;)t[i+e]=n[e];return t}switch(r){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:n[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:n[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:n[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:n[0];break;default:let s=r;for(;--s>=0;)t[i+s]=Number.isFinite(e[s])?e[s]:n[s]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}_createBuffer(e){var t;this._buffer&&this._buffer.destroy();const{isIndexed:i,type:n}=this.settings;return this._buffer=this.device.createBuffer((0,r.A)((0,r.A)({},null===(t=this._buffer)||void 0===t?void 0:t.props),{},{id:this.id,usage:(i?Ra.h.INDEX:Ra.h.VERTEX)|Ra.h.COPY_DST,indexType:i?n:void 0,byteLength:e})),this._buffer}}const ja=[],Va=[];function Ga(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=ja;const r={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?n=e:e.length>0&&(Va.length=e.length,n=Va):n=ja,(t>0||Number.isFinite(i))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,i),r.index=t-1),{iterable:n,objectInfo:r}}function Wa(e){return e&&e[Symbol.asyncIterator]}function Ha(e,t){const{size:i,stride:n,offset:r,startIndices:s,nested:o}=t,a=e.BYTES_PER_ELEMENT,l=n?n/a:i,c=r?r/a:0,u=Math.floor((e.length-c)/l);return(t,n)=>{let{index:r,target:a}=n;if(!s){const t=r*l+c;for(let n=0;n<i;n++)a[n]=e[t+n];return a}const h=s[r],d=s[r+1]||u;let p;if(o){p=new Array(d-h);for(let t=h;t<d;t++){const n=t*l+c;a=new Array(i);for(let t=0;t<i;t++)a[t]=e[n+t];p[t-h]=a}}else if(l===i)p=e.subarray(h*i+c,d*i+c);else{p=new e.constructor((d-h)*i);let t=0;for(let n=h;n<d;n++){const r=n*l+c;for(let n=0;n<i;n++)p[t++]=e[r+n]}}return p}}const Xa=[],qa=[[0,1/0]];const Za={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function Ya(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const i=e.type||"interpolation";return(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},Za[i]),t),e),{},{type:i})}class Ka extends Ua{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:qa}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t,i,n;(t=this.state).layoutChanged||(t.layoutChanged=(i=e,n=this.getAccessor(),!(i.type===n.type&&i.size===n.size&&za(i)===za(n)&&(i.offset||0)===(n.offset||0)))),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition,n=Array.isArray(t)?e[t.find(t=>e[t])]:e[t];return Ya(n,i)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:i=1/0}=t;this.state.updateRanges=function(e,t){if(e===qa)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const i=[],n=e.length;let r=0;for(let s=0;s<n;s++){const n=e[s];n[1]<t[0]?(i.push(n),r=s+1):n[0]>t[1]?i.push(n):t=[Math.min(n[0],t[0]),Math.max(n[1],t[1])]}return i.splice(r,0,t),i}(this.state.updateRanges,[e,i])}else this.state.updateRanges=qa}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Xa}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&(!!i.update&&(super.allocate(e,t.updateRanges!==qa),!0))}updateBuffer(e){let{numInstances:t,data:i,props:n,context:r}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[e,a]of s)o.call(r,this,{data:i,startRow:e,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,i]of s){const n=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(i)?this.getVertexOffset(i):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:n,endOffset:r})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e,t){const i="webgpu"===this.device.type;if(i||void 0===t||"function"===typeof t){if(i&&"function"!==typeof t){const e=this._normalizeValue(t,[],0);this._areValuesEqual(e,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const n=this.settings.transform&&e?this.settings.transform.call(e,t):t;return this.setData({constant:!0,value:n})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:i,settings:n}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(n.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;i.binaryValue=e,this.setNeedsRedraw();if(n.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const r=e;Qr(ArrayBuffer.isView(r.value),"invalid ".concat(n.accessor));const s=Boolean(r.size)&&r.size!==this.size;return i.binaryAccessor=Ha(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:t,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const i in e)Object.assign(t,super.getValue(i,e[i]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:n}=this.settings;if(i.stepMode="dynamic"===n?e?e.isInstanced?"instance":"vertex":"instance":null!==n&&void 0!==n?n:"vertex",!t)return i;for(const r in t){const e=super._getBufferLayout(r,t[r]);i.attributes.push(...e.attributes)}return i}_autoUpdater(e,t){let{data:i,startRow:n,endRow:r,props:s,numInstances:o}=t;if(e.constant&&"webgpu"!==this.context.device.type)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:d,transform:p}=a;let m=l.binaryAccessor||("function"===typeof d?d:s[d]);"function"!==typeof m&&"string"===typeof d&&(m=()=>s[d]),Qr("function"===typeof m,'accessor "'.concat(d,'" is not a function'));let f=e.getVertexOffset(n);const{iterable:g,objectInfo:_}=Ga(i,n,r);for(const v of g){_.index++;let t=m(v,_);if(p&&(t=p.call(this,t)),h){const i=(_.index<h.length-1?h[_.index+1]:o)-h[_.index];if(t&&Array.isArray(t[0])){let i=f;for(const n of t)e._normalizeValue(n,c,i),i+=u}else t&&t.length>u?c.set(t,f):(e._normalizeValue(t,_.target,0),_e({target:c,source:_.target,start:f,count:i}));f+=i*u}else e._normalizeValue(t,c,f),f+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Ja="#version 300 es\n".concat("out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}");function $a(e){const{input:t,inputChannels:i,output:n}=e||{};if(!t)return Ja;if(!i)throw new Error("inputChannels");const r=function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error("invalid channels: ".concat(e))}}(i),s=function(e,t){switch(t){case 1:return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case 2:return"vec4(".concat(e,", 0.0, 1.0)");case 3:return"vec4(".concat(e,", 1.0)");case 4:return e;default:throw new Error("invalid channels: ".concat(t))}}(t,i);return"#version 300 es\nin ".concat(r," ").concat(t,";\nout vec4 ").concat(n,";\nvoid main() {\n  ").concat(n," = ").concat(s,";\n}")}function Qa(e){return Array.isArray(e)?0===e.length||"number"===typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class el{constructor(e){if((0,s.A)(this,"name",void 0),(0,s.A)(this,"uniforms",{}),(0,s.A)(this,"modifiedUniforms",{}),(0,s.A)(this,"modified",!0),(0,s.A)(this,"bindingLayout",{}),(0,s.A)(this,"needsRedraw","initialized"),this.name=(null===e||void 0===e?void 0:e.name)||"unnamed",null!==e&&void 0!==e&&e.name&&null!==e&&void 0!==e&&e.shaderLayout){var t;const i=null===e||void 0===e||null===(t=e.shaderLayout.bindings)||void 0===t?void 0:t.find(t=>"uniform"===t.type&&t.name===(null===e||void 0===e?void 0:e.name));if(!i)throw new Error(null===e||void 0===e?void 0:e.name);const n=i;for(const e of n.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,i]of Object.entries(e))this._setUniform(t,i),this.needsRedraw||this.setNeedsRedraw("".concat(this.name,".").concat(t,"=").concat(i))}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){(function(e,t){if(e!==t)return!1;const i=e,n=t;if(!Qa(i))return!1;if(Qa(n)&&i.length===n.length)for(let r=0;r<i.length;++r)if(n[r]!==i[r])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=function(e){return Qa(e)?e.slice():e}(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}var tl=i(242),il=i(199);class nl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.A)(this,"layout",{}),(0,s.A)(this,"byteLength",void 0);let i=0;for(const[s,o]of Object.entries(e)){var n;const e=(0,tl.k0)(o),{type:r,components:a}=e,l=a*(null!==(n=null===t||void 0===t?void 0:t[s])&&void 0!==n?n:1);i=(0,La.JP)(i,l);const c=i;i+=l,this.layout[s]={type:r,size:l,offset:c}}i+=(4-i%4)%4;const r=4*i;this.byteLength=Math.max(r,1024)}getData(e){const t=(0,il.o)(this.byteLength),i={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[n,r]of Object.entries(e)){const e=this.layout[n];if(!e){la.R.warn("Supplied uniform value ".concat(n," not present in uniform block layout"))();continue}const{type:t,size:s,offset:o}=e,a=i[t];if(1===s){if("number"!==typeof r&&"boolean"!==typeof r){la.R.warn("Supplied value for single component uniform ".concat(n," is not a number: ").concat(r))();continue}a[o]=Number(r)}else{if(!Qa(r)){la.R.warn("Supplied value for multi component / array uniform ".concat(n," is not a numeric array: ").concat(r))();continue}a.set(r,o)}}return new Uint8Array(t,0,this.byteLength)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class rl{constructor(e){(0,s.A)(this,"uniformBlocks",new Map),(0,s.A)(this,"uniformBufferLayouts",new Map),(0,s.A)(this,"uniformBuffers",new Map);for(const[n,r]of Object.entries(e)){var t,i;const e=n,s=new nl(null!==(t=r.uniformTypes)&&void 0!==t?t:{},null!==(i=r.uniformSizes)&&void 0!==i?i:{});this.uniformBufferLayouts.set(e,s);const o=new el({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(e,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[i,n]of Object.entries(e)){var t;null===(t=this.uniformBlocks.get(i))||void 0===t||t.setUniforms(n)}this.updateUniformBuffers()}getUniformBufferByteLength(e){var t;return(null===(t=this.uniformBufferLayouts.get(e))||void 0===t?void 0:t.byteLength)||0}getUniformBufferData(e){var t,i;const n=(null===(t=this.uniformBlocks.get(e))||void 0===t?void 0:t.getAllUniforms())||{};return null===(i=this.uniformBufferLayouts.get(e))||void 0===i?void 0:i.getData(n)}createUniformBuffer(e,t,i){i&&this.setUniforms(i);const n=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:Ra.h.UNIFORM|Ra.h.COPY_DST,byteLength:n}),s=this.getUniformBufferData(t);return r.write(s),r}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const i=this.getUniformBufferByteLength(t),n=e.createBuffer({usage:Ra.h.UNIFORM|Ra.h.COPY_DST,byteLength:i});this.uniformBuffers.set(t,n)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const i=this.updateUniformBuffer(t);e||(e=i)}return e&&la.R.log(3,"UniformStore.updateUniformBuffers(): ".concat(e))(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let i=this.uniformBuffers.get(e),n=!1;if(i&&null!==t&&void 0!==t&&t.needsRedraw){var r,s;n||(n=t.needsRedraw);const o=this.getUniformBufferData(e);i=this.uniformBuffers.get(e),null===(r=i)||void 0===r||r.write(o);const a=null===(s=this.uniformBlocks.get(e))||void 0===s?void 0:s.getAllUniforms();la.R.log(4,"Writing to uniform buffer ".concat(String(e)),o,a)()}return n}}var sl,ol=i(927),al=i(501),ll=i(698),cl=i(184),ul=i(671);class hl{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class dl{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class pl extends hl{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class ml extends hl{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return"array<".concat(this.format.getTypeName(),", ").concat(this.count,">")}}class fl extends hl{constructor(e,t,i){super(e,i),this.format=t}get isPointer(){return!0}getTypeName(){return"&".concat(this.format.getTypeName())}}class gl extends hl{constructor(e,t,i,n){super(e,i),this.format=t,this.access=n}get isTemplate(){return!0}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+="<".concat(this.format.name,">")}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}(e=>{e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(sl||(sl={}));class _l{constructor(e,t,i,n,r,s,o){this.name=e,this.type=t,this.group=i,this.binding=n,this.attributes=r,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class vl{constructor(e,t){this.name=e,this.type=t}}class yl{constructor(e,t,i,n){this.name=e,this.type=t,this.locationType=i,this.location=n,this.interpolation=null}}class bl{constructor(e,t,i,n){this.name=e,this.type=t,this.locationType=i,this.location=n}}class xl{constructor(e,t,i,n){this.name=e,this.type=t,this.attributes=i,this.id=n}}class wl{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i}}class El{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0;this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=i}}class Al{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function Tl(e){var t=(32768&e)>>15,i=(31744&e)>>10,n=1023&e;return 0==i?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):31==i?n?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,i-15)*(1+n/Math.pow(2,10))}const Dl=new Float32Array(1),Sl=new Int32Array(Dl.buffer),Cl=new Uint16Array(1);function Pl(e){Dl[0]=e;const t=Sl[0],i=t>>31&1;let n=t>>23&255,r=8388607&t;if(255===n)return Cl[0]=i<<15|31744|(0!==r?512:0),Cl[0];if(0===n){if(0===r)return Cl[0]=i<<15,Cl[0];r|=8388608;let e=113;for(;!(8388608&r);)r<<=1,e--;return n=127-e,r&=8388607,n>0?(r=(r>>126-n)+(r>>127-n&1),Cl[0]=i<<15|n<<10|r>>13,Cl[0]):(Cl[0]=i<<15,Cl[0])}return n=n-127+15,n>=31?(Cl[0]=i<<15|31744,Cl[0]):n<=0?n<-10?(Cl[0]=i<<15,Cl[0]):(r=(8388608|r)>>1-n,Cl[0]=i<<15|r>>13,Cl[0]):(r>>=13,Cl[0]=i<<15|n<<10|r,Cl[0])}const Il=new Uint32Array(1),kl=new Float32Array(Il.buffer,0,1);function Ml(e){const t=112+(e>>6&31)<<23|(63&e)<<17;return Il[0]=t,kl[0]}function Rl(e,t,i,n){const r=[0,0,0,0];for(let s=0;s<n;++s)switch(i){case"8unorm":r[s]=e[t]/255,t++;break;case"8snorm":r[s]=e[t]/255*2-1,t++;break;case"8uint":r[s]=e[t],t++;break;case"8sint":r[s]=e[t]-127,t++;break;case"16uint":r[s]=e[t]|e[t+1]<<8,t+=2;break;case"16sint":r[s]=(e[t]|e[t+1]<<8)-32768,t+=2;break;case"16float":r[s]=Tl(e[t]|e[t+1]<<8),t+=2;break;case"32uint":case"32sint":r[s]=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,t+=4;break;case"32float":r[s]=new Float32Array(e.buffer,t,1)[0],t+=4}return r}function Fl(e,t,i,n,r){for(let s=0;s<n;++s)switch(i){case"8unorm":e[t]=255*r[s],t++;break;case"8snorm":e[t]=.5*(r[s]+1)*255,t++;break;case"8uint":e[t]=r[s],t++;break;case"8sint":e[t]=r[s]+127,t++;break;case"16uint":new Uint16Array(e.buffer,t,1)[0]=r[s],t+=2;break;case"16sint":new Int16Array(e.buffer,t,1)[0]=r[s],t+=2;break;case"16float":{const i=Pl(r[s]);new Uint16Array(e.buffer,t,1)[0]=i,t+=2;break}case"32uint":new Uint32Array(e.buffer,t,1)[0]=r[s],t+=4;break;case"32sint":new Int32Array(e.buffer,t,1)[0]=r[s],t+=4;break;case"32float":new Float32Array(e.buffer,t,1)[0]=r[s],t+=4}return r}const Ll={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Ol{constructor(){this.id=Ol._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(Bl.instance);for(const i of e)i instanceof Array?this.searchBlock(i,t):i.search(t);t(zl.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Ol._id=0;class Bl extends Ol{}Bl.instance=new Bl;class zl extends Ol{}zl.instance=new zl;const Nl=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class Ul extends Ol{constructor(){super()}}class jl extends Ul{constructor(e,t,i,n,r,s){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=i,this.body=n,this.startLine=r,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class Vl extends Ul{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class Gl extends Ul{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Wl extends Ul{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class Hl extends Ul{constructor(e,t,i,n){super(),this.init=e,this.condition=t,this.increment=i,this.body=n}get astNodeType(){return"for"}search(e){var t,i,n;null===(t=this.init)||void 0===t||t.search(e),null===(i=this.condition)||void 0===i||i.search(e),null===(n=this.increment)||void 0===n||n.search(e),this.searchBlock(this.body,e)}}class Xl extends Ul{constructor(e,t,i,n,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=n,this.value=r}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class ql extends Ul{constructor(e,t,i){super(),this.attributes=null,this.name=e,this.type=t,this.value=i}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Zl extends Ul{constructor(e,t,i,n,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=n,this.value=r}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class Yl extends Ul{constructor(e,t,i,n,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=n,this.value=r}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var Kl,Jl,$l,Ql;(e=>{e.increment="++",e.decrement="--"})(Kl||(Kl={})),(e=>{e.parse=function(t){const i=t;if("parse"==i)throw new Error("Invalid value for IncrementOperator");return e[i]}})(Kl||(Kl={}));class ec extends Ul{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(e=>{e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(Jl||(Jl={})),(e=>{e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}})(Jl||(Jl={}));class tc extends Ul{constructor(e,t,i){super(),this.operator=e,this.variable=t,this.value=i}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class ic extends Ul{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return Nl.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class nc extends Ul{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),null===(t=this.continuing)||void 0===t||t.search(e)}}class rc extends Ul{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class sc extends Ul{constructor(e,t,i,n){super(),this.condition=e,this.body=t,this.elseif=i,this.else=n}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class oc extends Ul{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class ac extends Ul{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class lc extends Ul{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class cc extends Ul{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class uc extends Ul{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class hc extends Ul{constructor(){super()}get astNodeType(){return"discard"}}class dc extends Ul{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class pc extends Ul{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class mc extends Ul{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if("f32"===t.name)return t;for(let i=1;i<e.length;++i){const n=mc._priority.get(t.name);mc._priority.get(e[i].name)<n&&(t=e[i])}return"x32"===t.name?mc.i32:t}getTypeName(){return this.name}}mc.x32=new mc("x32"),mc.f32=new mc("f32"),mc.i32=new mc("i32"),mc.u32=new mc("u32"),mc.f16=new mc("f16"),mc.bool=new mc("bool"),mc.void=new mc("void"),mc._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class fc extends mc{constructor(e){super(e)}}class gc extends mc{constructor(e,t,i,n){super(e),this.members=t,this.startLine=i,this.endLine=n}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class _c extends mc{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+="<".concat(this.format.name,">")}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}_c.vec2f=new _c("vec2",mc.f32,null),_c.vec3f=new _c("vec3",mc.f32,null),_c.vec4f=new _c("vec4",mc.f32,null),_c.vec2i=new _c("vec2",mc.i32,null),_c.vec3i=new _c("vec3",mc.i32,null),_c.vec4i=new _c("vec4",mc.i32,null),_c.vec2u=new _c("vec2",mc.u32,null),_c.vec3u=new _c("vec3",mc.u32,null),_c.vec4u=new _c("vec4",mc.u32,null),_c.vec2h=new _c("vec2",mc.f16,null),_c.vec3h=new _c("vec3",mc.f16,null),_c.vec4h=new _c("vec4",mc.f16,null),_c.vec2b=new _c("vec2",mc.bool,null),_c.vec3b=new _c("vec3",mc.bool,null),_c.vec4b=new _c("vec4",mc.bool,null),_c.mat2x2f=new _c("mat2x2",mc.f32,null),_c.mat2x3f=new _c("mat2x3",mc.f32,null),_c.mat2x4f=new _c("mat2x4",mc.f32,null),_c.mat3x2f=new _c("mat3x2",mc.f32,null),_c.mat3x3f=new _c("mat3x3",mc.f32,null),_c.mat3x4f=new _c("mat3x4",mc.f32,null),_c.mat4x2f=new _c("mat4x2",mc.f32,null),_c.mat4x3f=new _c("mat4x3",mc.f32,null),_c.mat4x4f=new _c("mat4x4",mc.f32,null),_c.mat2x2h=new _c("mat2x2",mc.f16,null),_c.mat2x3h=new _c("mat2x3",mc.f16,null),_c.mat2x4h=new _c("mat2x4",mc.f16,null),_c.mat3x2h=new _c("mat3x2",mc.f16,null),_c.mat3x3h=new _c("mat3x3",mc.f16,null),_c.mat3x4h=new _c("mat3x4",mc.f16,null),_c.mat4x2h=new _c("mat4x2",mc.f16,null),_c.mat4x3h=new _c("mat4x3",mc.f16,null),_c.mat4x4h=new _c("mat4x4",mc.f16,null),_c.mat2x2i=new _c("mat2x2",mc.i32,null),_c.mat2x3i=new _c("mat2x3",mc.i32,null),_c.mat2x4i=new _c("mat2x4",mc.i32,null),_c.mat3x2i=new _c("mat3x2",mc.i32,null),_c.mat3x3i=new _c("mat3x3",mc.i32,null),_c.mat3x4i=new _c("mat3x4",mc.i32,null),_c.mat4x2i=new _c("mat4x2",mc.i32,null),_c.mat4x3i=new _c("mat4x3",mc.i32,null),_c.mat4x4i=new _c("mat4x4",mc.i32,null),_c.mat2x2u=new _c("mat2x2",mc.u32,null),_c.mat2x3u=new _c("mat2x3",mc.u32,null),_c.mat2x4u=new _c("mat2x4",mc.u32,null),_c.mat3x2u=new _c("mat3x2",mc.u32,null),_c.mat3x3u=new _c("mat3x3",mc.u32,null),_c.mat3x4u=new _c("mat3x4",mc.u32,null),_c.mat4x2u=new _c("mat4x2",mc.u32,null),_c.mat4x3u=new _c("mat4x3",mc.u32,null),_c.mat4x4u=new _c("mat4x4",mc.u32,null);class vc extends mc{constructor(e,t,i,n){super(e),this.storage=t,this.type=i,this.access=n}get astNodeType(){return"pointer"}}class yc extends mc{constructor(e,t,i,n){super(e),this.attributes=t,this.format=i,this.count=n}get astNodeType(){return"array"}get isArray(){return!0}}class bc extends mc{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"sampler"}}class xc extends Ol{constructor(){super(),this.postfix=null}}class wc extends xc{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Ec extends xc{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class Ac extends xc{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Nl.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class Tc extends xc{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class Dc extends xc{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const t=e.evalExpression(this.initializer,e.context);return null!==t&&this.postfix?t.getSubData(e,this.postfix,e.context):t}return null}search(e){this.initializer.search(e)}}class Sc extends xc{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return void 0!==t&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof Wc}get isVector(){return this.value instanceof Xc||this.value instanceof qc}get scalarValue(){return this.value instanceof Wc?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Xc||this.value instanceof qc?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Cc extends xc{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Pc extends xc{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Ic extends xc{constructor(){super()}}class kc extends Ic{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Mc extends Ic{constructor(e,t,i){super(),this.operator=e,this.left=t,this.right=i}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:"f32"===e.name||"f32"===t.name?mc.f32:"u32"===e.name||"u32"===t.name?mc.u32:mc.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Rc extends Ol{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class Fc extends xc{constructor(){super()}get astNodeType(){return"default"}}class Lc extends Rc{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Oc extends Rc{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Bc extends Ol{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"argument"}}class zc extends Ol{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Nc extends Ol{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"member"}}class Uc extends Ol{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class jc{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=jc._id++}clone(){throw"Clone: Not implemented for ".concat(this.constructor.name)}setDataValue(e,t,i,n){console.error("SetDataValue: Not implemented for ".concat(this.constructor.name))}getSubData(e,t,i){return console.error("GetDataValue: Not implemented for ".concat(this.constructor.name)),null}toString(){return"<".concat(this.typeInfo.getTypeName(),">")}}jc._id=0;class Vc extends jc{constructor(){super(new hl("void",null),null)}toString(){return"void"}}Vc.void=new Vc;class Gc extends jc{constructor(e){super(new fl("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,i,n){this.reference.setDataValue(e,t,i,n)}getSubData(e,t,i){return t?this.reference.getSubData(e,t,i):this}toString(){return"&".concat(this.reference.toString())}}class Wc extends jc{constructor(e,t){super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:"x32"===this.typeInfo.name?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):"i32"===this.typeInfo.name||"bool"===this.typeInfo.name?this.data=new Int32Array([e]):"u32"===this.typeInfo.name?this.data=new Uint32Array([e]):"f32"===this.typeInfo.name||"f16"===this.typeInfo.name?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new Wc(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Wc(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Wc(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,i,n){if(i)return void console.error("SetDataValue: Scalar data does not support postfix",i);if(!(t instanceof Wc))return void console.error("SetDataValue: Invalid value",t);let r=t.data[0];"i32"===this.typeInfo.name||"u32"===this.typeInfo.name?r=Math.floor(r):"bool"===this.typeInfo.name&&(r=r?1:0),this.data[0]=r}getSubData(e,t,i){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return"".concat(this.value)}}function Hc(e,t,i){const n=t.length;return 2===n?"f32"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec2f")):"i32"===i||"bool"===i?new Xc(new Int32Array(t),e.getTypeInfo("vec2i")):"u32"===i?new Xc(new Uint32Array(t),e.getTypeInfo("vec2u")):"f16"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec2h")):(console.error("getSubData: Unknown format ".concat(i)),null):3===n?"f32"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec3f")):"i32"===i||"bool"===i?new Xc(new Int32Array(t),e.getTypeInfo("vec3i")):"u32"===i?new Xc(new Uint32Array(t),e.getTypeInfo("vec3u")):"f16"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec3h")):(console.error("getSubData: Unknown format ".concat(i)),null):4===n?"f32"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec4f")):"i32"===i||"bool"===i?new Xc(new Int32Array(t),e.getTypeInfo("vec4i")):"u32"===i?new Xc(new Uint32Array(t),e.getTypeInfo("vec4u")):"f16"===i?new Xc(new Float32Array(t),e.getTypeInfo("vec4h")):(console.error("getSubData: Unknown format ".concat(i)),null):(console.error("getSubData: Invalid vector size ".concat(t.length)),null)}class Xc extends jc{constructor(e,t){if(super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?this.data=new Float32Array(e):"vec2i"===t||"vec3i"===t||"vec4i"===t?this.data=new Int32Array(e):"vec2u"===t||"vec3u"===t||"vec4u"===t?this.data=new Uint32Array(e):"vec2h"===t||"vec3h"===t||"vec4h"===t?this.data=new Float32Array(e):"vec2b"===t||"vec3b"===t||"vec4b"===t?this.data=new Int32Array(e):"vec2"===t||"vec3"===t||"vec4"===t?this.data=new Float32Array(e):console.error("VectorData: Invalid type ".concat(t))}}clone(){if(this.data instanceof Float32Array)return new Xc(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Xc(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Xc(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,i,n){i instanceof wc?console.error("TODO: Set vector postfix"):t instanceof Xc?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(null===t)return this;let n=e.getTypeInfo("f32");if(this.typeInfo instanceof gl)n=this.typeInfo.format||n;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?n=e.getTypeInfo("f32"):"vec2i"===t||"vec3i"===t||"vec4i"===t?n=e.getTypeInfo("i32"):"vec2b"===t||"vec3b"===t||"vec4b"===t?n=e.getTypeInfo("bool"):"vec2u"===t||"vec3u"===t||"vec4u"===t?n=e.getTypeInfo("u32"):"vec2h"===t||"vec3h"===t||"vec4h"===t?n=e.getTypeInfo("f16"):console.error("GetSubData: Unknown type ".concat(t))}let r=this;for(;null!==t&&null!==r;){if(t instanceof Pc){const s=t.index;let o=-1;if(s instanceof Sc){if(!(s.value instanceof Wc))return console.error("GetSubData: Invalid array index ".concat(s.value)),null;o=s.value.value}else{const t=e.evalExpression(s,i);if(!(t instanceof Wc))return console.error("GetSubData: Unknown index type",s),null;o=t.value}if(o<0||o>=r.data.length)return console.error("GetSubData: Index out of range",o),null;if(r.data instanceof Float32Array){const e=new Float32Array(r.data.buffer,r.data.byteOffset+4*o,1);return new Wc(e,n)}if(r.data instanceof Int32Array){const e=new Int32Array(r.data.buffer,r.data.byteOffset+4*o,1);return new Wc(e,n)}if(r.data instanceof Uint32Array){const e=new Uint32Array(r.data.buffer,r.data.byteOffset+4*o,1);return new Wc(e,n)}throw"GetSubData: Invalid data type"}if(!(t instanceof wc))return console.error("GetSubData: Unknown postfix",t),null;{const i=t.value.toLowerCase();if(1===i.length){let e=0;if("x"===i||"r"===i)e=0;else if("y"===i||"g"===i)e=1;else if("z"===i||"b"===i)e=2;else{if("w"!==i&&"a"!==i)return console.error("GetSubData: Unknown member ".concat(i)),null;e=3}if(this.data instanceof Float32Array){let t=new Float32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new Wc(t,n,this)}if(this.data instanceof Int32Array){let t=new Int32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new Wc(t,n,this)}if(this.data instanceof Uint32Array){let t=new Uint32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new Wc(t,n,this)}}const s=[];for(const e of i)"x"===e||"r"===e?s.push(this.data[0]):"y"===e||"g"===e?s.push(this.data[1]):"z"===e||"b"===e?s.push(this.data[2]):"w"===e||"a"===e?s.push(this.data[3]):console.error("GetDataValue: Unknown member ".concat(e));r=Hc(e,s,n.name)}t=t.postfix}return r}toString(){let e="".concat(this.data[0]);for(let t=1;t<this.data.length;++t)e+=", ".concat(this.data[t]);return e}}class qc extends jc{constructor(e,t){super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new qc(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,i,n){i instanceof wc?console.error("TODO: Set matrix postfix"):t instanceof qc?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(null===t)return this;const n=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof gl)this.typeInfo.format;else if(n.endsWith("f"))e.getTypeInfo("f32");else if(n.endsWith("i"))e.getTypeInfo("i32");else if(n.endsWith("u"))e.getTypeInfo("u32");else{if(!n.endsWith("h"))return console.error("GetDataValue: Unknown type ".concat(n)),null;e.getTypeInfo("f16")}if(t instanceof Pc){const r=t.index;let s=-1;if(r instanceof Sc){if(!(r.value instanceof Wc))return console.error("GetDataValue: Invalid array index ".concat(r.value)),null;s=r.value.value}else{const t=e.evalExpression(r,i);if(!(t instanceof Wc))return console.error("GetDataValue: Unknown index type",r),null;s=t.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=n.endsWith("h")?"h":"f";let a;if("mat2x2"===n||"mat2x2f"===n||"mat2x2h"===n||"mat3x2"===n||"mat3x2f"===n||"mat3x2h"===n||"mat4x2"===n||"mat4x2f"===n||"mat4x2h"===n)a=new Xc(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo("vec2".concat(o)));else if("mat2x3"===n||"mat2x3f"===n||"mat2x3h"===n||"mat3x3"===n||"mat3x3f"===n||"mat3x3h"===n||"mat4x3"===n||"mat4x3f"===n||"mat4x3h"===n)a=new Xc(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo("vec3".concat(o)));else{if("mat2x4"!==n&&"mat2x4f"!==n&&"mat2x4h"!==n&&"mat3x4"!==n&&"mat3x4f"!==n&&"mat3x4h"!==n&&"mat4x4"!==n&&"mat4x4f"!==n&&"mat4x4h"!==n)return console.error("GetDataValue: Unknown type ".concat(n)),null;a=new Xc(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo("vec4".concat(o)))}return t.postfix?a.getSubData(e,t.postfix,i):a}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e="".concat(this.data[0]);for(let t=1;t<this.data.length;++t)e+=", ".concat(this.data[t]);return e}}class Zc extends jc{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=i}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Zc(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,i,n){if(null===t)return void console.log("setDataValue: NULL data.");let r=this.offset,s=this.typeInfo;for(;i;){if(i instanceof Pc)if(s instanceof ml){const t=i.index;if(t instanceof Sc){if(!(t.value instanceof Wc))return void console.error("SetDataValue: Invalid index type ".concat(t.value));r+=t.value.value*s.stride}else{const i=e.evalExpression(t,n);if(!(i instanceof Wc))return void console.error("SetDataValue: Unknown index type",t);r+=i.value*s.stride}s=s.format}else console.error("SetDataValue: Type ".concat(s.getTypeName()," is not an array"));else{if(!(i instanceof wc))return void console.error("SetDataValue: Unknown postfix type",i);{const e=i.value;if(s instanceof pl){let t=!1;for(const i of s.members)if(i.name===e){r+=i.offset,s=i.type,t=!0;break}if(!t)return void console.error("SetDataValue: Member ".concat(e," not found"))}else if(s instanceof hl){const i=s.getTypeName();let n=0;if("x"===e||"r"===e)n=0;else if("y"===e||"g"===e)n=1;else if("z"===e||"b"===e)n=2;else{if("w"!==e&&"a"!==e)return void console.error("SetDataValue: Unknown member ".concat(e));n=3}if(!(t instanceof Wc))return void console.error("SetDataValue: Invalid value",t);const o=t.value;return"vec2f"===i?void(new Float32Array(this.buffer,r,2)[n]=o):"vec3f"===i?void(new Float32Array(this.buffer,r,3)[n]=o):"vec4f"===i?void(new Float32Array(this.buffer,r,4)[n]=o):"vec2i"===i?void(new Int32Array(this.buffer,r,2)[n]=o):"vec3i"===i?void(new Int32Array(this.buffer,r,3)[n]=o):"vec4i"===i?void(new Int32Array(this.buffer,r,4)[n]=o):"vec2u"===i?void(new Uint32Array(this.buffer,r,2)[n]=o):"vec3u"===i?void(new Uint32Array(this.buffer,r,3)[n]=o):"vec4u"===i?void(new Uint32Array(this.buffer,r,4)[n]=o):void console.error("SetDataValue: Type ".concat(i," is not a struct"))}}}i=i.postfix}this.setData(e,t,s,r,n)}setData(e,t,i,n,r){const s=i.getTypeName();if("f32"!==s&&"f16"!==s)if("i32"!==s&&"atomic<i32>"!==s&&"x32"!==s)if("u32"!==s&&"atomic<u32>"!==s)if("bool"!==s){if("vec2f"===s||"vec2h"===s){const e=new Float32Array(this.buffer,n,2);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3f"===s||"vec3h"===s){const e=new Float32Array(this.buffer,n,3);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4f"===s||"vec4h"===s){const e=new Float32Array(this.buffer,n,4);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2i"===s){const e=new Int32Array(this.buffer,n,2);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3i"===s){const e=new Int32Array(this.buffer,n,3);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4i"===s){const e=new Int32Array(this.buffer,n,4);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2u"===s){const e=new Uint32Array(this.buffer,n,2);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3u"===s){const e=new Uint32Array(this.buffer,n,3);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4u"===s){const e=new Uint32Array(this.buffer,n,4);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2b"===s){const e=new Uint32Array(this.buffer,n,2);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3b"===s){const e=new Uint32Array(this.buffer,n,3);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4b"===s){const e=new Uint32Array(this.buffer,n,4);return void(t instanceof Xc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x2f"===s||"mat2x2h"===s){const e=new Float32Array(this.buffer,n,4);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x3f"===s||"mat2x3h"===s){const e=new Float32Array(this.buffer,n,6);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat2x4f"===s||"mat2x4h"===s){const e=new Float32Array(this.buffer,n,8);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat3x2f"===s||"mat3x2h"===s){const e=new Float32Array(this.buffer,n,6);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat3x3f"===s||"mat3x3h"===s){const e=new Float32Array(this.buffer,n,9);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]))}if("mat3x4f"===s||"mat3x4h"===s){const e=new Float32Array(this.buffer,n,12);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x2f"===s||"mat4x2h"===s){const e=new Float32Array(this.buffer,n,8);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat4x3f"===s||"mat4x3h"===s){const e=new Float32Array(this.buffer,n,12);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x4f"===s||"mat4x4h"===s){const e=new Float32Array(this.buffer,n,16);return void(t instanceof qc?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11],e[12]=t.data[12],e[13]=t.data[13],e[14]=t.data[14],e[15]=t.data[15]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}if(t instanceof Zc){if(i===t.typeInfo)return void new Uint8Array(this.buffer,n,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",s,t.typeInfo.getTypeName())}else console.error("SetData: Unknown type ".concat(s))}else t instanceof Wc&&(new Int32Array(this.buffer,n,1)[0]=t.value);else t instanceof Wc&&(new Uint32Array(this.buffer,n,1)[0]=t.value);else t instanceof Wc&&(new Int32Array(this.buffer,n,1)[0]=t.value);else t instanceof Wc&&(new Float32Array(this.buffer,n,1)[0]=t.value)}getSubData(e,t,i){var n,r,s;if(null===t)return this;let o=this.offset,a=this.typeInfo;for(;t;){if(t instanceof Pc){const n=t.index,r=n instanceof xc?e.evalExpression(n,i):n;let s=0;if(r instanceof Wc?s=r.value:"number"==typeof r?s=r:console.error("GetDataValue: Invalid index type",n),a instanceof ml)o+=s*a.stride,a=a.format;else{const t=a.getTypeName();"mat4x4"===t||"mat4x4f"===t||"mat4x4h"===t?(o+=16*s,a=e.getTypeInfo("vec4f")):console.error("getDataValue: Type ".concat(a.getTypeName()," is not an array"))}}else{if(!(t instanceof wc))return console.error("GetDataValue: Unknown postfix type",t),null;{const i=t.value;if(a instanceof pl){let e=!1;for(const t of a.members)if(t.name===i){o+=t.offset,a=t.type,e=!0;break}if(!e)return console.error("GetDataValue: Member ".concat(i," not found")),null}else if(a instanceof hl){const t=a.getTypeName();if("vec2f"===t||"vec3f"===t||"vec4f"===t||"vec2i"===t||"vec3i"===t||"vec4i"===t||"vec2u"===t||"vec3u"===t||"vec4u"===t||"vec2b"===t||"vec3b"===t||"vec4b"===t||"vec2h"===t||"vec3h"===t||"vec4h"===t||"vec2"===t||"vec3"===t||"vec4"===t){if(i.length>0&&i.length<5){let n="f";const r=[];for(let s=0;s<i.length;++s){const a=i[s].toLowerCase();let l=0;if("x"===a||"r"===a)l=0;else if("y"===a||"g"===a)l=1;else if("z"===a||"b"===a)l=2;else{if("w"!==a&&"a"!==a)return console.error("Unknown member ".concat(i)),null;l=3}if(1===i.length){if(t.endsWith("f"))return this.buffer.byteLength<o+4*l+4?(console.log("Insufficient buffer data"),null):new Wc(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f32"),this);if(t.endsWith("h"))return new Wc(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f16"),this);if(t.endsWith("i"))return new Wc(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this);if(t.endsWith("b"))return new Wc(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("bool"),this);if(t.endsWith("u"))return new Wc(new Uint32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this)}if("vec2f"===t)r.push(new Float32Array(this.buffer,o,2)[l]);else if("vec3f"===t){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const e=new Float32Array(this.buffer,o,3);r.push(e[l])}else if("vec4f"===t)r.push(new Float32Array(this.buffer,o,4)[l]);else if("vec2i"===t)n="i",r.push(new Int32Array(this.buffer,o,2)[l]);else if("vec3i"===t)n="i",r.push(new Int32Array(this.buffer,o,3)[l]);else if("vec4i"===t)n="i",r.push(new Int32Array(this.buffer,o,4)[l]);else if("vec2u"===t){n="u";const e=new Uint32Array(this.buffer,o,2);r.push(e[l])}else"vec3u"===t?(n="u",r.push(new Uint32Array(this.buffer,o,3)[l])):"vec4u"===t&&(n="u",r.push(new Uint32Array(this.buffer,o,4)[l]))}return 2===r.length?a=e.getTypeInfo("vec2".concat(n)):3===r.length?a=e.getTypeInfo("vec3".concat(n)):4===r.length?a=e.getTypeInfo("vec4".concat(n)):console.error("GetDataValue: Invalid vector length ".concat(r.length)),new Xc(r,a,null)}return console.error("GetDataValue: Unknown member ".concat(i)),null}return console.error("GetDataValue: Type ".concat(t," is not a struct")),null}}}t=t.postfix}const l=a.getTypeName();return"f32"===l?new Wc(new Float32Array(this.buffer,o,1),a,this):"i32"===l?new Wc(new Int32Array(this.buffer,o,1),a,this):"u32"===l?new Wc(new Uint32Array(this.buffer,o,1),a,this):"vec2f"===l?new Xc(new Float32Array(this.buffer,o,2),a,this):"vec3f"===l?new Xc(new Float32Array(this.buffer,o,3),a,this):"vec4f"===l?new Xc(new Float32Array(this.buffer,o,4),a,this):"vec2i"===l?new Xc(new Int32Array(this.buffer,o,2),a,this):"vec3i"===l?new Xc(new Int32Array(this.buffer,o,3),a,this):"vec4i"===l?new Xc(new Int32Array(this.buffer,o,4),a,this):"vec2u"===l?new Xc(new Uint32Array(this.buffer,o,2),a,this):"vec3u"===l?new Xc(new Uint32Array(this.buffer,o,3),a,this):"vec4u"===l?new Xc(new Uint32Array(this.buffer,o,4),a,this):a instanceof gl&&"atomic"===a.name?"u32"===(null===(n=a.format)||void 0===n?void 0:n.name)?new Wc(new Uint32Array(this.buffer,o,1)[0],a.format,this):"i32"===(null===(r=a.format)||void 0===r?void 0:r.name)?new Wc(new Int32Array(this.buffer,o,1)[0],a.format,this):(console.error("GetDataValue: Invalid atomic format ".concat(null===(s=a.format)||void 0===s?void 0:s.name)),null):new Zc(this.buffer,a,o,this)}toString(){let e="";if(this.typeInfo instanceof ml)if("f32"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let i=1;i<t.length;++i)e+=", ".concat(t[i])}else if("i32"===this.typeInfo.format.name){const t=new Int32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let i=1;i<t.length;++i)e+=", ".concat(t[i])}else if("u32"===this.typeInfo.format.name){const t=new Uint32Array(this.buffer,this.offset);e="[".concat(t[0]);for(let i=1;i<t.length;++i)e+=", ".concat(t[i])}else if("vec2f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],"]");for(let i=1;i<t.length/2;++i)e+=", [".concat(t[2*i],", ").concat(t[2*i+1],"]")}else if("vec3f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],", ").concat(t[2],"]");for(let i=4;i<t.length;i+=4)e+=", [".concat(t[i],", ").concat(t[i+1],", ").concat(t[i+2],"]")}else if("vec4f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e="[".concat(t[0],", ").concat(t[1],", ").concat(t[2],", ").concat(t[3],"]");for(let i=4;i<t.length;i+=4)e+=", [".concat(t[i],", ").concat(t[i+1],", ").concat(t[i+2],", ").concat(t[i+3],"]")}else e="[...]";else this.typeInfo instanceof pl?e+="{...}":e="[...]";return e}}class Yc extends jc{constructor(e,t,i,n){super(t,null),this.data=e,this.descriptor=i,this.view=n}clone(){return new Yc(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>0?null!==(e=i[0])&&void 0!==e?e:0:i instanceof Object&&null!==(t=i.width)&&void 0!==t?t:0}get height(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>1?null!==(e=i[1])&&void 0!==e?e:0:i instanceof Object&&null!==(t=i.height)&&void 0!==t?t:0}get depthOrArrayLayers(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>2?null!==(e=i[2])&&void 0!==e?e:0:i instanceof Object&&null!==(t=i.depthOrArrayLayers)&&void 0!==t?t:0}get format(){var e;return this.descriptor&&null!==(e=this.descriptor.format)&&void 0!==e?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&null!==(e=this.descriptor.sampleCount)&&void 0!==e?e:1}get mipLevelCount(){var e;return this.descriptor&&null!==(e=this.descriptor.mipLevelCount)&&void 0!==e?e:1}get dimension(){var e;return this.descriptor&&null!==(e=this.descriptor.dimension)&&void 0!==e?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let i=0;i<t.length;++i)t[i]=Math.max(1,t[i]>>e);return t}get texelByteSize(){const e=this.format,t=Ll[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=Ll[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=Ll[e],i=this.width;if(!e||i<=0||!t)return-1;const n=this.height,r=this.depthOrArrayLayers,s=this.dimension;return i/t.blockWidth*("1d"===s?1:n/t.blockHeight)*t.bytesPerBlock*r}getPixel(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=this.texelByteSize,s=this.bytesPerRow,o=this.height,a=this.data[n];return function(e,t,i,n,r,s,o,a,l){const c=n*(o>>=r)*(s>>=r)+i*o+t*a;switch(l){case"r8unorm":return[Rl(e,c,"8unorm",1)[0]];case"r8snorm":return[Rl(e,c,"8snorm",1)[0]];case"r8uint":return[Rl(e,c,"8uint",1)[0]];case"r8sint":return[Rl(e,c,"8sint",1)[0]];case"rg8unorm":{const t=Rl(e,c,"8unorm",2);return[t[0],t[1]]}case"rg8snorm":{const t=Rl(e,c,"8snorm",2);return[t[0],t[1]]}case"rg8uint":{const t=Rl(e,c,"8uint",2);return[t[0],t[1]]}case"rg8sint":{const t=Rl(e,c,"8sint",2);return[t[0],t[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const t=Rl(e,c,"8unorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8snorm":{const t=Rl(e,c,"8snorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8uint":{const t=Rl(e,c,"8uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba8sint":{const t=Rl(e,c,"8sint",4);return[t[0],t[1],t[2],t[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const t=Rl(e,c,"8unorm",4);return[t[2],t[1],t[0],t[3]]}case"r16uint":return[Rl(e,c,"16uint",1)[0]];case"r16sint":return[Rl(e,c,"16sint",1)[0]];case"r16float":return[Rl(e,c,"16float",1)[0]];case"rg16uint":{const t=Rl(e,c,"16uint",2);return[t[0],t[1]]}case"rg16sint":{const t=Rl(e,c,"16sint",2);return[t[0],t[1]]}case"rg16float":{const t=Rl(e,c,"16float",2);return[t[0],t[1]]}case"rgba16uint":{const t=Rl(e,c,"16uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16sint":{const t=Rl(e,c,"16sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16float":{const t=Rl(e,c,"16float",4);return[t[0],t[1],t[2],t[3]]}case"r32uint":return[Rl(e,c,"32uint",1)[0]];case"r32sint":return[Rl(e,c,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[Rl(e,c,"32float",1)[0]];case"rg32uint":{const t=Rl(e,c,"32uint",2);return[t[0],t[1]]}case"rg32sint":{const t=Rl(e,c,"32sint",2);return[t[0],t[1]]}case"rg32float":{const t=Rl(e,c,"32float",2);return[t[0],t[1]]}case"rgba32uint":{const t=Rl(e,c,"32uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32sint":{const t=Rl(e,c,"32sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32float":{const t=Rl(e,c,"32float",4);return[t[0],t[1],t[2],t[3]]}case"rg11b10ufloat":{const t=new Uint32Array(e.buffer,c,1)[0],i=(4192256&t)>>11,n=(4290772992&t)>>22;return[Ml(2047&t),Ml(i),function(e){const t=112+(e>>5&31)<<23|(31&e)<<18;return Il[0]=t,kl[0]}(n),1]}}return null}(new Uint8Array(a),e,t,i,n,o,s,r,this.format)}setPixel(e,t,i,n,r){const s=this.texelByteSize,o=this.bytesPerRow,a=this.height,l=this.data[n];!function(e,t,i,n,r,s,o,a,l,c){const u=n*(o>>=r)*(s>>=r)+i*o+t*a;switch(l){case"r8unorm":return void Fl(e,u,"8unorm",1,c);case"r8snorm":return void Fl(e,u,"8snorm",1,c);case"r8uint":return void Fl(e,u,"8uint",1,c);case"r8sint":return void Fl(e,u,"8sint",1,c);case"rg8unorm":return void Fl(e,u,"8unorm",2,c);case"rg8snorm":return void Fl(e,u,"8snorm",2,c);case"rg8uint":return void Fl(e,u,"8uint",2,c);case"rg8sint":return void Fl(e,u,"8sint",2,c);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Fl(e,u,"8unorm",4,c);case"rgba8snorm":return void Fl(e,u,"8snorm",4,c);case"rgba8uint":return void Fl(e,u,"8uint",4,c);case"rgba8sint":return void Fl(e,u,"8sint",4,c);case"r16uint":return void Fl(e,u,"16uint",1,c);case"r16sint":return void Fl(e,u,"16sint",1,c);case"r16float":return void Fl(e,u,"16float",1,c);case"rg16uint":return void Fl(e,u,"16uint",2,c);case"rg16sint":return void Fl(e,u,"16sint",2,c);case"rg16float":return void Fl(e,u,"16float",2,c);case"rgba16uint":return void Fl(e,u,"16uint",4,c);case"rgba16sint":return void Fl(e,u,"16sint",4,c);case"rgba16float":return void Fl(e,u,"16float",4,c);case"r32uint":return void Fl(e,u,"32uint",1,c);case"r32sint":return void Fl(e,u,"32sint",1,c);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Fl(e,u,"32float",1,c);case"rg32uint":return void Fl(e,u,"32uint",2,c);case"rg32sint":return void Fl(e,u,"32sint",2,c);case"rg32float":return void Fl(e,u,"32float",2,c);case"rgba32uint":return void Fl(e,u,"32uint",4,c);case"rgba32sint":return void Fl(e,u,"32sint",4,c);case"rgba32float":return void Fl(e,u,"32float",4,c);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}}(new Uint8Array(l),e,t,i,n,a,o,s,this.format,r)}}(e=>{e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(Ql||(Ql={}));class Kc{constructor(e,t,i){this.name=e,this.type=t,this.rule=i}toString(){return this.name}}class Jc{}$l=Jc,Jc.none=new Kc("",Ql.reserved,""),Jc.eof=new Kc("EOF",Ql.token,""),Jc.reserved={asm:new Kc("asm",Ql.reserved,"asm"),bf16:new Kc("bf16",Ql.reserved,"bf16"),do:new Kc("do",Ql.reserved,"do"),enum:new Kc("enum",Ql.reserved,"enum"),f16:new Kc("f16",Ql.reserved,"f16"),f64:new Kc("f64",Ql.reserved,"f64"),handle:new Kc("handle",Ql.reserved,"handle"),i8:new Kc("i8",Ql.reserved,"i8"),i16:new Kc("i16",Ql.reserved,"i16"),i64:new Kc("i64",Ql.reserved,"i64"),mat:new Kc("mat",Ql.reserved,"mat"),premerge:new Kc("premerge",Ql.reserved,"premerge"),regardless:new Kc("regardless",Ql.reserved,"regardless"),typedef:new Kc("typedef",Ql.reserved,"typedef"),u8:new Kc("u8",Ql.reserved,"u8"),u16:new Kc("u16",Ql.reserved,"u16"),u64:new Kc("u64",Ql.reserved,"u64"),unless:new Kc("unless",Ql.reserved,"unless"),using:new Kc("using",Ql.reserved,"using"),vec:new Kc("vec",Ql.reserved,"vec"),void:new Kc("void",Ql.reserved,"void")},Jc.keywords={array:new Kc("array",Ql.keyword,"array"),atomic:new Kc("atomic",Ql.keyword,"atomic"),bool:new Kc("bool",Ql.keyword,"bool"),f32:new Kc("f32",Ql.keyword,"f32"),i32:new Kc("i32",Ql.keyword,"i32"),mat2x2:new Kc("mat2x2",Ql.keyword,"mat2x2"),mat2x3:new Kc("mat2x3",Ql.keyword,"mat2x3"),mat2x4:new Kc("mat2x4",Ql.keyword,"mat2x4"),mat3x2:new Kc("mat3x2",Ql.keyword,"mat3x2"),mat3x3:new Kc("mat3x3",Ql.keyword,"mat3x3"),mat3x4:new Kc("mat3x4",Ql.keyword,"mat3x4"),mat4x2:new Kc("mat4x2",Ql.keyword,"mat4x2"),mat4x3:new Kc("mat4x3",Ql.keyword,"mat4x3"),mat4x4:new Kc("mat4x4",Ql.keyword,"mat4x4"),ptr:new Kc("ptr",Ql.keyword,"ptr"),sampler:new Kc("sampler",Ql.keyword,"sampler"),sampler_comparison:new Kc("sampler_comparison",Ql.keyword,"sampler_comparison"),struct:new Kc("struct",Ql.keyword,"struct"),texture_1d:new Kc("texture_1d",Ql.keyword,"texture_1d"),texture_2d:new Kc("texture_2d",Ql.keyword,"texture_2d"),texture_2d_array:new Kc("texture_2d_array",Ql.keyword,"texture_2d_array"),texture_3d:new Kc("texture_3d",Ql.keyword,"texture_3d"),texture_cube:new Kc("texture_cube",Ql.keyword,"texture_cube"),texture_cube_array:new Kc("texture_cube_array",Ql.keyword,"texture_cube_array"),texture_multisampled_2d:new Kc("texture_multisampled_2d",Ql.keyword,"texture_multisampled_2d"),texture_storage_1d:new Kc("texture_storage_1d",Ql.keyword,"texture_storage_1d"),texture_storage_2d:new Kc("texture_storage_2d",Ql.keyword,"texture_storage_2d"),texture_storage_2d_array:new Kc("texture_storage_2d_array",Ql.keyword,"texture_storage_2d_array"),texture_storage_3d:new Kc("texture_storage_3d",Ql.keyword,"texture_storage_3d"),texture_depth_2d:new Kc("texture_depth_2d",Ql.keyword,"texture_depth_2d"),texture_depth_2d_array:new Kc("texture_depth_2d_array",Ql.keyword,"texture_depth_2d_array"),texture_depth_cube:new Kc("texture_depth_cube",Ql.keyword,"texture_depth_cube"),texture_depth_cube_array:new Kc("texture_depth_cube_array",Ql.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new Kc("texture_depth_multisampled_2d",Ql.keyword,"texture_depth_multisampled_2d"),texture_external:new Kc("texture_external",Ql.keyword,"texture_external"),u32:new Kc("u32",Ql.keyword,"u32"),vec2:new Kc("vec2",Ql.keyword,"vec2"),vec3:new Kc("vec3",Ql.keyword,"vec3"),vec4:new Kc("vec4",Ql.keyword,"vec4"),bitcast:new Kc("bitcast",Ql.keyword,"bitcast"),block:new Kc("block",Ql.keyword,"block"),break:new Kc("break",Ql.keyword,"break"),case:new Kc("case",Ql.keyword,"case"),continue:new Kc("continue",Ql.keyword,"continue"),continuing:new Kc("continuing",Ql.keyword,"continuing"),default:new Kc("default",Ql.keyword,"default"),diagnostic:new Kc("diagnostic",Ql.keyword,"diagnostic"),discard:new Kc("discard",Ql.keyword,"discard"),else:new Kc("else",Ql.keyword,"else"),enable:new Kc("enable",Ql.keyword,"enable"),fallthrough:new Kc("fallthrough",Ql.keyword,"fallthrough"),false:new Kc("false",Ql.keyword,"false"),fn:new Kc("fn",Ql.keyword,"fn"),for:new Kc("for",Ql.keyword,"for"),function:new Kc("function",Ql.keyword,"function"),if:new Kc("if",Ql.keyword,"if"),let:new Kc("let",Ql.keyword,"let"),const:new Kc("const",Ql.keyword,"const"),loop:new Kc("loop",Ql.keyword,"loop"),while:new Kc("while",Ql.keyword,"while"),private:new Kc("private",Ql.keyword,"private"),read:new Kc("read",Ql.keyword,"read"),read_write:new Kc("read_write",Ql.keyword,"read_write"),return:new Kc("return",Ql.keyword,"return"),requires:new Kc("requires",Ql.keyword,"requires"),storage:new Kc("storage",Ql.keyword,"storage"),switch:new Kc("switch",Ql.keyword,"switch"),true:new Kc("true",Ql.keyword,"true"),alias:new Kc("alias",Ql.keyword,"alias"),type:new Kc("type",Ql.keyword,"type"),uniform:new Kc("uniform",Ql.keyword,"uniform"),var:new Kc("var",Ql.keyword,"var"),override:new Kc("override",Ql.keyword,"override"),workgroup:new Kc("workgroup",Ql.keyword,"workgroup"),write:new Kc("write",Ql.keyword,"write"),r8unorm:new Kc("r8unorm",Ql.keyword,"r8unorm"),r8snorm:new Kc("r8snorm",Ql.keyword,"r8snorm"),r8uint:new Kc("r8uint",Ql.keyword,"r8uint"),r8sint:new Kc("r8sint",Ql.keyword,"r8sint"),r16uint:new Kc("r16uint",Ql.keyword,"r16uint"),r16sint:new Kc("r16sint",Ql.keyword,"r16sint"),r16float:new Kc("r16float",Ql.keyword,"r16float"),rg8unorm:new Kc("rg8unorm",Ql.keyword,"rg8unorm"),rg8snorm:new Kc("rg8snorm",Ql.keyword,"rg8snorm"),rg8uint:new Kc("rg8uint",Ql.keyword,"rg8uint"),rg8sint:new Kc("rg8sint",Ql.keyword,"rg8sint"),r32uint:new Kc("r32uint",Ql.keyword,"r32uint"),r32sint:new Kc("r32sint",Ql.keyword,"r32sint"),r32float:new Kc("r32float",Ql.keyword,"r32float"),rg16uint:new Kc("rg16uint",Ql.keyword,"rg16uint"),rg16sint:new Kc("rg16sint",Ql.keyword,"rg16sint"),rg16float:new Kc("rg16float",Ql.keyword,"rg16float"),rgba8unorm:new Kc("rgba8unorm",Ql.keyword,"rgba8unorm"),rgba8unorm_srgb:new Kc("rgba8unorm_srgb",Ql.keyword,"rgba8unorm_srgb"),rgba8snorm:new Kc("rgba8snorm",Ql.keyword,"rgba8snorm"),rgba8uint:new Kc("rgba8uint",Ql.keyword,"rgba8uint"),rgba8sint:new Kc("rgba8sint",Ql.keyword,"rgba8sint"),bgra8unorm:new Kc("bgra8unorm",Ql.keyword,"bgra8unorm"),bgra8unorm_srgb:new Kc("bgra8unorm_srgb",Ql.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new Kc("rgb10a2unorm",Ql.keyword,"rgb10a2unorm"),rg11b10float:new Kc("rg11b10float",Ql.keyword,"rg11b10float"),rg32uint:new Kc("rg32uint",Ql.keyword,"rg32uint"),rg32sint:new Kc("rg32sint",Ql.keyword,"rg32sint"),rg32float:new Kc("rg32float",Ql.keyword,"rg32float"),rgba16uint:new Kc("rgba16uint",Ql.keyword,"rgba16uint"),rgba16sint:new Kc("rgba16sint",Ql.keyword,"rgba16sint"),rgba16float:new Kc("rgba16float",Ql.keyword,"rgba16float"),rgba32uint:new Kc("rgba32uint",Ql.keyword,"rgba32uint"),rgba32sint:new Kc("rgba32sint",Ql.keyword,"rgba32sint"),rgba32float:new Kc("rgba32float",Ql.keyword,"rgba32float"),static_assert:new Kc("static_assert",Ql.keyword,"static_assert")},Jc.tokens={decimal_float_literal:new Kc("decimal_float_literal",Ql.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new Kc("hex_float_literal",Ql.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new Kc("int_literal",Ql.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new Kc("uint_literal",Ql.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new Kc("name",Ql.token,/((?:[A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])(?:[0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088F\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5C\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDC-\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ADD\u1AE0-\u1AEB\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC7\uDEFA-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDF60-\uDF67\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEF5\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]|\uDB40[\uDD00-\uDDEF])+)|((?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037B-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFC5D\uFC64-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDF9\uFE71\uFE73\uFE77\uFE79\uFE7B\uFE7D\uFE7F-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]))/),ident:new Kc("ident",Ql.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new Kc("and",Ql.token,"&"),and_and:new Kc("and_and",Ql.token,"&&"),arrow:new Kc("arrow ",Ql.token,"->"),attr:new Kc("attr",Ql.token,"@"),forward_slash:new Kc("forward_slash",Ql.token,"/"),bang:new Kc("bang",Ql.token,"!"),bracket_left:new Kc("bracket_left",Ql.token,"["),bracket_right:new Kc("bracket_right",Ql.token,"]"),brace_left:new Kc("brace_left",Ql.token,"{"),brace_right:new Kc("brace_right",Ql.token,"}"),colon:new Kc("colon",Ql.token,":"),comma:new Kc("comma",Ql.token,","),equal:new Kc("equal",Ql.token,"="),equal_equal:new Kc("equal_equal",Ql.token,"=="),not_equal:new Kc("not_equal",Ql.token,"!="),greater_than:new Kc("greater_than",Ql.token,">"),greater_than_equal:new Kc("greater_than_equal",Ql.token,">="),shift_right:new Kc("shift_right",Ql.token,">>"),less_than:new Kc("less_than",Ql.token,"<"),less_than_equal:new Kc("less_than_equal",Ql.token,"<="),shift_left:new Kc("shift_left",Ql.token,"<<"),modulo:new Kc("modulo",Ql.token,"%"),minus:new Kc("minus",Ql.token,"-"),minus_minus:new Kc("minus_minus",Ql.token,"--"),period:new Kc("period",Ql.token,"."),plus:new Kc("plus",Ql.token,"+"),plus_plus:new Kc("plus_plus",Ql.token,"++"),or:new Kc("or",Ql.token,"|"),or_or:new Kc("or_or",Ql.token,"||"),paren_left:new Kc("paren_left",Ql.token,"("),paren_right:new Kc("paren_right",Ql.token,")"),semicolon:new Kc("semicolon",Ql.token,";"),star:new Kc("star",Ql.token,"*"),tilde:new Kc("tilde",Ql.token,"~"),underscore:new Kc("underscore",Ql.token,"_"),xor:new Kc("xor",Ql.token,"^"),plus_equal:new Kc("plus_equal",Ql.token,"+="),minus_equal:new Kc("minus_equal",Ql.token,"-="),times_equal:new Kc("times_equal",Ql.token,"*="),division_equal:new Kc("division_equal",Ql.token,"/="),modulo_equal:new Kc("modulo_equal",Ql.token,"%="),and_equal:new Kc("and_equal",Ql.token,"&="),or_equal:new Kc("or_equal",Ql.token,"|="),xor_equal:new Kc("xor_equal",Ql.token,"^="),shift_right_equal:new Kc("shift_right_equal",Ql.token,">>="),shift_left_equal:new Kc("shift_left_equal",Ql.token,"<<=")},Jc.simpleTokens={"@":$l.tokens.attr,"{":$l.tokens.brace_left,"}":$l.tokens.brace_right,":":$l.tokens.colon,",":$l.tokens.comma,"(":$l.tokens.paren_left,")":$l.tokens.paren_right,";":$l.tokens.semicolon},Jc.literalTokens={"&":$l.tokens.and,"&&":$l.tokens.and_and,"->":$l.tokens.arrow,"/":$l.tokens.forward_slash,"!":$l.tokens.bang,"[":$l.tokens.bracket_left,"]":$l.tokens.bracket_right,"=":$l.tokens.equal,"==":$l.tokens.equal_equal,"!=":$l.tokens.not_equal,">":$l.tokens.greater_than,">=":$l.tokens.greater_than_equal,">>":$l.tokens.shift_right,"<":$l.tokens.less_than,"<=":$l.tokens.less_than_equal,"<<":$l.tokens.shift_left,"%":$l.tokens.modulo,"-":$l.tokens.minus,"--":$l.tokens.minus_minus,".":$l.tokens.period,"+":$l.tokens.plus,"++":$l.tokens.plus_plus,"|":$l.tokens.or,"||":$l.tokens.or_or,"*":$l.tokens.star,"~":$l.tokens.tilde,_:$l.tokens.underscore,"^":$l.tokens.xor,"+=":$l.tokens.plus_equal,"-=":$l.tokens.minus_equal,"*=":$l.tokens.times_equal,"/=":$l.tokens.division_equal,"%=":$l.tokens.modulo_equal,"&=":$l.tokens.and_equal,"|=":$l.tokens.or_equal,"^=":$l.tokens.xor_equal,">>=":$l.tokens.shift_right_equal,"<<=":$l.tokens.shift_left_equal},Jc.regexTokens={decimal_float_literal:$l.tokens.decimal_float_literal,hex_float_literal:$l.tokens.hex_float_literal,int_literal:$l.tokens.int_literal,uint_literal:$l.tokens.uint_literal,ident:$l.tokens.ident},Jc.storage_class=[$l.keywords.function,$l.keywords.private,$l.keywords.workgroup,$l.keywords.uniform,$l.keywords.storage],Jc.access_mode=[$l.keywords.read,$l.keywords.write,$l.keywords.read_write],Jc.sampler_type=[$l.keywords.sampler,$l.keywords.sampler_comparison],Jc.sampled_texture_type=[$l.keywords.texture_1d,$l.keywords.texture_2d,$l.keywords.texture_2d_array,$l.keywords.texture_3d,$l.keywords.texture_cube,$l.keywords.texture_cube_array],Jc.multisampled_texture_type=[$l.keywords.texture_multisampled_2d],Jc.storage_texture_type=[$l.keywords.texture_storage_1d,$l.keywords.texture_storage_2d,$l.keywords.texture_storage_2d_array,$l.keywords.texture_storage_3d],Jc.depth_texture_type=[$l.keywords.texture_depth_2d,$l.keywords.texture_depth_2d_array,$l.keywords.texture_depth_cube,$l.keywords.texture_depth_cube_array,$l.keywords.texture_depth_multisampled_2d],Jc.texture_external_type=[$l.keywords.texture_external],Jc.any_texture_type=[...$l.sampled_texture_type,...$l.multisampled_texture_type,...$l.storage_texture_type,...$l.depth_texture_type,...$l.texture_external_type],Jc.texel_format=[$l.keywords.r8unorm,$l.keywords.r8snorm,$l.keywords.r8uint,$l.keywords.r8sint,$l.keywords.r16uint,$l.keywords.r16sint,$l.keywords.r16float,$l.keywords.rg8unorm,$l.keywords.rg8snorm,$l.keywords.rg8uint,$l.keywords.rg8sint,$l.keywords.r32uint,$l.keywords.r32sint,$l.keywords.r32float,$l.keywords.rg16uint,$l.keywords.rg16sint,$l.keywords.rg16float,$l.keywords.rgba8unorm,$l.keywords.rgba8unorm_srgb,$l.keywords.rgba8snorm,$l.keywords.rgba8uint,$l.keywords.rgba8sint,$l.keywords.bgra8unorm,$l.keywords.bgra8unorm_srgb,$l.keywords.rgb10a2unorm,$l.keywords.rg11b10float,$l.keywords.rg32uint,$l.keywords.rg32sint,$l.keywords.rg32float,$l.keywords.rgba16uint,$l.keywords.rgba16sint,$l.keywords.rgba16float,$l.keywords.rgba32uint,$l.keywords.rgba32sint,$l.keywords.rgba32float],Jc.const_literal=[$l.tokens.int_literal,$l.tokens.uint_literal,$l.tokens.decimal_float_literal,$l.tokens.hex_float_literal,$l.keywords.true,$l.keywords.false],Jc.literal_or_ident=[$l.tokens.ident,$l.tokens.int_literal,$l.tokens.uint_literal,$l.tokens.decimal_float_literal,$l.tokens.hex_float_literal,$l.tokens.name],Jc.element_count_expression=[$l.tokens.int_literal,$l.tokens.uint_literal,$l.tokens.ident],Jc.template_types=[$l.keywords.vec2,$l.keywords.vec3,$l.keywords.vec4,$l.keywords.mat2x2,$l.keywords.mat2x3,$l.keywords.mat2x4,$l.keywords.mat3x2,$l.keywords.mat3x3,$l.keywords.mat3x4,$l.keywords.mat4x2,$l.keywords.mat4x3,$l.keywords.mat4x4,$l.keywords.atomic,$l.keywords.bitcast,...$l.any_texture_type],Jc.attribute_name=[$l.tokens.ident,$l.keywords.block,$l.keywords.diagnostic],Jc.assignment_operators=[$l.tokens.equal,$l.tokens.plus_equal,$l.tokens.minus_equal,$l.tokens.times_equal,$l.tokens.division_equal,$l.tokens.modulo_equal,$l.tokens.and_equal,$l.tokens.or_equal,$l.tokens.xor_equal,$l.tokens.shift_right_equal,$l.tokens.shift_left_equal],Jc.increment_operators=[$l.tokens.plus_plus,$l.tokens.minus_minus];class $c{constructor(e,t,i,n,r){this.type=e,this.lexeme=t,this.line=i,this.start=n,this.end=r}toString(){return this.lexeme}isTemplateType(){return-1!=Jc.template_types.indexOf(this.type)}isArrayType(){return this.type==Jc.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class Qc{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw"Invalid syntax at line ".concat(this._line);return this._tokens.push(new $c(Jc.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=Jc.simpleTokens[e];if(t)return this._addToken(t),!0;let i=Jc.none;const n=this._isAlpha(e),r="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(n){const t=Jc.keywords[e];if(t)return this._addToken(t),!0}if(n||r)return this._addToken(Jc.tokens.ident),!0;for(;;){let t=this._findType(e);const n=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==n)return this._current++,e+=n,this._addToken(Jc.tokens.minus_equal),!0;if("-"==n)return this._current++,e+=n,this._addToken(Jc.tokens.minus_minus),!0;const i=this._tokens.length-1;if((-1!=Jc.literal_or_ident.indexOf(this._tokens[i].type)||this._tokens[i].type==Jc.tokens.paren_right)&&">"!=n)return this._addToken(t),!0}if(">"==e&&(">"==n||"="==n)){let e=!1,i=this._tokens.length-1;for(let t=0;t<5&&i>=0&&-1===Jc.assignment_operators.indexOf(this._tokens[i].type);++t,--i)if(this._tokens[i].type===Jc.tokens.less_than){i>0&&this._tokens[i-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===Jc.none){let n=e,r=0;const s=2;for(let e=0;e<s;++e)if(n+=this._peekAhead(e),t=this._findType(n),t!==Jc.none){r=e;break}if(t===Jc.none)return i!==Jc.none&&(this._current--,this._addToken(i),!0);e=n,this._current+=r+1}if(i=t,this._isAtEnd())break;e+=this._advance()}return i!==Jc.none&&(this._addToken(i),!0)}_findType(e){for(const t in Jc.regexTokens){const i=Jc.regexTokens[t];if(this._match(e,i.rule))return i}return Jc.literalTokens[e]||Jc.none}_match(e,t){const i=t.exec(e);return i&&0==i.index&&i[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&"_"!==e&&"."!==e&&"("!==e&&")"!==e&&"["!==e&&"]"!==e&&"{"!==e&&"}"!==e&&","!==e&&";"!==e&&":"!==e&&"="!==e&&"!"!==e&&"<"!==e&&">"!==e&&"+"!==e&&"-"!==e&&"*"!==e&&"/"!==e&&"%"!==e&&"&"!==e&&"|"!==e&&"^"!==e&&"~"!==e&&"@"!==e&&"#"!==e&&"?"!==e&&"'"!==e&&"`"!==e&&'"'!==e&&"\\"!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e&&"\0"!==e}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||"_"===e}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new $c(e,t,this._line,this._start,this._current))}}function eu(e){return Array.isArray(e)||(null==e?void 0:e.buffer)instanceof ArrayBuffer}const tu=new Float32Array(1),iu=new Uint32Array(tu.buffer),nu=new Uint32Array(tu.buffer),ru=new Int32Array(1),su=new Float32Array(ru.buffer),ou=new Uint32Array(ru.buffer),au=new Uint32Array(1),lu=new Float32Array(au.buffer),cu=new Int32Array(au.buffer);function uu(e,t,i){if(t===i)return e;if("f32"===t){if("i32"===i||"x32"===i)return tu[0]=e,iu[0];if("u32"===i)return tu[0]=e,nu[0]}else if("i32"===t||"x32"===t){if("f32"===i)return ru[0]=e,su[0];if("u32"===i)return ru[0]=e,ou[0]}else if("u32"===t){if("f32"===i)return au[0]=e,lu[0];if("i32"===i||"x32"===i)return au[0]=e,cu[0]}return console.error("Unsupported cast from ".concat(t," to ").concat(i)),e}class hu{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class du{constructor(e,t){this.align=e,this.size=t}}class pu{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Al,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}updateAST(e){for(const t of e)t instanceof jl&&this._functions.set(t.name,new hu(t));for(const t of e)if(t instanceof gc){const e=this.getTypeInfo(t,null);e instanceof pl&&this.structs.push(e)}for(const t of e)if(t instanceof uc)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof ql){const e=t,i=this._getAttributeNum(e.attributes,"id",0),n=null!=e.type?this.getTypeInfo(e.type,e.attributes):null;this.overrides.push(new xl(e.name,n,e.attributes,i));continue}if(this._isUniformVar(t)){const e=t,i=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),s=new _l(e.name,r,i,n,e.attributes,sl.Uniform,e.access);s.access||(s.access="read"),this.uniforms.push(s);continue}if(this._isStorageVar(t)){const e=t,i=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(r),o=new _l(e.name,r,i,n,e.attributes,s?sl.StorageTexture:sl.Storage,e.access);o.access||(o.access="read"),this.storage.push(o);continue}if(this._isTextureVar(t)){const e=t,i=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(r),o=new _l(e.name,r,i,n,e.attributes,s?sl.StorageTexture:sl.Texture,e.access);o.access||(o.access="read"),s?this.storage.push(o):this.textures.push(o);continue}if(this._isSamplerVar(t)){const e=t,i=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),s=new _l(e.name,r,i,n,e.attributes,sl.Sampler,e.access);this.samplers.push(s);continue}}for(const t of e)if(t instanceof jl){const e=this._getAttribute(t,"vertex"),i=this._getAttribute(t,"fragment"),n=this._getAttribute(t,"compute"),r=e||i||n,s=new El(t.name,null==r?void 0:r.name,t.attributes);s.attributes=t.attributes,s.startLine=t.startLine,s.endLine=t.endLine,this.functions.push(s),this._functions.get(t.name).info=s,r&&(this._functions.get(t.name).inUse=!0,s.inUse=!0,s.resources=this._findResources(t,!!r),s.inputs=this._getInputs(t.args),s.outputs=this._getOutputs(t.returnType),this.entry[r.name].push(s)),s.arguments=t.args.map(e=>new wl(e.name,this.getTypeInfo(e.type,e.attributes),e.attributes)),s.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(e=>{var i,n,r;if(e instanceof Uc){if(e.value)if(eu(e.value))for(const s of e.value)for(const e of this.overrides)s===e.name&&(null===(i=t.info)||void 0===i||i.overrides.push(e));else for(const s of this.overrides)e.value===s.name&&(null===(n=t.info)||void 0===n||n.overrides.push(s))}else if(e instanceof Tc)for(const s of this.overrides)e.name===s.name&&(null===(r=t.info)||void 0===r||r.overrides.push(s))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var i;for(const n of e.calls){const e=null===(i=this._functions.get(n.name))||void 0===i?void 0:i.info;e&&t.add(e)}}findResource(e,t,i){if(i){for(const n of this.entry.compute)if(n.name===i)for(const i of n.resources)if(i.group==e&&i.binding==t)return i;for(const n of this.entry.vertex)if(n.name===i)for(const i of n.resources)if(i.group==e&&i.binding==t)return i;for(const n of this.entry.fragment)if(n.name===i)for(const i of n.resources)if(i.group==e&&i.binding==t)return i}for(const n of this.uniforms)if(n.group==e&&n.binding==t)return n;for(const n of this.storage)if(n.group==e&&n.binding==t)return n;for(const n of this.textures)if(n.group==e&&n.binding==t)return n;for(const n of this.samplers)if(n.group==e&&n.binding==t)return n;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const i=[],n=this,r=[];return e.search(s=>{if(s instanceof Bl)r.push({});else if(s instanceof zl)r.pop();else if(s instanceof Xl){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),r.length>0&&(r[r.length-1][e.name]=e)}else if(s instanceof Ec){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(s instanceof Zl){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),r.length>0&&(r[r.length-1][e.name]=e)}else if(s instanceof Tc){const e=s;if(r.length>0&&r[r.length-1][e.name])return;const t=n._findResource(e.name);t&&i.push(t)}else if(s instanceof Ac){const r=s,o=n._functions.get(r.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=n._findResources(o.node,t)),i.push(...o.resources))}else if(s instanceof ic){const r=s,o=n._functions.get(r.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=n._findResources(o.node,t)),i.push(...o.resources))}}),[...new Map(i.map(e=>[e.name,e])).values()]}getBindGroups(){const e=[];function t(t,i){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),i>=e[t].length&&(e[t].length=i+1)}for(const i of this.uniforms)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.storage)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.textures)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.samplers)t(i.group,i.binding),e[i.group][i.binding]=i;return e}_getOutputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0===t&&(t=[]),e instanceof gc)this._getStructOutputs(e,t);else{const i=this._getOutputInfo(e);null!==i&&t.push(i)}return t}_getStructOutputs(e,t){for(const i of e.members)if(i.type instanceof gc)this._getStructOutputs(i.type,t);else{const e=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(null!==e){const n=this.getTypeInfo(i.type,i.type.attributes),r=this._parseInt(e.value),s=new bl(i.name,n,e.name,r);t.push(s)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const i=this.getTypeInfo(e,e.attributes),n=this._parseInt(t.value);return new bl("",i,t.name,n)}return null}_getInputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0===t&&(t=[]);for(const i of e)if(i.type instanceof gc)this._getStructInputs(i.type,t);else{const e=this._getInputInfo(i);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const i of e.members)if(i.type instanceof gc)this._getStructInputs(i.type,t);else{const e=this._getInputInfo(i);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const i=this._getAttribute(e,"interpolation"),n=this.getTypeInfo(e.type,e.attributes),r=this._parseInt(t.value),s=new yl(e.name,n,t.name,r);return null!==i&&(s.interpolation=this._parseString(i.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new vl(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._types.has(e))return this._types.get(e);if(e instanceof vc){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,n=new fl(e.name,i,t);return this._types.set(e,n),this._updateTypeInfo(n),n}if(e instanceof yc){const i=e,n=i.format?this.getTypeInfo(i.format,i.attributes):null,r=new ml(i.name,t);return r.format=n,r.count=i.count,this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof gc){const i=e,n=new pl(i.name,t);n.startLine=i.startLine,n.endLine=i.endLine;for(const e of i.members){const t=this.getTypeInfo(e.type,e.attributes);n.members.push(new dl(e.name,t,e.attributes))}return this._types.set(e,n),this._updateTypeInfo(n),n}if(e instanceof bc){const i=e,n=i.format instanceof mc,r=i.format?n?this.getTypeInfo(i.format,null):new hl(i.format,null):null,s=new gl(i.name,r,t,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof _c){const i=e,n=i.format?this.getTypeInfo(i.format,null):null,r=new gl(i.name,n,t,i.access);return this._types.set(e,r),this._updateTypeInfo(r),r}const i=new hl(e.name,t);return this._types.set(e,i),this._updateTypeInfo(i),i}_updateTypeInfo(e){var t,i,n;const r=this._getTypeSize(e);if(e.size=null!==(t=null==r?void 0:r.size)&&void 0!==t?t:0,e instanceof ml&&e.format){const t=this._getTypeSize(e.format);e.stride=Math.max(null!==(i=null==t?void 0:t.size)&&void 0!==i?i:0,null!==(n=null==t?void 0:t.align)&&void 0!==n?n:0),this._updateTypeInfo(e.format)}e instanceof fl&&this._updateTypeInfo(e.format),e instanceof pl&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let i=0,n=0,r=0,s=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const c=l.align,u=l.size;i=this._roundUp(c,i+n),n=u,r=i,s=Math.max(s,c),a.offset=i,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(s,r+n),e.align=s}_getTypeSize(e){var t,i;if(null==e)return null;const n=this._getAttributeNum(e.attributes,"size",0),r=this._getAttributeNum(e.attributes,"align",0);if(e instanceof dl&&(e=e.type),e instanceof hl){const t=this._getAlias(e.name);null!==t&&(e=t)}{const i=pu._typeInfo[e.name];if(void 0!==i){const s="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new du(Math.max(r,i.align/s),Math.max(n,i.size/s))}}{const t=pu._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const i="h"===e.name[e.name.length-1]?2:1;return new du(Math.max(r,t.align/i),Math.max(n,t.size/i))}}if(e instanceof ml){let t=e,s=8,o=8;const a=this._getTypeSize(t.format);return null!==a&&(o=a.size,s=a.align),o=t.count*this._getAttributeNum(null!==(i=null==e?void 0:e.attributes)&&void 0!==i?i:null,"stride",this._roundUp(s,o)),n&&(o=n),new du(Math.max(r,s),Math.max(n,o))}if(e instanceof pl){let t=0,i=0,s=0,o=0,a=0;for(const n of e.members){const e=this._getTypeSize(n.type);null!==e&&(t=Math.max(e.align,t),s=this._roundUp(e.align,s+o),o=e.size,a=s)}return i=this._roundUp(t,a+o),new du(Math.max(r,t),Math.max(n,i))}return null}_isUniformVar(e){return e instanceof Xl&&"uniform"==e.storage}_isStorageVar(e){return e instanceof Xl&&"storage"==e.storage}_isTextureVar(e){return e instanceof Xl&&null!==e.type&&-1!=pu._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof Xl&&null!==e.type&&-1!=pu._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const i=e;if(!i||!i.attributes)return null;const n=i.attributes;for(let r of n)if(r.name==t)return r;return null}_getAttributeNum(e,t,i){if(null===e)return i;for(let n of e)if(n.name==t){let e=null!==n&&null!==n.value?n.value:i;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):i}return i}_roundUp(e,t){return Math.ceil(t/e)*e}}pu._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},pu._textureTypes=Jc.any_texture_type.map(e=>e.name),pu._samplerTypes=Jc.sampler_type.map(e=>e.name);let mu=0;class fu{constructor(e,t,i){this.id=mu++,this.name=e,this.value=t,this.node=i}clone(){return new fu(this.name,this.value,this.node)}}class gu{constructor(e){this.id=mu++,this.name=e.name,this.node=e}clone(){return new gu(this.node)}}class _u{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=mu++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?null!==(t=this.variables.get(e))&&void 0!==t?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?null!==(t=this.functions.get(e))&&void 0!==t?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,i){this.variables.set(e,new fu(e,t,null!=i?i:null))}setVariable(e,t,i){const n=this.getVariable(e);null!==n?n.value=t:this.createVariable(e,t,i)}getVariableValue(e){var t;const i=this.getVariable(e);return null!==(t=null==i?void 0:i.value)&&void 0!==t?t:null}clone(){return new _u(this)}}class vu{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class yu{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const i=this.exec.evalExpression(e.args[0],t);let n=!0;if(i instanceof Xc)return i.data.forEach(e=>{e||(n=!1)}),new Wc(n?1:0,this.getTypeInfo("bool"));throw new Error("All() expects a vector argument. Line ".concat(e.line))}Any(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc){const e=i.data.some(e=>e);return new Wc(e?1:0,this.getTypeInfo("bool"))}throw new Error("Any() expects a vector argument. Line ".concat(e.line))}Select(e,t){const i=this.exec.evalExpression(e.args[2],t);if(!(i instanceof Wc))throw new Error("Select() expects a bool condition. Line ".concat(e.line));return i.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.evalExpression(i,t);if(n instanceof Zc&&0===n.typeInfo.size){const e=n.typeInfo,t=n.buffer.byteLength/e.stride;return new Wc(t,this.getTypeInfo("u32"))}return new Wc(n.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.abs(e)),i.typeInfo);const n=i;return new Wc(Math.abs(n.value),n.typeInfo)}Acos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.acos(e)),i.typeInfo);const n=i;return new Wc(Math.acos(n.value),i.typeInfo)}Acosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.acosh(e)),i.typeInfo);const n=i;return new Wc(Math.acosh(n.value),i.typeInfo)}Asin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.asin(e)),i.typeInfo);const n=i;return new Wc(Math.asin(n.value),i.typeInfo)}Asinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.asinh(e)),i.typeInfo);const n=i;return new Wc(Math.asinh(n.value),i.typeInfo)}Atan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.atan(e)),i.typeInfo);const n=i;return new Wc(Math.atan(n.value),i.typeInfo)}Atanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.atanh(e)),i.typeInfo);const n=i;return new Wc(Math.atanh(n.value),i.typeInfo)}Atan2(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>Math.atan2(e,n.data[t])),i.typeInfo);const r=i,s=n;return new Wc(Math.atan2(r.value,s.value),i.typeInfo)}Ceil(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.ceil(e)),i.typeInfo);const n=i;return new Wc(Math.ceil(n.value),i.typeInfo)}_clamp(e,t,i){return Math.min(Math.max(e,t),i)}Clamp(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(i instanceof Xc&&n instanceof Xc&&r instanceof Xc)return new Xc(i.data.map((e,t)=>this._clamp(e,n.data[t],r.data[t])),i.typeInfo);const s=i,o=n,a=r;return new Wc(this._clamp(s.value,o.value,a.value),i.typeInfo)}Cos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.cos(e)),i.typeInfo);const n=i;return new Wc(Math.cos(n.value),i.typeInfo)}Cosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.cosh(e)),i.typeInfo);const n=i;return new Wc(Math.cos(n.value),i.typeInfo)}CountLeadingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.clz32(e)),i.typeInfo);const n=i;return new Wc(Math.clz32(n.value),i.typeInfo)}_countOneBits(e){let t=0;for(;0!==e;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>this._countOneBits(e)),i.typeInfo);const n=i;return new Wc(this._countOneBits(n.value),i.typeInfo)}_countTrailingZeros(e){if(0===e)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>this._countTrailingZeros(e)),i.typeInfo);const n=i;return new Wc(this._countTrailingZeros(n.value),i.typeInfo)}Cross(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc){if(3!==i.data.length||3!==n.data.length)return console.error("Cross() expects 3D vectors. Line ".concat(e.line)),null;const t=i.data,r=n.data;return new Xc([t[1]*r[2]-r[1]*t[2],t[2]*r[0]-r[2]*t[0],t[0]*r[1]-r[0]*t[1]],i.typeInfo)}return console.error("Cross() expects vector arguments. Line ".concat(e.line)),null}Degrees(e,t){const i=this.exec.evalExpression(e.args[0],t),n=180/Math.PI;return i instanceof Xc?new Xc(i.data.map(e=>e*n),i.typeInfo):new Wc(i.value*n,this.getTypeInfo("f32"))}Determinant(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof qc){const e=i.data,t=i.typeInfo.getTypeName(),n=t.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t)return new Wc(e[0]*e[3]-e[1]*e[2],n);if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t)return new Wc(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),n);if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t)console.error("TODO: Determinant for ".concat(t));else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t)console.error("TODO: Determinant for ".concat(t));else{if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t)return new Wc(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),n);"mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t||"mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t||"mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t?console.error("TODO: Determinant for ".concat(t)):"mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t||console.error("TODO: Determinant for ".concat(t))}}return console.error("Determinant expects a matrix argument. Line ".concat(e.line)),null}Distance(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc){let e=0;for(let t=0;t<i.data.length;++t)e+=(i.data[t]-n.data[t])*(i.data[t]-n.data[t]);return new Wc(Math.sqrt(e),this.getTypeInfo("f32"))}const r=i,s=n;return new Wc(Math.abs(r.value-s.value),i.typeInfo)}_dot(e,t){let i=0;for(let n=0;n<e.length;++n)i+=t[n]*e[n];return i}Dot(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);return i instanceof Xc&&n instanceof Xc?new Wc(this._dot(i.data,n.data),this.getTypeInfo("f32")):(console.error("Dot() expects vector arguments. Line ".concat(e.line)),null)}Dot4U8Packed(e,t){return console.error("TODO: dot4U8Packed. Line ".concat(e.line)),null}Dot4I8Packed(e,t){return console.error("TODO: dot4I8Packed. Line ".concat(e.line)),null}Exp(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.exp(e)),i.typeInfo);const n=i;return new Wc(Math.exp(n.value),i.typeInfo)}Exp2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.pow(2,e)),i.typeInfo);const n=i;return new Wc(Math.pow(2,n.value),i.typeInfo)}ExtractBits(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if("u32"!==n.typeInfo.name&&"x32"!==n.typeInfo.name)return console.error("ExtractBits() expects an i32 offset argument. Line ".concat(e.line)),null;if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return console.error("ExtractBits() expects an i32 count argument. Line ".concat(e.line)),null;const s=n.value,o=r.value;if(i instanceof Xc)return new Xc(i.data.map(e=>e>>s&(1<<o)-1),i.typeInfo);if("i32"!==i.typeInfo.name&&"x32"!==i.typeInfo.name)return console.error("ExtractBits() expects an i32 argument. Line ".concat(e.line)),null;const a=i.value;return new Wc(a>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(i instanceof Xc&&n instanceof Xc&&r instanceof Xc){const e=this._dot(n.data,r.data);return new Xc(e<0?Array.from(i.data):i.data.map(e=>-e),i.typeInfo)}return console.error("FaceForward() expects vector arguments. Line ".concat(e.line)),null}_firstLeadingBit(e){return 0===e?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>this._firstLeadingBit(e)),i.typeInfo);const n=i;return new Wc(this._firstLeadingBit(n.value),i.typeInfo)}_firstTrailingBit(e){return 0===e?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>this._firstTrailingBit(e)),i.typeInfo);const n=i;return new Wc(this._firstTrailingBit(n.value),i.typeInfo)}Floor(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.floor(e)),i.typeInfo);const n=i;return new Wc(Math.floor(n.value),i.typeInfo)}Fma(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(i instanceof Xc&&n instanceof Xc&&r instanceof Xc)return i.data.length!==n.data.length||i.data.length!==r.data.length?(console.error("Fma() expects vectors of the same length. Line ".concat(e.line)),null):new Xc(i.data.map((e,t)=>e*n.data[t]+r.data[t]),i.typeInfo);const s=i,o=n,a=r;return new Wc(s.value*o.value+a.value,s.typeInfo)}Fract(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>e-Math.floor(e)),i.typeInfo);const n=i;return new Wc(n.value-Math.floor(n.value),i.typeInfo)}Frexp(e,t){return console.error("TODO: frexp. Line ".concat(e.line)),null}InsertBits(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t),s=this.exec.evalExpression(e.args[3],t);if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return console.error("InsertBits() expects an i32 offset argument. Line ".concat(e.line)),null;const o=r.value,a=(1<<s.value)-1<<o,l=~a;if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>e&l|n.data[t]<<o&a),i.typeInfo);const c=i.value,u=n.value;return new Wc(c&l|u<<o&a,i.typeInfo)}InverseSqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>1/Math.sqrt(e)),i.typeInfo);const n=i;return new Wc(1/Math.sqrt(n.value),i.typeInfo)}Ldexp(e,t){return console.error("TODO: ldexp. Line ".concat(e.line)),null}Length(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc){let e=0;return i.data.forEach(t=>{e+=t*t}),new Wc(Math.sqrt(e),this.getTypeInfo("f32"))}const n=i;return new Wc(Math.abs(n.value),i.typeInfo)}Log(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.log(e)),i.typeInfo);const n=i;return new Wc(Math.log(n.value),i.typeInfo)}Log2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.log2(e)),i.typeInfo);const n=i;return new Wc(Math.log2(n.value),i.typeInfo)}Max(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>Math.max(e,n.data[t])),i.typeInfo);const r=i,s=n;return new Wc(Math.max(r.value,s.value),i.typeInfo)}Min(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>Math.min(e,n.data[t])),i.typeInfo);const r=i,s=n;return new Wc(Math.min(r.value,s.value),i.typeInfo)}Mix(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(i instanceof Xc&&n instanceof Xc&&r instanceof Xc)return new Xc(i.data.map((e,t)=>i.data[t]*(1-r.data[t])+n.data[t]*r.data[t]),i.typeInfo);const s=n,o=r;return new Wc(i.value*(1-o.value)+s.value*o.value,i.typeInfo)}Modf(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>e%n.data[t]),i.typeInfo);const r=n;return new Wc(i.value%r.value,i.typeInfo)}Normalize(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc){const n=this.Length(e,t).value;return new Xc(i.data.map(e=>e/n),i.typeInfo)}return console.error("Normalize() expects a vector argument. Line ".concat(e.line)),null}Pow(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc)return new Xc(i.data.map((e,t)=>Math.pow(e,n.data[t])),i.typeInfo);const r=i,s=n;return new Wc(Math.pow(r.value,s.value),i.typeInfo)}QuantizeToF16(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof Xc?new Xc(i.data.map(e=>e),i.typeInfo):new Wc(i.value,i.typeInfo)}Radians(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof Xc?new Xc(i.data.map(e=>e*Math.PI/180),i.typeInfo):new Wc(i.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(i instanceof Xc&&n instanceof Xc){const e=this._dot(i.data,n.data);return new Xc(i.data.map((t,i)=>t-2*e*n.data[i]),i.typeInfo)}return console.error("Reflect() expects vector arguments. Line ".concat(e.line)),null}Refract(e,t){let i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(i instanceof Xc&&n instanceof Xc&&r instanceof Wc){const e=this._dot(n.data,i.data);return new Xc(i.data.map((t,i)=>{const s=1-r.value*r.value*(1-e*e);if(s<0)return 0;const o=Math.sqrt(s);return r.value*t-(r.value*e+o)*n.data[i]}),i.typeInfo)}return console.error("Refract() expects vector arguments and a scalar argument. Line ".concat(e.line)),null}ReverseBits(e,t){return console.error("TODO: reverseBits. Line ".concat(e.line)),null}Round(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.round(e)),i.typeInfo);const n=i;return new Wc(Math.round(n.value),i.typeInfo)}Saturate(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.min(Math.max(e,0),1)),i.typeInfo);const n=i;return new Wc(Math.min(Math.max(n.value,0),1),i.typeInfo)}Sign(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.sign(e)),i.typeInfo);const n=i;return new Wc(Math.sign(n.value),i.typeInfo)}Sin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.sin(e)),i.typeInfo);const n=i;return new Wc(Math.sin(n.value),i.typeInfo)}Sinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.sinh(e)),i.typeInfo);const n=i;return new Wc(Math.sinh(n.value),i.typeInfo)}_smoothstep(e,t,i){const n=Math.min(Math.max((i-e)/(t-e),0),1);return n*n*(3-2*n)}SmoothStep(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(r instanceof Xc&&i instanceof Xc&&n instanceof Xc)return new Xc(r.data.map((e,t)=>this._smoothstep(i.data[t],n.data[t],e)),r.typeInfo);const s=i,o=n,a=r;return new Wc(this._smoothstep(s.value,o.value,a.value),r.typeInfo)}Sqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.sqrt(e)),i.typeInfo);const n=i;return new Wc(Math.sqrt(n.value),i.typeInfo)}Step(e,t){const i=this.exec.evalExpression(e.args[0],t),n=this.exec.evalExpression(e.args[1],t);if(n instanceof Xc&&i instanceof Xc)return new Xc(n.data.map((e,t)=>e<i.data[t]?0:1),n.typeInfo);const r=i;return new Wc(n.value<r.value?0:1,r.typeInfo)}Tan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.tan(e)),i.typeInfo);const n=i;return new Wc(Math.tan(n.value),i.typeInfo)}Tanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.tanh(e)),i.typeInfo);const n=i;return new Wc(Math.tanh(n.value),i.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return"mat2x2f"===t||"mat2x2h"===t?e:"mat2x3f"===t?this.getTypeInfo("mat3x2f"):"mat2x3h"===t?this.getTypeInfo("mat3x2h"):"mat2x4f"===t?this.getTypeInfo("mat4x2f"):"mat2x4h"===t?this.getTypeInfo("mat4x2h"):"mat3x2f"===t?this.getTypeInfo("mat2x3f"):"mat3x2h"===t?this.getTypeInfo("mat2x3h"):"mat3x3f"===t||"mat3x3h"===t?e:"mat3x4f"===t?this.getTypeInfo("mat4x3f"):"mat3x4h"===t?this.getTypeInfo("mat4x3h"):"mat4x2f"===t?this.getTypeInfo("mat2x4f"):"mat4x2h"===t?this.getTypeInfo("mat2x4h"):"mat4x3f"===t?this.getTypeInfo("mat3x4f"):"mat4x3h"===t?this.getTypeInfo("mat3x4h"):("mat4x4f"===t||"mat4x4h"===t||console.error("Invalid matrix type ".concat(t)),e)}Transpose(e,t){const i=this.exec.evalExpression(e.args[0],t);if(!(i instanceof qc))return console.error("Transpose() expects a matrix argument. Line ".concat(e.line)),null;const n=this._getTransposeType(i.typeInfo);if("mat2x2"===i.typeInfo.name||"mat2x2f"===i.typeInfo.name||"mat2x2h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[2],e[1],e[3]],n)}if("mat2x3"===i.typeInfo.name||"mat2x3f"===i.typeInfo.name||"mat2x3h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[3],e[6],e[1],e[4],e[7]],n)}if("mat2x4"===i.typeInfo.name||"mat2x4f"===i.typeInfo.name||"mat2x4h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13]],n)}if("mat3x2"===i.typeInfo.name||"mat3x2f"===i.typeInfo.name||"mat3x2h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[3],e[1],e[4],e[2],e[5]],n)}if("mat3x3"===i.typeInfo.name||"mat3x3f"===i.typeInfo.name||"mat3x3h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]],n)}if("mat3x4"===i.typeInfo.name||"mat3x4f"===i.typeInfo.name||"mat3x4h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14]],n)}if("mat4x2"===i.typeInfo.name||"mat4x2f"===i.typeInfo.name||"mat4x2h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[4],e[1],e[5],e[2],e[6]],n)}if("mat4x3"===i.typeInfo.name||"mat4x3f"===i.typeInfo.name||"mat4x3h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]],n)}if("mat4x4"===i.typeInfo.name||"mat4x4f"===i.typeInfo.name||"mat4x4h"===i.typeInfo.name){const e=i.data;return new qc([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]],n)}return console.error("Invalid matrix type ".concat(i.typeInfo.name)),null}Trunc(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Xc)return new Xc(i.data.map(e=>Math.trunc(e)),i.typeInfo);const n=i;return new Wc(Math.trunc(n.value),i.typeInfo)}Dpdx(e,t){return console.error("TODO: dpdx. Line ".concat(e.line)),null}DpdxCoarse(e,t){return console.error("TODO: dpdxCoarse. Line ".concat(e.line)),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const i=e.args[0],n=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(i instanceof Tc){const r=i.name,s=t.getVariableValue(r);if(s instanceof Yc){if(n<0||n>=s.mipLevelCount)return console.error("Invalid mip level for textureDimensions. Line ".concat(e.line)),null;const t=s.getMipLevelSize(n),i=s.dimension;return"1d"===i?new Wc(t[0],this.getTypeInfo("u32")):"3d"===i?new Xc(t,this.getTypeInfo("vec3u")):"2d"===i?new Xc(t.slice(0,2),this.getTypeInfo("vec2u")):(console.error("Invalid texture dimension ".concat(i," not found. Line ").concat(e.line)),null)}return console.error("Texture ".concat(r," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureDimensions. Line ".concat(e.line)),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const i=e.args[0],n=this.exec.evalExpression(e.args[1],t),r=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(n instanceof Xc)||2!==n.data.length)return console.error("Invalid UV argument for textureLoad. Line ".concat(e.line)),null;if(i instanceof Tc){const s=i.name,o=t.getVariableValue(s);if(o instanceof Yc){const t=Math.floor(n.data[0]),i=Math.floor(n.data[1]);if(t<0||t>=o.width||i<0||i>=o.height)return console.error("Texture ".concat(s," out of bounds. Line ").concat(e.line)),null;const a=o.getPixel(t,i,0,r);return null===a?(console.error("Invalid texture format for textureLoad. Line ".concat(e.line)),null):new Xc(a,this.getTypeInfo("vec4f"))}return console.error("Texture ".concat(s," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureLoad. Line ".concat(e.line)),null}TextureNumLayers(e,t){const i=e.args[0];if(i instanceof Tc){const n=i.name,r=t.getVariableValue(n);return r instanceof Yc?new Wc(r.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error("Texture ".concat(n," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumLayers. Line ".concat(e.line)),null}TextureNumLevels(e,t){const i=e.args[0];if(i instanceof Tc){const n=i.name,r=t.getVariableValue(n);return r instanceof Yc?new Wc(r.mipLevelCount,this.getTypeInfo("u32")):(console.error("Texture ".concat(n," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumLevels. Line ".concat(e.line)),null}TextureNumSamples(e,t){const i=e.args[0];if(i instanceof Tc){const n=i.name,r=t.getVariableValue(n);return r instanceof Yc?new Wc(r.sampleCount,this.getTypeInfo("u32")):(console.error("Texture ".concat(n," not found. Line ").concat(e.line)),null)}return console.error("Invalid texture argument for textureNumSamples. Line ".concat(e.line)),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const i=e.args[0],n=this.exec.evalExpression(e.args[1],t),r=4===e.args.length?this.exec.evalExpression(e.args[2],t).value:0,s=4===e.args.length?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(4!==s.length)return console.error("Invalid value argument for textureStore. Line ".concat(e.line)),null;if(!(n instanceof Xc)||2!==n.data.length)return console.error("Invalid UV argument for textureStore. Line ".concat(e.line)),null;if(i instanceof Tc){const o=i.name,a=t.getVariableValue(o);if(a instanceof Yc){const t=a.getMipLevelSize(0),i=Math.floor(n.data[0]),l=Math.floor(n.data[1]);return i<0||i>=t[0]||l<0||l>=t[1]?(console.error("Texture ".concat(o," out of bounds. Line ").concat(e.line)),null):(a.setPixel(i,l,0,r,Array.from(s)),null)}return console.error("Texture ".concat(o," not found. Line ").concat(e.line)),null}return console.error("Invalid texture argument for textureStore. Line ".concat(e.line)),null}AtomicLoad(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t);return t.getVariable(n).value.getSubData(this.exec,i.postfix,t)}AtomicStore(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t);return a instanceof Wc&&o instanceof Wc&&(a.value=o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),null}AtomicAdd(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value+=o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicSub(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value-=o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicMax(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=Math.max(a.value,o.value)),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicMin(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=Math.min(a.value,o.value)),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicAnd(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=a.value&o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicOr(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=a.value|o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicXor(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=a.value^o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicExchange(e,t){let i=e.args[0];i instanceof kc&&(i=i.right);const n=this.exec.getVariableName(i,t),r=t.getVariable(n);let s=e.args[1];const o=this.exec.evalExpression(s,t),a=r.value.getSubData(this.exec,i.postfix,t),l=new Wc(a.value,a.typeInfo);return a instanceof Wc&&o instanceof Wc&&(a.value=o.value),r.value instanceof Zc&&r.value.setDataValue(this.exec,a,i.postfix,t),l}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const bu={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},xu={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class wu extends vu{constructor(e,t){var i;super(),this.ast=null!=e?e:[],this.reflection=new pu,this.reflection.updateAST(this.ast),this.context=null!==(i=null==t?void 0:t.clone())&&void 0!==i?i:new _u,this.builtins=new yu(this),this.typeInfo={bool:this.getTypeInfo(mc.bool),i32:this.getTypeInfo(mc.i32),u32:this.getTypeInfo(mc.u32),f32:this.getTypeInfo(mc.f32),f16:this.getTypeInfo(mc.f16),vec2f:this.getTypeInfo(_c.vec2f),vec2u:this.getTypeInfo(_c.vec2u),vec2i:this.getTypeInfo(_c.vec2i),vec2h:this.getTypeInfo(_c.vec2h),vec3f:this.getTypeInfo(_c.vec3f),vec3u:this.getTypeInfo(_c.vec3u),vec3i:this.getTypeInfo(_c.vec3i),vec3h:this.getTypeInfo(_c.vec3h),vec4f:this.getTypeInfo(_c.vec4f),vec4u:this.getTypeInfo(_c.vec4u),vec4i:this.getTypeInfo(_c.vec4i),vec4h:this.getTypeInfo(_c.vec4h),mat2x2f:this.getTypeInfo(_c.mat2x2f),mat2x3f:this.getTypeInfo(_c.mat2x3f),mat2x4f:this.getTypeInfo(_c.mat2x4f),mat3x2f:this.getTypeInfo(_c.mat3x2f),mat3x3f:this.getTypeInfo(_c.mat3x3f),mat3x4f:this.getTypeInfo(_c.mat3x4f),mat4x2f:this.getTypeInfo(_c.mat4x2f),mat4x3f:this.getTypeInfo(_c.mat4x3f),mat4x4f:this.getTypeInfo(_c.mat4x4f)}}getVariableValue(e){var t,i;const n=null!==(i=null===(t=this.context.getVariable(e))||void 0===t?void 0:t.value)&&void 0!==i?i:null;if(null===n)return null;if(n instanceof Wc)return n.value;if(n instanceof Xc)return Array.from(n.data);if(n instanceof qc)return Array.from(n.data);if(n instanceof Zc&&n.typeInfo instanceof ml){if("u32"===n.typeInfo.format.name)return Array.from(new Uint32Array(n.buffer,n.offset,n.typeInfo.count));if("i32"===n.typeInfo.format.name)return Array.from(new Int32Array(n.buffer,n.offset,n.typeInfo.count));if("f32"===n.typeInfo.format.name)return Array.from(new Float32Array(n.buffer,n.offset,n.typeInfo.count))}return console.error("Unsupported return variable type ".concat(n.typeInfo.name)),null}execute(e){(e=null!=e?e:{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,i,n){const r=this.context.clone();(n=null!=n?n:{}).constants&&this._setOverrides(n.constants,r),this._execStatements(this.ast,r);const s=r.getFunction(e);if(!s)return void console.error("Function ".concat(e," not found"));if("number"==typeof t)t=[t,1,1];else{if(0===t.length)return void console.error("Invalid dispatch count");1===t.length?t=[t[0],1,1]:2===t.length?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const o=t[0],a=t[1],l=t[2],c=this.getTypeInfo("vec3u");r.setVariable("@num_workgroups",new Xc(t,c));const u=this.reflection.getFunctionInfo(e);null===u&&console.error("Function ".concat(e," not found in reflection data"));for(const h in i)for(const e in i[h]){const t=i[h][e];r.variables.forEach(i=>{var n;const r=i.node;if(null==r?void 0:r.attributes){let s=null,o=null;for(const e of r.attributes)"binding"===e.name?s=e.value:"group"===e.name&&(o=e.value);if(e==s&&h==o){let s=!1;for(const t of u.resources)if(t.name===i.name&&t.group===parseInt(h)&&t.binding===parseInt(e)){s=!0;break}if(s)if(void 0!==t.texture&&void 0!==t.descriptor){const e=new Yc(t.texture,this.getTypeInfo(r.type),t.descriptor,null!==(n=t.texture.view)&&void 0!==n?n:null);i.value=e}else void 0!==t.uniform?i.value=new Zc(t.uniform,this.getTypeInfo(r.type)):i.value=new Zc(t,this.getTypeInfo(r.type))}}})}for(let h=0;h<l;++h)for(let e=0;e<a;++e)for(let t=0;t<o;++t)r.setVariable("@workgroup_id",new Xc([t,e,h],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[t,e,h],r)}execStatement(e,t){if(e instanceof oc)return this.evalExpression(e.value,t);if(e instanceof dc){if(e.condition){const i=this.evalExpression(e.condition,t);if(!(i instanceof Wc))throw new Error("Invalid break-if condition");if(!i.value)return null}return wu._breakObj}if(e instanceof pc)return wu._continueObj;if(e instanceof Zl)this._let(e,t);else if(e instanceof Xl)this._var(e,t);else if(e instanceof Yl)this._const(e,t);else if(e instanceof jl)this._function(e,t);else{if(e instanceof sc)return this._if(e,t);if(e instanceof rc)return this._switch(e,t);if(e instanceof Hl)return this._for(e,t);if(e instanceof Gl)return this._while(e,t);if(e instanceof nc)return this._loop(e,t);if(e instanceof Wl){const i=t.clone();return i.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,i)}if(e instanceof tc)this._assign(e,t);else if(e instanceof ec)this._increment(e,t);else{if(e instanceof gc)return null;if(e instanceof ql){const i=e.name;null===t.getVariable(i)&&t.setVariable(i,new Wc(0,this.getTypeInfo("u32")))}else if(e instanceof ic)this._call(e,t);else{if(e instanceof cc)return null;if(e instanceof uc)return null;console.error("Invalid statement type.",e,"Line ".concat(e.line))}}}return null}evalExpression(e,t){return e instanceof Mc?this._evalBinaryOp(e,t):e instanceof Sc?this._evalLiteral(e,t):e instanceof Tc?this._evalVariable(e,t):e instanceof Ac?this._evalCall(e,t):e instanceof Ec?this._evalCreate(e,t):e instanceof Dc?this._evalConst(e,t):e instanceof Cc?this._evalBitcast(e,t):e instanceof kc?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,"Line ".concat(e.line)),null)}getTypeInfo(e){var t;if(e instanceof mc){const t=this.reflection.getTypeInfo(e);if(null!==t)return t}let i=null!==(t=this.typeInfo[e])&&void 0!==t?t:null;return null!==i||(i=this.reflection.getTypeInfoByName(e)),i}_setOverrides(e,t){for(const i in e){const n=e[i],r=this.reflection.getOverrideInfo(i);null!==r?(null===r.type&&(r.type=this.getTypeInfo("u32")),"u32"===r.type.name||"i32"===r.type.name||"f32"===r.type.name||"f16"===r.type.name?t.setVariable(i,new Wc(n,r.type)):"bool"===r.type.name?t.setVariable(i,new Wc(n?1:0,r.type)):"vec2"===r.type.name||"vec3"===r.type.name||"vec4"===r.type.name||"vec2f"===r.type.name||"vec3f"===r.type.name||"vec4f"===r.type.name||"vec2i"===r.type.name||"vec3i"===r.type.name||"vec4i"===r.type.name||"vec2u"===r.type.name||"vec3u"===r.type.name||"vec4u"===r.type.name||"vec2h"===r.type.name||"vec3h"===r.type.name||"vec4h"===r.type.name?t.setVariable(i,new Xc(n,r.type)):console.error("Invalid constant type for ".concat(i))):console.error("Override ".concat(i," does not exist in the shader."))}}_dispatchWorkgroup(e,t,i){const n=[1,1,1];for(const c of e.node.attributes)if("workgroup_size"===c.name){if(c.value.length>0){const e=i.getVariableValue(c.value[0]);n[0]=e instanceof Wc?e.value:parseInt(c.value[0])}if(c.value.length>1){const e=i.getVariableValue(c.value[1]);n[1]=e instanceof Wc?e.value:parseInt(c.value[1])}if(c.value.length>2){const e=i.getVariableValue(c.value[2]);n[2]=e instanceof Wc?e.value:parseInt(c.value[2])}}const r=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");i.setVariable("@workgroup_size",new Xc(n,r));const o=n[0],a=n[1],l=n[2];for(let c=0,u=0;c<l;++c)for(let l=0;l<a;++l)for(let a=0;a<o;++a,++u){const o=[a,l,c],h=[a+t[0]*n[0],l+t[1]*n[1],c+t[2]*n[2]];i.setVariable("@local_invocation_id",new Xc(o,r)),i.setVariable("@global_invocation_id",new Xc(h,r)),i.setVariable("@local_invocation_index",new Wc(u,s)),this._dispatchExec(e,i)}}_dispatchExec(e,t){for(const i of e.node.args)for(const e of i.attributes)if("builtin"===e.name){const n="@".concat(e.value),r=t.getVariable(n);void 0!==r&&t.variables.set(i.name,r)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof kc;)e=e.right;return e instanceof Tc?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const i of e){if(i instanceof Array){const e=t.clone(),n=this._execStatements(i,e);if(n)return n;continue}const e=this.execStatement(i,t);if(e)return e}return null}_call(e,t){const i=t.clone();i.currentFunctionName=e.name;const n=t.getFunction(e.name);if(n){for(let t=0;t<n.node.args.length;++t){const r=n.node.args[t],s=this.evalExpression(e.args[t],i);i.setVariable(r.name,s,r)}this._execStatements(n.node.body,i)}else e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const i=this.getVariableName(e.variable,t),n=t.getVariable(i);n?"++"===e.operator?n.value instanceof Wc?n.value.value++:console.error("Variable ".concat(i," is not a scalar. Line ").concat(e.line)):"--"===e.operator?n.value instanceof Wc?n.value.value--:console.error("Variable ".concat(i," is not a scalar. Line ").concat(e.line)):console.error("Unknown increment operator ".concat(e.operator,". Line ").concat(e.line)):console.error("Variable ".concat(i," not found. Line ").concat(e.line))}_getVariableData(e,t){if(e instanceof Tc){const i=this.getVariableName(e,t),n=t.getVariable(i);return null===n?(console.error("Variable ".concat(i," not found. Line ").concat(e.line)),null):n.value.getSubData(this,e.postfix,t)}if(e instanceof kc){if("*"===e.operator){const i=this._getVariableData(e.right,t);return i instanceof Gc?i.reference.getSubData(this,e.postfix,t):(console.error("Variable ".concat(e.right," is not a pointer. Line ").concat(e.line)),null)}if("&"===e.operator){const i=this._getVariableData(e.right,t);return new Gc(i)}}return null}_assign(e,t){let i=null,n="<var>",r=null;if(e.variable instanceof kc){const i=this._getVariableData(e.variable,t),n=this.evalExpression(e.value,t),r=e.operator;if("="===r){if(i instanceof Wc||i instanceof Xc||i instanceof qc){if(n instanceof Wc||n instanceof Xc||n instanceof qc&&i.data.length===n.data.length)return void i.data.set(n.data);console.error("Invalid assignment. Line ".concat(e.line))}else if(i instanceof Zc&&n instanceof Zc&&i.buffer.byteLength-i.offset>=n.buffer.byteLength-n.offset)return void(i.buffer.byteLength%4==0?new Uint32Array(i.buffer,i.offset,i.typeInfo.size/4).set(new Uint32Array(n.buffer,n.offset,n.typeInfo.size/4)):new Uint8Array(i.buffer,i.offset,i.typeInfo.size).set(new Uint8Array(n.buffer,n.offset,n.typeInfo.size)));return console.error("Invalid assignment. Line ".concat(e.line)),null}if("+="===r)return i instanceof Wc||i instanceof Xc||i instanceof qc?n instanceof Wc||n instanceof Xc||n instanceof qc?void i.data.set(n.data.map((e,t)=>i.data[t]+e)):void console.error("Invalid assignment . Line ".concat(e.line)):void console.error("Invalid assignment. Line ".concat(e.line));if("-="===r)return(i instanceof Wc||i instanceof Xc||i instanceof qc)&&(n instanceof Wc||n instanceof Xc||n instanceof qc)?void i.data.set(n.data.map((e,t)=>i.data[t]-e)):void console.error("Invalid assignment. Line ".concat(e.line))}if(e.variable instanceof kc){if("*"===e.variable.operator){n=this.getVariableName(e.variable.right,t);const r=t.getVariable(n);if(!(r&&r.value instanceof Gc))return void console.error("Variable ".concat(n," is not a pointer. Line ").concat(e.line));i=r.value.reference;let s=e.variable.postfix;if(!s){let t=e.variable.right;for(;t instanceof kc;){if(t.postfix){s=t.postfix;break}t=t.right}}s&&(i=i.getSubData(this,s,t))}}else{r=e.variable.postfix,n=this.getVariableName(e.variable,t);const s=t.getVariable(n);if(null===s)return void console.error("Variable ".concat(n," not found. Line ").concat(e.line));i=s.value}if(i instanceof Gc&&(i=i.reference),null===i)return void console.error("Variable ".concat(n," not found. Line ").concat(e.line));const s=this.evalExpression(e.value,t),o=e.operator;if("="!==o){const n=i.getSubData(this,r,t);if(n instanceof Xc&&s instanceof Wc){const t=n.data,i=s.value;if("+="===o)for(let e=0;e<t.length;++e)t[e]+=i;else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=i;else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=i;else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=i;else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=i;else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=i;else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=i;else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=i;else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=i;else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=i;else console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}else if(n instanceof Xc&&s instanceof Xc){const t=n.data,i=s.data;if(t.length!==i.length)return void console.error("Vector length mismatch. Line ".concat(e.line));if("+="===o)for(let e=0;e<t.length;++e)t[e]+=i[e];else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=i[e];else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=i[e];else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=i[e];else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=i[e];else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=i[e];else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=i[e];else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=i[e];else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=i[e];else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=i[e];else console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}else{if(!(n instanceof Wc&&s instanceof Wc))return void console.error("Invalid type for ".concat(e.operator," operator. Line ").concat(e.line));"+="===o?n.value+=s.value:"-="===o?n.value-=s.value:"*="===o?n.value*=s.value:"/="===o?n.value/=s.value:"%="===o?n.value%=s.value:"&="===o?n.value&=s.value:"|="===o?n.value|=s.value:"^="===o?n.value^=s.value:"<<="===o?n.value<<=s.value:">>="===o?n.value>>=s.value:console.error("Invalid operator ".concat(o,". Line ").concat(e.line))}return void(i instanceof Zc&&i.setDataValue(this,n,r,t))}if(i instanceof Zc)i.setDataValue(this,s,r,t);else if(r){if(!(i instanceof Xc||i instanceof qc))return void console.error("Variable ".concat(n," is not a vector or matrix. Line ").concat(e.line));if(r instanceof Pc){const o=this.evalExpression(r.index,t).value;if(i instanceof Xc){if(!(s instanceof Wc))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[o]=s.value}else{if(!(i instanceof qc))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));{const o=this.evalExpression(r.index,t).value;if(o<0)return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));if(!(s instanceof Xc))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));{const t=i.typeInfo.getTypeName();if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t){if(!(o<2&&2===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[2*o]=s.data[0],i.data[2*o+1]=s.data[1]}else if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t){if(!(o<2&&3===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[3*o]=s.data[0],i.data[3*o+1]=s.data[1],i.data[3*o+2]=s.data[2]}else if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t){if(!(o<2&&4===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[4*o]=s.data[0],i.data[4*o+1]=s.data[1],i.data[4*o+2]=s.data[2],i.data[4*o+3]=s.data[3]}else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t){if(!(o<3&&2===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[2*o]=s.data[0],i.data[2*o+1]=s.data[1]}else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t){if(!(o<3&&3===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[3*o]=s.data[0],i.data[3*o+1]=s.data[1],i.data[3*o+2]=s.data[2]}else if("mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t){if(!(o<3&&4===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[4*o]=s.data[0],i.data[4*o+1]=s.data[1],i.data[4*o+2]=s.data[2],i.data[4*o+3]=s.data[3]}else if("mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t){if(!(o<4&&2===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[2*o]=s.data[0],i.data[2*o+1]=s.data[1]}else if("mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t){if(!(o<4&&3===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[3*o]=s.data[0],i.data[3*o+1]=s.data[1],i.data[3*o+2]=s.data[2]}else{if("mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t)return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));if(!(o<4&&4===s.data.length))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));i.data[4*o]=s.data[0],i.data[4*o+1]=s.data[1],i.data[4*o+2]=s.data[2],i.data[4*o+3]=s.data[3]}}}}}else if(r instanceof wc){const t=r.value;if(!(i instanceof Xc))return void console.error("Invalid assignment to ".concat(t,". Variable ").concat(n," is not a vector. Line ").concat(e.line));if(s instanceof Wc){if(t.length>1)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(n,". Line ").concat(e.line));if("x"===t)i.data[0]=s.value;else if("y"===t){if(i.data.length<2)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(n,". Line ").concat(e.line));i.data[1]=s.value}else if("z"===t){if(i.data.length<3)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(n,". Line ").concat(e.line));i.data[2]=s.value}else if("w"===t){if(i.data.length<4)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(n,". Line ").concat(e.line));i.data[3]=s.value}}else{if(!(s instanceof Xc))return void console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line));if(t.length!==s.data.length)return void console.error("Invalid assignment to ".concat(t," for variable ").concat(n,". Line ").concat(e.line));for(let r=0;r<t.length;++r){const o=t[r];if("x"===o||"r"===o)i.data[0]=s.data[r];else if("y"===o||"g"===o){if(s.data.length<2)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(n,". Line ").concat(e.line));i.data[1]=s.data[r]}else if("z"===o||"b"===o){if(s.data.length<3)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(n,". Line ").concat(e.line));i.data[2]=s.data[r]}else{if("w"!==o&&"a"!==o)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(n,". Line ").concat(e.line));if(s.data.length<4)return void console.error("Invalid assignment to ".concat(o," for variable ").concat(n,". Line ").concat(e.line));i.data[3]=s.data[r]}}}}}else i instanceof Wc&&s instanceof Wc?i.value=s.value:i instanceof Xc&&s instanceof Xc||i instanceof qc&&s instanceof qc?i.data.set(s.data):console.error("Invalid assignment to ".concat(n,". Line ").concat(e.line))}_function(e,t){const i=new gu(e);t.functions.set(e.name,i)}_const(e,t){let i=null;null!==e.value&&(i=this.evalExpression(e.value,t)),t.createVariable(e.name,i,e)}_let(e,t){let i=null;if(null!==e.value){if(i=this.evalExpression(e.value,t),null===i)return void console.error("Invalid value for variable ".concat(e.name,". Line ").concat(e.line));e.value instanceof kc||(i=i.clone())}else{const n=e.type.name;if("f32"===n||"i32"===n||"u32"===n||"bool"===n||"f16"===n||"vec2"===n||"vec3"===n||"vec4"===n||"vec2f"===n||"vec3f"===n||"vec4f"===n||"vec2i"===n||"vec3i"===n||"vec4i"===n||"vec2u"===n||"vec3u"===n||"vec4u"===n||"vec2h"===n||"vec3h"===n||"vec4h"===n||"vec2b"===n||"vec3b"===n||"vec4b"===n||"mat2x2"===n||"mat2x3"===n||"mat2x4"===n||"mat3x2"===n||"mat3x3"===n||"mat3x4"===n||"mat4x2"===n||"mat4x3"===n||"mat4x4"===n||"mat2x2f"===n||"mat2x3f"===n||"mat2x4f"===n||"mat3x2f"===n||"mat3x3f"===n||"mat3x4f"===n||"mat4x2f"===n||"mat4x3f"===n||"mat4x4f"===n||"mat2x2h"===n||"mat2x3h"===n||"mat2x4h"===n||"mat3x2h"===n||"mat3x3h"===n||"mat3x4h"===n||"mat4x2h"===n||"mat4x3h"===n||"mat4x4h"===n||"array"===n){const n=new Ec(e.type,[]);i=this._evalCreate(n,t)}}t.createVariable(e.name,i,e)}_var(e,t){let i=null;if(null!==e.value){if(i=this.evalExpression(e.value,t),null===i)return void console.error("Invalid value for variable ".concat(e.name,". Line ").concat(e.line));e.value instanceof kc||(i=i.clone())}else{if(null===e.type)return void console.error("Variable ".concat(e.name," has no type. Line ").concat(e.line));const n=e.type.name;if("f32"===n||"i32"===n||"u32"===n||"bool"===n||"f16"===n||"vec2"===n||"vec3"===n||"vec4"===n||"vec2f"===n||"vec3f"===n||"vec4f"===n||"vec2i"===n||"vec3i"===n||"vec4i"===n||"vec2u"===n||"vec3u"===n||"vec4u"===n||"vec2h"===n||"vec3h"===n||"vec4h"===n||"vec2b"===n||"vec3b"===n||"vec4b"===n||"mat2x2"===n||"mat2x3"===n||"mat2x4"===n||"mat3x2"===n||"mat3x3"===n||"mat3x4"===n||"mat4x2"===n||"mat4x3"===n||"mat4x4"===n||"mat2x2f"===n||"mat2x3f"===n||"mat2x4f"===n||"mat3x2f"===n||"mat3x3f"===n||"mat3x4f"===n||"mat4x2f"===n||"mat4x3f"===n||"mat4x4f"===n||"mat2x2h"===n||"mat2x3h"===n||"mat2x4h"===n||"mat3x2h"===n||"mat3x3h"===n||"mat3x4h"===n||"mat4x2h"===n||"mat4x3h"===n||"mat4x4h"===n||e.type instanceof yc||e.type instanceof gc||e.type instanceof _c){const n=new Ec(e.type,[]);i=this._evalCreate(n,t)}}t.createVariable(e.name,i,e)}_switch(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof Wc))return console.error("Invalid if condition. Line ".concat(e.line)),null;let n=null;for(const r of e.cases)if(r instanceof Lc)for(const s of r.selectors){if(s instanceof Fc){n=r;continue}const o=this.evalExpression(s,t);if(!(o instanceof Wc))return console.error("Invalid case selector. Line ".concat(e.line)),null;if(o.value===i.value)return this._execStatements(r.body,t)}else r instanceof Oc&&(n=r);return n?this._execStatements(n.body,t):null}_if(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof Wc))return console.error("Invalid if condition. Line ".concat(e.line)),null;if(i.value)return this._execStatements(e.body,t);for(const n of e.elseif){const i=this.evalExpression(n.condition,t);if(!(i instanceof Wc))return console.error("Invalid if condition. Line ".concat(e.line)),null;if(i.value)return this._execStatements(n.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof Wc?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===wu._breakObj)break;if(null!==i&&i!==wu._continueObj)return i;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const i=this._execStatements(e.body,t);if(i===wu._breakObj)break;if(i===wu._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===wu._breakObj)break}else if(null!==i)return i}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===wu._breakObj)break;if(i!==wu._continueObj&&null!==i)return i}return null}_evalBitcast(e,t){const i=this.evalExpression(e.value,t),n=e.type;if(i instanceof Wc){const e=uu(i.value,i.typeInfo.name,n.name);return new Wc(e,this.getTypeInfo(n))}if(i instanceof Xc){const t=i.typeInfo.getTypeName();let r="";if(t.endsWith("f"))r="f32";else if(t.endsWith("i"))r="i32";else if(t.endsWith("u"))r="u32";else if(t.endsWith("b"))r="bool";else{if(!t.endsWith("h"))return console.error("Unknown vector type ".concat(t,". Line ").concat(e.line)),null;r="f16"}const s=n.getTypeName();let o="";if(s.endsWith("f"))o="f32";else if(s.endsWith("i"))o="i32";else if(s.endsWith("u"))o="u32";else if(s.endsWith("b"))o="bool";else{if(!s.endsWith("h"))return console.error("Unknown vector type ".concat(o,". Line ").concat(e.line)),null;o="f16"}const a=function(e,t,i){if(t===i)return e;const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=uu(e[r],t,i);return n}(Array.from(i.data),r,o);return new Xc(a,this.getTypeInfo(n))}return console.error("TODO: bitcast for ".concat(i.typeInfo.name,". Line ").concat(e.line)),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var i;if(e instanceof Ec){if(null===e.type)return Vc.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const n=e instanceof Ec?e.type.name:e.name,r=e instanceof Ec?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(null===r)return console.error("Unknown type ".concat(n,". Line ").concat(e.line)),null;if(0===r.size)return null;const s=new Zc(new ArrayBuffer(r.size),r,0);if(r instanceof pl){if(e.args)for(let o=0;o<e.args.length;++o){const i=r.members[o],n=e.args[o],a=this.evalExpression(n,t);s.setData(this,a,i.type,i.offset,t)}}else if(r instanceof ml){let n=0;if(e.args)for(let o=0;o<e.args.length;++o){const a=e.args[o],l=this.evalExpression(a,t);null===r.format&&("x32"===(null===(i=l.typeInfo)||void 0===i?void 0:i.name)?r.format=this.getTypeInfo("i32"):r.format=l.typeInfo),s.setData(this,l,r.format,n,t),n+=r.stride}}else console.error('Unknown type "'.concat(n,'". Line ').concat(e.line));return e instanceof Ec?s.getSubData(this,e.postfix,t):s}_evalLiteral(e,t){const i=this.getTypeInfo(e.type),n=i.name;return"x32"===n||"u32"===n||"f32"===n||"f16"===n||"i32"===n||"bool"===n?new Wc(e.scalarValue,i):"vec2"===n||"vec3"===n||"vec4"===n||"vec2f"===n||"vec3f"===n||"vec4f"===n||"vec2h"===n||"vec3h"===n||"vec4h"===n||"vec2i"===n||"vec3i"===n||"vec4i"===n||"vec2u"===n||"vec3u"===n||"vec4u"===n?this._callConstructorVec(e,t):"mat2x2"===n||"mat2x3"===n||"mat2x4"===n||"mat3x2"===n||"mat3x3"===n||"mat3x4"===n||"mat4x2"===n||"mat4x3"===n||"mat4x4"===n||"mat2x2f"===n||"mat2x3f"===n||"mat2x4f"===n||"mat3x2f"===n||"mat3x3f"===n||"mat3x4f"===n||"mat4x2f"===n||"mat4x3f"===n||"mat4x4f"===n||"mat2x2h"===n||"mat2x3h"===n||"mat2x4h"===n||"mat3x2h"===n||"mat3x3h"===n||"mat3x4h"===n||"mat4x2h"===n||"mat4x3h"===n||"mat4x4h"===n?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const i=t.getVariableValue(e.name);return null===i?i:i.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if("f32"===t.name)return t;for(let i=1;i<e.length;++i){const n=wu._priority.get(t.name);wu._priority.get(e[i].name)<n&&(t=e[i])}return"x32"===t.name?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const i=this.evalExpression(e.right,t);if("&"===e.operator)return new Gc(i);if("*"===e.operator)return i instanceof Gc?i.reference.getSubData(this,e.postfix,t):(console.error("Invalid dereference. Line ".concat(e.line)),null);const n=i instanceof Wc?i.value:i instanceof Xc?Array.from(i.data):null;switch(e.operator){case"+":{if(eu(n)){const e=n.map((e,t)=>+e);return new Xc(e,i.typeInfo)}const e=n,t=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new Wc(+e,t)}case"-":{if(eu(n)){const e=n.map((e,t)=>-e);return new Xc(e,i.typeInfo)}const e=n,t=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new Wc(-e,t)}case"!":{if(eu(n)){const e=n.map((e,t)=>e?0:1);return new Xc(e,i.typeInfo)}const e=n,t=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new Wc(e?0:1,t)}case"~":{if(eu(n)){const e=n.map((e,t)=>~e);return new Xc(e,i.typeInfo)}const e=n,t=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new Wc(~e,t)}}return console.error("Invalid unary operator ".concat(e.operator,". Line ").concat(e.line)),null}_evalBinaryOp(e,t){const i=this.evalExpression(e.left,t),n=this.evalExpression(e.right,t),r=i instanceof Wc?i.value:i instanceof Xc||i instanceof qc?Array.from(i.data):null,s=n instanceof Wc?n.value:n instanceof Xc||n instanceof qc?Array.from(n.data):null;switch(e.operator){case"+":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e+n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t+e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e+t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t+o,a)}case"-":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e-n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t-e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e-t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t-o,a)}case"*":{if(eu(r)&&eu(s)){const t=r,o=s;if(i instanceof qc&&n instanceof qc){const r=function(e,t,i,n){if(void 0===xu[t.name]||void 0===xu[n.name])return null;const r=xu[t.name][0],s=xu[t.name][1],o=xu[n.name][0];if(r!==xu[n.name][1])return null;const a=new Array(o*s);for(let l=0;l<s;l++)for(let t=0;t<o;t++){let n=0;for(let o=0;o<r;o++)n+=e[o*s+l]*i[t*r+o];a[l*o+t]=n}return a}(t,i.typeInfo,o,n.typeInfo);if(null===r)return console.error("Matrix multiplication failed. Line ".concat(e.line,".")),null;const s=xu[n.typeInfo.name][0],a=xu[i.typeInfo.name][1],l=this.getTypeInfo("mat".concat(s,"x").concat(a,"f"));return new qc(r,l)}if(i instanceof qc&&n instanceof Xc){const r=function(e,t,i,n){if(void 0===xu[t.name]||void 0===bu[n.name])return null;const r=xu[t.name][0],s=xu[t.name][1];if(r!==i.length)return null;const o=new Array(s);for(let a=0;a<s;a++){let t=0;for(let n=0;n<r;n++)t+=e[n*s+a]*i[n];o[a]=t}return o}(t,i.typeInfo,o,n.typeInfo);return null===r?(console.error("Matrix vector multiplication failed. Line ".concat(e.line,".")),null):new Xc(r,n.typeInfo)}if(i instanceof Xc&&n instanceof qc){const r=function(e,t,i,n){if(void 0===bu[t.name]||void 0===xu[n.name])return null;const r=xu[n.name][0],s=xu[n.name][1];if(s!==e.length)return null;const o=[];for(let a=0;a<r;a++){let t=0;for(let n=0;n<s;n++)t+=e[n]*i[n*r+a];o[a]=t}return o}(t,i.typeInfo,o,n.typeInfo);return null===r?(console.error("Matrix vector multiplication failed. Line ".concat(e.line,".")),null):new Xc(r,i.typeInfo)}{if(t.length!==o.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const n=t.map((e,t)=>e*o[t]);return new Xc(n,i.typeInfo)}}if(eu(r)){const e=s,t=r.map((t,i)=>t*e);return i instanceof qc?new qc(t,i.typeInfo):new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e*t);return n instanceof qc?new qc(t,n.typeInfo):new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t*o,a)}case"%":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e%n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t%e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e%t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t%o,a)}case"/":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e/n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t/e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e/t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t/o,a)}case"&":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e&n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t&e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e&t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t&o,a)}case"|":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e|n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t|e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e|t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t|o,a)}case"^":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e^n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t^e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e^t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t^o,a)}case"<<":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<<n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t<<e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e<<t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t<<o,a)}case">>":{if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>>n[t]);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t>>e);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e>>t);return new Xc(t,n.typeInfo)}const t=r,o=s,a=this._maxFormatTypeInfo([i.typeInfo,n.typeInfo]);return new Wc(t>>o,a)}case">":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t>e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e>t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r>s?1:0,this.getTypeInfo("bool"));case"<":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t<e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e<t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r<s?1:0,this.getTypeInfo("bool"));case"==":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e===n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t==e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e==t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r===s?1:0,this.getTypeInfo("bool"));case"!=":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e!==n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t!==e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e!==t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r!==s?1:0,this.getTypeInfo("bool"));case">=":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e>=n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t>=e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e>=t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r>=s?1:0,this.getTypeInfo("bool"));case"<=":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e<=n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t<=e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e<=t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r<=s?1:0,this.getTypeInfo("bool"));case"&&":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e&&n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t&&e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e&&t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r&&s?1:0,this.getTypeInfo("bool"));case"||":if(eu(r)&&eu(s)){const t=r,n=s;if(t.length!==n.length)return console.error("Vector length mismatch. Line ".concat(e.line,".")),null;const o=t.map((e,t)=>e||n[t]?1:0);return new Xc(o,i.typeInfo)}if(eu(r)){const e=s,t=r.map((t,i)=>t||e?1:0);return new Xc(t,i.typeInfo)}if(eu(s)){const e=r,t=s.map((t,i)=>e||t?1:0);return new Xc(t,n.typeInfo)}return new Wc(r||s?1:0,this.getTypeInfo("bool"))}return console.error("Unknown operator ".concat(e.operator,". Line ").concat(e.line)),null}_evalCall(e,t){if(null!==e.cachedReturnValue)return e.cachedReturnValue;const i=t.clone();i.currentFunctionName=e.name;const n=t.getFunction(e.name);if(!n)return e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error('Unknown function "'.concat(e.name,'". Line ').concat(e.line)),null);for(let r=0;r<n.node.args.length;++r){const t=n.node.args[r],s=this.evalExpression(e.args[r],i);i.createVariable(t.name,s,t)}return this._execStatements(n.node.body,i)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const i=t.getFunction(e.name);if(i){const n=t.clone();for(let t=0;t<i.node.args.length;++t){const r=i.node.args[t],s=this.evalExpression(e.args[t],n);n.setVariable(r.name,s,r)}return this._execStatements(i.node.body,n)}return null}_callConstructorValue(e,t){if(!e.args||0===e.args.length)return new Wc(0,this.getTypeInfo(e.type));const i=this.evalExpression(e.args[0],t);return i.typeInfo=this.getTypeInfo(e.type),i.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const i=this.getTypeInfo(e.type),n=e.type.getTypeName(),r=bu[n];if(void 0===r)return console.error("Invalid vec constructor ".concat(n,". Line ").concat(e.line)),null;const s=[];if(e instanceof Sc)if(e.isVector){const t=e.vectorValue;for(const e of t)s.push(e)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);if(e instanceof Xc){const t=e.data;for(let e=0;e<t.length;++e){let i=t[e];s.push(i)}}else if(e instanceof Wc){let t=e.value;s.push(t)}}if(e.type instanceof _c&&null===e.type.format&&(e.type.format=_c.f32),0===s.length){const n=new Array(r).fill(0);return new Xc(n,i).getSubData(this,e.postfix,t)}if(1===s.length)for(;s.length<r;)s.push(s[0]);return s.length<r?(console.error("Invalid vec constructor. Line ".concat(e.line)),null):new Xc(s.length>r?s.slice(0,r):s,i).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const i=this.getTypeInfo(e.type),n=e.type.getTypeName(),r=xu[n];if(void 0===r)return console.error("Invalid matrix constructor ".concat(n,". Line ").concat(e.line)),null;const s=[];if(e instanceof Sc)if(e.isVector){const t=e.vectorValue;for(const e of t)s.push(e)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);e instanceof Xc?s.push(...e.data):e instanceof Wc?s.push(e.value):e instanceof qc&&s.push(...e.data)}if(i instanceof gl&&null===i.format&&(i.format=this.getTypeInfo("f32")),0===s.length){const n=new Array(r[2]).fill(0);return new qc(n,i).getSubData(this,e.postfix,t)}return s.length!==r[2]?(console.error("Invalid matrix constructor. Line ".concat(e.line)),null):new qc(s,i).getSubData(this,e.postfix,t)}}wu._breakObj=new jc(new hl("BREAK",null),null),wu._continueObj=new jc(new hl("CONTINUE",null),null),wu._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Eu{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Au{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Eu,this._exec=new wu,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const t of this._deferArrayCountEval){const i=t.arrayType,n=t.countNode;if(n instanceof Tc){const t=n.name,r=this._context.constants.get(t);if(r)try{const e=r.constEvaluate(this._exec);i.count=e}catch(e){}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const i of t)i.search(e=>{e instanceof Nc||e instanceof vc?e.type=this._forwardType(e.type):e instanceof yc?e.format=this._forwardType(e.format):e instanceof Xl||e instanceof Zl||e instanceof Yl?e.type=this._forwardType(e.type):e instanceof jl?e.returnType=this._forwardType(e.returnType):e instanceof Bc&&(e.type=this._forwardType(e.type))});return t}_forwardType(e){if(e instanceof fc){const t=this._getType(e.name);if(t)return t}else e instanceof vc?e.type=this._forwardType(e.type):e instanceof yc&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if("string"==typeof e){const t=new Qc(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=null!=t?t:this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>"".concat(t)}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Jc.eof}_match(e){if(e instanceof Kc)return!!this._check(e)&&(this._advance(),!0);for(let t=0,i=e.length;t<i;++t){const i=e[t];if(this._check(i))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),"".concat(t,". Line:").concat(this._currentLine))}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const i=t.type;let n=!1;for(const t of e){if(i===t)return!0;t===Jc.tokens.name&&(n=!0)}if(n){const e=Jc.tokens.name.rule.exec(t.lexeme);if(e&&0==e.index&&e[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===Jc.tokens.name){const e=Jc.tokens.name.rule.exec(t.lexeme);return e&&0==e.index&&e[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Jc.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Jc.keywords.alias)){const e=this._type_alias();return this._consume(Jc.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(Jc.keywords.diagnostic)){const e=this._diagnostic();return this._consume(Jc.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(Jc.keywords.requires)){const e=this._requires_directive();return this._consume(Jc.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(Jc.keywords.enable)){const e=this._enable_directive();return this._consume(Jc.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}const e=this._attribute();if(this._check(Jc.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(Jc.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(Jc.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(Jc.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(Jc.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(Jc.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(Jc.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(Jc.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(Jc.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(Jc.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(Jc.keywords.fn))return null;const e=this._currentLine,t=this._consume(Jc.tokens.ident,"Expected function name.").toString();this._consume(Jc.tokens.paren_left,"Expected '(' for function arguments.");const i=[];if(!this._check(Jc.tokens.paren_right))do{if(this._check(Jc.tokens.paren_right))break;const e=this._attribute(),t=this._consume(Jc.tokens.name,"Expected argument name.").toString();this._consume(Jc.tokens.colon,"Expected ':' for argument type.");const n=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=n,i.push(this._updateNode(new Bc(t,r,e))))}while(this._match(Jc.tokens.comma));this._consume(Jc.tokens.paren_right,"Expected ')' after function arguments.");let n=null;if(this._match(Jc.tokens.arrow)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}const r=this._compound_statement(),s=this._currentLine;return this._updateNode(new jl(t,i,n,r,e,s),e)}_compound_statement(){const e=[];for(this._consume(Jc.tokens.brace_left,"Expected '{' for block.");!this._check(Jc.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(Jc.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(Jc.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Jc.tokens.attr)&&this._attribute(),this._check(Jc.keywords.if))return this._if_statement();if(this._check(Jc.keywords.switch))return this._switch_statement();if(this._check(Jc.keywords.loop))return this._loop_statement();if(this._check(Jc.keywords.for))return this._for_statement();if(this._check(Jc.keywords.while))return this._while_statement();if(this._check(Jc.keywords.continuing))return this._continuing_statement();if(this._check(Jc.keywords.static_assert))return this._static_assert_statement();if(this._check(Jc.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(Jc.keywords.return))e=this._return_statement();else if(this._check([Jc.keywords.var,Jc.keywords.let,Jc.keywords.const]))e=this._variable_statement();else if(this._match(Jc.keywords.discard))e=this._updateNode(new hc);else if(this._match(Jc.keywords.break)){const t=this._updateNode(new dc);if(this._currentLoop.length>0){const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t,this._check(Jc.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(Jc.keywords.continue)){const t=this._updateNode(new pc);if(!(this._currentLoop.length>0))throw this._error(this._peek(),"Continue statement must be inside a loop. Line: ".concat(t.line));{const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return null!=e&&this._consume(Jc.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(Jc.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new Vl(t),e)}_while_statement(){if(!this._match(Jc.keywords.while))return null;const e=this._updateNode(new Gl(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Jc.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(Jc.keywords.continuing))return null;const t=this._currentLine,i=this._compound_statement();return this._updateNode(new Wl(i,e),t)}_for_statement(){if(!this._match(Jc.keywords.for))return null;this._consume(Jc.tokens.paren_left,"Expected '('.");const e=this._updateNode(new Hl(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(Jc.tokens.semicolon)?null:this._for_init(),this._consume(Jc.tokens.semicolon,"Expected ';'."),e.condition=this._check(Jc.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(Jc.tokens.semicolon,"Expected ';'."),e.increment=this._check(Jc.tokens.paren_right)?null:this._for_increment(),this._consume(Jc.tokens.paren_right,"Expected ')'."),this._check(Jc.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Jc.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(Jc.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new Xl(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(Jc.keywords.let)){const e=this._currentLine,t=this._consume(Jc.tokens.name,"Expected name for let.").toString();let i=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}this._consume(Jc.tokens.equal,"Expected '=' for let.");const n=this._short_circuit_or_expression();return this._updateNode(new Zl(t,i,null,null,n),e)}if(this._match(Jc.keywords.const)){const e=this._currentLine,t=this._consume(Jc.tokens.name,"Expected name for const.").toString();let i=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}this._consume(Jc.tokens.equal,"Expected '=' for const.");const n=this._short_circuit_or_expression();return null===i&&n instanceof Sc&&(i=n.type),this._updateNode(new Yl(t,i,null,null,n),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(Jc.increment_operators))return this._current=e,null;const i=this._consume(Jc.increment_operators,"Expected increment operator");return this._updateNode(new ec(i.type===Jc.tokens.plus_plus?Kl.increment:Kl.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(Jc.tokens.brace_right))return null;let i=this._match(Jc.tokens.underscore);if(i||(e=this._unary_expression()),!i&&null==e)return null;const n=this._consume(Jc.assignment_operators,"Expected assignment operator."),r=this._short_circuit_or_expression();return this._updateNode(new tc(Jl.parse(n.lexeme),e,r),t)}_func_call_statement(){if(!this._check(Jc.tokens.ident))return null;const e=this._currentLine,t=this._current,i=this._consume(Jc.tokens.ident,"Expected function name."),n=this._argument_expression_list();return null===n?(this._current=t,null):this._updateNode(new ic(i.lexeme,n),e)}_loop_statement(){if(!this._match(Jc.keywords.loop))return null;this._check(Jc.tokens.attr)&&this._attribute(),this._consume(Jc.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new nc([],null));this._currentLoop.push(e);let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let i of t)e.body.push(i);else e.body.push(t);if(t instanceof Wl){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(Jc.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(Jc.keywords.switch))return null;const e=this._updateNode(new rc(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(Jc.tokens.attr)&&this._attribute(),this._consume(Jc.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),null==e.cases||0==e.cases.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(Jc.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([Jc.keywords.default,Jc.keywords.case]);){if(this._match(Jc.keywords.case)){const i=this._case_selectors();for(const e of i)if(e instanceof Fc){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(Jc.tokens.colon),this._check(Jc.tokens.attr)&&this._attribute(),this._consume(Jc.tokens.brace_left,"Exected '{' for switch case.");const n=this._case_body();this._consume(Jc.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Lc(i,n)))}if(this._match(Jc.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(Jc.tokens.colon),this._check(Jc.tokens.attr)&&this._attribute(),this._consume(Jc.tokens.brace_left,"Exected '{' for switch default.");const i=this._case_body();this._consume(Jc.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Oc(i)))}}return e}_case_selectors(){const e=[];for(this._match(Jc.keywords.default)?e.push(this._updateNode(new Fc)):e.push(this._shift_expression());this._match(Jc.tokens.comma);)this._match(Jc.keywords.default)?e.push(this._updateNode(new Fc)):e.push(this._shift_expression());return e}_case_body(){if(this._match(Jc.keywords.fallthrough))return this._consume(Jc.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(Jc.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(Jc.tokens.attr)&&this._attribute();const i=this._compound_statement();let n=[];this._match_elseif()&&(this._check(Jc.tokens.attr)&&this._attribute(),n=this._elseif_statement(n));let r=null;return this._match(Jc.keywords.else)&&(this._check(Jc.tokens.attr)&&this._attribute(),r=this._compound_statement()),this._updateNode(new sc(t,i,n,r),e)}_match_elseif(){return this._tokens[this._current].type===Jc.keywords.else&&this._tokens[this._current+1].type===Jc.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this._optional_paren_expression(),i=this._compound_statement();return e.push(this._updateNode(new zc(t,i))),this._match_elseif()&&(this._check(Jc.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(Jc.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new oc(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(Jc.tokens.or_or);)e=this._updateNode(new Mc(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(Jc.tokens.and_and);)e=this._updateNode(new Mc(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(Jc.tokens.or);)e=this._updateNode(new Mc(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(Jc.tokens.xor);)e=this._updateNode(new Mc(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(Jc.tokens.and);)e=this._updateNode(new Mc(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([Jc.tokens.equal_equal,Jc.tokens.not_equal])?this._updateNode(new Mc(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([Jc.tokens.less_than,Jc.tokens.greater_than,Jc.tokens.less_than_equal,Jc.tokens.greater_than_equal]);)e=this._updateNode(new Mc(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([Jc.tokens.shift_left,Jc.tokens.shift_right]);)e=this._updateNode(new Mc(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([Jc.tokens.plus,Jc.tokens.minus]);)e=this._updateNode(new Mc(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([Jc.tokens.star,Jc.tokens.forward_slash,Jc.tokens.modulo]);)e=this._updateNode(new Mc(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([Jc.tokens.minus,Jc.tokens.bang,Jc.tokens.tilde,Jc.tokens.star,Jc.tokens.and])?this._updateNode(new kc(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(Jc.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(Jc.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new Pc(e)),i=this._postfix_expression();return i&&(t.postfix=i),t}if(this._match(Jc.tokens.period)){const e=this._consume(Jc.tokens.name,"Expected member name."),t=this._postfix_expression(),i=this._updateNode(new wc(e.lexeme));return t&&(i.postfix=t),i}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(null!==t)return t;switch(e){case"void":return mc.void;case"bool":return mc.bool;case"i32":return mc.i32;case"u32":return mc.u32;case"f32":return mc.f32;case"f16":return mc.f16;case"vec2f":return _c.vec2f;case"vec3f":return _c.vec3f;case"vec4f":return _c.vec4f;case"vec2i":return _c.vec2i;case"vec3i":return _c.vec3i;case"vec4i":return _c.vec4i;case"vec2u":return _c.vec2u;case"vec3u":return _c.vec3u;case"vec4u":return _c.vec4u;case"vec2h":return _c.vec2h;case"vec3h":return _c.vec3h;case"vec4h":return _c.vec4h;case"mat2x2f":return _c.mat2x2f;case"mat2x3f":return _c.mat2x3f;case"mat2x4f":return _c.mat2x4f;case"mat3x2f":return _c.mat3x2f;case"mat3x3f":return _c.mat3x3f;case"mat3x4f":return _c.mat3x4f;case"mat4x2f":return _c.mat4x2f;case"mat4x3f":return _c.mat4x3f;case"mat4x4f":return _c.mat4x4f;case"mat2x2h":return _c.mat2x2h;case"mat2x3h":return _c.mat2x3h;case"mat2x4h":return _c.mat2x4h;case"mat3x2h":return _c.mat3x2h;case"mat3x3h":return _c.mat3x3h;case"mat3x4h":return _c.mat3x4h;case"mat4x2h":return _c.mat4x2h;case"mat4x3h":return _c.mat4x3h;case"mat4x4h":return _c.mat4x4h;case"mat2x2i":return _c.mat2x2i;case"mat2x3i":return _c.mat2x3i;case"mat2x4i":return _c.mat2x4i;case"mat3x2i":return _c.mat3x2i;case"mat3x3i":return _c.mat3x3i;case"mat3x4i":return _c.mat3x4i;case"mat4x2i":return _c.mat4x2i;case"mat4x3i":return _c.mat4x3i;case"mat4x4i":return _c.mat4x4i;case"mat2x2u":return _c.mat2x2u;case"mat2x3u":return _c.mat2x3u;case"mat2x4u":return _c.mat2x4u;case"mat3x2u":return _c.mat3x2u;case"mat3x3u":return _c.mat3x3u;case"mat3x4u":return _c.mat3x4u;case"mat4x2u":return _c.mat4x2u;case"mat4x3u":return _c.mat4x3u;case"mat4x4u":return _c.mat4x4u}return null}_validateTypeRange(e,t){if("i32"===t.name){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),"Value out of range for i32: ".concat(e,". Line: ").concat(this._currentLine,"."))}else if("u32"===t.name&&(e<0||e>4294967295))throw this._error(this._previous(),"Value out of range for u32: ".concat(e,". Line: ").concat(this._currentLine,"."))}_primary_expression(){if(this._match(Jc.tokens.ident)){const e=this._previous().toString();if(this._check(Jc.tokens.paren_left)){const t=this._argument_expression_list(),i=this._getType(e);return null!==i?this._updateNode(new Ec(i,t)):this._updateNode(new Ac(e,t))}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return this._updateNode(new Dc(e,t.value))}return this._updateNode(new Tc(e))}if(this._match(Jc.tokens.int_literal)){const e=this._previous().toString();let t=e.endsWith("i")||e.endsWith("i")?mc.i32:e.endsWith("u")||e.endsWith("U")?mc.u32:mc.x32;const i=parseInt(e);return this._validateTypeRange(i,t),this._updateNode(new Sc(new Wc(i,this._exec.getTypeInfo(t)),t))}if(this._match(Jc.tokens.uint_literal)){const e=parseInt(this._previous().toString());return this._validateTypeRange(e,mc.u32),this._updateNode(new Sc(new Wc(e,this._exec.getTypeInfo(mc.u32)),mc.u32))}if(this._match([Jc.tokens.decimal_float_literal,Jc.tokens.hex_float_literal])){let e=this._previous().toString(),t=e.endsWith("h");t&&(e=e.substring(0,e.length-1));const i=parseFloat(e);this._validateTypeRange(i,t?mc.f16:mc.f32);const n=t?mc.f16:mc.f32;return this._updateNode(new Sc(new Wc(i,this._exec.getTypeInfo(n)),n))}if(this._match([Jc.keywords.true,Jc.keywords.false])){let e=this._previous().toString()===Jc.keywords.true.rule;return this._updateNode(new Sc(new Wc(e?1:0,this._exec.getTypeInfo(mc.bool)),mc.bool))}if(this._check(Jc.tokens.paren_left))return this._paren_expression();if(this._match(Jc.keywords.bitcast)){this._consume(Jc.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(Jc.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return this._updateNode(new Cc(e,t))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Ec(e,t))}_argument_expression_list(){if(!this._match(Jc.tokens.paren_left))return null;const e=[];do{if(this._check(Jc.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(Jc.tokens.comma));return this._consume(Jc.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(Jc.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(Jc.tokens.paren_right),e}_paren_expression(){this._consume(Jc.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(Jc.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(Jc.keywords.struct))return null;const e=this._currentLine,t=this._consume(Jc.tokens.ident,"Expected name for struct.").toString();this._consume(Jc.tokens.brace_left,"Expected '{' for struct body.");const i=[];for(;!this._check(Jc.tokens.brace_right);){const e=this._attribute(),t=this._consume(Jc.tokens.name,"Expected variable name.").toString();this._consume(Jc.tokens.colon,"Expected ':' for struct member type.");const n=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=n),this._check(Jc.tokens.brace_right)?this._match(Jc.tokens.comma):this._consume(Jc.tokens.comma,"Expected ',' for struct member."),i.push(this._updateNode(new Nc(t,r,e)))}this._consume(Jc.tokens.brace_right,"Expected '}' after struct body.");const n=this._currentLine,r=this._updateNode(new gc(t,i,e,n),e);return this._context.structs.set(t,r),r}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(Jc.tokens.equal)){const t=this._const_expression();e.value=t}if(null!==e.type&&e.value instanceof Sc){if("x32"!==e.value.type.name&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(e.value.type.name," to ").concat(e.type.name,". Line:").concat(this._currentLine));e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else null===e.type&&e.value instanceof Sc&&(e.type="x32"===e.value.type.name?mc.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(Jc.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(Jc.keywords.const))return null;const t=this._consume(Jc.tokens.name,"Expected variable name"),i=this._currentLine;let n=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}let r=null;this._consume(Jc.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let e=[mc.f32],i=s.constEvaluate(this._exec,e);i instanceof Wc&&this._validateTypeRange(i.value,e[0]),e[0]instanceof _c&&null===e[0].format&&i.typeInfo instanceof gl&&null!==i.typeInfo.format&&("f16"===i.typeInfo.format.name?e[0].format=mc.f16:"f32"===i.typeInfo.format.name?e[0].format=mc.f32:"i32"===i.typeInfo.format.name?e[0].format=mc.i32:"u32"===i.typeInfo.format.name?e[0].format=mc.u32:"bool"===i.typeInfo.format.name?e[0].format=mc.bool:console.error("TODO: impelement template format type ".concat(i.typeInfo.format.name))),r=this._updateNode(new Sc(i,e[0])),this._exec.context.setVariable(t.toString(),i)}catch(e){r=s}if(null!==n&&r instanceof Sc){if("x32"!==r.type.name&&n.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(r.type.name," to ").concat(n.name,". Line:").concat(this._currentLine));r.type=n,r.isScalar&&this._validateTypeRange(r.scalarValue,r.type)}else null===n&&r instanceof Sc&&(n=null!==(e=null==r?void 0:r.type)&&void 0!==e?e:mc.f32,n===mc.x32&&(n=mc.i32));const o=this._updateNode(new Yl(t.toString(),n,"","",r),i);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(Jc.keywords.let))return null;const e=this._currentLine,t=this._consume(Jc.tokens.name,"Expected variable name");let i=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}let n=null;if(this._match(Jc.tokens.equal)&&(n=this._const_expression()),null!==i&&n instanceof Sc){if("x32"!==n.type.name&&i.getTypeName()!==n.type.getTypeName())throw this._error(this._peek(),"Invalid cast from ".concat(n.type.name," to ").concat(i.name,". Line:").concat(this._currentLine));n.type=i}else null===i&&n instanceof Sc&&(i="x32"===n.type.name?mc.i32:n.type);return n instanceof Sc&&n.isScalar&&this._validateTypeRange(n.scalarValue,i),this._updateNode(new Zl(t.toString(),i,"","",n),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(Jc.keywords.var))return null;const e=this._currentLine;let t="",i="";this._match(Jc.tokens.less_than)&&(t=this._consume(Jc.storage_class,"Expected storage_class.").toString(),this._match(Jc.tokens.comma)&&(i=this._consume(Jc.access_mode,"Expected access_mode.").toString()),this._consume(Jc.tokens.greater_than,"Expected '>'."));const n=this._consume(Jc.tokens.name,"Expected variable name");let r=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}return this._updateNode(new Xl(n.toString(),r,t,i,null),e)}_override_decl(){if(!this._match(Jc.keywords.override))return null;const e=this._consume(Jc.tokens.name,"Expected variable name");let t=null;if(this._match(Jc.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return this._updateNode(new ql(e.toString(),t,null))}_diagnostic(){this._consume(Jc.tokens.paren_left,"Expected '('");const e=this._consume(Jc.tokens.ident,"Expected severity control name.");this._consume(Jc.tokens.comma,"Expected ','");let t=this._consume(Jc.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(Jc.tokens.period)&&(t+=".".concat(this._consume(Jc.tokens.ident,"Expected diagnostic message.").toString())),this._consume(Jc.tokens.paren_right,"Expected ')'"),this._updateNode(new cc(e.toString(),t))}_enable_directive(){const e=this._consume(Jc.tokens.ident,"identity expected.");return this._updateNode(new ac(e.toString()))}_requires_directive(){const e=[this._consume(Jc.tokens.ident,"identity expected.").toString()];for(;this._match(Jc.tokens.comma);){const t=this._consume(Jc.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new lc(e))}_type_alias(){const e=this._consume(Jc.tokens.ident,"identity expected.");this._consume(Jc.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const i=this._updateNode(new uc(e.toString(),t));return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([Jc.tokens.ident,...Jc.texel_format,Jc.keywords.bool,Jc.keywords.f32,Jc.keywords.i32,Jc.keywords.u32])){const e=this._advance().toString();if(this._context.structs.has(e))return this._context.structs.get(e);if(this._context.aliases.has(e))return this._context.aliases.get(e).type;if(!this._getType(e)){const t=this._updateNode(new fc(e));return this._forwardTypeCount++,t}return this._updateNode(new mc(e))}let e=this._texture_sampler_types();if(e)return e;if(this._check(Jc.template_types)){let e=this._advance().toString(),t=null,i=null;return this._match(Jc.tokens.less_than)&&(t=this._type_decl(),i=null,this._match(Jc.tokens.comma)&&(i=this._consume(Jc.access_mode,"Expected access_mode for pointer").toString()),this._consume(Jc.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new _c(e,t,i))}if(this._match(Jc.keywords.ptr)){let e=this._previous().toString();this._consume(Jc.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(Jc.storage_class,"Expected storage_class for pointer");this._consume(Jc.tokens.comma,"Expected ',' for pointer.");const i=this._type_decl();let n=null;return this._match(Jc.tokens.comma)&&(n=this._consume(Jc.access_mode,"Expected access_mode for pointer").toString()),this._consume(Jc.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new vc(e,t.toString(),i,n))}const t=this._attribute();if(this._match(Jc.keywords.array)){let i=null,n=-1;const r=this._previous();let s=null;if(this._match(Jc.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let t="";if(this._match(Jc.tokens.comma)){s=this._shift_expression();try{t=s.constEvaluate(this._exec).toString(),s=null}catch(e){t="1"}}this._consume(Jc.tokens.greater_than,"Expected '>' for array."),n=t?parseInt(t):0}const o=this._updateNode(new yc(r.toString(),t,i,n));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(Jc.sampler_type))return this._updateNode(new bc(this._previous().toString(),null,null));if(this._match(Jc.depth_texture_type))return this._updateNode(new bc(this._previous().toString(),null,null));if(this._match(Jc.sampled_texture_type)||this._match(Jc.multisampled_texture_type)){const e=this._previous();this._consume(Jc.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(Jc.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new bc(e.toString(),t,null))}if(this._match(Jc.storage_texture_type)){const e=this._previous();this._consume(Jc.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(Jc.texel_format,"Invalid texel format.").toString();this._consume(Jc.tokens.comma,"Expected ',' after texel format.");const i=this._consume(Jc.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(Jc.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new bc(e.toString(),t,i))}return null}_attribute(){let e=[];for(;this._match(Jc.tokens.attr);){const t=this._consume(Jc.attribute_name,"Expected attribute name"),i=this._updateNode(new Uc(t.toString(),null));if(this._match(Jc.tokens.paren_left)){if(i.value=this._consume(Jc.literal_or_ident,"Expected attribute value").toString(),this._check(Jc.tokens.comma)){this._advance();do{const e=this._consume(Jc.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(e)}while(this._match(Jc.tokens.comma))}this._consume(Jc.tokens.paren_right,"Expected ')'")}e.push(i)}return 0==e.length?null:e}}class Tu extends pu{constructor(e){super(),e&&this.update(e)}update(e){const t=(new Au).parse(e);this.updateAST(t)}}function Du(e){const t={attributes:[],bindings:[]};let i;try{i=function(e){try{return new Tu(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"===typeof t&&null!==t&&void 0!==t&&t.message&&(e+=": ".concat(t.message," ")),"object"===typeof t&&null!==t&&void 0!==t&&t.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(o){return la.R.error(o.message)(),t}for(const a of i.uniforms){const e=[];for(const t of(null===(n=a.type)||void 0===n?void 0:n.members)||[]){var n;e.push({name:t.name,type:Su(t.type)})}t.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:e})}for(const a of i.textures)t.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of i.samplers)t.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const r=i.entry.vertex[0],s=(null===r||void 0===r?void 0:r.inputs.length)||0;for(let a=0;a<s;a++){const e=r.inputs[a];if("location"===e.locationType){const i=Su(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:i})}}return t}function Su(e){return null!==e&&void 0!==e&&e.format?"".concat(e.name,"<").concat(e.format.name,">"):e.name}var Cu=i(76);const Pu={};function Iu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Pu[e]=Pu[e]||1;const t=Pu[e]++;return"".concat(e,"-").concat(t)}class ku{constructor(e){if((0,s.A)(this,"id",void 0),(0,s.A)(this,"userData",{}),(0,s.A)(this,"topology",void 0),(0,s.A)(this,"bufferLayout",[]),(0,s.A)(this,"vertexCount",void 0),(0,s.A)(this,"indices",void 0),(0,s.A)(this,"attributes",void 0),this.id=e.id||Iu("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Ra.h.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){var e;null===(e=this.indices)||void 0===e||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function Mu(e,t){if(t instanceof ku)return t;const i=function(e,t){if(!t.indices)return;const i=t.indices.value;return e.createBuffer({usage:Ra.h.INDEX,data:i})}(e,t),{attributes:n,bufferLayout:r}=function(e,t){const i=[],n={};for(const[s,o]of Object.entries(t.attributes)){let t=s;switch(s){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(o){n[t]=e.createBuffer({data:o.value,id:"".concat(s,"-buffer")});const{value:r,size:a,normalized:l}=o;i.push({name:t,format:(0,Cu.OB)(r,a,l)})}}const r=t._calculateVertexCount(t.attributes,t.indices);return{attributes:n,bufferLayout:i,vertexCount:r}}(e,t);return new ku({topology:t.topology||"triangle-list",bufferLayout:r,vertexCount:t.vertexCount,indices:i,attributes:n})}var Ru=i(804);class Fu extends Ru.F{get[Symbol.toStringTag](){return"ComputePipeline"}constructor(e,t){super(e,t,Fu.defaultProps),(0,s.A)(this,"hash",""),(0,s.A)(this,"shaderLayout",void 0),this.shaderLayout=t.shaderLayout}}(0,s.A)(Fu,"defaultProps",(0,r.A)((0,r.A)({},Ru.F.defaultProps),{},{shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}));class Lu{static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Lu(e),e._lumaData.defaultPipelineFactory}get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return"PipelineFactory(".concat(this.device.id,")")}constructor(e){(0,s.A)(this,"device",void 0),(0,s.A)(this,"cachingEnabled",void 0),(0,s.A)(this,"destroyPolicy",void 0),(0,s.A)(this,"debug",void 0),(0,s.A)(this,"_hashCounter",0),(0,s.A)(this,"_hashes",{}),(0,s.A)(this,"_renderPipelineCache",{}),(0,s.A)(this,"_computePipelineCache",{}),this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){var t;if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const i=(0,r.A)((0,r.A)({},ul.r.defaultProps),e),n=this._renderPipelineCache,s=this._hashRenderPipeline(i);let o=null===(t=n[s])||void 0===t?void 0:t.pipeline;return o?(n[s].useCount++,this.debug&&la.R.warn("".concat(this,": ").concat(n[s].pipeline," reused, count=").concat(n[s].useCount,", (id=").concat(e.id,")"))()):(o=this.device.createRenderPipeline((0,r.A)((0,r.A)({},i),{},{id:i.id?"".concat(i.id,"-cached"):Iu("unnamed-cached")})),o.hash=s,n[s]={pipeline:o,useCount:1},this.debug&&la.R.warn("".concat(this,": ").concat(o," created, count=").concat(n[s].useCount))()),o}createComputePipeline(e){var t;if(!this.cachingEnabled)return this.device.createComputePipeline(e);const i=(0,r.A)((0,r.A)({},Fu.defaultProps),e),n=this._computePipelineCache,s=this._hashComputePipeline(i);let o=null===(t=n[s])||void 0===t?void 0:t.pipeline;return o?(n[s].useCount++,this.debug&&la.R.warn("".concat(this,": ").concat(n[s].pipeline," reused, count=").concat(n[s].useCount,", (id=").concat(e.id,")"))()):(o=this.device.createComputePipeline((0,r.A)((0,r.A)({},i),{},{id:i.id?"".concat(i.id,"-cached"):void 0})),o.hash=s,n[s]={pipeline:o,useCount:1},this.debug&&la.R.warn("".concat(this,": ").concat(o," created, count=").concat(n[s].useCount))()),o}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._getCache(e),i=e.hash;t[i].useCount--,0===t[i].useCount?(this._destroyPipeline(e),this.debug&&la.R.warn("".concat(this,": ").concat(e," released and destroyed"))()):t[i].useCount<0?(la.R.error("".concat(this,": ").concat(e," released, useCount < 0, resetting"))(),t[i].useCount=0):this.debug&&la.R.warn("".concat(this,": ").concat(e," released, count=").concat(t[i].useCount))()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof Fu&&(t=this._computePipelineCache),e instanceof ul.r&&(t=this._renderPipelineCache),!t)throw new Error("".concat(this));if(!t[e.hash])throw new Error("".concat(this,": ").concat(e," matched incorrect entry"));return t}_hashComputePipeline(e){const{type:t}=this.device,i=this._getHash(e.shader.source);return"".concat(t,"/C/").concat(i)}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,i=e.fs?this._getHash(e.fs.source):0,n=this._getHash(JSON.stringify(e.bufferLayout)),{type:r}=this.device;if("webgl"===r)return"".concat(r,"/R/").concat(t,"/").concat(i,"V").concat("-","BL").concat(n);{const s=this._getHash(JSON.stringify(e.parameters));return"".concat(r,"/R/").concat(t,"/").concat(i,"V").concat("-","T").concat(e.topology,"P").concat(s,"BL").concat(n)}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}(0,s.A)(Lu,"defaultProps",(0,r.A)({},ul.r.defaultProps));var Ou=i(404);class Bu{static getDefaultShaderFactory(e){var t;return(t=e._lumaData)["defaultShaderFactory"]||(t.defaultShaderFactory=new Bu(e)),e._lumaData.defaultShaderFactory}get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return"".concat(this[Symbol.toStringTag],"(").concat(this.device.id,")")}constructor(e){(0,s.A)(this,"device",void 0),(0,s.A)(this,"cachingEnabled",void 0),(0,s.A)(this,"destroyPolicy",void 0),(0,s.A)(this,"debug",void 0),(0,s.A)(this,"_cache",{}),this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let i=this._cache[t];if(i)i.useCount++,this.debug&&la.R.warn("".concat(this,": Reusing shader ").concat(i.shader.id," count=").concat(i.useCount))();else{const n=this.device.createShader((0,r.A)((0,r.A)({},e),{},{id:e.id?"".concat(e.id,"-cached"):void 0}));this._cache[t]=i={shader:n,useCount:1},this.debug&&la.R.warn("".concat(this,": Created new shader ").concat(n.id))()}return i.shader}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._hashShader(e),i=this._cache[t];if(i)if(i.useCount--,0===i.useCount)"unused"===this.destroyPolicy&&(delete this._cache[t],i.shader.destroy(),this.debug&&la.R.warn("".concat(this,": Releasing shader ").concat(e.id,", destroyed"))());else{if(i.useCount<0)throw new Error("ShaderFactory: Shader ".concat(e.id," released too many times"));this.debug&&la.R.warn("".concat(this,": Releasing shader ").concat(e.id," count=").concat(i.useCount))()}}_hashShader(e){return"".concat(e.stage,":").concat(e.source)}}(0,s.A)(Bu,"defaultProps",(0,r.A)({},Ou.M.defaultProps));let zu=null,Nu=null;function Uu(e,t,i){if(e===t)return!0;if(!i||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Uu(e[n],t[n],i-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){if(!t.hasOwnProperty(s))return!1;if(!Uu(e[s],t[s],i-1))return!1}return!0}return!1}class ju{constructor(e){(0,s.A)(this,"bufferLayouts",void 0),this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){var t;return e.attributes?null===(t=e.attributes)||void 0===t?void 0:t.map(e=>e.attribute):[e.name]}mergeBufferLayouts(e,t){const i=[...e];for(const n of t){const e=i.findIndex(e=>e.name===n.name);e<0?i.push(n):i[e]=n}return i}getBufferIndex(e){const t=this.bufferLayouts.findIndex(t=>t.name===e);return-1===t&&la.R.warn('BufferLayout: Missing buffer for "'.concat(e,'".'))(),t}}function Vu(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}(e)}function Gu(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(i=>{const n=e[i];var r;Vu(r=n)||"number"===typeof r||"boolean"===typeof r?t.uniforms[i]=n:t.bindings[i]=n}),t}class Wu{constructor(e,t){(0,s.A)(this,"options",{disableWarnings:!1}),(0,s.A)(this,"modules",void 0),(0,s.A)(this,"moduleUniforms",void 0),(0,s.A)(this,"moduleBindings",void 0),Object.assign(this.options,t);const i=A(Object.values(e).filter(e=>e.dependencies));for(const n of i)e[n.name]=n;la.R.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[n,r]of Object.entries(e))this._addModule(r),r.name&&n!==r.name&&!this.options.disableWarnings&&la.R.warn("Module name: ".concat(n," vs ").concat(r.name))()}destroy(){}setProps(e){for(const i of Object.keys(e)){var t;const n=i,s=e[n]||{},o=this.modules[n];if(!o){this.options.disableWarnings||la.R.warn("Module ".concat(i," not found"))();continue}const a=this.moduleUniforms[n],l=this.moduleBindings[n],c=(null===(t=o.getUniforms)||void 0===t?void 0:t.call(o,s,a))||s,{uniforms:u,bindings:h}=Gu(c);this.moduleUniforms[n]=(0,r.A)((0,r.A)({},a),u),this.moduleBindings[n]=(0,r.A)((0,r.A)({},l),h)}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[i,n]of Object.entries(this.moduleUniforms))for(const[r,s]of Object.entries(n)){var t;e["".concat(i,".").concat(r)]={type:null===(t=this.modules[i].uniformTypes)||void 0===t?void 0:t[r],value:String(s)}}return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let Hu="";const Xu=["+X","-X","+Y","-Y","+Z","-Z"],qu=["+X","-X","+Y","-Y","+Z","-Z"];class Zu{get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return'AsyncTexture:"'.concat(this.id,'"(').concat(this.isReady?"ready":"loading",")")}constructor(e,t){var i;(0,s.A)(this,"device",void 0),(0,s.A)(this,"id",void 0),(0,s.A)(this,"props",void 0),(0,s.A)(this,"texture",void 0),(0,s.A)(this,"sampler",void 0),(0,s.A)(this,"view",void 0),(0,s.A)(this,"ready",void 0),(0,s.A)(this,"isReady",!1),(0,s.A)(this,"destroyed",!1),(0,s.A)(this,"resolveReady",()=>{}),(0,s.A)(this,"rejectReady",()=>{}),this.device=e;const n=Iu("async-texture");this.props=(0,r.A)((0,r.A)({},Zu.defaultProps),{},{id:n},t),this.id=this.props.id,"string"===typeof(null===(i=t=(0,r.A)({},t))||void 0===i?void 0:i.data)&&"2d"===t.dimension&&(t.data=async function(e,t){const i=new Image;return i.crossOrigin=(null===t||void 0===t?void 0:t.crossOrigin)||"anonymous",i.src=e.startsWith("http")?e:Hu+e,await i.decode(),t?await createImageBitmap(i,t):await createImageBitmap(i)}(t.data)),t.mipmaps&&(t.mipLevels="auto"),this.ready=new Promise((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t}),this.initAsync(t)}async initAsync(e){const t=e.data,i=await Yu(t).then(void 0,this.rejectReady);if(this.destroyed)return;const n=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(i);if(!n)throw new Error("Texture size could not be determined");const s=(0,r.A)((0,r.A)((0,r.A)({},n),e),{},{data:void 0,mipLevels:1}),o=this.device.getMipLevelCount(s.width,s.height);if(s.mipLevels="auto"===this.props.mipLevels?o:Math.min(o,this.props.mipLevels),this.texture=this.device.createTexture(s),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,i);break;case"2d":this._setTexture2DData(i);break;case"3d":this._setTexture3DData(this.texture,i);break;case"2d-array":this._setTextureArrayData(this.texture,i);break;case"cube":this._setTextureCubeData(this.texture,i);break;case"cube-array":this._setTextureCubeArrayData(this.texture,i)}this.props.mipmaps&&this.generateMipmaps(),la.R.info(1,"".concat(this," loaded")),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture.setSampler(e instanceof ll.L?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=null===e||void 0===e?void 0:e.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&"object"===typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.texture)throw new Error("Texture not initialized");const i=this._normalizeTextureData(e);i.length>1&&!1!==this.props.mipmaps&&la.R.warn("Texture ".concat(this.id," mipmap and multiple LODs."))();for(let n=0;n<i.length;n++){const e=i[n];this.device.isExternalImage(e)?this.texture.copyExternalImage({image:e,depth:t,mipLevel:n,flipY:!0}):this.texture.copyImageData({data:e.data,mipLevel:n})}}_setTexture3DData(e,t){var i;if("3d"!==(null===(i=this.texture)||void 0===i?void 0:i.props.dimension))throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeData(e,t){var i;if("cube"!==(null===(i=this.texture)||void 0===i?void 0:i.props.dimension))throw new Error(this.id);for(const[n,r]of Object.entries(t)){const e=qu.indexOf(n);this._setTexture2DData(r,e)}}_setTextureArrayData(e,t){var i;if("2d-array"!==(null===(i=this.texture)||void 0===i?void 0:i.props.dimension))throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,i){Array.isArray(t)&&t.length>1&&!1!==this.props.mipmaps&&la.R.warn("".concat(this.id," has mipmap and multiple LODs."))();const n=Xu.indexOf(i);this._setTexture2DData(t,n)}_normalizeTextureData(e){const t=this.texture;let i;return i=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],i}}async function Yu(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(Yu));if(e&&"object"===typeof e&&e.constructor===Object){const t=e,i=await Promise.all(Object.values(t)),n=Object.keys(t),r={};for(let e=0;e<n.length;e++)r[n[e]]=i[e];return r}return e}(0,s.A)(Zu,"defaultProps",(0,r.A)((0,r.A)({},al.g.defaultProps),{},{data:null,mipmaps:!1}));class Ku{get[Symbol.toStringTag](){return"Model"}toString(){return"Model(".concat(this.id,")")}constructor(e,t){var i,n,o;(0,s.A)(this,"device",void 0),(0,s.A)(this,"id",void 0),(0,s.A)(this,"source",void 0),(0,s.A)(this,"vs",void 0),(0,s.A)(this,"fs",void 0),(0,s.A)(this,"pipelineFactory",void 0),(0,s.A)(this,"shaderFactory",void 0),(0,s.A)(this,"userData",{}),(0,s.A)(this,"parameters",void 0),(0,s.A)(this,"topology",void 0),(0,s.A)(this,"bufferLayout",void 0),(0,s.A)(this,"isInstanced",void 0),(0,s.A)(this,"instanceCount",0),(0,s.A)(this,"vertexCount",void 0),(0,s.A)(this,"indexBuffer",null),(0,s.A)(this,"bufferAttributes",{}),(0,s.A)(this,"constantAttributes",{}),(0,s.A)(this,"bindings",{}),(0,s.A)(this,"vertexArray",void 0),(0,s.A)(this,"transformFeedback",null),(0,s.A)(this,"pipeline",void 0),(0,s.A)(this,"shaderInputs",void 0),(0,s.A)(this,"_uniformStore",void 0),(0,s.A)(this,"_attributeInfos",{}),(0,s.A)(this,"_gpuGeometry",null),(0,s.A)(this,"props",void 0),(0,s.A)(this,"_pipelineNeedsUpdate","newly created"),(0,s.A)(this,"_needsRedraw","initializing"),(0,s.A)(this,"_destroyed",!1),(0,s.A)(this,"_lastDrawTimestamp",-1),(0,s.A)(this,"_lastLogTime",0),(0,s.A)(this,"_logOpen",!1),(0,s.A)(this,"_drawCount",0),this.props=(0,r.A)((0,r.A)({},Ku.defaultProps),t),t=this.props,this.id=t.id||Iu("model"),this.device=e,Object.assign(this.userData,t.userData);const a=Object.fromEntries((null===(i=this.props.modules)||void 0===i?void 0:i.map(e=>[e.name,e]))||[]),l=t.shaderInputs||new Wu(a,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(l);const c=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),u=((null===(n=this.props.modules)||void 0===n?void 0:n.length)>0?this.props.modules:null===(o=this.shaderInputs)||void 0===o?void 0:o.getModules())||[];if("webgpu"===this.device.type&&this.props.source){var h;const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader((0,r.A)((0,r.A)({platformInfo:c},this.props),{},{modules:u}));this.source=e,this._getModuleUniforms=t,(h=this.props).shaderLayout||(h.shaderLayout=Du(this.source))}else{const{vs:e,fs:t,getUniforms:i}=this.props.shaderAssembler.assembleGLSLShaderPair((0,r.A)((0,r.A)({platformInfo:c},this.props),{},{modules:u}));this.vs=e,this.fs=t,this._getModuleUniforms=i}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||Lu.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||Bu.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),null===(e=this._gpuGeometry)||void 0===e||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return la.R.info(2,">>> DRAWING ABORTED ".concat(this.id,": ").concat(t," not loaded"))(),!1;try{e.pushDebugGroup("".concat(this,".predraw(").concat(e,")")),this.predraw()}finally{e.popDebugGroup()}let i;try{e.pushDebugGroup("".concat(this,".draw(").concat(e,")")),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings});const{indexBuffer:n}=this.vertexArray,r=n?n.byteLength/("uint32"===n.indexType?4:2):void 0;i=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:r,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),i?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",i}setGeometry(e){var t;null===(t=this._gpuGeometry)||void 0===t||t.destroy();const i=e&&Mu(this.device,e);if(i){this.setTopology(i.topology||"triangle-list");const e=new ju(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(i.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(i)}this._gpuGeometry=i}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new ju(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){Uu(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new rl(this.shaderInputs.modules);for(const[t,i]of Object.entries(this.shaderInputs.modules))if(Ju(i)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings["".concat(t,"Uniforms")]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){var i;const n=null!==(i=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==i?i:this.props.disableWarnings;e.indices&&la.R.warn("Model:".concat(this.id," setAttributes() - indexBuffer should be set using setIndexBuffer()"))(),this.bufferLayout=function(e,t){const i=Object.fromEntries(e.attributes.map(e=>[e.name,e.location])),n=t.slice();return n.sort((e,t)=>{const n=e.attributes?e.attributes.map(e=>e.attribute):[e.name],r=t.attributes?t.attributes.map(e=>e.attribute):[t.name];return Math.min(...n.map(e=>i[e]))-Math.min(...r.map(e=>i[e]))}),n}(this.pipeline.shaderLayout,this.bufferLayout);const r=new ju(this.bufferLayout);for(const[s,o]of Object.entries(e)){const e=r.getBufferLayout(s);if(!e){n||la.R.warn("Model(".concat(this.id,'): Missing layout for buffer "').concat(s,'".'))();continue}const t=r.getAttributeNamesForBuffer(e);let i=!1;for(const n of t){const e=this._attributeInfos[n];if(e){const t="webgpu"===this.device.type?r.getBufferIndex(e.bufferName):e.location;this.vertexArray.setBuffer(t,o),i=!0}}i||n||la.R.warn("Model(".concat(this.id,'): Ignoring buffer "').concat(o.id,'" for unknown attribute "').concat(s,'"'))()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,r]of Object.entries(e)){var i;const e=this._attributeInfos[n];e?this.vertexArray.setConstantWebGL(e.location,r):(null!==(i=null===t||void 0===t?void 0:t.disableWarnings)&&void 0!==i?i:this.props.disableWarnings)||la.R.warn('Model "'.concat(this.id,': Ignoring constant supplied for unknown attribute "').concat(n,'"'))()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Zu&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,i]of Object.entries(this.bindings))i instanceof Zu?i.isReady&&(e[t]=i.texture):e[t]=i;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof ol.X?e=Math.max(e,t.texture.updateTimestamp):t instanceof Ra.h||t instanceof al.g?e=Math.max(e,t.updateTimestamp):t instanceof Zu?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof ll.L||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t=(0,r.A)({},e.attributes);for(const[i]of Object.entries(t))this.pipeline.shaderLayout.attributes.find(e=>e.name===i)||"positions"===i||delete t[i];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(la.R.log(1,"Model ".concat(this.id,': Recreating pipeline because "').concat(this._pipelineNeedsUpdate,'".'))(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const i=this.shaderFactory.createShader({id:"".concat(this.id,"-vertex"),stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let n=null;this.source?n=i:this.fs&&(n=this.shaderFactory.createShader({id:"".concat(this.id,"-fragment"),stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline((0,r.A)((0,r.A)({},this.props),{},{bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:i,fs:n})),this._attributeInfos=(0,cl.P)(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=la.R.level>3?0:1e4;la.R.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,la.R.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:la.R.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){var t;const i={},n="Values";if(0===e.attributes.length&&(null===(t=e.varyings)||void 0===t||!t.length))return{"No attributes or varyings":{[n]:"N/A"}};for(const r of e.attributes)if(r){const e="".concat(r.location," ").concat(r.name,": ").concat(r.type);i["in ".concat(e)]={[n]:r.stepMode||"vertex"}}for(const r of e.varyings||[]){const e="".concat(r.location," ").concat(r.name);i["out ".concat(e)]={[n]:JSON.stringify(r)}}return i}(this.pipeline.shaderLayout,this.id);la.R.table(2,e)();const t=this.shaderInputs.getDebugTable();la.R.table(2,t)();const i=this._getAttributeDebugTable();la.R.table(2,this._attributeInfos)(),la.R.table(2,i)(),la.R.groupEnd(2)(),this._logOpen=!1}}_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const i=e.props.framebuffer;i&&function(e,t){var i;let{id:n,minimap:r,opaque:s,top:o="0",left:a="0",rgbaScale:l=1}=t;zu||(zu=document.createElement("canvas"),zu.id=n,zu.title=n,zu.style.zIndex="100",zu.style.position="absolute",zu.style.top=o,zu.style.left=a,zu.style.border="blue 5px solid",zu.style.transform="scaleY(-1)",document.body.appendChild(zu),Nu=zu.getContext("2d")),zu.width===e.width&&zu.height===e.height||(zu.width=e.width/2,zu.height=e.height/2,zu.style.width="400px",zu.style.height="400px");const c=e.device.readPixelsToArrayWebGL(e),u=null===(i=Nu)||void 0===i?void 0:i.createImageData(e.width,e.height);if(u){var h;const e=0;for(let t=0;t<c.length;t+=4)u.data[e+t+0]=c[t+0]*l,u.data[e+t+1]=c[t+1]*l,u.data[e+t+2]=c[t+2]*l,u.data[e+t+3]=s?255:c[t+3]*l;null===(h=Nu)||void 0===h||h.putImageData(u,0,0)}}(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,i]of Object.entries(this._attributeInfos)){const n=this.vertexArray.attributes[i.location];e[i.location]={name:t,type:i.shaderType,values:n?this._getBufferOrConstantValues(n,i.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,i="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:i.toString()}}return e}_getBufferOrConstantValues(e,t){const i=(0,La.Ak)(t);return(e instanceof Ra.h?new i(e.debugData):e).toString()}}function Ju(e){return Boolean(e.uniformTypes&&!function(e){for(const t in e)return!1;return!0}(e.uniformTypes))}(0,s.A)(Ku,"defaultProps",(0,r.A)((0,r.A)({},ul.r.defaultProps),{},{source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:G.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0}));class $u{static isSupported(e){var t;return"webgl"===(null===e||void 0===e||null===(t=e.info)||void 0===t?void 0:t.type)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$u.defaultProps;if((0,s.A)(this,"device",void 0),(0,s.A)(this,"model",void 0),(0,s.A)(this,"transformFeedback",void 0),!$u.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Ku(this.device,(0,r.A)({id:t.id||"buffer-transform-model",fs:t.fs||$a(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings},t)),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){null!==e&&void 0!==e&&e.inputBuffers&&this.model.setAttributes(e.inputBuffers),null!==e&&void 0!==e&&e.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof Ra.h)return t.readAsync();const{buffer:i,byteOffset:n=0,byteLength:r=i.byteLength}=t;return i.readAsync(n,r)}}function Qu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=Math.fround(e),r=e-n;return t[i]=n,t[i+1]=r,t}function eh(e){return e-Math.fround(e)}function th(e){const t=new Float32Array(32);for(let i=0;i<4;++i)for(let n=0;n<4;++n){const r=4*i+n;Qu(e[4*n+i],t,2*r)}return t}(0,s.A)($u,"defaultProps",(0,r.A)((0,r.A)({},Ku.defaultProps),{},{outputs:void 0,feedbackBuffers:void 0}));const ih={name:"fp64arithmetic",vs:"\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:Qu,fp64LowPart:eh,fp64ifyMatrix4:th};function nh(e){const{source:t,target:i,start:n=0,size:r,getData:s}=e,o=e.end||i.length,a=t.length,l=o-n;if(a>l)return void i.set(t.subarray(0,l),n);if(i.set(t,n),!s)return;let c=a;for(;c<l;){const e=s(c,t);for(let t=0;t<r;t++)i[n+c]=e[t]||0,c++}}function rh(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function sh(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function oh(e){e.push(e.shift())}function ah(e){let{device:t,source:i,target:n}=e;var r;(!n||n.byteLength<i.byteLength)&&(null===(r=n)||void 0===r||r.destroy(),n=t.createBuffer({byteLength:i.byteLength,usage:i.usage}));return n}function lh(e){let{device:t,buffer:i,attribute:n,fromLength:r,toLength:s,fromStartIndices:o,getData:a=e=>e}=e;const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,c=n.size*l,u=n.byteOffset,h=n.settings.bytesPerElement<4?u/n.settings.bytesPerElement*4:u,d=n.startIndices,p=o&&d,m=n.isConstant;if(!p&&i&&r>=s)return i;const f=n.value instanceof Float64Array?Float32Array:n.value.constructor,g=m?n.value:new f(n.getBuffer().readSyncWebGL(u,s*f.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!m){const e=a;a=(t,i)=>n.normalizeConstant(e(t,i))}const _=m?(e,t)=>a(g,t):(e,t)=>a(g.subarray(e+u,e+u+c),t),v=i?new Float32Array(i.readSyncWebGL(h,4*r).buffer):new Float32Array(0),y=new Float32Array(s);var b;(function(e){let{source:t,target:i,size:n,getData:r,sourceStartIndices:s,targetStartIndices:o}=e;if(!s||!o)return nh({source:t,target:i,size:n,getData:r}),i;let a=0,l=0;const c=r&&((e,t)=>r(e+l,t)),u=Math.min(s.length,o.length);for(let h=1;h<u;h++){const e=s[h]*n,r=o[h]*n;nh({source:t.subarray(a,e),target:i,start:l,end:r,size:n,getData:c}),a=e,l=r}l<i.length&&nh({source:[],target:i,start:l,size:n,getData:c})}({source:v,target:y,sourceStartIndices:o,targetStartIndices:d,size:c,getData:_}),!i||i.byteLength<y.byteLength+h)&&(null===(b=i)||void 0===b||b.destroy(),i=t.createBuffer({byteLength:y.byteLength+h,usage:35050}));return i.write(y,h),i}class ch{constructor(e){let{device:t,attribute:i,timeline:n}=e;this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Xr(n),this.attribute=i,this.attributeInTransition=function(e){const{device:t,settings:i,value:n}=e,r=new Ka(t,i);return r.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:i.normalized}),r}(i),this.currentStartIndices=i.startIndices}get inProgress(){return this.transition.inProgress}start(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(e,t){const{doublePrecision:i,settings:n,value:r,size:s}=e,o=i&&r instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=e.settings;if(l)for(const u of Object.values(l)){var c;a=Math.max(a,null!==(c=u.vertexOffset)&&void 0!==c?c:0)}return(n.noAlloc?r.length:(t+a)*s)*o}(this.attribute,t),this.transition.start((0,r.A)((0,r.A)({},e),{},{duration:i}))}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}const uh={name:"interpolation",vs:"uniform interpolationUniforms {\n  float time;\n} interpolation;\n",uniformTypes:{time:"f32"}},hh="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n",dh="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function ph(e){return e.doublePrecision&&e.value instanceof Float64Array}const mh={name:"spring",vs:"uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n",uniformTypes:{damping:"f32",stiffness:"f32"}},fh="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",gh="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const _h={interpolation:class extends ch{constructor(e){let{device:t,attribute:i,timeline:n}=e;super({device:t,attribute:i,timeline:n}),this.type="interpolation",this.transform=function(e,t){const i=t.size,n=rh(i),r=sh(i),s=t.getBufferLayout();if(ph(t))return new $u(e,{vs:dh,bufferLayout:[{name:"aFrom",byteStride:8*i,attributes:[{attribute:"aFrom",format:r,byteOffset:0},{attribute:"aFrom64Low",format:r,byteOffset:4*i}]},{name:"aTo",byteStride:8*i,attributes:[{attribute:"aTo",format:r,byteOffset:0},{attribute:"aTo64Low",format:r,byteOffset:4*i}]}],modules:[ih,uh],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:i},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new $u(e,{vs:hh,bufferLayout:[{name:"aFrom",format:r},{name:"aTo",format:s.attributes[0].format}],modules:[uh],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}(t,i)}start(e,t){const i=this.currentLength,n=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;oh(r),r[0]=lh({device:this.device,buffer:r[0],attribute:s,fromLength:i,toLength:this.currentLength,fromStartIndices:n,getData:e.enter}),r[1]=ah({device:this.device,source:r[0],target:r[1]}),this.setBuffer(r[1]);const{transform:o}=this,a=o.model;let l=Math.floor(this.currentLength/s.size);ph(s)&&(l/=2),a.setVertexCount(l),s.isConstant?(a.setAttributes({aFrom:r[0]}),a.setConstantAttributes({aTo:s.value})):a.setAttributes({aFrom:r[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:r[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:i}=this.transition;let n=i/e;t&&(n=t(n));const{model:r}=this.transform,s={time:n};r.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends ch{constructor(e){let{device:t,attribute:i,timeline:n}=e;super({device:t,attribute:i,timeline:n}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}(t),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(t,this.texture),this.transform=function(e,t){const i=rh(t.size),n=sh(t.size);return new $u(e,{vs:fh,fs:gh,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[mh],defines:{ATTRIBUTE_TYPE:i},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(t,i)}start(e,t){const i=this.currentLength,n=this.currentStartIndices;super.start(e,t);const{buffers:r,attribute:s}=this;for(let a=0;a<2;a++)r[a]=lh({device:this.device,buffer:r[a],attribute:s,fromLength:i,toLength:this.currentLength,fromStartIndices:n,getData:e.enter});r[2]=ah({device:this.device,source:r[0],target:r[2]}),this.setBuffer(r[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:i,transition:n}=this,r=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:r.stiffness,damping:r.damping};t.model.shaderInputs.setProps({spring:s}),t.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),oh(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(i)[0]>0||n.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class vh{constructor(e,t){let{id:i,timeline:n}=t;if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=i,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:i,numInstances:n}=e;this.numInstances=n||1;for(const r in t){const e=t[r],n=e.getTransitionSetting(i);n&&this._updateAttribute(r,e,n)}for(const r in this.transitions){const e=t[r];e&&e.getTransitionSetting(i)||this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,i){const n=this.transitions[e];let r=!n||n.type!==i.type;if(r){n&&this._removeTransition(e);const s=_h[i.type];s?this.transitions[e]=new s({attribute:t,timeline:this.timeline,device:this.device}):(he.error("unsupported transition type '".concat(i.type,"'"))(),r=!1)}(r||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const yh="attributeManager.invalidate";class bh{constructor(e){let{id:t="attribute-manager",stats:i,timeline:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mergeBoundsMemoized=Ls(Mi),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new vh(e,{id:"".concat(t,"-transitions"),timeline:n}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const i=this._invalidateTrigger(e,t);me(yh,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);me(yh,this,"all")}update(e){let{data:t,numInstances:i,startIndices:n=null,transitions:r,props:s={},buffers:o={},context:a={}}=e,l=!1;me("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const e=this.attributes[c],r=e.settings.accessor;e.startIndices=n,e.numInstances=i,s[c]&&he.removed("props.".concat(c),"data.attributes.".concat(c))(),e.setExternalBuffer(o[c])||e.setBinaryValue("string"===typeof r?o[r]:void 0,t.startIndices)||"string"===typeof r&&!o[r]&&e.setConstantValue(a,s[r])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:i,data:t,props:s,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&me("attributeManager.updateEnd",this,i),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:i,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return(0,r.A)((0,r.A)({},this.attributes),this.attributeTransitionManager.getAttributes())}getBounds(e){const t=e.map(e=>{var t;return null===(t=this.attributes[e])||void 0===t?void 0:t.getBounds()});return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:i}=this,n=(0,r.A)({},i.getAttributes());for(const r in t){const s=t[r];s.needsRedraw(e)&&!i.hasAttribute(r)&&(n[r]=s)}return n}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const i in e){const n=e[i],s=(0,r.A)((0,r.A)({},n),{},{id:i,size:(n.isIndexed?1:n.size)||1},t);this.attributes[i]=new Ka(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(t)})}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:n}=this,r=n[e];return r&&r.forEach(e=>{const n=i[e];n&&n.setNeedsUpdate(n.id,t)}),r}_updateAttribute(e){const{attribute:t,numInstances:i}=e;if(me("attribute.updateStart",t),t.constant)return void t.setConstantValue(e.context,t.value);t.allocate(i)&&me("attribute.allocate",t,i);t.updateBuffer(e)&&(this.needsRedraw=!0,me("attribute.updateEnd",t,i))}}const xh=1e-5;function wh(e,t,i,n,r){const s=t-e;return(i-t)*r+-s*n+s+t}function Eh(e,t){if(Array.isArray(e)){let i=0;for(let n=0;n<e.length;n++){const r=e[n]-t[n];i+=r*r}return Math.sqrt(i)}return Math.abs(e-t)}const Ah={interpolation:class extends Xr{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:n,easing:r}}=this,s=r(e/n);this._value=ui(t,i,s)}},spring:class extends Xr{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:n}=this.settings,{_prevValue:r=e,_currValue:s=e}=this;let o=function(e,t,i,n,r){if(Array.isArray(i)){const s=[];for(let o=0;o<i.length;o++)s[o]=wh(e[o],t[o],i[o],n,r);return s}return wh(e,t,i,n,r)}(r,s,t,i,n);const a=Eh(o,t),l=Eh(o,s);a<xh&&l<xh&&(o=t,this.end()),this._prevValue=s,this._currValue=o}}};class Th{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,n){const{transitions:s}=this;if(s.has(e)){const i=s.get(e),{value:n=i.settings.fromValue}=i;t=n,this.remove(e)}if(!(n=Ya(n)))return;const o=Ah[n.type];if(!o)return void he.error("unsupported transition type '".concat(n.type,"'"))();const a=new o(this.timeline);a.start((0,r.A)((0,r.A)({},n),{},{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Dh(e,t){const i=Ch({newProps:e,oldProps:t,propTypes:e[se],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=function(e,t){if(null===t)return"oldProps is null, initial diff";let i=!1;const{dataComparator:n,_dataDiff:r}=e;n?n(e.data,t.data)||(i="Data comparator detected a change"):e.data!==t.data&&(i="A new data container was supplied");i&&r&&(i=r(e.data,t.data)||i);return i}(e,t);let r=!1;return n||(r=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(kh(e,t,"all"))return{all:!0}}const i={};let n=!1;for(const r in e.updateTriggers)if("all"!==r){kh(e,t,r)&&(i[r]=!0,n=!0)}return!!n&&i}(e,t)),{dataChanged:n,propsChanged:i,updateTriggersChanged:r,extensionsChanged:Ih(e,t),transitionsChanged:Sh(e,t)}}function Sh(e,t){if(!e.transitions)return!1;const i={},n=e[se];let r=!1;for(const s in e.transitions){const o=n[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&Ph(e[s],t[s],o)&&(i[s]=!0,r=!0)}return!!r&&i}function Ch(e){let{newProps:t,oldProps:i,ignoreProps:n={},propTypes:r={},triggerName:s="props"}=e;if(i===t)return!1;if("object"!==typeof t||null===t)return"".concat(s," changed shallowly");if("object"!==typeof i||null===i)return"".concat(s," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in i))return"".concat(s,".").concat(o," added");const e=Ph(t[o],i[o],r[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}for(const o of Object.keys(i))if(!(o in n)){if(!(o in t))return"".concat(s,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const e=Ph(t[o],i[o],r[o]);if(e)return"".concat(s,".").concat(o," ").concat(e)}}return!1}function Ph(e,t,i){let n=i&&i.equal;return n&&!n(e,t,i)?"changed deeply":n||(n=e&&t&&e.equals,!n||n.call(e,t))?n||t===e?null:"changed shallowly":"changed deeply"}function Ih(e,t){if(null===t)return!0;const i=t.extensions,{extensions:n}=e;if(n===i)return!1;if(!i||!n)return!0;if(n.length!==i.length)return!0;for(let r=0;r<n.length;r++)if(!n[r].equals(i[r]))return!0;return!1}function kh(e,t,i){let n=e.updateTriggers[i];n=void 0===n||null===n?{}:n;let r=t.updateTriggers[i];r=void 0===r||null===r?{}:r;return Ch({oldProps:r,newProps:n,triggerName:i})}function Mh(e){if(null===(t=e)||"object"!==typeof t)throw new Error("count(): argument not an object");var t;if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function Rh(e,t){if(!t)return e;const i=(0,r.A)((0,r.A)({},e),t);if("defines"in t&&(i.defines=(0,r.A)((0,r.A)({},e.defines),t.defines)),"modules"in t&&(i.modules=(e.modules||[]).concat(t.modules),t.modules.some(e=>"project64"===e.name))){const e=i.modules.findIndex(e=>"project32"===e.name);e>=0&&i.modules.splice(e,1)}if("inject"in t)if(e.inject){const n=(0,r.A)({},e.inject);for(const e in t.inject)n[e]=(n[e]||"")+t.inject[e];i.inject=n}else i.inject=t.inject;return i}const Fh=[0,0,0];function Lh(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.projectPosition(e);if(i&&t instanceof Hr){const[i,r,s=0]=e,o=t.getDistanceScales([i,r]);n[2]=s*o.unitsPerMeter[2]}return n}function Oh(e,t){let{viewport:i,modelMatrix:n,coordinateSystem:r,coordinateOrigin:s,offsetMode:o}=t,[a,l,c=0]=e;switch(n&&([a,l,c]=Wi([],[a,l,c,1],n)),r){case Dr.LNGLAT:return Lh([a,l,c],i,o);case Dr.LNGLAT_OFFSETS:return Lh([a+s[0],l+s[1],c+(s[2]||0)],i,o);case Dr.METER_OFFSETS:return Lh(bn(s,[a,l,c]),i,o);case Dr.CARTESIAN:default:return i.isGeospatial?[a+s[0],l+s[1],c+s[2]]:i.projectPosition([a,l,c])}}function Bh(e,t){const{viewport:i,coordinateSystem:n,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:i,coordinateOrigin:n}=e;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=e;return r===Dr.DEFAULT&&(r=t.isGeospatial?Dr.LNGLAT:Dr.CARTESIAN),void 0===s&&(s=r),void 0===o&&(o=n),{viewport:t,coordinateSystem:r,coordinateOrigin:n,modelMatrix:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=Fh,shaderCoordinateOrigin:u=Fh,offsetMode:h=!1}=l?Vs(i,n,r):{},d=Oh(e,{viewport:i,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const e=i.projectPosition(c||u);wi(d,d,e)}return d}const zh={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Nh={};const Uh={boolean:{validate:(e,t)=>!0,equal:(e,t,i)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||Gh(e)&&(3===e.length||4===e.length),equal:(e,t,i)=>zr(e,t,1)},accessor:{validate(e,t){const i=Wh(e);return"function"===i||i===Wh(t.value)},equal:(e,t,i)=>"function"===typeof t||zr(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||Gh(e),equal(e,t,i){const{compare:n}=i,r=Number.isInteger(n)?n:n?1:0;return n?zr(e,t,r):e===t}},object:{equal(e,t,i){if(i.ignore)return!0;const{compare:n}=i,r=Number.isInteger(n)?n:n?1:0;return n?zr(e,t,r):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,i)=>!i.compare&&!1!==i.ignore||e===t},data:{transform:(e,t,i)=>{if(!e)return e;const{dataTransform:n}=i.props;return n?n(e):"string"===typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,i)=>{const n=i.context;return n&&n.device?function(e,t,i,n){if(i instanceof al.g)return i;i.constructor&&"Object"!==i.constructor.name&&(i={data:i});let s=null;i.compressed&&(s={minFilter:"linear",mipmapFilter:i.data.length>1?"nearest":"linear"});const{width:o,height:a}=i.data,l=t.createTexture((0,r.A)((0,r.A)({},i),{},{sampler:(0,r.A)((0,r.A)((0,r.A)({},zh),s),n),mipLevels:t.getMipLevelCount(o,a)}));return l.generateMipmapsWebGL(),Nh[l.id]=e,l}(i.id,n.device,e,(0,r.A)((0,r.A)({},t.parameters),i.props.textureParameters)):null},release:(e,t,i)=>{var n,r;n=i.id,(r=e)&&r instanceof al.g&&Nh[r.id]===n&&(r.delete(),delete Nh[r.id])}}};function jh(e,t){switch(Wh(t)){case"object":return Vh(e,t);case"array":return Vh(e,{type:"array",value:t,compare:!1});case"boolean":return Vh(e,{type:"boolean",value:t});case"number":return Vh(e,{type:"number",value:t});case"function":return Vh(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function Vh(e,t){return"type"in t?(0,r.A)((0,r.A)({name:e},Uh[t.type]),t):"value"in t?(0,r.A)({name:e,type:Wh(t.value)},t):{name:e,type:"object",value:t}}function Gh(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function Wh(e){return Gh(e)?"array":null===e?"null":typeof e}const Hh="_mergedDefaultProps";function Xh(e,t){if(!(e instanceof $h.constructor))return{};let i=Hh;if(t)for(const r of t){const e=r.constructor;e&&(i+=":".concat(e.extensionName||e.name))}const n=Yh(e,i);return n||(e[i]=function(e,t){const i=e.prototype;if(!i)return null;const n=Object.getPrototypeOf(e),r=Xh(n),s=Yh(e,"defaultProps")||{},o=function(e){const t={},i={},n={};for(const[r,s]of Object.entries(e)){const e=null===s||void 0===s?void 0:s.deprecatedFor;if(e)n[r]=Array.isArray(e)?e:[e];else{const e=jh(r,s);t[r]=e,i[r]=e.value}}return{propTypes:t,defaultProps:i,deprecatedProps:n}}(s),a=Object.assign(Object.create(null),r,o.defaultProps),l=Object.assign(Object.create(null),null===r||void 0===r?void 0:r[se],o.propTypes),c=Object.assign(Object.create(null),null===r||void 0===r?void 0:r[oe],o.deprecatedProps);for(const u of t){const e=Xh(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[se]),Object.assign(c,e[oe]))}(function(e,t){const i=function(e){const t=e.componentName;t||he.warn("".concat(e.name,".componentName not specified"))();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:i}})})(a,e),function(e,t){const i={},n={};for(const r in t){const e=t[r],{name:s,value:o}=e;e.async&&(i[s]=o,n[s]=qh(s))}e[ae]=i,e[le]={},Object.defineProperties(e,n)}(a,l),function(e,t){for(const i in t)Object.defineProperty(e,i,{enumerable:!1,set(e){const n="".concat(this.id,": ").concat(i);for(const r of t[i])Zh(this,r)||(this[r]=e);he.deprecated(n,t[i].join("/"))()}})}(a,c),a[se]=l,a[oe]=c,0!==t.length||Zh(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function qh(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||Wa(t)?this[le][e]=t:this[ce][e]=t},get(){if(this[ce]){if(e in this[ce]){return this[ce][e]||this[ae][e]}if(e in this[le]){const t=this[re]&&this[re].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[ae][e]}}return this[ae][e]}}}function Zh(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Yh(e,t){return Zh(e,t)&&e[t]}let Kh=0;class Jh{constructor(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.props=function(e,t){let i;for(let s=t.length-1;s>=0;s--){const e=t[s];"extensions"in e&&(i=e.extensions)}const n=Xh(e.constructor,i),r=Object.create(n);r[re]=e,r[le]={},r[ce]={};for(let s=0;s<t.length;++s){const e=t[s];for(const t in e)r[t]=e[t]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=Kh++}clone(e){const{props:t}=this,i={};for(const n in t[ae])n in t[ce]?i[n]=t[ce][n]:n in t[le]&&(i[n]=t[le][n]);return new this.constructor((0,r.A)((0,r.A)((0,r.A)({},t),i),e))}}Jh.componentName="Component",Jh.defaultProps={};const $h=Jh,Qh=Object.freeze({});class ed{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Qh}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[re]||this.component;const t=e[ce]||{},i=e[le]||e,n=e[ae]||{};for(const r in t){const e=t[r];this._createAsyncPropData(r,n[r]),this._updateAsyncProp(r,e),t[r]=this.getAsyncProp(r)}for(const r in i){const e=i[r];this._createAsyncPropData(r,n[r]),this._updateAsyncProp(r,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):Wa(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,t,i){const n=this.asyncProps[e];n&&i>=n.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),n.resolvedValue=t,n.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const n=i.pendingLoadCount;t.then(t=>{this.component&&(t=this._postProcessValue(i,t),this._setAsyncPropValue(e,t,n),this._onResolve(e,t))}).catch(t=>{this._onError(e,t)})}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const n=i.pendingLoadCount;let r=[],s=0;var o,a=!1,l=!1;try{for(var c,u=At(t);a=!(c=await u.next()).done;a=!1){const t=c.value;{if(!this.component)return;const{dataTransform:i}=this.component.props;r=i?i(t,r):r.concat(t),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:s,endRow:r.length}]}),s=r.length,this._setAsyncPropValue(e,r,n)}}}catch(h){l=!0,o=h}finally{try{a&&null!=u.return&&await u.return()}finally{if(l)throw o}}this._onResolve(e,r)}_postProcessValue(e,t){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const i=this.component&&this.component.props[se];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class td extends ed{constructor(e){let{attributeManager:t,layer:i}=e;super(i),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const i=this.layer,n=null===i||void 0===i?void 0:i.props.fetch;return n?n(t,{propName:e,layer:i}):super._fetch(e,t)}_onResolve(e,t){const i=this.layer;if(i){const n=i.props.onDataLoad;"data"===e&&n&&n(t,{propName:e,layer:i})}}_onError(e,t){const i=this.layer;i&&i.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const id=2**24-1,nd=Object.freeze([]),rd=Ls(e=>{let{oldViewport:t,viewport:i}=e;return t.equals(i)});let sd=new Uint8ClampedArray(0);const od={data:{type:"data",value:nd,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:i,layer:n,loaders:s,loadOptions:o,signal:a}=t;const{resourceManager:l}=n.context;var c;(o=o||n.getLoadOptions(),s=s||n.props.loaders,a)&&(o=(0,r.A)((0,r.A)({},o),{},{fetch:(0,r.A)((0,r.A)({},null===(c=o)||void 0===c?void 0:c.fetch),{},{signal:a})}));let u=l.contains(e);return u||o||(l.add({resourceId:e,data:ii(e,s),persistent:!1}),u=!0),u?l.subscribe({resourceId:e,onChange:e=>{var t;return null===(t=n.internalState)||void 0===t?void 0:t.reloadAsyncProp(i,e)},consumerId:n.id,requestId:i}):ii(e,s,o)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Dr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ad extends $h{constructor(){super(...arguments),this.internalState=null,this.lifecycle=$,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Qr(this.internalState);const t=this.internalState.viewport||this.context.viewport,i=Oh(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[n,r,s]=An(i,t.pixelProjectionMatrix);return 2===e.length?[n,r]:[n,r,s]}unproject(e){Qr(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Qr(this.internalState);const i=this.internalState.viewport||this.context.viewport;return Bh(e,(0,r.A)({viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem},t))}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(){for(const e of this.getModels())e.shaderInputs.setProps(...arguments)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Dr.DEFAULT||e===Dr.LNGLAT||e===Dr.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Qr(e instanceof Uint8Array);const[t,i,n]=e;return t+256*i+65536*n-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Mh(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=Rh(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=Rh(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&t)if(Array.isArray(i))for(const n of i)t.invalidateAll(n);else t.invalidateAll();if(t){const{props:i}=e,n=this.internalState.hasPickingBuffer,r=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(e=>e.getNeedsPickingBuffer.call(this,e));if(n!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:e,instancePickingColors:i}=t.attributes,n=e||i;n&&(r&&n.constant&&(n.constant=!1,t.invalidate(n.id)),n.value||r||(n.constant=!0,n.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo(e){let{info:t,mode:i,sourceLayer:n}=e;const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}raiseError(e,t){var i,n,r,s;(t&&(e=new Error("".concat(t,": ").concat(e.message),{cause:e})),null!==(i=(n=this.props).onError)&&void 0!==i&&i.call(n,e))||(null===(r=this.context)||void 0===r||null===(s=r.onError)||void 0===s||s.call(r,e,this))}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&rd({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const i in e)e[i].layoutChanged()&&(t=!0);for(const i of this.getModels())this._setModelAttributes(i,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,i=this.getNumInstances(),n=this.getStartIndices();e.update({data:t.data,numInstances:i,startIndices:n,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const r=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),i=Object.create(this.props);for(const e in t)Object.defineProperty(i,e,{value:t[e]});return i}return this.props}calculateInstancePickingColors(e,t){let{numInstances:i}=t;if(e.constant)return;const n=Math.floor(sd.length/4);if(this.internalState.usesPickingColorCache=!0,n<i){i>id&&he.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),sd=si.allocate(sd,i,{size:4,copy:!0,maxCount:Math.max(i,id)});const e=Math.floor(sd.length/4),t=[0,0,0];for(let i=n;i<e;i++)this.encodePickingColor(i,t),sd[4*i+0]=t[0],sd[4*i+1]=t[1],sd[4*i+2]=t[2],sd[4*i+3]=0}e.value=sd.subarray(0,4*i)}_setModelAttributes(e,t){var i;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Object.keys(t).length)return;if(n){const i=this.getAttributeManager();e.setBufferLayout(i.getBufferLayouts(e)),t=i.getAttributes()}const r=(null===(i=e.userData)||void 0===i?void 0:i.excludeAttributes)||{},s={},o={};for(const a in t){if(r[a])continue;const i=t[a].getValue();for(const n in i){const r=i[n];r instanceof Ra.h?t[a].settings.isIndexed?e.setIndexBuffer(r):s[n]=r:r&&(o[n]=r)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:i,instancePickingColors:n}=this.getAttributeManager().attributes,r=i||n,s=r&&t.attributes&&t.attributes[r.id];if(s&&s.value){const i=s.value,n=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=r.getVertexOffset(e);i[t]===n[0]&&i[t+1]===n[1]&&i[t+2]===n[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,n=t||i;if(!n)return;const r=n.getVertexOffset(e),s=n.getVertexOffset(e+1);n.buffer.write(new Uint8Array(s-r),r)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,i=e||t;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==sd.buffer&&(i.value=sd.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Qr(!this.internalState),Qr(Number.isFinite(this.props.coordinateSystem)),me("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new td({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(he.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Th(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){me("layer.matched",this,this===e);const{state:t,internalState:i}=e;this!==e&&(this.internalState=i,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(me("layer.update",this,e),!e)return;const t=this.props,i=this.context,n=this.internalState,r=i.viewport,s=this._updateUniformTransition();n.propsInTransition=s,i.viewport=n.viewport||r,this.props=s;try{const e=this._getUpdateParams(),t=this.getModels();if(i.device)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const i of this.props.extensions)i.updateState.call(this,e,i);this.setNeedsRedraw(),this._updateAttributes();const n=this.getModels()[0]!==t[0];this._postUpdate(e,n)}finally{i.viewport=r,this.props=t,this._clearChangeFlags(),n.needsUpdate=!1,n.resetOldProps()}}_finalize(){me("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{renderPass:t,shaderModuleProps:i=null,uniforms:n={},parameters:s={}}=e;this._updateAttributeTransition();const o=this.props,a=this.context;this.props=this.internalState.propsInTransition||o;try{i&&this.setShaderModuleProps(i);const{getPolygonOffset:e}=this.props,o=e&&e(n)||[0,0];a.device instanceof Fa.WebGLDevice&&a.device.setParametersWebGL({polygonOffset:o});for(const t of this.getModels())"webgpu"===t.device.type?t.setParameters((0,r.A)((0,r.A)({},t.parameters),s)):t.setParameters(s);if(a.device instanceof Fa.WebGLDevice)a.device.withParametersWebGL(s,()=>{const e={renderPass:t,shaderModuleProps:i,uniforms:n,parameters:s,context:a};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)});else{const e={renderPass:t,shaderModuleProps:i,uniforms:n,parameters:s,context:a};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}}finally{this.props=o}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const n in e)if(e[n]){let i=!1;if("dataChanged"===n){const r=e[n],s=t[n];r&&Array.isArray(s)&&(t.dataChanged=Array.isArray(r)?s.concat(r):r,i=!0)}t[n]||(t[n]=e[n],i=!0),i&&me("layer.changeFlag",this,n,e)}const i=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=i,t.somethingChanged=i||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const i=Dh(e,t);if(i.updateTriggersChanged)for(const r in i.updateTriggersChanged)i.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(i.transitionsChanged)for(const r in i.transitionsChanged){var n;this.internalState.uniformTransitions.add(r,t[r],e[r],null===(n=e.transitions)||void 0===n?void 0:n[r])}return this.setChangeFlags(i)}validateProps(){!function(e){const t=e[se];for(const i in t){const n=t[i],{validate:r}=n;if(r&&!r(e[i],n))throw new Error("Invalid prop ".concat(i,": ").concat(e[i]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&"function"===typeof i&&(t.highlightColor=i(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new bh(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:i,oldProps:n}=e,r=this.state.model;null!==r&&void 0!==r&&r.isInstanced&&r.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=i;if(t||n.autoHighlight!==s||n.highlightedObjectIndex!==o||n.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||n.autoHighlight!==s||o!==n.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),n=!!i&&i.getNeedsRedraw(e);if(t=t||n,t)for(const r of this.props.extensions)r.onNeedsRedraw.call(this,r);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ad.defaultProps=od,ad.layerName="Layer";const ld=ad,cd={position:"absolute",zIndex:-1};function ud(t,i){if("function"===typeof t)return t(i);if(Array.isArray(t))return t.map(e=>ud(e,i));if(hd(t)){if(function(e){var t;return null===(t=e.props)||void 0===t?void 0:t.mapStyle}(t))return i.style=cd,(0,e.cloneElement)(t,i);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(t))return(0,e.cloneElement)(t,i)}return t}function hd(e){return e&&"object"===typeof e&&"type"in e||!1}function dd(t){if("function"===typeof t)return(0,e.createElement)(Gr,{},t);if(Array.isArray(t))return t.map(dd);if(hd(t)){if(t.type===e.Fragment)return dd(t.props.children);if(Ma(t.type,Gr))return t}return t}const pd=(0,e.createContext)();const md={mixBlendMode:null};function fd(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const gd=e.forwardRef(function(t,i){const[n,s]=(0,e.useState)(0),o=(0,e.useRef)({control:null,version:n,forceUpdate:()=>s(e=>e+1)}),a=o.current,l=(0,e.useRef)(null),c=(0,e.useRef)(null),u=(0,e.useMemo)(()=>function(t){let{children:i,layers:n=[],views:r=null}=t;const s=[],o=[],a={};return e.Children.forEach(dd(i),e=>{if(hd(e)){const t=e.type;if(Ma(t,ld)){const i=function(e,t){const i={},n=e.defaultProps||{};for(const r in t)n[r]!==t[r]&&(i[r]=t[r]);return new e(i)}(t,e.props);o.push(i)}else s.push(e);if(Ma(t,Gr)&&t!==Gr&&e.props.id){const i=new t(e.props);a[i.id]=i}}else e&&s.push(e)}),Object.keys(a).length>0&&(Array.isArray(r)?r.forEach(e=>{a[e.id]=e}):r&&(a[r.id]=r),r=Object.values(a)),n=o.length>0?[...o,...n]:n,{layers:n,children:s,views:r}}(t),[t.layers,t.views,t.children]);let h=!0;const d=e=>{var i;return h&&t.viewState?(a.viewStateUpdateRequested=e,null):(a.viewStateUpdateRequested=null,null===(i=t.onViewStateChange)||void 0===i?void 0:i.call(t,e))},p=e=>{var i;h?a.interactionStateUpdateRequested=e:(a.interactionStateUpdateRequested=null,null===(i=t.onInteractionStateChange)||void 0===i||i.call(t,e))},m=(0,e.useMemo)(()=>{const e=(0,r.A)((0,r.A)({widgets:[]},t),{},{style:null,width:"100%",height:"100%",parent:l.current,canvas:c.current,layers:u.layers,views:u.views,onViewStateChange:d,onInteractionStateChange:p});return delete e._customRender,a.deck&&a.deck.setProps(e),e},[t]);(0,e.useEffect)(()=>{const e=t.Deck||Ia;return a.deck=function(e,t,i){var n;const s=new t((0,r.A)((0,r.A)({},i),{},{_customRender:"webgpu"===(null===(n=i.deviceProps)||void 0===n||null===(n=n.adapters)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.type)?void 0:t=>{e.redrawReason=t;const i=s.getViewports();e.lastRenderedViewports!==i?e.forceUpdate():fd(e)}}));return s}(a,e,(0,r.A)((0,r.A)({},m),{},{parent:l.current,canvas:c.current})),()=>{var e;return null===(e=a.deck)||void 0===e?void 0:e.finalize()}},[]),ka(()=>{var e;fd(a);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:i}=a;t&&d(t),i&&p(i),null!==(e=a.deck)&&void 0!==e&&e.isInitialized&&a.deck.redraw("Initial render")}),(0,e.useImperativeHandle)(i,()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(a),[]);const f=a.deck&&a.deck.isInitialized?a.deck.getViewports():void 0,{ContextProvider:g,width:_="100%",height:v="100%",id:y,style:b}=t,{containerStyle:x,canvasStyle:w}=(0,e.useMemo)(()=>function(e){let{width:t,height:i,style:n}=e;const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:i},s={left:0,top:0};if(n)for(const o in n)o in md?s[o]=n[o]:r[o]=n[o];return{containerStyle:r,canvasStyle:s}}({width:_,height:v,style:b}),[_,v,b]);if(!a.viewStateUpdateRequested&&a.lastRenderedViewports===f||a.version!==n){a.lastRenderedViewports=f,a.version=n;const t=function(t){let{children:i,deck:n,ContextProvider:r=pd.Provider}=t;const{viewManager:s}=n||{};if(!s||!s.views.length)return[];const o={},a=s.views[0].id;for(const e of i){let t=a,i=e;hd(e)&&Ma(e.type,Gr)&&(t=e.props.id||a,i=e.props.children);const n=s.getViewport(t),r=s.getViewState(t);if(n){r.padding=n.padding;const{x:e,y:s,width:a,height:l}=n;i=ud(i,{x:e,y:s,width:a,height:l,viewport:n,viewState:r}),o[t]||(o[t]={viewport:n,children:[]}),o[t].children.push(i)}}return Object.keys(o).map(t=>{const{viewport:i,children:s}=o[t],{x:a,y:l,width:c,height:u}=i,h={position:"absolute",left:a,top:l,width:c,height:u},d="view-".concat(t),p=(0,e.createElement)("div",{key:d,id:d,style:h},...s),m={deck:n,viewport:i,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:e=>{e.viewId=t,n._onViewStateChange(e)},widgets:[]},f="view-".concat(t,"-context");return(0,e.createElement)(r,{key:f,value:m},p)})}({children:u.children,deck:a.deck,ContextProvider:g}),i=(0,e.createElement)("canvas",{key:"canvas",id:y||"deckgl-overlay",ref:c,style:w});a.control=(0,e.createElement)("div",{id:"".concat(y||"deckgl","-wrapper"),ref:l,style:x},[i,t])}return h=!1,a.control}),_d=gd;function vd(){return vd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},vd.apply(null,arguments)}function yd(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function bd(e,t){if(e){if("string"==typeof e)return yd(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?yd(e,t):void 0}}function xd(e){return function(e){if(Array.isArray(e))return yd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||bd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var wd=i(173);function Ed(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,s,o,a=[],l=!0,c=!1;try{if(s=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=s.call(i)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(c)throw r}}return a}}(e,t)||bd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ad=1e-6,Td="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI,Math.PI;!function(){var e=function(){var e=new Td(4);return Td!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function Dd(e,t){const i=function(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3];return e[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,e[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,e[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,e[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,e}([],t,e);return function(e,t,i){e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i}(i,i,1/i[3]),i}function Sd(e,t){const i=e%t;return i<0?t+i:i}function Cd(e,t,i){return i*t+(1-i)*e}function Pd(e,t,i){return e<t?t:e>i?i:e}const Id=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function kd(e,t,i){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],m=t[11],f=t[12],g=t[13],_=t[14],v=t[15],y=i[0],b=i[1],x=i[2],w=i[3];return e[0]=y*n+b*a+x*h+w*f,e[1]=y*r+b*l+x*d+w*g,e[2]=y*s+b*c+x*p+w*_,e[3]=y*o+b*u+x*m+w*v,y=i[4],b=i[5],x=i[6],w=i[7],e[4]=y*n+b*a+x*h+w*f,e[5]=y*r+b*l+x*d+w*g,e[6]=y*s+b*c+x*p+w*_,e[7]=y*o+b*u+x*m+w*v,y=i[8],b=i[9],x=i[10],w=i[11],e[8]=y*n+b*a+x*h+w*f,e[9]=y*r+b*l+x*d+w*g,e[10]=y*s+b*c+x*p+w*_,e[11]=y*o+b*u+x*m+w*v,y=i[12],b=i[13],x=i[14],w=i[15],e[12]=y*n+b*a+x*h+w*f,e[13]=y*r+b*l+x*d+w*g,e[14]=y*s+b*c+x*p+w*_,e[15]=y*o+b*u+x*m+w*v,e}function Md(e,t,i){var n,r,s,o,a,l,c,u,h,d,p,m,f=i[0],g=i[1],_=i[2];return t===e?(e[12]=t[0]*f+t[4]*g+t[8]*_+t[12],e[13]=t[1]*f+t[5]*g+t[9]*_+t[13],e[14]=t[2]*f+t[6]*g+t[10]*_+t[14],e[15]=t[3]*f+t[7]*g+t[11]*_+t[15]):(n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],m=t[11],e[0]=n,e[1]=r,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=m,e[12]=n*f+a*g+h*_+t[12],e[13]=r*f+l*g+d*_+t[13],e[14]=s*f+c*g+p*_+t[14],e[15]=o*f+u*g+m*_+t[15]),e}function Rd(e,t,i){var n=i[0],r=i[1],s=i[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}var Fd=function(e,t,i,n,r){var s=1/Math.tan(t/2);if(e[0]=s/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0){var o=1/(n-r);e[10]=(r+n)*o,e[14]=2*r*n*o}else e[10]=-1,e[14]=-2*n;return e};function Ld(e,t){var i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],m=e[12],f=e[13],g=e[14],_=e[15],v=t[0],y=t[1],b=t[2],x=t[3],w=t[4],E=t[5],A=t[6],T=t[7],D=t[8],S=t[9],C=t[10],P=t[11],I=t[12],k=t[13],M=t[14],R=t[15];return Math.abs(i-v)<=Ad*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(n-y)<=Ad*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=Ad*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(s-x)<=Ad*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(o-w)<=Ad*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-E)<=Ad*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(l-A)<=Ad*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-T)<=Ad*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-D)<=Ad*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(h-S)<=Ad*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(d-C)<=Ad*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-P)<=Ad*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(m-I)<=Ad*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(f-k)<=Ad*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(g-M)<=Ad*Math.max(1,Math.abs(g),Math.abs(M))&&Math.abs(_-R)<=Ad*Math.max(1,Math.abs(_),Math.abs(R))}function Od(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function Bd(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function zd(e,t,i,n){var r=t[0],s=t[1];return e[0]=r+n*(i[0]-r),e[1]=s+n*(i[1]-s),e}var Nd=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e};!function(){var e=function(){var e=new Td(2);return Td!=Float32Array&&(e[0]=0,e[1]=0),e}()}();var Ud=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e};!function(){var e=function(){var e=new Td(3);return Td!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function jd(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Vd=Math.PI,Gd=Vd/4,Wd=Vd/180,Hd=180/Vd,Xd=512,qd=85.051129,Zd=1.5;function Yd(e){return Math.pow(2,e)}function Kd(e){return Id(e)}function Jd(e){const[t,i]=e;jd(Number.isFinite(t)),jd(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");const n=i*Wd;return[Xd*(t*Wd+Vd)/(2*Vd),Xd*(Vd+Math.log(Math.tan(Gd+.5*n)))/(2*Vd)]}function $d(e){const[t,i]=e,n=t/Xd*(2*Vd)-Vd,r=2*(Math.atan(Math.exp(i/Xd*(2*Vd)-Vd))-Gd);return[n*Hd,r*Hd]}function Qd(e){const{latitude:t,longitude:i,highPrecision:n=!1}=e;jd(Number.isFinite(t)&&Number.isFinite(i));const r=Xd,s=Math.cos(t*Wd),o=r/360,a=o/s,l=12790407194604047e-21/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(n){const e=Wd*Math.tan(t*Wd)/s,i=o*e/2,n=12790407194604047e-21*e,r=n/a*l;c.unitsPerDegree2=[0,i,n],c.unitsPerMeter2=[r,0,r]}return c}function ep(e){const{height:t,pitch:i,bearing:n,altitude:r,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Md(a,a,[0,0,-r]),function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*n,e[5]=o*r+u*n,e[6]=a*r+h*n,e[7]=l*r+d*n,e[8]=c*r-s*n,e[9]=u*r-o*n,e[10]=h*r-a*n,e[11]=d*r-l*n}(a,a,-i*Wd),function(e,t,i){var n=Math.sin(i),r=Math.cos(i),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*n,e[1]=o*r+u*n,e[2]=a*r+h*n,e[3]=l*r+d*n,e[4]=c*r-s*n,e[5]=u*r-o*n,e[6]=h*r-a*n,e[7]=d*r-l*n}(a,a,n*Wd);const l=s/t;return Rd(a,a,[l,l,l]),o&&Md(a,a,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),a}function tp(e){const{fov:t,aspect:i,near:n,far:r}=function(e){const{width:t,height:i,altitude:n,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=ip(Zd)}=e;void 0!==n&&(u=ip(n));const h=u*Wd,d=r*Wd,p=np(u);let m=p;o&&(m+=o[2]*a/Math.cos(d)/i);const f=h*(.5+(s?s[1]:0)/i),g=Math.sin(f)*m/Math.sin(Pd(Math.PI/2-d-f,.01,Math.PI-.01)),_=Math.sin(d)*g+m,v=10*m;return{fov:h,aspect:t/i,focalDistance:p,near:l,far:Math.min(_*c,v)}}(e);return Fd([],t,i,n,r)}function ip(e){return 2*Math.atan(.5/e)*Hd}function np(e){return.5/Math.tan(.5*e*Wd)}function rp(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[n,r,s]=e;if(jd(Number.isFinite(n)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s)){return Dd(t,[n,r,s,1])}const o=Dd(t,[n,r,0,1]),a=Dd(t,[n,r,1,1]),l=o[2],c=a[2];return zd([],o,a,l===c?0:((i||0)-l)/(c-l))}function sp(e){const{width:t,height:i,bounds:n,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[c,u]]=n,h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return jd(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),d=Jd([a,Pd(u,-85.051129,qd)]),p=Jd([c,Pd(l,-85.051129,qd)]),m=[Math.max(Math.abs(p[0]-d[0]),r),Math.max(Math.abs(p[1]-d[1]),r)],f=[t-h.left-h.right-2*Math.abs(o[0]),i-h.top-h.bottom-2*Math.abs(o[1])];jd(f[0]>0&&f[1]>0);const g=f[0]/m[0],_=f[1]/m[1],v=(h.right-h.left)/2/g,y=(h.top-h.bottom)/2/_,b=$d([(p[0]+d[0])/2+v,(p[1]+d[1])/2+y]),x=Math.min(s,Id(Math.abs(Math.min(g,_))));return jd(Number.isFinite(x)),{longitude:b[0],latitude:b[1],zoom:x}}const op=Math.PI/180;function ap(e,t,i){const{pixelUnprojectionMatrix:n}=e,r=Dd(n,[t,0,1,1]),s=Dd(n,[t,e.height,1,1]),o=$d(zd([],r,s,(i*e.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return o.push(i),o}class lp{constructor(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1};(0,s.A)(this,"latitude",void 0),(0,s.A)(this,"longitude",void 0),(0,s.A)(this,"zoom",void 0),(0,s.A)(this,"pitch",void 0),(0,s.A)(this,"bearing",void 0),(0,s.A)(this,"altitude",void 0),(0,s.A)(this,"fovy",void 0),(0,s.A)(this,"meterOffset",void 0),(0,s.A)(this,"center",void 0),(0,s.A)(this,"width",void 0),(0,s.A)(this,"height",void 0),(0,s.A)(this,"scale",void 0),(0,s.A)(this,"distanceScales",void 0),(0,s.A)(this,"viewMatrix",void 0),(0,s.A)(this,"projectionMatrix",void 0),(0,s.A)(this,"viewProjectionMatrix",void 0),(0,s.A)(this,"pixelProjectionMatrix",void 0),(0,s.A)(this,"pixelUnprojectionMatrix",void 0),(0,s.A)(this,"equals",e=>e instanceof lp&&(e.width===this.width&&e.height===this.height&&Ld(e.projectionMatrix,this.projectionMatrix)&&Ld(e.viewMatrix,this.viewMatrix))),(0,s.A)(this,"project",function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{topLeft:n=!0}=i,r=function(e,t){const[i,n,r=0]=e;return jd(Number.isFinite(i)&&Number.isFinite(n)&&Number.isFinite(r)),Dd(t,[i,n,r,1])}(e.projectPosition(t),e.pixelProjectionMatrix),[s,o]=r,a=n?o:e.height-o;return 2===t.length?[s,a]:[s,a,r[2]]}),(0,s.A)(this,"unproject",function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{topLeft:n=!0,targetZ:r}=i,[s,o,a]=t,l=n?o:e.height-o,c=r&&r*e.distanceScales.unitsPerMeter[2],u=rp([s,l,a],e.pixelUnprojectionMatrix,c),[h,d,p]=e.unprojectPosition(u);return Number.isFinite(a)?[h,d,p]:Number.isFinite(r)?[h,d,r]:[h,d]}),(0,s.A)(this,"projectPosition",e=>{const[t,i]=Jd(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}),(0,s.A)(this,"unprojectPosition",e=>{const[t,i]=$d(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]});let{width:i,height:n,altitude:r=null,fovy:o=null}=t;const{latitude:a=0,longitude:l=0,zoom:c=0,pitch:u=0,bearing:h=0,position:d=null,nearZMultiplier:p=.02,farZMultiplier:m=1.01}=t;i=i||1,n=n||1,null===o&&null===r?(r=Zd,o=ip(r)):null===o?o=ip(r):null===r&&(r=np(o));const f=Yd(c);r=Math.max(.75,r);const g=Qd({longitude:l,latitude:a}),_=Jd([l,a]);_.push(0),d&&function(e,t,i){e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2]}(_,_,Ud([],d,g.unitsPerMeter)),this.projectionMatrix=tp({width:i,height:n,scale:f,center:_,pitch:u,fovy:o,nearZMultiplier:p,farZMultiplier:m}),this.viewMatrix=ep({height:n,scale:f,center:_,pitch:u,bearing:h,altitude:r}),this.width=i,this.height=n,this.scale=f,this.latitude=a,this.longitude=l,this.zoom=c,this.pitch=u,this.bearing=h,this.altitude=r,this.fovy=o,this.center=_,this.meterOffset=d||[0,0,0],this.distanceScales=g,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:i,viewMatrix:n}=this,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];kd(r,r,i),kd(r,r,n),this.viewProjectionMatrix=r;const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Rd(s,s,[e/2,-t/2,1]),Md(s,s,[1,-1,0]),kd(s,s,r);const o=function(e,t){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],_=t[15],v=i*a-n*o,y=i*l-r*o,b=i*c-s*o,x=n*l-r*a,w=n*c-s*a,E=r*c-s*l,A=u*f-h*m,T=u*g-d*m,D=u*_-p*m,S=h*g-d*f,C=h*_-p*f,P=d*_-p*g,I=v*P-y*C+b*S+x*D-w*T+E*A;return I?(I=1/I,e[0]=(a*P-l*C+c*S)*I,e[1]=(r*C-n*P-s*S)*I,e[2]=(f*E-g*w+_*x)*I,e[3]=(d*w-h*E-p*x)*I,e[4]=(l*D-o*P-c*T)*I,e[5]=(i*P-r*D+s*T)*I,e[6]=(g*b-m*E-_*y)*I,e[7]=(u*E-d*b+p*y)*I,e[8]=(o*C-a*D+c*A)*I,e[9]=(n*D-i*C-s*A)*I,e[10]=(m*w-f*b+_*v)*I,e[11]=(h*b-u*w-p*v)*I,e[12]=(a*T-o*S-l*A)*I,e[13]=(i*S-n*T+r*A)*I,e[14]=(f*y-m*x-g*v)*I,e[15]=(u*x-h*y+d*v)*I,e):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s);if(!o)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=o}projectFlat(e){return Jd(e)}unprojectFlat(e){return $d(e)}getMapCenterByLngLatPosition(e){let{lngLat:t,pos:i}=e;const n=rp(i,this.pixelUnprojectionMatrix),r=Od([],Jd(t),function(e,t){return e[0]=-t[0],e[1]=-t[1],e}([],n));return $d(Od([],this.center,r))}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:i,height:n}=this,{longitude:r,latitude:s,zoom:o}=sp(Object.assign({width:i,height:n,bounds:e},t));return new lp({width:i,height:n,longitude:r,latitude:s,zoom:o})}getBounds(e){const t=this.getBoundingRegion(e),i=Math.min(...t.map(e=>e[0])),n=Math.max(...t.map(e=>e[0])),r=Math.min(...t.map(e=>e[1])),s=Math.max(...t.map(e=>e[1]));return[[i,r],[n,s]]}getBoundingRegion(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:i,height:n,unproject:r}=e,s={targetZ:t},o=r([0,n],s),a=r([i,n],s);let l,c;return(e.fovy?.5*e.fovy*op:Math.atan(.5/e.altitude))>(90-e.pitch)*op-.01?(l=ap(e,0,t),c=ap(e,i,t)):(l=r([0,0],s),c=r([i,0],s)),[o,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0)}getLocationAtPoint(e){let{lngLat:t,pos:i}=e;return this.getMapCenterByLngLatPosition({lngLat:t,pos:i})}}const cp=["longitude","latitude","zoom"],up={curve:1.414,speed:1.2};function hp(e,t,i){const n=(i=Object.assign({},up,i)).curve,r=e.zoom,s=[e.longitude,e.latitude],o=Yd(r),a=t.zoom,l=[t.longitude,t.latitude],c=Yd(a-r),u=Jd(s),h=Jd(l),d=Nd([],h,u),p=Math.max(e.width,e.height),m=p/c,f=Bd(d)*o,g=Math.max(f,.01),_=n*n,v=(m*m-p*p+_*_*g*g)/(2*p*_*g),y=(m*m-p*p-_*_*g*g)/(2*m*_*g),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);return{startZoom:r,startCenterXY:u,uDelta:d,w0:p,u1:f,S:(x-b)/n,rho:n,rho2:_,r0:b,r1:x}}var dp=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var i=-1;return e.some(function(e,n){return e[0]===t&&(i=n,!0)}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var i=e(this.__entries__,t),n=this.__entries__[i];return n&&n[1]},t.prototype.set=function(t,i){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,n=e(i,t);~n&&i.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];e.call(t,r[1],r[0])}},t}()}(),pp="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,mp="undefined"!==typeof i.g&&i.g.Math===Math?i.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),fp="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(mp):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)};var gp=["top","right","bottom","left","width","height","size","weight"],_p="undefined"!==typeof MutationObserver,vp=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var i=!1,n=!1,r=0;function s(){i&&(i=!1,e()),n&&a()}function o(){fp(s)}function a(){var e=Date.now();if(i){if(e-r<2)return;n=!0}else i=!0,n=!1,setTimeout(o,t);r=e}return a}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){pp&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),_p?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){pp&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=void 0===t?"":t;gp.some(function(e){return!!~i.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),yp=function(e,t){for(var i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];Object.defineProperty(e,r,{value:t[r],enumerable:!1,writable:!1,configurable:!0})}return e},bp=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||mp},xp=Sp(0,0,0,0);function wp(e){return parseFloat(e)||0}function Ep(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce(function(t,i){return t+wp(e["border-"+i+"-width"])},0)}function Ap(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return xp;var n=bp(e).getComputedStyle(e),r=function(e){for(var t={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i],s=e["padding-"+r];t[r]=wp(s)}return t}(n),s=r.left+r.right,o=r.top+r.bottom,a=wp(n.width),l=wp(n.height);if("border-box"===n.boxSizing&&(Math.round(a+s)!==t&&(a-=Ep(n,"left","right")+s),Math.round(l+o)!==i&&(l-=Ep(n,"top","bottom")+o)),!function(e){return e===bp(e).document.documentElement}(e)){var c=Math.round(a+s)-t,u=Math.round(l+o)-i;1!==Math.abs(c)&&(a-=c),1!==Math.abs(u)&&(l-=u)}return Sp(r.left,r.top,a,l)}var Tp="undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof bp(e).SVGGraphicsElement}:function(e){return e instanceof bp(e).SVGElement&&"function"===typeof e.getBBox};function Dp(e){return pp?Tp(e)?function(e){var t=e.getBBox();return Sp(0,0,t.width,t.height)}(e):Ap(e):xp}function Sp(e,t,i,n){return{x:e,y:t,width:i,height:n}}var Cp=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Sp(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=Dp(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),Pp=function(e,t){var i=function(e){var t=e.x,i=e.y,n=e.width,r=e.height,s="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(s.prototype);return yp(o,{x:t,y:i,width:n,height:r,top:i,right:t+n,bottom:r+i,left:t}),o}(t);yp(this,{target:e,contentRect:i})},Ip=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new dp,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof bp(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Cp(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof bp(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new Pp(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),kp="undefined"!==typeof WeakMap?new WeakMap:new dp,Mp=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=vp.getInstance(),n=new Ip(t,i,this);kp.set(this,n)};["observe","unobserve","disconnect"].forEach(function(e){Mp.prototype[e]=function(){var t;return(t=kp.get(this))[e].apply(t,arguments)}});const Rp="undefined"!==typeof mp.ResizeObserver?mp.ResizeObserver:Mp;function Fp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Lp=i(816);function Op(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(0,Lp.A)(n.key),n)}}function Bp(e,t,i){return t&&Op(e.prototype,t),i&&Op(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}"undefined"!==typeof window?window:i.g,"undefined"!==typeof i.g?i.g:window;var zp="undefined"!==typeof document?document:{};function Np(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Up(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Np(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Np(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function jp(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return Vp(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Vp(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function Vp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Gp=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wp(e){if(!e)return null;if("string"===typeof e)return e;e.toJS&&(e=e.toJS());var t,i={},n=jp(e.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;i[r.id]=r}}catch(o){n.e(o)}finally{n.f()}var s=e.layers.map(function(e){var t=i[e.ref],n=null;if("interactive"in e&&delete(n=Up({},e)).interactive,t){delete(n=n||Up({},e)).ref;var r,s=jp(Gp);try{for(s.s();!(r=s.n()).done;){var a=r.value;a in t&&(n[a]=t[a])}}catch(o){s.e(o)}finally{s.f()}}return n||e});return Up(Up({},e),{},{layers:s})}var Hp={container:wd.object,gl:wd.object,mapboxApiAccessToken:wd.string,mapboxApiUrl:wd.string,attributionControl:wd.bool,preserveDrawingBuffer:wd.bool,reuseMaps:wd.bool,transformRequest:wd.func,mapOptions:wd.object,mapStyle:wd.oneOfType([wd.string,wd.object]),preventStyleDiffing:wd.bool,visible:wd.bool,asyncRender:wd.bool,onLoad:wd.func,onError:wd.func,width:wd.number,height:wd.number,viewState:wd.object,longitude:wd.number,latitude:wd.number,zoom:wd.number,bearing:wd.number,pitch:wd.number,altitude:wd.number},Xp={container:zp.body,mapboxApiAccessToken:function(){var e=null;if("undefined"!==typeof window&&window.location){var t=window.location.search.match(/access_token=([^&\/]*)/);e=t&&t[1]}e||"undefined"===typeof process||(e=e||{NODE_ENV:"production",PUBLIC_URL:"/final",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken||{NODE_ENV:"production",PUBLIC_URL:"/final",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN);return e||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(e){e&&console.error(e.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function qp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";e.debug&&wd.checkPropTypes(Hp,e,"prop",t)}var Zp=function(){function e(t){var i=this;if(Fp(this,e),(0,s.A)(this,"props",Xp),(0,s.A)(this,"width",0),(0,s.A)(this,"height",0),(0,s.A)(this,"_fireLoadEvent",function(){i.props.onLoad({type:"load",target:i._map})}),(0,s.A)(this,"_handleError",function(e){i.props.onError(e)}),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,e.initialized||(e.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}return Bp(e,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(e){return this._update(this.props,e),this}},{key:"redraw",value:function(){var e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(t){this._map=e.savedMap;var i=this._map.getContainer(),n=t.container;for(n.classList.add("mapboxgl-map");i.childNodes.length>0;)n.appendChild(i.childNodes[0]);this._map._container=n,e.savedMap=null,t.mapStyle&&this._map.setStyle(Wp(t.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(t){if(t.reuseMaps&&e.savedMap)this._reuse(t);else{if(t.gl){var i=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=i,t.gl}}var n={container:t.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:Wp(t.mapStyle),interactive:!1,trackResize:!1,attributionControl:t.attributionControl,preserveDrawingBuffer:t.preserveDrawingBuffer};t.transformRequest&&(n.transformRequest=t.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},n,t.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!e.savedMap?(e.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(e){var t=this;qp(e=Object.assign({},Xp,e),"Mapbox"),this.mapboxgl.accessToken=e.mapboxApiAccessToken||Xp.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=e.mapboxApiUrl,this._create(e);var i=e.container;Object.defineProperty(i,"offsetWidth",{configurable:!0,get:function(){return t.width}}),Object.defineProperty(i,"clientWidth",{configurable:!0,get:function(){return t.width}}),Object.defineProperty(i,"offsetHeight",{configurable:!0,get:function(){return t.height}}),Object.defineProperty(i,"clientHeight",{configurable:!0,get:function(){return t.height}});var n=this._map.getCanvas();n&&(n.style.outline="none"),this._updateMapViewport({},e),this._updateMapSize({},e),this.props=e}},{key:"_update",value:function(e,t){if(this._map){qp(t=Object.assign({},this.props,t),"Mapbox");var i=this._updateMapViewport(e,t),n=this._updateMapSize(e,t);this._updateMapStyle(e,t),t.asyncRender||!i&&!n||this.redraw(),this.props=t}}},{key:"_updateMapStyle",value:function(e,t){e.mapStyle!==t.mapStyle&&this._map.setStyle(Wp(t.mapStyle),{diff:!t.preventStyleDiffing})}},{key:"_updateMapSize",value:function(e,t){var i=e.width!==t.width||e.height!==t.height;return i&&(this.width=t.width,this.height=t.height,this._map.resize()),i}},{key:"_updateMapViewport",value:function(e,t){var i=this._getViewState(e),n=this._getViewState(t),r=n.latitude!==i.latitude||n.longitude!==i.longitude||n.zoom!==i.zoom||n.pitch!==i.pitch||n.bearing!==i.bearing||n.altitude!==i.altitude;return r&&(this._map.jumpTo(this._viewStateToMapboxProps(n)),n.altitude!==i.altitude&&(this._map.transform.altitude=n.altitude)),r}},{key:"_getViewState",value:function(e){var t=e.viewState||e,i=t.longitude,n=t.latitude,r=t.zoom,s=t.pitch,o=void 0===s?0:s,a=t.bearing,l=void 0===a?0:a,c=t.altitude;return{longitude:i,latitude:n,zoom:r,pitch:o,bearing:l,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof zp)try{var t=zp.createElement("div");if(t.className="mapboxgl-map",t.style.display="none",zp.body.appendChild(t),!("static"!==window.getComputedStyle(t).position)){var i=zp.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(e,"/mapbox-gl.css")),zp.head.appendChild(i)}}catch(n){}}},{key:"_viewStateToMapboxProps",value:function(e){return{center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}}}]),e}();(0,s.A)(Zp,"initialized",!1),(0,s.A)(Zp,"propTypes",Hp),(0,s.A)(Zp,"defaultProps",Xp),(0,s.A)(Zp,"savedMap",null);var Yp=i(879),Kp=i.n(Yp);function Jp(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function $p(e,t){if(e===t)return!0;if(Jp(e)&&Jp(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!$p(e[i],t[i]))return!1;return!0}return Math.abs(e-t)<=1e-7}function Qp(e,t,i){return Math.max(t,Math.min(i,e))}function em(e,t,i){return Jp(e)?e.map(function(e,n){return em(e,t[n],i)}):i*t+(1-i)*e}function tm(e,t){if(!e)throw new Error(t||"react-map-gl: assertion failed.")}function im(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function nm(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?im(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):im(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var rm={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},sm=0,om=0,am=1.5,lm=function(){function e(t){var i=t.width,n=t.height,r=t.latitude,s=t.longitude,o=t.zoom,a=t.bearing,l=void 0===a?om:a,c=t.pitch,u=void 0===c?sm:c,h=t.altitude,d=void 0===h?am:h,p=t.maxZoom,m=void 0===p?rm.maxZoom:p,f=t.minZoom,g=void 0===f?rm.minZoom:f,_=t.maxPitch,v=void 0===_?rm.maxPitch:_,y=t.minPitch,b=void 0===y?rm.minPitch:y,x=t.transitionDuration,w=t.transitionEasing,E=t.transitionInterpolator,A=t.transitionInterruption,T=t.startPanLngLat,D=t.startZoomLngLat,S=t.startRotatePos,C=t.startBearing,P=t.startPitch,I=t.startZoom;Fp(this,e),tm(Number.isFinite(i),"`width` must be supplied"),tm(Number.isFinite(n),"`height` must be supplied"),tm(Number.isFinite(s),"`longitude` must be supplied"),tm(Number.isFinite(r),"`latitude` must be supplied"),tm(Number.isFinite(o),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:i,height:n,latitude:r,longitude:s,zoom:o,bearing:l,pitch:u,altitude:d,maxZoom:m,minZoom:g,maxPitch:v,minPitch:b,transitionDuration:x,transitionEasing:w,transitionInterpolator:E,transitionInterruption:A}),this._state={startPanLngLat:T,startZoomLngLat:D,startRotatePos:S,startBearing:C,startPitch:P,startZoom:I}}return Bp(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(t)})}},{key:"pan",value:function(e){var t=e.pos,i=e.startPos,n=this._state.startPanLngLat||this._unproject(i);if(!n)return this;var r=Ed(this._calculateNewLngLat({startPanLngLat:n,pos:t}),2),s=r[0],o=r[1];return this._getUpdatedMapState({longitude:s,latitude:o})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(e){var t,i=e.pos,n=e.deltaAngleX,r=void 0===n?0:n,s=e.deltaAngleY,o=void 0===s?0:s,a=this._state,l=a.startRotatePos,c=a.startBearing,u=a.startPitch;return Number.isFinite(c)&&Number.isFinite(u)?(t=i?this._calculateNewPitchAndBearing(nm(nm({},this._getRotationParams(i,l)),{},{startBearing:c,startPitch:u})):{bearing:c+r,pitch:u+o},this._getUpdatedMapState(t)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(e){var t=e.pos,i=e.startPos,n=e.scale;tm(n>0,"`scale` must be a positive number");var r=this._state,s=r.startZoom,o=r.startZoomLngLat;Number.isFinite(s)||(s=this._viewportProps.zoom,o=this._unproject(i)||this._unproject(t)),tm(o,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var a=this._calculateNewZoom({scale:n,startZoom:s||0}),l=Ed(new lp(Object.assign({},this._viewportProps,{zoom:a})).getMapCenterByLngLatPosition({lngLat:o,pos:t}),2),c=l[0],u=l[1];return this._getUpdatedMapState({zoom:a,longitude:c,latitude:u})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(t){return new e(Object.assign({},this._viewportProps,this._state,t))}},{key:"_applyConstraints",value:function(e){var t=e.maxZoom,i=e.minZoom,n=e.zoom;e.zoom=Qp(n,i,t);var r=e.maxPitch,s=e.minPitch,o=e.pitch;return e.pitch=Qp(o,s,r),Object.assign(e,function(e){const{width:t,height:i,pitch:n=0}=e;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=e;(r<-180||r>180)&&(r=Sd(r+180,360)-180),(a<-180||a>180)&&(a=Sd(a+180,360)-180);const l=Id(i/512);if(o<=l)o=l,s=0;else{const e=i/2/Math.pow(2,o),t=$d([0,e])[1];if(s<t)s=t;else{const t=$d([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:i,longitude:r,latitude:s,zoom:o,pitch:n,bearing:a}}(e)),e}},{key:"_unproject",value:function(e){var t=new lp(this._viewportProps);return e&&t.unproject(e)}},{key:"_calculateNewLngLat",value:function(e){var t=e.startPanLngLat,i=e.pos;return new lp(this._viewportProps).getMapCenterByLngLatPosition({lngLat:t,pos:i})}},{key:"_calculateNewZoom",value:function(e){var t=e.scale,i=e.startZoom,n=this._viewportProps,r=n.maxZoom,s=n.minZoom;return Qp(i+Math.log2(t),s,r)}},{key:"_calculateNewPitchAndBearing",value:function(e){var t=e.deltaScaleX,i=e.deltaScaleY,n=e.startBearing,r=e.startPitch;i=Qp(i,-1,1);var s=this._viewportProps,o=s.minPitch,a=s.maxPitch,l=r;return i>0?l=r+i*(a-r):i<0&&(l=r-i*(o-r)),{pitch:l,bearing:n+180*t}}},{key:"_getRotationParams",value:function(e,t){var i=e[0]-t[0],n=e[1]-t[1],r=e[1],s=t[1],o=this._viewportProps,a=o.width,l=o.height,c=i/a,u=0;return n>0?Math.abs(l-s)>5&&(u=n/(s-l)*1.2):n<0&&s>5&&(u=1-r/s),{deltaScaleX:c,deltaScaleY:u=Math.min(1,Math.max(-1,u))}}}]),e}();function cm(e){return e[0].toLowerCase()+e.slice(1)}function um(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function hm(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?um(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):um(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var dm=(0,e.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),pm=dm.Provider;dm.Provider=function(t){var i=t.value,n=t.children,r=Ed((0,e.useState)(null),2),s=r[0],o=r[1],a=(0,e.useContext)(dm);return i=hm(hm({setMap:o},a),{},{map:a&&a.map||s},i),e.createElement(pm,{value:i},n)};const mm=dm;const fm="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;function gm(e,t){var i=t.longitude,n=t.latitude;return e&&e.queryTerrainElevation&&e.queryTerrainElevation([i,n])||0}function _m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function vm(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_m(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_m(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var ym="A valid API access token is required to use Mapbox data";function bm(e){var t=e.map,i=e.props,n=e.width,r=e.height,s=vm(vm(vm({},i),i.viewState),{},{width:n,height:r});return s.position=[0,0,gm(t,s)],new lp(s)}var xm={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},wm=Object.assign({},Zp.propTypes,{width:wd.oneOfType([wd.number,wd.string]),height:wd.oneOfType([wd.number,wd.string]),onResize:wd.func,disableTokenWarning:wd.bool,visible:wd.bool,className:wd.string,style:wd.object,visibilityConstraints:wd.object}),Em=Object.assign({},Zp.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:rm});function Am(){return e.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},e.createElement("h3",{key:"header"},ym),e.createElement("div",{key:"text"},"For information on setting up your basemap, read"),e.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var Tm=(0,e.forwardRef)(function(t,i){var n=Ed((0,e.useState)(!0),2),r=n[0],s=n[1],o=Ed((0,e.useState)({width:0,height:0}),2),a=o[0],l=o[1],c=(0,e.useRef)(null),u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),p=(0,e.useContext)(mm);fm(function(){if(Tm.supported()){var e=new Zp(vm(vm(vm({},t),a),{},{mapboxgl:Kp(),container:u.current,onError:function(e){401===(e.error&&e.error.status||e.status)&&r&&(console.error(ym),s(!1)),t.onError(e)}}));c.current=e,p&&p.setMap&&p.setMap(e.getMap());var i=new Rp(function(e){if(e[0].contentRect){var i=e[0].contentRect,n=i.width,r=i.height;l({width:n,height:r}),t.onResize({width:n,height:r})}});return i.observe(h.current),function(){e.finalize(),c.current=null,i.disconnect()}}},[]),fm(function(){c.current&&c.current.setProps(vm(vm({},t),a))});var m=c.current&&c.current.getMap();(0,e.useImperativeHandle)(i,function(){return function(e){return{getMap:function(){return e.current&&e.current.getMap()},queryRenderedFeatures:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.current&&e.current.getMap();return n&&n.queryRenderedFeatures(t,i)}}}(c)},[]);var f=(0,e.useCallback)(function(e){var t=e.target;t===d.current&&t.scrollTo(0,0)},[]),g=m&&e.createElement(pm,{value:vm(vm({},p),{},{viewport:p.viewport||bm(vm({map:m,props:t},a)),map:m,container:p.container||h.current})},e.createElement("div",{key:"map-overlays",className:"overlays",ref:d,style:xm,onScroll:f},t.children)),_=t.className,v=t.width,y=t.height,b=t.style,x=t.visibilityConstraints,w=Object.assign({position:"relative"},b,{width:v,height:y}),E=t.visible&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rm;for(var i in t){var n=i.slice(0,3),r=cm(i.slice(3));if("min"===n&&e[r]<t[i])return!1;if("max"===n&&e[r]>t[i])return!1}return!0}(t.viewState||t,x),A=Object.assign({},xm,{visibility:E?"inherit":"hidden"});return e.createElement("div",{key:"map-container",ref:h,style:w},e.createElement("div",{key:"map-mapbox",ref:u,style:A,className:_}),g,!r&&!t.disableTokenWarning&&e.createElement(Am,null))});Tm.supported=function(){return Kp()&&Kp().supported()},Tm.propTypes=wm,Tm.defaultProps=Em;const Dm=Tm;function Sm(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return Cm(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Cm(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function Cm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Pm=function(){function e(){Fp(this,e),(0,s.A)(this,"propNames",[])}return Bp(e,[{key:"arePropsEqual",value:function(e,t){var i,n=Sm(this.propNames||[]);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!$p(e[r],t[r]))return!1}}catch(s){n.e(s)}finally{n.f()}return!0}},{key:"initializeProps",value:function(e,t){return{start:e,end:t}}},{key:"interpolateProps",value:function(e,t,i){tm(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(e,t){return t.transitionDuration}}]),e}();function Im(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function km(e,t){return km=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},km(e,t)}function Mm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&km(e,t)}var Rm=i(284);function Fm(e,t){if(t&&("object"==(0,Rm.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Im(e)}function Lm(e){return Lm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lm(e)}var Om={longitude:1,bearing:1};function Bm(e){return Number.isFinite(e)||Array.isArray(e)}function zm(e,t,i){return function(e){return e in Om}(e)&&Math.abs(i-t)>180&&(i=i<0?i+360:i-360),i}function Nm(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return Um(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Um(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function Um(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function jm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(hl){return!1}}();return function(){var i,n=Lm(e);if(t){var r=Lm(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Fm(this,i)}}var Vm=["longitude","latitude","zoom","bearing","pitch"],Gm=["latitude","longitude","zoom","width","height"],Wm=["bearing","pitch"],Hm={speed:1.2,curve:1.414};!function(e){Mm(i,e);var t=jm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Fp(this,i),e=t.call(this),(0,s.A)(Im(e),"propNames",Vm),e.props=Object.assign({},Hm,n),e}Bp(i,[{key:"initializeProps",value:function(e,t){var i,n={},r={},s=Nm(Gm);try{for(s.s();!(i=s.n()).done;){var o=i.value,a=e[o],l=t[o];tm(Bm(a)&&Bm(l),"".concat(o," must be supplied for transition")),n[o]=a,r[o]=zm(o,a,l)}}catch(m){s.e(m)}finally{s.f()}var c,u=Nm(Wm);try{for(u.s();!(c=u.n()).done;){var h=c.value,d=e[h]||0,p=t[h]||0;n[h]=d,r[h]=zm(h,d,p)}}catch(m){u.e(m)}finally{u.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(e,t,i){var n,r=function(e,t,i,n){const{startZoom:r,startCenterXY:s,uDelta:o,w0:a,u1:l,S:c,rho:u,rho2:h,r0:d}=hp(e,t,n);if(l<.01){const n={};for(const r of cp){const s=e[r],o=t[r];n[r]=Cd(s,o,i)}return n}const p=i*c,m=Math.cosh(d)/Math.cosh(d+u*p),f=a*((Math.cosh(d)*Math.tanh(d+u*p)-Math.sinh(d))/h)/l,g=r+Kd(1/m),_=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}([],o,f);Od(_,_,s);const v=$d(_);return{longitude:v[0],latitude:v[1],zoom:g}}(e,t,i,this.props),s=Nm(Wm);try{for(s.s();!(n=s.n()).done;){var o=n.value;r[o]=em(e[o],t[o],i)}}catch(a){s.e(a)}finally{s.f()}return r}},{key:"getDuration",value:function(e,t){var i=t.transitionDuration;return"auto"===i&&(i=function(e,t,i){const n=(0,r.A)((0,r.A)({},up),i),{screenSpeed:s,speed:o,maxDuration:a}=n,{S:l,rho:c}=hp(e,t,n),u=1e3*l;let h;return h=Number.isFinite(s)?u/(s/c):u/o,Number.isFinite(a)&&h>a?0:h}(e,t,this.props)),i}}])}(Pm);function Xm(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return qm(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qm(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function qm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Zm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(hl){return!1}}();return function(){var i,n=Lm(e);if(t){var r=Lm(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Fm(this,i)}}var Ym=["longitude","latitude","zoom","bearing","pitch"],Km=function(e){Mm(i,e);var t=Zm(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Fp(this,i),e=t.call(this),Array.isArray(n)&&(n={transitionProps:n}),e.propNames=n.transitionProps||Ym,n.around&&(e.around=n.around),e}return Bp(i,[{key:"initializeProps",value:function(e,t){var i={},n={};if(this.around){i.around=this.around;var r=new lp(e).unproject(this.around);Object.assign(n,t,{around:new lp(t).project(r),aroundLngLat:r})}var s,o=Xm(this.propNames);try{for(o.s();!(s=o.n()).done;){var a=s.value,l=e[a],c=t[a];tm(Bm(l)&&Bm(c),"".concat(a," must be supplied for transition")),i[a]=l,n[a]=zm(a,l,c)}}catch(u){o.e(u)}finally{o.f()}return{start:i,end:n}}},{key:"interpolateProps",value:function(e,t,i){var n,r={},s=Xm(this.propNames);try{for(s.s();!(n=s.n()).done;){var o=n.value;r[o]=em(e[o],t[o],i)}}catch(u){s.e(u)}finally{s.f()}if(t.around){var a=Ed(new lp(Object.assign({},t,r)).getMapCenterByLngLatPosition({lngLat:t.aroundLngLat,pos:em(e.around,t.around,i)}),2),l=a[0],c=a[1];r.longitude=l,r.latitude=c}return r}}]),i}(Pm),Jm=function(){};var $m=1,Qm=2,ef=3,tf=4,nf={transitionDuration:0,transitionEasing:function(e){return e},transitionInterpolator:new Km,transitionInterruption:$m,onTransitionStart:Jm,onTransitionInterrupt:Jm,onTransitionEnd:Jm},rf=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Fp(this,e),(0,s.A)(this,"_animationFrame",null),(0,s.A)(this,"_onTransitionFrame",function(){t._animationFrame=requestAnimationFrame(t._onTransitionFrame),t._updateViewport()}),this.props=null,this.onViewportChange=i.onViewportChange||Jm,this.onStateChange=i.onStateChange||Jm,this.time=i.getTime||Date.now}return Bp(e,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(e){var t=this.props;if(this.props=e,!t||this._shouldIgnoreViewportChange(t,e))return!1;if(this._isTransitionEnabled(e)){var i=Object.assign({},t),n=Object.assign({},e);if(this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this.state.interruption===Qm?Object.assign(i,this.state.endProps):Object.assign(i,this.state.propsInTransition),this.state.interruption===tf)){var r=this.time(),s=(r-this.state.startTime)/this.state.duration;n.transitionDuration=this.state.duration-(r-this.state.startTime),n.transitionEasing=function(e,t){var i=e(t);return function(n){return 1/(1-i)*(e(n*(1-t)+t)-i)}}(this.state.easing,s),n.transitionInterpolator=i.transitionInterpolator}return n.onTransitionStart(),this._triggerTransition(i,n),!0}return this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(e){var t=e.transitionDuration,i=e.transitionInterpolator;return(t>0||"auto"===t)&&Boolean(i)}},{key:"_isUpdateDueToCurrentTransition",value:function(e){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(e,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(e,t){return!e||(this._isTransitionInProgress()?this.state.interruption===ef||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t))}},{key:"_triggerTransition",value:function(e,t){tm(this._isTransitionEnabled(t)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var i=t.transitionInterpolator,n=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0!==n){var r=t.transitionInterpolator.initializeProps(e,t),s={inTransition:!0,isZooming:e.zoom!==t.zoom,isPanning:e.longitude!==t.longitude||e.latitude!==t.latitude,isRotating:e.bearing!==t.bearing||e.pitch!==t.pitch};this.state={duration:n,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startTime:this.time(),startProps:r.start,endProps:r.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(s)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var e=this.time(),t=this.state,i=t.startTime,n=t.duration,r=t.easing,s=t.interpolator,o=t.startProps,a=t.endProps,l=!1,c=(e-i)/n;c>=1&&(c=1,l=!0),c=r(c);var u=s.interpolateProps(o,a,c),h=new lm(Object.assign({},this.props,u));this.state.propsInTransition=h.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),l&&(this._endTransition(),this.props.onTransitionEnd())}}]),e}();(0,s.A)(rf,"defaultProps",nf);var sf=i(895);const of={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const i=this.store;e.button>0&&"pointerdown"===e.type&&(function(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return!0;return!1}(i,t=>t.pointerId===e.pointerId)||i.push(e)),t.call(this,e)}}(sf.PointerEventInput),sf.MouseInput.prototype.handler=function(e){let t=of[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.buttons&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const af=sf.Manager,lf=sf;class cf{constructor(e,t,i){this.element=e,this.callback=t,this.options=(0,r.A)({enable:!0},i)}}const uf=lf?[[lf.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[lf.Rotate,{enable:!1}],[lf.Pinch,{enable:!1}],[lf.Swipe,{enable:!1}],[lf.Pan,{threshold:0,enable:!1}],[lf.Press,{enable:!1}],[lf.Tap,{event:"doubletap",taps:2,enable:!1}],[lf.Tap,{event:"anytap",enable:!1}],[lf.Tap,{enable:!1}]]:null,hf={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},df={doubletap:["tap"]},pf={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},mf={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},ff={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},gf={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},_f="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",vf="undefined"!==typeof window?window:i.g;"undefined"!==typeof i.g?i.g:window,"undefined"!==typeof document&&document;let yf=!1;try{const e={get passive(){return yf=!0,!0}};vf.addEventListener("test",null,e),vf.removeEventListener("test",null)}catch(_A){yf=!1}const bf=-1!==_f.indexOf("firefox"),{WHEEL_EVENTS:xf}=mf,wf="wheel",Ef=4.000244140625;class Af extends cf{constructor(e,t,i){super(e,t,i),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;vf.WheelEvent&&(bf&&e.deltaMode===vf.WheelEvent.DOM_DELTA_PIXEL&&(t/=vf.devicePixelRatio),e.deltaMode===vf.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%Ef===0&&(t=Math.floor(t/Ef)),e.shiftKey&&t&&(t*=.25),this.callback({type:wf,center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},this.events=(this.options.events||[]).concat(xf),this.events.forEach(t=>e.addEventListener(t,this.handleEvent,!!yf&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===wf&&(this.options.enable=t)}}const{MOUSE_EVENTS:Tf}=mf,Df="pointermove",Sf="pointerover",Cf="pointerout",Pf="pointerenter",If="pointerleave";class kf extends cf{constructor(e,t,i){super(e,t,i),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:n}=this.options;this.enableMoveEvent=n,this.enableLeaveEvent=n,this.enableEnterEvent=n,this.enableOutEvent=n,this.enableOverEvent=n,this.events=(this.options.events||[]).concat(Tf),this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Df&&(this.enableMoveEvent=t),e===Sf&&(this.enableOverEvent=t),e===Cf&&(this.enableOutEvent=t),e===Pf&&(this.enableEnterEvent=t),e===If&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(Sf,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(Cf,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(Pf,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(If,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit(Df,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Mf}=mf,Rf="keydown",Ff="keyup";class Lf extends cf{constructor(e,t,i){super(e,t,i),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:Rf,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:Ff,srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Mf),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Rf&&(this.enableDownEvent=t),e===Ff&&(this.enableUpEvent=t)}}const Of="contextmenu";class Bf extends cf{constructor(e,t,i){super(e,t,i),this.handleEvent=e=>{this.options.enable&&this.callback({type:Of,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===Of&&(this.options.enable=t)}}const zf={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const Nf={srcElement:"root",priority:0};class Uf{constructor(e){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:o,handlersByElement:a}=this;let l=Nf;"string"===typeof i||i&&i.addEventListener?l=(0,r.A)((0,r.A)({},Nf),{},{srcElement:i}):i&&(l=(0,r.A)((0,r.A)({},Nf),i));let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:t,srcElement:l.srcElement,priority:l.priority};n&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let h=c.length-1;for(;h>=0&&!(c[h].priority>=u.priority);)h--;c.splice(h+1,0,u)}remove(e,t){const{handlers:i,handlersByElement:n}=this;for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.type===e&&s.handler===t){i.splice(r,1);const e=n.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&n.delete(s.srcElement)}}this._active=i.some(e=>!e.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let t=!1;const n=()=>{e.handled=!0},s=()=>{e.handled=!0,t=!0},o=[];for(let a=0;a<i.length;a++){const{type:l,handler:c,once:u}=i[a];if(c((0,r.A)((0,r.A)({},e),{},{type:l,stopPropagation:n,stopImmediatePropagation:s})),u&&o.push(i[a]),t)break}for(let e=0;e<o.length;e++){const{type:t,handler:i}=o[e];this.remove(t,i)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},e),function(e){const t=zf[e.srcEvent.type];if(!t)return null;const{buttons:i,button:n}=e.srcEvent;let r=!1,s=!1,o=!1;return 2===t?(r=Boolean(1&i),s=Boolean(4&i),o=Boolean(2&i)):(r=0===n,s=1===n,o=2===n),{leftButton:r,middleButton:s,rightButton:o}}(e)),function(e,t){const i=e.center;if(!i)return null;const n=t.getBoundingClientRect(),r=n.width/t.offsetWidth||1,s=n.height/t.offsetHeight||1;return{center:i,offsetCenter:{x:(i.x-n.left-t.clientLeft)/r,y:(i.y-n.top-t.clientTop)/s}}}(e,t)),{},{preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t})}}const jf={events:null,recognizers:null,recognizerOptions:{},Manager:af,touchAction:"none",tabIndex:0};class Vf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;this._onBasicInput=e=>{const{srcEvent:t}=e,i=pf[t.type];i&&this.manager.emit(i,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options=(0,r.A)((0,r.A)({},jf),t),this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this,i=t.Manager;this.manager=new i(e,{touchAction:t.touchAction,recognizers:t.recognizers||uf}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(hf).forEach(e=>{const t=this.manager.get(e);t&&hf[e].forEach(e=>{t.recognizeWith(e)})});for(const n in t.recognizerOptions){const e=this.manager.get(n);if(e){const i=t.recognizerOptions[n];delete i.enable,e.set(i)}}this.wheelInput=new Af(e,this._onOtherEvent,{enable:!1}),this.moveInput=new kf(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Lf(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Bf(e,this._onOtherEvent,{enable:!1});for(const[n,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(n,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const n=i.get(e);if(n&&n.options.enable!==t){n.set({enable:t});const r=df[e];r&&!this.options.recognizers&&r.forEach(r=>{const s=i.get(r);t?(s.requireFailure(e),n.dropRequireFailure(r)):s.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,n,r){if("string"!==typeof e){i=t;for(const t in e)this._addEventHandler(t,e[t],i,n,r);return}const{manager:s,events:o}=this,a=gf[e]||e;let l=o.get(a);l||(l=new Uf(this),o.set(a,l),l.recognizerName=ff[a]||a,s&&s.on(a,l.handleEvent)),l.add(e,t,i,n,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:i}=this,n=gf[e]||e,r=i.get(n);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const n of i.values())if(n.recognizerName===e&&!n.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}}function Gf(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Wf(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Gf(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Gf(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var Hf={transitionDuration:0},Xf={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new Km,transitionInterruption:$m},qf=300,Zf=function(e){return 1-(1-e)*(1-e)},Yf=["wheel"],Kf=["panstart","panmove","panend"],Jf=["pinchstart","pinchmove","pinchend"],$f=["tripanstart","tripanmove","tripanend"],Qf=["doubletap"],eg=["keydown"],tg=function(){function e(){var t=this;Fp(this,e),(0,s.A)(this,"events",[]),(0,s.A)(this,"scrollZoom",!0),(0,s.A)(this,"dragPan",!0),(0,s.A)(this,"dragRotate",!0),(0,s.A)(this,"doubleClickZoom",!0),(0,s.A)(this,"touchZoom",!0),(0,s.A)(this,"touchRotate",!1),(0,s.A)(this,"keyboard",!0),(0,s.A)(this,"_interactionState",{isDragging:!1}),(0,s.A)(this,"_events",{}),(0,s.A)(this,"_setInteractionState",function(e){Object.assign(t._interactionState,e),t.onStateChange&&t.onStateChange(t._interactionState)}),(0,s.A)(this,"_onTransition",function(e,i){t.onViewportChange(e,t._interactionState,i)}),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new rf({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return Bp(e,[{key:"handleEvent",value:function(e){this.mapState=this.getMapState();var t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}},{key:"getCenter",value:function(e){var t=e.offsetCenter;return[t.x,t.y]}},{key:"isFunctionKeyPressed",value:function(e){var t=e.srcEvent;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}},{key:"blockEvents",value:function(e){var t=this,i=setTimeout(function(){t._eventStartBlocked===i&&(t._eventStartBlocked=null)},e);this._eventStartBlocked=i}},{key:"updateViewport",value:function(e,t,i){var n=this.mapState instanceof lm?this.mapState.getViewportProps():this.mapState,r=Wf(Wf({},e.getViewportProps()),t),s=Object.keys(r).some(function(e){return n[e]!==r[e]});this._state=e.getState(),this._setInteractionState(i),s&&this.onViewportChange(r,this._interactionState,n)}},{key:"getMapState",value:function(e){return new lm(Wf(Wf(Wf({},this.mapStateProps),this._state),e))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(e){var t=e.onViewportChange,i=e.onStateChange,n=e.eventManager,r=void 0===n?this.eventManager:n,s=e.isInteractive,o=void 0===s||s,a=e.scrollZoom,l=void 0===a?this.scrollZoom:a,c=e.dragPan,u=void 0===c?this.dragPan:c,h=e.dragRotate,d=void 0===h?this.dragRotate:h,p=e.doubleClickZoom,m=void 0===p?this.doubleClickZoom:p,f=e.touchZoom,g=void 0===f?this.touchZoom:f,_=e.touchRotate,v=void 0===_?this.touchRotate:_,y=e.keyboard,b=void 0===y?this.keyboard:y;this.onViewportChange=t,this.onStateChange=i;var x=this.mapStateProps||{},w=x.height!==e.height||x.width!==e.width;this.mapStateProps=e,w&&(this.mapState=x,this.updateViewport(new lm(e))),this._transitionManager.processViewportChange(e),this.eventManager!==r&&(this.eventManager=r,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Yf,o&&Boolean(l)),this.toggleEvents(Kf,o&&Boolean(u||d)),this.toggleEvents(Jf,o&&Boolean(g||v)),this.toggleEvents($f,o&&Boolean(v)),this.toggleEvents(Qf,o&&Boolean(m)),this.toggleEvents(eg,o&&Boolean(b)),this.scrollZoom=l,this.dragPan=u,this.dragRotate=d,this.doubleClickZoom=m,this.touchZoom=g,this.touchRotate=v,this.keyboard=b}},{key:"toggleEvents",value:function(e,t){var i=this;this.eventManager&&e.forEach(function(e){i._events[e]!==t&&(i._events[e]=t,t?i.eventManager.on(e,i.handleEvent):i.eventManager.off(e,i.handleEvent))})}},{key:"_onPanStart",value:function(e){var t=this.getCenter(e);this._panRotate=this.isFunctionKeyPressed(e)||e.rightButton;var i=this._panRotate?this.mapState.rotateStart({pos:t}):this.mapState.panStart({pos:t});return this.updateViewport(i,Hf,{isDragging:!0}),!0}},{key:"_onPan",value:function(e){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(e):this._onPanMove(e))}},{key:"_onPanEnd",value:function(e){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(e):this._onPanMoveEnd(e))}},{key:"_onPanMove",value:function(e){if(!this.dragPan)return!1;var t=this.getCenter(e),i=this.mapState.pan({pos:t});return this.updateViewport(i,Hf,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(e){if(this.dragPan){var t=this.dragPan.inertia,i=void 0===t?qf:t;if(i&&e.velocity){var n=this.getCenter(e),r=[n[0]+e.velocityX*i/2,n[1]+e.velocityY*i/2],s=this.mapState.pan({pos:r}).panEnd();return this.updateViewport(s,Wf(Wf({},Xf),{},{transitionDuration:i,transitionEasing:Zf}),{isDragging:!1,isPanning:!0}),!0}}var o=this.mapState.panEnd();return this.updateViewport(o,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(e){if(!this.dragRotate)return!1;var t=this.getCenter(e),i=this.mapState.rotate({pos:t});return this.updateViewport(i,Hf,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(e){if(this.dragRotate){var t=this.dragRotate.inertia,i=void 0===t?qf:t;if(i&&e.velocity){var n=this.getCenter(e),r=[n[0]+e.velocityX*i/2,n[1]+e.velocityY*i/2],s=this.mapState.rotate({pos:r}).rotateEnd();return this.updateViewport(s,Wf(Wf({},Xf),{},{transitionDuration:i,transitionEasing:Zf}),{isDragging:!1,isRotating:!0}),!0}}var o=this.mapState.panEnd();return this.updateViewport(o,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(e){if(!this.scrollZoom)return!1;var t=this.scrollZoom,i=t.speed,n=void 0===i?.01:i,r=t.smooth,s=void 0!==r&&r;e.preventDefault();var o=this.getCenter(e),a=e.delta,l=2/(1+Math.exp(-Math.abs(a*n)));a<0&&0!==l&&(l=1/l);var c=this.mapState.zoom({pos:o,scale:l});return c.getViewportProps().zoom!==this.mapStateProps.zoom&&(this.updateViewport(c,Wf(Wf({},Xf),{},{transitionInterpolator:new Km({around:o}),transitionDuration:s?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(e){var t=this.getCenter(e),i=this.mapState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,Hf,{isDragging:!0}),!0}},{key:"_onPinch",value:function(e){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var t=this.mapState;if(this.touchZoom){var i=e.scale,n=this.getCenter(e);t=t.zoom({pos:n,scale:i})}if(this.touchRotate){var r=e.rotation;t=t.rotate({deltaAngleX:this._startPinchRotation-r})}return this.updateViewport(t,Hf,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=e,!0}},{key:"_onPinchEnd",value:function(e){if(!this.isDragging())return!1;if(this.touchZoom){var t=this.touchZoom.inertia,i=void 0===t?qf:t,n=this._lastPinchEvent;if(i&&n&&e.scale!==n.scale){var r=this.getCenter(e),s=this.mapState.rotateEnd(),o=Math.log2(e.scale),a=(o-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),l=Math.pow(2,o+a*i/2);return s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Wf(Wf({},Xf),{},{transitionInterpolator:new Km({around:r}),transitionDuration:i,transitionEasing:Zf}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(i),!0}}var c=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(c,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(e){var t=this.getCenter(e),i=this.mapState.rotateStart({pos:t});return this.updateViewport(i,Hf,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(e){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var t=this.getCenter(e);t[0]-=e.deltaX;var i=this.mapState.rotate({pos:t});return this.updateViewport(i,Hf,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(e){if(!this.isDragging())return!1;if(this.touchRotate){var t=this.touchRotate.inertia,i=void 0===t?qf:t;if(i&&e.velocityY){var n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*i/2],s=this.mapState.rotate({pos:r});return this.updateViewport(s,Wf(Wf({},Xf),{},{transitionDuration:i,transitionEasing:Zf}),{isDragging:!1,isRotating:!0}),this.blockEvents(i),!1}}var o=this.mapState.rotateEnd();return this.updateViewport(o,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(e){if(!this.doubleClickZoom)return!1;var t=this.getCenter(e),i=this.isFunctionKeyPressed(e),n=this.mapState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(n,Object.assign({},Xf,{transitionInterpolator:new Km({around:t})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(e){if(!this.keyboard)return!1;var t,i=this.isFunctionKeyPressed(e),n=this.keyboard,r=n.zoomSpeed,s=void 0===r?2:r,o=n.moveSpeed,a=void 0===o?100:o,l=n.rotateSpeedX,c=void 0===l?15:l,u=n.rotateSpeedY,h=void 0===u?10:u,d=this.mapStateProps;switch(e.srcEvent.keyCode){case 189:t=i?this.getMapState({zoom:d.zoom-Math.log2(s)-1}):this.getMapState({zoom:d.zoom-Math.log2(s)});break;case 187:t=i?this.getMapState({zoom:d.zoom+Math.log2(s)+1}):this.getMapState({zoom:d.zoom+Math.log2(s)});break;case 37:t=i?this.getMapState({bearing:d.bearing-c}):this.mapState.pan({pos:[a,0],startPos:[0,0]});break;case 39:t=i?this.getMapState({bearing:d.bearing+c}):this.mapState.pan({pos:[-a,0],startPos:[0,0]});break;case 38:t=i?this.getMapState({pitch:d.pitch+h}):this.mapState.pan({pos:[0,a],startPos:[0,0]});break;case 40:t=i?this.getMapState({pitch:d.pitch-h}):this.mapState.pan({pos:[0,-a],startPos:[0,0]});break;default:return!1}return this.updateViewport(t,Xf)}}]),e}();function ig(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function ng(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ig(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ig(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var rg=Object.assign({},Dm.propTypes,{maxZoom:wd.number,minZoom:wd.number,maxPitch:wd.number,minPitch:wd.number,onViewStateChange:wd.func,onViewportChange:wd.func,onInteractionStateChange:wd.func,transitionDuration:wd.oneOfType([wd.number,wd.string]),transitionInterpolator:wd.object,transitionInterruption:wd.number,transitionEasing:wd.func,onTransitionStart:wd.func,onTransitionInterrupt:wd.func,onTransitionEnd:wd.func,scrollZoom:wd.oneOfType([wd.bool,wd.object]),dragPan:wd.oneOfType([wd.bool,wd.object]),dragRotate:wd.oneOfType([wd.bool,wd.object]),doubleClickZoom:wd.bool,touchZoom:wd.oneOfType([wd.bool,wd.object]),touchRotate:wd.oneOfType([wd.bool,wd.object]),keyboard:wd.oneOfType([wd.bool,wd.object]),onHover:wd.func,onClick:wd.func,onDblClick:wd.func,onContextMenu:wd.func,onMouseDown:wd.func,onMouseMove:wd.func,onMouseUp:wd.func,onTouchStart:wd.func,onTouchMove:wd.func,onTouchEnd:wd.func,onMouseEnter:wd.func,onMouseLeave:wd.func,onMouseOut:wd.func,onWheel:wd.func,touchAction:wd.string,eventRecognizerOptions:wd.object,clickRadius:wd.number,interactiveLayerIds:wd.array,getCursor:wd.func,controller:wd.instanceOf(tg)}),sg=Object.assign({},Dm.defaultProps,rm,rf.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(e){return e.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(e){var t=e.isDragging,i=e.isHovering;return t?"grabbing":i?"pointer":"grab"}});function og(e){if(e.lngLat||!e.offsetCenter)return e;var t=e.offsetCenter,i=t.x,n=t.y;if(!Number.isFinite(i)||!Number.isFinite(n))return e;var r=[i,n];if(e.point=r,this.map){var s=this.map.unproject(r);e.lngLat=[s.lng,s.lat]}return e}function ag(e){var t=this.map;if(!t||!e)return null;var i={},n=this.props.clickRadius;this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds);try{return t.queryRenderedFeatures(n?[[e[0]-n,e[1]+n],[e[0]+n,e[1]-n]]:e,i)}catch(r){return null}}function lg(e,t){var i=this.props[e];i&&i(og.call(this,t))}function cg(e){lg.call(this,"touch"===e.pointerType?"onTouchStart":"onMouseDown",e)}function ug(e){lg.call(this,"touch"===e.pointerType?"onTouchEnd":"onMouseUp",e)}function hg(e){if(lg.call(this,"touch"===e.pointerType?"onTouchMove":"onMouseMove",e),!this.state.isDragging){var t,i=this.props,n=i.onHover,r=i.interactiveLayerIds;e=og.call(this,e),(r||n)&&(t=ag.call(this,e.point));var s=Boolean(r&&t&&t.length>0),o=s&&!this.state.isHovering,a=!s&&this.state.isHovering;(n||o)&&(e.features=t,n&&n(e)),o&&lg.call(this,"onMouseEnter",e),a&&lg.call(this,"onMouseLeave",e),(o||a)&&this.setState({isHovering:s})}}function dg(e){var t=this.props,i=t.onClick,n=t.onNativeClick,r=t.onDblClick,s=t.doubleClickZoom,o=[],a=r||s;switch(e.type){case"anyclick":o.push(n),a||o.push(i);break;case"click":a&&o.push(i)}(o=o.filter(Boolean)).length&&((e=og.call(this,e)).features=ag.call(this,e.point),o.forEach(function(t){return t(e)}))}var pg=(0,e.forwardRef)(function(t,i){var n=(0,e.useContext)(mm),r=(0,e.useMemo)(function(){return t.controller||new tg},[]),s=(0,e.useMemo)(function(){return new Vf(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})},[]),o=(0,e.useRef)(null),a=(0,e.useRef)(null),l=(0,e.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;l.props=t,l.map=a.current&&a.current.getMap(),l.setState=function(e){l.state=ng(ng({},l.state),e),o.current.style.cursor=t.getCursor(l.state)};var c,u,h=!0,d=function(e,t,i){if(h)c=[e,t,i];else{var n=l.props,r=n.onViewStateChange,s=n.onViewportChange;Object.defineProperty(e,"position",{get:function(){return[0,0,gm(l.map,e)]}}),r&&r({viewState:e,interactionState:t,oldViewState:i}),s&&s(e,t,i)}};(0,e.useImperativeHandle)(i,function(){return function(e){return{getMap:e.current&&e.current.getMap,queryRenderedFeatures:e.current&&e.current.queryRenderedFeatures}}(a)},[]);var p=(0,e.useMemo)(function(){return ng(ng({},n),{},{eventManager:s,container:n.container||o.current})},[n,o.current]);p.onViewportChange=d,p.viewport=n.viewport||bm(l),l.viewport=p.viewport;var m=function(e){var t=e.isDragging,i=void 0!==t&&t;if(i!==l.state.isDragging&&l.setState({isDragging:i}),h)u=e;else{var n=l.props.onInteractionStateChange;n&&n(e)}},f=function(){l.width&&l.height&&r.setOptions(ng(ng(ng({},l.props),l.props.viewState),{},{isInteractive:Boolean(l.props.onViewStateChange||l.props.onViewportChange),onViewportChange:d,onStateChange:m,eventManager:s,width:l.width,height:l.height}))};(0,e.useEffect)(function(){return s.setElement(o.current),s.on({pointerdown:cg.bind(l),pointermove:hg.bind(l),pointerup:ug.bind(l),pointerleave:lg.bind(l,"onMouseOut"),click:dg.bind(l),anyclick:dg.bind(l),dblclick:lg.bind(l,"onDblClick"),wheel:lg.bind(l,"onWheel"),contextmenu:lg.bind(l,"onContextMenu")}),function(){s.destroy()}},[]),fm(function(){c&&d.apply(void 0,xd(c)),u&&m(u)}),f();var g=t.width,_=t.height,v=t.style,y=t.getCursor,b=(0,e.useMemo)(function(){return ng(ng({position:"relative"},v),{},{width:g,height:_,cursor:y(l.state)})},[v,g,_,y,l.state]);return c&&l._child||(l._child=e.createElement(pm,{value:p},e.createElement("div",{key:"event-canvas",ref:o,style:b},e.createElement(Dm,vd({},t,{width:"100%",height:"100%",style:null,onResize:function(e){var t=e.width,i=e.height;l.width=t,l.height=i,f(),l.props.onResize({width:t,height:i})},ref:a}))))),h=!1,l._child});pg.supported=Dm.supported,pg.propTypes=rg,pg.defaultProps=sg;function mg(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!mg(e[i],t[i]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===(0,Rm.A)(e)&&"object"===(0,Rm.A)(t)){var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var s=0,o=n;s<o.length;s++){var a=o[s];if(!t.hasOwnProperty(a))return!1;if(!mg(e[a],t[a]))return!1}return!0}return!1}function fg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var gg={type:wd.string.isRequired,id:wd.string},_g=0;function vg(e,t,i){if(e&&e.style&&e.style._loaded){var n=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?fg(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fg(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},i);return delete n.id,delete n.children,e.addSource(t,n),e.getSource(t)}return null}function yg(t){var i=(0,e.useContext)(mm),n=(0,e.useRef)({id:t.id,type:t.type}),r=Ed((0,e.useState)(0),2)[1],s=(0,e.useMemo)(function(){return t.id||"jsx-source-".concat(_g++)},[]),o=i.map;(0,e.useEffect)(function(){if(o){var e=function(){return r(function(e){return e+1})};return o.on("styledata",e),function(){o.off("styledata",e),requestAnimationFrame(function(){o.style&&o.style._loaded&&o.getSource(s)&&o.removeSource(s)})}}},[o,s]);var a=o&&o.style&&o.getSource(s);return a?function(e,t,i){tm(t.id===i.id,"source id changed"),tm(t.type===i.type,"source type changed");var n="",r=0;for(var s in t)"children"===s||"id"===s||mg(i[s],t[s])||(n=s,r++);if(r){var o=t.type;if("geojson"===o)e.setData(t.data);else if("image"===o)e.updateImage({url:t.url,coordinates:t.coordinates});else if("canvas"!==o&&"video"!==o||1!==r||"coordinates"!==n)if("vector"===o&&e.setUrl)switch(n){case"url":e.setUrl(t.url);break;case"tiles":e.setTiles(t.tiles)}else console.warn("Unable to update <Source> prop: ".concat(n));else e.setCoordinates(t.coordinates)}}(a,t,n.current):a=vg(o,s,t),n.current=t,a&&e.Children.map(t.children,function(t){return t&&(0,e.cloneElement)(t,{source:s})})||null}yg.propTypes=gg;function bg(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function xg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function wg(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?xg(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xg(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var Eg={type:wd.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,id:wd.string,source:wd.string,beforeId:wd.string};function Ag(e,t,i,n){tm(i.id===n.id,"layer id changed"),tm(i.type===n.type,"layer type changed");try{!function(e,t,i,n){var r=i.layout,s=void 0===r?{}:r,o=i.paint,a=void 0===o?{}:o,l=i.filter,c=i.minzoom,u=i.maxzoom,h=i.beforeId,d=bg(i,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==n.beforeId&&e.moveLayer(t,h),s!==n.layout){var p=n.layout||{};for(var m in s)mg(s[m],p[m])||e.setLayoutProperty(t,m,s[m]);for(var f in p)s.hasOwnProperty(f)||e.setLayoutProperty(t,f,void 0)}if(a!==n.paint){var g=n.paint||{};for(var _ in a)mg(a[_],g[_])||e.setPaintProperty(t,_,a[_]);for(var v in g)a.hasOwnProperty(v)||e.setPaintProperty(t,v,void 0)}for(var y in mg(l,n.filter)||e.setFilter(t,l),c===n.minzoom&&u===n.maxzoom||e.setLayerZoomRange(t,c,u),d)mg(d[y],n[y])||e.setLayerProperty(t,y,d[y])}(e,t,i,n)}catch(r){console.warn(r)}}var Tg=0;function Dg(t){var i=(0,e.useContext)(mm),n=(0,e.useRef)({id:t.id,type:t.type}),r=Ed((0,e.useState)(0),2)[1],s=(0,e.useMemo)(function(){return t.id||"jsx-layer-".concat(Tg++)},[]),o=i.map;return(0,e.useEffect)(function(){if(o){var e=function(){return r(function(e){return e+1})};return o.on("styledata",e),function(){o.off("styledata",e),o.style&&o.style._loaded&&o.removeLayer(s)}}},[o]),o&&o.style&&o.getLayer(s)?Ag(o,s,t,n.current):function(e,t,i){if(e.style&&e.style._loaded){var n=wg(wg({},i),{},{id:t});delete n.beforeId,e.addLayer(n,i.beforeId)}}(o,s,t),n.current=t,null}Dg.propTypes=Eg;var Sg={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},Cg={captureScroll:wd.bool,captureDrag:wd.bool,captureClick:wd.bool,captureDoubleClick:wd.bool,capturePointerMove:wd.bool};function Pg(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,e.useContext)(mm),n=(0,e.useRef)(null),r=(0,e.useRef)({props:t,state:{},context:i,containerRef:n}).current;return r.props=t,r.context=i,(0,e.useEffect)(function(){return function(e){var t=e.containerRef.current,i=e.context.eventManager;if(t&&i){var n={wheel:function(t){var i=e.props;i.captureScroll&&t.stopPropagation(),i.onScroll&&i.onScroll(t,e)},panstart:function(t){var i=e.props;i.captureDrag&&t.stopPropagation(),i.onDragStart&&i.onDragStart(t,e)},anyclick:function(t){var i=e.props;i.captureClick&&t.stopPropagation(),i.onNativeClick&&i.onNativeClick(t,e)},click:function(t){var i=e.props;i.captureClick&&t.stopPropagation(),i.onClick&&i.onClick(t,e)},dblclick:function(t){var i=e.props;i.captureDoubleClick&&t.stopPropagation(),i.onDoubleClick&&i.onDoubleClick(t,e)},pointermove:function(t){var i=e.props;i.capturePointerMove&&t.stopPropagation(),i.onPointerMove&&i.onPointerMove(t,e)}};return i.watch(n,t),function(){i.off(n)}}}(r)},[i.eventManager]),r}function Ig(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(hl){return!1}}();return function(){var i,n=Lm(e);if(t){var r=Lm(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Fm(this,i)}}function kg(e){var t=e.instance,i=Pg(e),n=i.context,r=i.containerRef;return t._context=n,t._containerRef=r,t._render()}var Mg=function(t){Mm(n,t);var i=Ig(n);function n(){var t;Fp(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=i.call.apply(i,[this].concat(o)),(0,s.A)(Im(t),"_context",{}),(0,s.A)(Im(t),"_containerRef",(0,e.createRef)()),(0,s.A)(Im(t),"_onScroll",function(e){}),(0,s.A)(Im(t),"_onDragStart",function(e){}),(0,s.A)(Im(t),"_onDblClick",function(e){}),(0,s.A)(Im(t),"_onClick",function(e){}),(0,s.A)(Im(t),"_onPointerMove",function(e){}),t}return Bp(n,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return e.createElement(kg,vd({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),n}(e.PureComponent);function Rg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function Fg(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Rg(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Rg(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}(0,s.A)(Mg,"propTypes",Cg),(0,s.A)(Mg,"defaultProps",Sg);var Lg=Object.assign({},Cg,{draggable:wd.bool,onDrag:wd.func,onDragEnd:wd.func,onDragStart:wd.func,offsetLeft:wd.number,offsetTop:wd.number}),Og=Object.assign({},Sg,{draggable:!1,offsetLeft:0,offsetTop:0});function Bg(e){var t=e.offsetCenter;return[t.x,t.y]}function zg(e,t,i,n){var r=e[0]+t[0]-i.offsetLeft,s=e[1]+t[1]-i.offsetTop;return n.viewport.unproject([r,s])}function Ng(e,t){var i=t.props,n=t.callbacks,r=t.state,s=t.context,o=t.containerRef;if(i.draggable){e.stopPropagation();var a=Bg(e),l=function(e,t){var i=e.center,n=i.x,r=i.y;if(t){var s=t.getBoundingClientRect();return[s.left-n,s.top-r]}return null}(e,o.current);if(r.setDragPos(a),r.setDragOffset(l),n.onDragStart&&l){var c=Object.assign({},e);c.lngLat=zg(a,l,i,s),n.onDragStart(c)}}}function Ug(e){var t=e.context.eventManager;if(t&&e.state.dragPos){var i={panmove:function(t){return function(e,t){var i=t.props,n=t.callbacks,r=t.state,s=t.context;e.stopPropagation();var o=Bg(e);r.setDragPos(o);var a=r.dragOffset;if(n.onDrag&&a){var l=Object.assign({},e);l.lngLat=zg(o,a,i,s),n.onDrag(l)}}(t,e)},panend:function(t){return function(e,t){var i=t.props,n=t.callbacks,r=t.state,s=t.context;e.stopPropagation();var o=r.dragPos,a=r.dragOffset;if(r.setDragPos(null),r.setDragOffset(null),n.onDragEnd&&o&&a){var l=Object.assign({},e);l.lngLat=zg(o,a,i,s),n.onDragEnd(l)}}(t,e)},pancancel:function(t){return function(e,t){var i=t.state;e.stopPropagation(),i.setDragPos(null),i.setDragOffset(null)}(t,e)}};return t.watch(i),function(){t.off(i)}}}var jg="undefined"!==typeof window&&window.devicePixelRatio||1,Vg=function(e){return Math.round(e*jg)/jg},Gg=function(e,t){if(null===e)return t;var i="x"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x")?e.offsetWidth:e.offsetHeight;return Vg(t/100*i)/i*100};function Wg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var Hg=Object.assign({},Lg,{className:wd.string,longitude:wd.number.isRequired,latitude:wd.number.isRequired,style:wd.object}),Xg=Object.assign({},Og,{className:""});function qg(t){var i=function(t){var i=Ed((0,e.useState)(null),2),n=i[0],r=i[1],s=Ed((0,e.useState)(null),2),o=s[0],a=s[1],l=Pg(Fg(Fg({},t),{},{onDragStart:Ng}));return l.callbacks=t,l.state.dragPos=n,l.state.setDragPos=r,l.state.dragOffset=o,l.state.setDragOffset=a,(0,e.useEffect)(function(){return Ug(l)},[l.context.eventManager,Boolean(n)]),l}(t),n=i.state,r=i.containerRef,o=t.children,a=t.className,l=t.draggable,c=t.style,u=n.dragPos,h=function(e){var t=e.props,i=e.state,n=e.context,r=t.longitude,s=t.latitude,o=t.offsetLeft,a=t.offsetTop,l=i.dragPos,c=i.dragOffset,u=n.viewport,h=n.map;if(l&&c)return[l[0]+c[0],l[1]+c[1]];var d=gm(h,{longitude:r,latitude:s}),p=Ed(u.project([r,s,d]),2),m=p[0],f=p[1];return[m+=o,f+=a]}(i),d=Ed(h,2),p=d[0],m=d[1],f="translate(".concat(Vg(p),"px, ").concat(Vg(m),"px)"),g=l?u?"grabbing":"grab":"auto",_=(0,e.useMemo)(function(){var t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Wg(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Wg(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute",left:0,top:0,transform:f,cursor:g},c);return e.createElement("div",{className:"mapboxgl-marker ".concat(a),ref:i.containerRef,style:t},o)},[o,a]),v=r.current;return v&&(v.style.transform=f,v.style.cursor=g),_}qg.defaultProps=Xg,qg.propTypes=Hg;e.memo(qg);var Zg={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Yg=Object.keys(Zg);var Kg=Object.assign({},Cg,{className:wd.string,longitude:wd.number.isRequired,latitude:wd.number.isRequired,altitude:wd.number,offsetLeft:wd.number,offsetTop:wd.number,tipSize:wd.number,closeButton:wd.bool,closeOnClick:wd.bool,anchor:wd.oneOf(Object.keys(Zg)),dynamicPosition:wd.bool,sortByDepth:wd.bool,onClose:wd.func}),Jg=Object.assign({},Sg,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function $g(e,t,i,n){var r=Ed(n,2),s=r[0],o=r[1],a=e.anchor,l=e.dynamicPosition,c=e.tipSize;return i&&l?function(e){var t=e.x,i=e.y,n=e.width,r=e.height,s=e.selfWidth,o=e.selfHeight,a=e.anchor,l=e.padding,c=void 0===l?0:l,u=Zg[a],h=u.x,d=u.y,p=i-d*o,m=p+o,f=Math.max(0,c-p)+Math.max(0,m-r+c);if(f>0){var g=d,_=f;for(d=0;d<=1;d+=.5)m=(p=i-d*o)+o,(f=Math.max(0,c-p)+Math.max(0,m-r+c))<_&&(_=f,g=d);d=g}var v=.5;.5===d&&(h=Math.floor(h),v=1);var y=t-h*s,b=y+s,x=Math.max(0,c-y)+Math.max(0,b-n+c);if(x>0){var w=h,E=x;for(h=0;h<=1;h+=v)b=(y=t-h*s)+s,(x=Math.max(0,c-y)+Math.max(0,b-n+c))<E&&(E=x,w=h);h=w}return Yg.find(function(e){var t=Zg[e];return t.x===h&&t.y===d})||a}({x:s,y:o,anchor:a,padding:c,width:t.width,height:t.height,selfWidth:i.clientWidth,selfHeight:i.clientHeight}):a}function Qg(t){var i=(0,e.useRef)(null),n=Pg(t),r=n.context,s=n.containerRef,o=Ed((0,e.useState)(!1),2)[1];(0,e.useEffect)(function(){o(!0)},[i.current]),(0,e.useEffect)(function(){if(r.eventManager&&t.closeOnClick){var e=function(){return n.props.onClose()};return r.eventManager.on("anyclick",e),function(){r.eventManager.off("anyclick",e)}}},[r.eventManager,t.closeOnClick]);var a=r.viewport,l=r.map,c=t.className,u=t.longitude,h=t.latitude,d=t.tipSize,p=t.closeButton,m=t.children,f=t.altitude;void 0===f&&(f=gm(l,{longitude:u,latitude:h}));var g=a.project([u,h,f]),_=$g(t,a,i.current,g),v=function(e,t,i,n,r){var s=Ed(n,3),o=s[0],a=s[1],l=s[2],c=e.offsetLeft,u=e.offsetTop,h=e.sortByDepth,d=Zg[r],p=o+c,m=a+u,f=Gg(i,100*-d.x),g=Gg(i,100*-d.y,"y"),_={position:"absolute",transform:"\n      translate(".concat(f,"%, ").concat(g,"%)\n      translate(").concat(Vg(p),"px, ").concat(Vg(m),"px)\n    "),display:void 0,zIndex:void 0};return h?(l>1||l<-1||o<0||o>t.width||a<0||a>t.height?_.display="none":_.zIndex=Math.floor((1-l)/2*1e5),_):_}(t,a,s.current,g,_),y=(0,e.useCallback)(function(e){n.props.onClose();var t=n.context.eventManager;t&&t.once("click",function(e){return e.stopPropagation()},e.target)},[]);return e.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(_," ").concat(c),style:v,ref:s},e.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:d}}),e.createElement("div",{key:"content",ref:i,className:"mapboxgl-popup-content"},p&&e.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:y},"\xd7"),m))}Qg.propTypes=Kg,Qg.defaultProps=Jg;e.memo(Qg);function e_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var t_=Object.assign({},Cg,{toggleLabel:wd.string,className:wd.string,style:wd.object,compact:wd.bool,customAttribution:wd.oneOfType([wd.string,wd.arrayOf(wd.string)])}),i_=Object.assign({},Sg,{className:"",toggleLabel:"Toggle Attribution"});function n_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=(0,e.useRef)(null),a=Ed((0,e.useState)(!1),2),l=a[0],c=a[1];(0,e.useEffect)(function(){var e;return n.map&&(e=function(e,t,i,n){var r=new(Kp().AttributionControl)(e);return r._map=t,r._container=i,r._innerContainer=n,r._updateAttributions(),r._updateEditLink(),t.on("styledata",r._updateData),t.on("sourcedata",r._updateData),r}({customAttribution:t.customAttribution},n.map,r.current,o.current)),function(){return e&&function(e){e._map.off("styledata",e._updateData),e._map.off("sourcedata",e._updateData)}(e)}},[n.map]);var u=void 0===t.compact?n.viewport.width<=640:t.compact;(0,e.useEffect)(function(){!u&&l&&c(!1)},[u]);var h=(0,e.useCallback)(function(){return c(function(e){return!e})},[]),d=(0,e.useMemo)(function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):e_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute"},t.style)},[t.style]);return e.createElement("div",{style:d,className:t.className},e.createElement("div",{ref:r,"aria-pressed":l,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(u?"mapboxgl-compact":""," ").concat(l?"mapboxgl-compact-show":"")},e.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:h}),e.createElement("div",{ref:o,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}n_.propTypes=t_,n_.defaultProps=i_;e.memo(n_);function r_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var s_=Object.assign({},Cg,{className:wd.string,style:wd.object,container:wd.object,label:wd.string}),o_=Object.assign({},Sg,{className:"",container:null,label:"Toggle fullscreen"});function a_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=Ed((0,e.useState)(!1),2),a=o[0],l=o[1],c=Ed((0,e.useState)(!1),2),u=c[0],h=c[1],d=Ed((0,e.useState)(null),2),p=d[0],m=d[1];(0,e.useEffect)(function(){var e=new(Kp().FullscreenControl);m(e),h(e._checkFullscreenSupport());var t=function(){var t=!e._fullscreen;e._fullscreen=t,l(t)};return zp.addEventListener(e._fullscreenchange,t),function(){zp.removeEventListener(e._fullscreenchange,t)}},[]);var f=(0,e.useMemo)(function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute"},t.style)},[t.style]);if(!u)return null;var g=t.className,_=t.label,v=a?"shrink":"fullscreen";return e.createElement("div",{style:f,className:g},e.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},e.createElement("button",{key:v,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(v),type:"button",title:_,onClick:function(){p&&(p._container=t.container||n.container,p._onClickFullscreen())}},e.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}a_.propTypes=s_,a_.defaultProps=o_;e.memo(a_);var l_;function c_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var u_=function(){},h_=Object.assign({},Cg,{className:wd.string,style:wd.object,label:wd.string,disabledLabel:wd.string,auto:wd.bool,positionOptions:wd.object,fitBoundsOptions:wd.object,trackUserLocation:wd.bool,showUserLocation:wd.bool,showAccuracyCircle:wd.bool,showUserHeading:wd.bool,onViewStateChange:wd.func,onViewportChange:wd.func,onGeolocate:wd.func}),d_=Object.assign({},Sg,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function p_(e,t){var i=t.context,n=t.props,r=function(e){var t=new(Kp().LngLat)(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,n=t.toBounds(i);return[[n._ne.lng,n._ne.lat],[n._sw.lng,n._sw.lat]]}(e),s=i.viewport.fitBounds(r,n.fitBoundsOptions),o=s.longitude,a=s.latitude,l=s.zoom,c=Object.assign({},i.viewport,{longitude:o,latitude:a,zoom:l}),u=new lm(c),h=Object.assign({},u.getViewportProps(),Xf),d=n.onViewportChange||i.onViewportChange||u_;(n.onViewStateChange||i.onViewStateChange||u_)({viewState:h}),d(h)}function m_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=(0,e.useRef)(null),a=Ed((0,e.useState)(null),2),l=a[0],c=a[1],u=Ed((0,e.useState)(!1),2),h=u[0],d=u[1];(0,e.useEffect)(function(){var e;return n.map&&(void 0!==l_?Promise.resolve(l_):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(function(e){return l_="denied"!==e.state}):(l_=Boolean(window.navigator.geolocation),Promise.resolve(l_))).then(function(r){d(r),o.current&&(e=function(e,t,i){var n=new(Kp().GeolocateControl)(t);n._container=zp.createElement("div"),n._map={on:function(){},_getUIString:function(){return""}},n._setupUI(!0),n._map=e.map,n._geolocateButton=i;var r=e.eventManager;return n.options.trackUserLocation&&r&&r.on("panstart",function(){"ACTIVE_LOCK"===n._watchState&&(n._watchState="BACKGROUND",i.classList.add("mapboxgl-ctrl-geolocate-background"),i.classList.remove("mapboxgl-ctrl-geolocate-active"))}),n.on("geolocate",t.onGeolocate),n}(n,t,o.current),e._updateCamera=function(e){return p_(e,i)},c(e))}),function(){e&&e._clearWatch()}},[n.map]);var p=(0,e.useCallback)(function(){l&&(l.options=i.props,l.trigger())},[l]);(0,e.useEffect)(function(){t.auto&&p()},[l,t.auto]),(0,e.useEffect)(function(){l&&l._onZoom()},[n.viewport.zoom]);var m=t.className,f=t.label,g=t.disabledLabel,_=t.trackUserLocation,v=(0,e.useMemo)(function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute"},t.style)},[t.style]);return e.createElement("div",{style:v,className:m},e.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},e.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:o,disabled:!h,"aria-pressed":!_,type:"button",title:h?f:g,"aria-label":h?f:g,onClick:p},e.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}m_.propTypes=h_,m_.defaultProps=d_;e.memo(m_);function f_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var g_=function(){},__=Object.assign({},Cg,{className:wd.string,style:wd.object,onViewStateChange:wd.func,onViewportChange:wd.func,showCompass:wd.bool,showZoom:wd.bool,zoomInLabel:wd.string,zoomOutLabel:wd.string,compassLabel:wd.string}),v_=Object.assign({},Sg,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function y_(e){return function(e,t){for(var i=(e||"").split(".").map(Number),n=(t||"").split(".").map(Number),r=0;r<3;r++){var s=i[r]||0,o=n[r]||0;if(s<o)return-1;if(s>o)return 1}return 0}(e,"1.6.0")>=0?2:1}function b_(e,t,i){var n=e.viewport,r=new lm(Object.assign({},n,i)),s=Object.assign({},r.getViewportProps(),Xf),o=t.onViewportChange||e.onViewportChange||g_;(t.onViewStateChange||e.onViewStateChange||g_)({viewState:s}),o(s)}function x_(t,i,n,r){return e.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:i,onClick:n},r||e.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function w_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=t.className,a=t.showCompass,l=t.showZoom,c=t.zoomInLabel,u=t.zoomOutLabel,h=t.compassLabel,d=(0,e.useMemo)(function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?f_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute"},t.style)},[t.style]);return e.createElement("div",{style:d,className:o},e.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},l&&x_("zoom-in",c,function(){b_(n,t,{zoom:n.viewport.zoom+1})}),l&&x_("zoom-out",u,function(){b_(n,t,{zoom:n.viewport.zoom-1})}),a&&x_("compass",h,function(){b_(n,t,{bearing:0,pitch:0})},function(t){var i=(0,e.useMemo)(function(){return t.map?y_(t.map.version):2},[t.map]),n=t.viewport.bearing,r={transform:"rotate(".concat(-n,"deg)")};return 2===i?e.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:r}):e.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:r})}(n))))}w_.propTypes=__,w_.defaultProps=v_;e.memo(w_);function E_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var A_=Object.assign({},Cg,{className:wd.string,style:wd.object,maxWidth:wd.number,unit:wd.oneOf(["imperial","metric","nautical"])}),T_=Object.assign({},Sg,{className:"",maxWidth:100,unit:"metric"});function D_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=Ed((0,e.useState)(null),2),a=o[0],l=o[1];(0,e.useEffect)(function(){if(n.map){var e=new(Kp().ScaleControl);e._map=n.map,e._container=r.current,l(e)}},[n.map]),a&&(a.options=t,a._onMove&&a._onMove());var c=(0,e.useMemo)(function(){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute"},t.style)},[t.style]);return e.createElement("div",{style:c,className:t.className},e.createElement("div",{ref:r,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}D_.propTypes=A_,D_.defaultProps=T_;e.memo(D_);var S_="undefined"!==typeof window&&window.devicePixelRatio||1,C_=Object.assign({},Cg,{redraw:wd.func.isRequired});function P_(t){var i=Pg(t),n=i.context,r=i.containerRef,s=Ed((0,e.useState)(null),2),o=s[0],a=s[1];(0,e.useEffect)(function(){a(r.current.getContext("2d"))},[]);var l=n.viewport,c=n.isDragging;return o&&(o.save(),o.scale(S_,S_),t.redraw({width:l.width,height:l.height,ctx:o,isDragging:c,project:l.project,unproject:l.unproject}),o.restore()),e.createElement("canvas",{ref:r,width:l.width*S_,height:l.height*S_,style:{width:"".concat(l.width,"px"),height:"".concat(l.height,"px"),position:"absolute",left:0,top:0}})}P_.propTypes=C_,P_.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function I_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var k_=Object.assign({},Cg,{redraw:wd.func.isRequired,style:wd.object});function M_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=n.viewport,a=n.isDragging,l=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute",left:0,top:0,width:o.width,height:o.height},t.style);return e.createElement("div",{ref:r,style:l},t.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}M_.propTypes=k_,M_.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function R_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var F_=Object.assign({},Cg,{redraw:wd.func.isRequired,style:wd.object});function L_(t){var i=Pg(t),n=i.context,r=i.containerRef,o=n.viewport,a=n.isDragging,l=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?R_(Object(i),!0).forEach(function(t){(0,s.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):R_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({position:"absolute",left:0,top:0},t.style);return e.createElement("svg",{width:o.width,height:o.height,ref:r,style:l},t.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}L_.propTypes=F_,L_.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};Kp()&&Kp().setRTLTextPlugin;const O_=[255,255,255],B_=1,z_=[1,0,0],N_=[0,0,1];let U_=0;const j_={name:"project32",dependencies:[Qs],source:"// Define a structure to hold both the clip-space position and the common position.\nstruct ProjectResult {\n  clipPosition: vec4<f32>,\n  commonPosition: vec4<f32>,\n};\n\n// This function mimics the GLSL version with the 'out' parameter by returning both values.\nfn project_position_to_clipspace_and_commonspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> ProjectResult {\n  // Compute the projected position.\n  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);\n\n  // Start with the provided offset.\n  var finalOffset: vec3<f32> = offset;\n\n  // Get whether a rotation is needed and the rotation matrix.\n  let rotationResult = project_needs_rotation(projectedPosition);\n\n  // If rotation is needed, update the offset.\n  if (rotationResult.needsRotation) {\n    finalOffset = rotationResult.transform * offset;\n  }\n\n  // Compute the common position.\n  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);\n\n  // Convert to clip-space.\n  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);\n\n  return ProjectResult(clipPosition, commonPosition);\n}\n\n// A convenience overload that returns only the clip-space position.\nfn project_position_to_clipspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> vec4<f32> {\n  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;\n}\n",vs:"vec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},V_={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},vs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const i=e.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=i}if(e.highlightColor){const i=Array.from(e.highlightColor,e=>e/255);Number.isFinite(i[3])||(i[3]=1),t.highlightColor=i}void 0!==e.isActive&&(t.isActive=Boolean(e.isActive),t.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(t.useFloatColors=Boolean(e.useFloatColors));return t}};const G_=(0,r.A)((0,r.A)({},V_),{},{defaultUniforms:(0,r.A)((0,r.A)({},V_.defaultUniforms),{},{useFloatColors:!1}),inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}});class W_{constructor(e){(0,s.A)(this,"id",void 0),(0,s.A)(this,"topology",void 0),(0,s.A)(this,"vertexCount",void 0),(0,s.A)(this,"indices",void 0),(0,s.A)(this,"attributes",void 0),(0,s.A)(this,"userData",{});const{attributes:t={},indices:i=null,vertexCount:n=null}=e;this.id=e.id||Iu("geometry"),this.topology=e.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(const[r,s]of Object.entries(t)){const e=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(e.value))throw new Error("".concat(this._print(r),": must be typed array or object with value as typed array"));if("POSITION"!==r&&"positions"!==r||e.size||(e.size=3),"indices"===r){if(this.indices)throw new Error("Multiple indices detected");this.indices=e}else this.attributes[r]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=n||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?(0,r.A)({indices:this.indices},this.attributes):this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const n of Object.values(e)){const{value:e,size:t,constant:r}=n;!r&&e&&void 0!==t&&t>=1&&(i=Math.min(i,e.length/t))}return i}}class H_{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=si,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:i={},getGeometry:n,geometryBuffer:r,positionFormat:s,dataChanged:o,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=n,this.positionSize=r&&r.size||("XY"===s?2:3),this.buffers=i,this.normalize=a,r&&(Qr(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),a||(i.vertexPositions=r)),this.geometryBuffer=i.vertexPositions,Array.isArray(o))for(const l of o)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(e){let{startRow:t,endRow:i}=e;this._rebuildGeometry({startRow:t,endRow:i})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?Ha(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:i,buffers:n,_attributeDefs:r,typedArrayManager:s}=this;for(const o in r)if(o in n)s.release(i[o]),i[o]=null;else{const n=r[o];n.copy=t,i[o]=s.allocate(i[o],e,n)}}_forEachGeometry(e,t,i){const{data:n,getGeometry:r}=this,{iterable:s,objectInfo:o}=Ga(n,t,i);for(const a of s){o.index++;e(r?r(a,o):null,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:i,instanceCount:n}=this;const{data:r,geometryBuffer:s}=this,{startRow:o=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],i=[0]),this.normalize||!s)this._forEachGeometry((e,t)=>{const n=e&&this.normalizeGeometry(e);l[t]=n,i[t+1]=i[t]+(n?this.getGeometrySize(n):0)},o,a),n=i[i.length-1];else if(i=r.startIndices,n=i[r.length]||0,ArrayBuffer.isView(s))n=n||s.length/this.positionSize;else if(s instanceof Ra.h){const e=4*this.positionSize;n=n||s.byteLength/e}else if(s.buffer){const e=s.stride||4*this.positionSize;n=n||s.buffer.byteLength/e}else if(s.value){const e=s.value,t=s.stride/e.BYTES_PER_ELEMENT||this.positionSize;n=n||e.length/t}this._allocate(n,Boolean(e)),this.indexStarts=t,this.vertexStarts=i,this.instanceCount=n;const c={};this._forEachGeometry((e,r)=>{const s=l[r]||e;c.vertexStart=i[r],c.indexStart=t[r];const o=r<i.length-1?i[r+1]:n;c.geometrySize=o-i[r],c.geometryIndex=r,this.updateGeometryAttributes(s,c)},o,a),this.vertexCount=t[t.length-1]}}function X_(e,t,i,n){let r,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&i)r=(n[3]-e[1])/(t[1]-e[1]),s=3;else if(4&i)r=(n[1]-e[1])/(t[1]-e[1]),s=1;else if(2&i)r=(n[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&i))return null;r=(n[0]-e[0])/(t[0]-e[0]),s=0}for(let a=0;a<e.length;a++)o[a]=(1&s)===a?n[s]:r*(t[a]-e[a])+e[a];return o}function q_(e,t){let i=0;return e[0]<t[0]?i|=1:e[0]>t[2]&&(i|=2),e[1]<t[1]?i|=4:e[1]>t[3]&&(i|=8),i}function Z_(e,t){const i=t.length,n=e.length;if(n>0){let r=!0;for(let s=0;s<i;s++)if(e[n-i+s]!==t[s]){r=!1;break}if(r)return!1}for(let r=0;r<i;r++)e[n+r]=t[r];return!0}function Y_(e,t){const i=t.length;for(let n=0;n<i;n++)e[n]=t[n]}function K_(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const s=n+t*i;for(let o=0;o<i;o++)r[o]=e[s+o];return r}function J_(e,t){const{size:i=2,broken:n=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=e.length}=t||{},l=(a-o)/i;let c=[];const u=[c],h=K_(e,0,i,o);let d,p;const m=$_(h,r,s,[]),f=[];Z_(c,h);for(let g=1;g<l;g++){for(d=K_(e,g,i,o,d),p=q_(d,m);p;){X_(h,d,p,m,f);const e=q_(f,m);e&&(X_(h,f,e,m,f),p=e),Z_(c,f),Y_(h,f),Q_(m,r,p),n&&c.length>i&&(c=[],u.push(c),Z_(c,h)),p=q_(d,m)}Z_(c,d),Y_(h,d)}return n?u:u[0]}function $_(e,t,i,n){const r=Math.floor((e[0]-i[0])/t)*t+i[0],s=Math.floor((e[1]-i[1])/t)*t+i[1];return n[0]=r,n[1]=s,n[2]=r+t,n[3]=s+t,n}function Q_(e,t,i){8&i?(e[1]+=t,e[3]+=t):4&i?(e[1]-=t,e[3]-=t):2&i?(e[0]+=t,e[2]+=t):1&i&&(e[0]-=t,e[2]-=t)}function ev(e,t,i,n){let r,s=e[0];for(let o=i;o<n;o+=t){r=e[o];const t=r-s;(t>180||t<-180)&&(r-=360*Math.round(t/360)),e[o]=s=r}}function tv(e,t){let i;const n=e.length/t;for(let s=0;s<n&&(i=e[s*t],(i+180)%360===0);s++);const r=360*-Math.round(i/360);if(0!==r)for(let s=0;s<n;s++)e[s*t]+=r}function iv(e,t,i,n){let r;if(Array.isArray(e[0])){const i=e.length*t;r=new Array(i);for(let n=0;n<e.length;n++)for(let i=0;i<t;i++)r[n*t+i]=e[n][i]||0}else r=e;return i?J_(r,{size:t,gridResolution:i}):n?function(e,t){const{size:i=2,startIndex:n=0,endIndex:r=e.length,normalize:s=!0}=t||{},o=e.slice(n,r);ev(o,i,0,r-n);const a=J_(o,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)tv(l,i);return a}(r,{size:t}):r}class nv extends H_{constructor(e){super((0,r.A)((0,r.A)({},e),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?iv(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(rv(e)){let t=0;for(const i of e)t+=this.getGeometrySize(i);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&rv(e))for(const i of e){const e=this.getGeometrySize(i);t.geometrySize=e,this.updateGeometryAttributes(i,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const i=this.attributes.segmentTypes,n=!!e&&this.isClosed(e),{vertexStart:r,geometrySize:s}=t;i.fill(0,r,r+s),n?(i[r]=4,i[r+s-2]=4):(i[r]+=1,i[r+s-2]+=2),i[r+s-1]=4}_updatePositions(e,t){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:n,geometrySize:r}=t,s=new Array(3);for(let o=n,a=0;a<r;o++,a++)this.getPointOnPath(e,a,s),i[3*o]=s[0],i[3*o+1]=s[1],i[3*o+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:n}=this;t*n>=e.length&&(t+=1-e.length/n);const r=t*n;return i[0]=e[r],i[1]=e[r+1],i[2]=3===n&&e[r+2]||0,i}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,i=e.length-t;return e[0]===e[i]&&e[1]===e[i+1]&&(2===t||e[2]===e[i+2])}}function rv(e){return Array.isArray(e[0])}const sv="uniform pathUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float jointType;\n  float capType;\n  float miterLimit;\n  bool billboard;\n  highp int widthUnits;\n} path;\n",ov={name:"path",vs:sv,fs:sv,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},av=[0,0,0,255],lv={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:av},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},cv={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class uv extends ld{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = path.capType;\n} else {\nvJointType = path.jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),\npath.widthMinPixels, path.widthMaxPixels) / 2.0);\nvec3 width;\nif (path.billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[j_,G_,ov]})}get wrapLongitude(){return!1}getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["vertexPositions"])}initializeState(){const e=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:cv,accessor:"getPath",update:this.calculatePositions,noAlloc:e,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:e},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:cv,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:cv,defaultValue:av},instancePickingColors:{size:4,type:"uint8",accessor:(e,t)=>{let{index:i,target:n}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:i,n)}}}),this.setState({pathTesselator:new nv({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:i}=e,n=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:r.getPath,buffers:r,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),i.dataChanged||n.invalidateAll()}var r;i.extensionsChanged&&(null===(r=this.state.model)||void 0===r||r.destroy(),this.state.model=this._getModel(),n.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i}=t,n=this.props.data;return n[0]&&n[0].__source&&(t.object=n.find(e=>e.__source.index===i)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{jointRounded:i,capRounded:n,billboard:r,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model,h={jointType:Number(i),capType:Number(n),billboard:r,widthUnits:Cr[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c};u.shaderInputs.setProps({path:h}),u.draw(this.context.renderPass)}_getModel(){return new Ku(this.context.device,(0,r.A)((0,r.A)({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new W_({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}uv.defaultProps=lv,uv.layerName="PathLayer";const hv=uv,dv="uniform tripsUniforms {\n  bool fadeTrail;\n  float trailLength;\n  float currentTime;\n} trips;\n",pv={name:"trips",vs:dv,fs:dv,uniformTypes:{fadeTrail:"f32",trailLength:"f32",currentTime:"f32"}};class mv extends hv{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":"in float instanceTimestamps;\nin float instanceNextTimestamps;\nout float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"in float vTime;\n","fs:#main-start":"if(vTime > trips.currentTime || (trips.fadeTrail && (vTime < trips.currentTime - trips.trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(trips.fadeTrail) {\n  color.a *= 1.0 - (trips.currentTime - vTime) / trips.trailLength;\n}\n"},e.modules=[...e.modules,pv],e}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:t,trailLength:i,currentTime:n}=this.props,r={fadeTrail:t,trailLength:i,currentTime:n};this.state.model.shaderInputs.setProps({trips:r}),super.draw(e)}}mv.layerName="TripsLayer",mv.defaultProps={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:e=>e.timestamps}};const fv=mv,gv={name:"color",dependencies:[],source:"\n\nstruct ColorUniforms {\n  opacity: f32,\n};\n\nvar<private> color: ColorUniforms = ColorUniforms(1.0);\n// TODO (kaapp) avoiding binding index collisions to handle layer opacity \n// requires some thought.\n// @group(0) @binding(0) var<uniform> color: ColorUniforms;\n\n@must_use\nfn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {\n    return vec4(fragColor.rgb * fragColor.a, fragColor.a); \n};\n",getUniforms:e=>({}),uniformTypes:{opacity:"f32"}},_v="uniform scatterplotUniforms {\n  float radiusScale;\n  float radiusMinPixels;\n  float radiusMaxPixels;\n  float lineWidthScale;\n  float lineWidthMinPixels;\n  float lineWidthMaxPixels;\n  float stroked;\n  float filled;\n  bool antialiasing;\n  bool billboard;\n  highp int radiusUnits;\n  highp int lineWidthUnits;\n} scatterplot;\n",vv={name:"scatterplot",vs:_v,fs:_v,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},yv=[0,0,0,255],bv={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:yv},getLineColor:{type:"accessor",value:yv},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class xv extends ld{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),\nscatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),\nscatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n);\nouterRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\nfloat edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;\nif (scatterplot.billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = scatterplot.antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (scatterplot.stroked > 0.5) {\nfloat isLine = scatterplot.antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (scatterplot.filled > 0.5) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (scatterplot.filled < 0.5) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",source:"// Main shaders\n\nstruct ScatterplotUniforms {\n  radiusScale: f32,\n  radiusMinPixels: f32,\n  radiusMaxPixels: f32,\n  lineWidthScale: f32,\n  lineWidthMinPixels: f32,\n  lineWidthMaxPixels: f32,\n  stroked: f32,\n  filled: i32,\n  antialiasing: i32,\n  billboard: i32,\n  radiusUnits: i32,\n  lineWidthUnits: i32,\n};\n\nstruct ConstantAttributeUniforms {\n instancePositions: vec3<f32>,\n instancePositions64Low: vec3<f32>,\n instanceRadius: f32,\n instanceLineWidths: f32,\n instanceFillColors: vec4<f32>,\n instanceLineColors: vec4<f32>,\n instancePickingColors: vec3<f32>,\n\n instancePositionsConstant: i32,\n instancePositions64LowConstant: i32,\n instanceRadiusConstant: i32,\n instanceLineWidthsConstant: i32,\n instanceFillColorsConstant: i32,\n instanceLineColorsConstant: i32,\n instancePickingColorsConstant: i32\n};\n\n@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;\n\nstruct ConstantAttributes {\n  instancePositions: vec3<f32>,\n  instancePositions64Low: vec3<f32>,\n  instanceRadius: f32,\n  instanceLineWidths: f32,\n  instanceFillColors: vec4<f32>,\n  instanceLineColors: vec4<f32>,\n  instancePickingColors: vec3<f32>\n};\n\nconst constants = ConstantAttributes(\n  vec3<f32>(0.0),\n  vec3<f32>(0.0),\n  0.0,\n  0.0,\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec4<f32>(0.0, 0.0, 0.0, 1.0),\n  vec3<f32>(0.0)\n);\n\nstruct Attributes {\n  @builtin(instance_index) instanceIndex : u32,\n  @builtin(vertex_index) vertexIndex : u32,\n  @location(0) positions: vec3<f32>,\n  @location(1) instancePositions: vec3<f32>,\n  @location(2) instancePositions64Low: vec3<f32>,\n  @location(3) instanceRadius: f32,\n  @location(4) instanceLineWidths: f32,\n  @location(5) instanceFillColors: vec4<f32>,\n  @location(6) instanceLineColors: vec4<f32>,\n  @location(7) instancePickingColors: vec3<f32>\n};\n\nstruct Varyings {\n  @builtin(position) position: vec4<f32>,\n  @location(0) vFillColor: vec4<f32>,\n  @location(1) vLineColor: vec4<f32>,\n  @location(2) unitPosition: vec2<f32>,\n  @location(3) innerUnitRadius: f32,\n  @location(4) outerRadiusPixels: f32,\n};\n\n@vertex\nfn vertexMain(attributes: Attributes) -> Varyings {\n  var varyings: Varyings;\n\n  // Draw an inline geometry constant array clip space triangle to verify that rendering works.\n  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));\n  // if (attributes.instanceIndex == 0) {\n  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);\n  //   return varyings;\n  // }\n\n  // var geometry: Geometry;\n  // geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  varyings.outerRadiusPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),\n    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n  );\n\n  // Multiply out line width and clamp to limits\n  let lineWidthPixels = clamp(\n    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),\n    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\n  // Expand geometry to accommodate edge smoothing\n  let edgePadding = select(\n    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,\n    1.0,\n    scatterplot.antialiasing != 0\n  );\n\n  // position on the containing square in [-1, 1] space\n  varyings.unitPosition = edgePadding * attributes.positions.xy;\n  geometry.uv = varyings.unitPosition;\n  geometry.pickingColor = attributes.instancePickingColors;\n\n  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;\n\n  if (scatterplot.billboard != 0) {\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    let clipPixels = project_pixel_size_to_clipspace(offset.xy);\n    varyings.position.x = clipPixels.x;\n    varyings.position.y = clipPixels.y;\n  } else {\n    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);\n    // DECKGL_FILTER_SIZE(offset, geometry);\n    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);\n    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);\n  }\n\n  // Apply opacity to instance color, or return instance picking color\n  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);\n  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);\n  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);\n\n  return varyings;\n}\n\n@fragment\nfn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {\n  // var geometry: Geometry;\n  // geometry.uv = unitPosition;\n\n  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;\n  let inCircle = select(\n    smoothedge(distToCenter, varyings.outerRadiusPixels),\n    step(distToCenter, varyings.outerRadiusPixels),\n    scatterplot.antialiasing != 0\n  );\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  var fragColor: vec4<f32>;\n\n  if (scatterplot.stroked != 0) {\n    let isLine = select(\n      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),\n      scatterplot.antialiasing != 0\n    );\n\n    if (scatterplot.filled != 0) {\n      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);\n    }\n  } else if (scatterplot.filled == 0) {\n    discard;\n  } else {\n    fragColor = varyings.vFillColor;\n  }\n\n  fragColor.a *= inCircle;\n  // DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  // Apply premultiplied alpha as required by transparent canvas\n  fragColor = deckgl_premultiplied_alpha(fragColor);\n\n  return fragColor;\n  // return vec4<f32>(0, 0, 1, 1);\n}\n",modules:[j_,gv,G_,vv]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var t;(super.updateState(e),e.changeFlags.extensionsChanged)&&(null===(t=this.state.model)||void 0===t||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{radiusUnits:i,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:p}=this.props,m={stroked:o,filled:a,billboard:l,antialiasing:c,radiusUnits:Cr[i],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:Cr[u],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:p},f=this.state.model;f.shaderInputs.setProps({scatterplot:m}),"webgpu"===this.context.device.type&&(f.instanceCount=this.props.data.length),f.draw(this.context.renderPass)}_getModel(){const e="webgpu"===this.context.device.type?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0;return new Ku(this.context.device,(0,r.A)((0,r.A)({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new W_({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0,parameters:e}))}}xv.defaultProps=bv,xv.layerName="ScatterplotLayer";const wv=xv,Ev="uniform arcUniforms {\n  bool greatCircle;\n  bool useShortestPath;\n  float numSegments;\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  highp int widthUnits;\n} arc;\n",Av={name:"arc",vs:Ev,fs:Ev,uniformTypes:{greatCircle:"f32",useShortestPath:"f32",numSegments:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",widthUnits:"i32"}},Tv=[0,0,0,255],Dv={getSourcePosition:{type:"accessor",value:e=>e.sourcePosition},getTargetPosition:{type:"accessor",value:e=>e.targetPosition},getSourceColor:{type:"accessor",value:Tv},getTargetColor:{type:"accessor",value:Tv},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Sv extends ld{getBounds(){var e;return null===(e=this.getAttributeManager())||void 0===e?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME arc-layer-vertex-shader\nin vec4 instanceSourceColors;\nin vec4 instanceTargetColors;\nin vec3 instanceSourcePositions;\nin vec3 instanceSourcePositions64Low;\nin vec3 instanceTargetPositions;\nin vec3 instanceTargetPositions64Low;\nin vec3 instancePickingColors;\nin float instanceWidths;\nin float instanceHeights;\nin float instanceTilts;\nout vec4 vColor;\nout vec2 uv;\nout float isValid;\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\nfloat deltaZ = targetZ - sourceZ;\nfloat dh = distance * instanceHeights;\nif (dh == 0.0) {\nreturn sourceZ + deltaZ * ratio;\n}\nfloat unitZ = deltaZ / dh;\nfloat p2 = unitZ * unitZ + 1.0;\nfloat dir = step(deltaZ, 0.0);\nfloat z0 = mix(sourceZ, targetZ, dir);\nfloat r = mix(ratio, 1.0 - ratio, dir);\nreturn sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\nvec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);\ndir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\nreturn dir_screenspace * offset_direction * width / 2.0;\n}\nfloat getSegmentRatio(float index) {\nreturn smoothstep(0.0, 1.0, index / (arc.numSegments - 1.0));\n}\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\nfloat distance = length(source.xy - target.xy);\nfloat z = paraboloid(distance, source.z, target.z, segmentRatio);\nfloat tiltAngle = radians(instanceTilts);\nvec2 tiltDirection = normalize(target.xy - source.xy);\nvec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\nreturn vec3(\nmix(source.xy, target.xy, segmentRatio) + tilt,\nz * cos(tiltAngle)\n);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\nvec2 sourceRadians = radians(source);\nvec2 targetRadians = radians(target);\nvec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\nvec2 shd_sq = sin_half_delta * sin_half_delta;\nfloat a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\nreturn 2.0 * asin(sqrt(a));\n}\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\nvec2 lngLat;\nif(abs(angularDist - PI) < 0.001) {\nlngLat = (1.0 - t) * source.xy + t * target.xy;\n} else {\nfloat a = sin((1.0 - t) * angularDist);\nfloat b = sin(t * angularDist);\nvec3 p = source3D.yxz * a + target3D.yxz * b;\nlngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n}\nfloat z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\nreturn vec3(lngLat, z);\n}\nvoid main(void) {\ngeometry.worldPosition = instanceSourcePositions;\ngeometry.worldPositionAlt = instanceTargetPositions;\nfloat segmentIndex = float(gl_VertexID / 2);\nfloat segmentSide = mod(float(gl_VertexID), 2.) == 0. ? -1. : 1.;\nfloat segmentRatio = getSegmentRatio(segmentIndex);\nfloat prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\nfloat nextSegmentRatio = getSegmentRatio(min(arc.numSegments - 1.0, segmentIndex + 1.0));\nfloat indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\nisValid = 1.0;\nuv = vec2(segmentRatio, segmentSide);\ngeometry.uv = uv;\ngeometry.pickingColor = instancePickingColors;\nvec4 curr;\nvec4 next;\nvec3 source;\nvec3 target;\nif ((arc.greatCircle || project.projectionMode == PROJECTION_MODE_GLOBE) && project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nsource = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\ntarget = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\nfloat angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\nvec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\nvec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\nvec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\nif (abs(currPos.x - prevPos.x) > 180.0) {\nindexDir = -1.0;\nisValid = 0.0;\n} else if (abs(currPos.x - nextPos.x) > 180.0) {\nindexDir = 1.0;\nisValid = 0.0;\n}\nnextPos = indexDir < 0.0 ? prevPos : nextPos;\nnextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\nif (isValid == 0.0) {\nnextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\nfloat t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\ncurrPos = mix(currPos, nextPos, t);\nsegmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n}\nvec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\nvec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\ncurr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\nnext = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n} else {\nvec3 source_world = instanceSourcePositions;\nvec3 target_world = instanceTargetPositions;\nif (arc.useShortestPath) {\nsource_world.x = mod(source_world.x + 180., 360.0) - 180.;\ntarget_world.x = mod(target_world.x + 180., 360.0) - 180.;\nfloat deltaLng = target_world.x - source_world.x;\nif (deltaLng > 180.) target_world.x -= 360.;\nif (deltaLng < -180.) source_world.x -= 360.;\n}\nsource = project_position(source_world, instanceSourcePositions64Low);\ntarget = project_position(target_world, instanceTargetPositions64Low);\nfloat antiMeridianX = 0.0;\nif (arc.useShortestPath) {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nantiMeridianX = -(project.coordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n}\nfloat thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\nif (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\nisValid = 0.0;\nindexDir = sign(segmentRatio - thresholdRatio);\nsegmentRatio = thresholdRatio;\n}\n}\nnextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\nvec3 currPos = interpolateFlat(source, target, segmentRatio);\nvec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\nif (arc.useShortestPath) {\nif (nextPos.x < antiMeridianX) {\ncurrPos.x += TILE_SIZE;\nnextPos.x += TILE_SIZE;\n}\n}\ncurr = project_common_position_to_clipspace(vec4(currPos, 1.0));\nnext = project_common_position_to_clipspace(vec4(nextPos, 1.0));\ngeometry.position = vec4(currPos, 1.0);\n}\nfloat widthPixels = clamp(\nproject_size_to_pixel(instanceWidths * arc.widthScale, arc.widthUnits),\narc.widthMinPixels, arc.widthMaxPixels\n);\nvec3 offset = vec3(\ngetExtrusionOffset((next.xy - curr.xy) * indexDir, segmentSide, widthPixels),\n0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\nDECKGL_FILTER_GL_POSITION(curr, geometry);\ngl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\nvec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\nvColor = vec4(color.rgb, color.a * layer.opacity);\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME arc-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 uv;\nin float isValid;\nout vec4 fragColor;\nvoid main(void) {\nif (isValid == 0.0) {\ndiscard;\n}\nfragColor = vColor;\ngeometry.uv = uv;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[j_,G_,Av]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getSourceColor",defaultValue:Tv},instanceTargetColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getTargetColor",defaultValue:Tv},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){var t;(super.updateState(e),e.changeFlags.extensionsChanged)&&(null===(t=this.state.model)||void 0===t||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{widthUnits:i,widthScale:n,widthMinPixels:r,widthMaxPixels:s,greatCircle:o,wrapLongitude:a,numSegments:l}=this.props,c={numSegments:l,widthUnits:Cr[i],widthScale:n,widthMinPixels:r,widthMaxPixels:s,greatCircle:o,useShortestPath:a},u=this.state.model;u.shaderInputs.setProps({arc:c}),u.setVertexCount(2*l),u.draw(this.context.renderPass)}_getModel(){return new Ku(this.context.device,(0,r.A)((0,r.A)({},this.getShaders()),{},{id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-strip",isInstanced:!0}))}}Sv.layerName="ArcLayer",Sv.defaultProps=Dv;const Cv=Sv;function Pv(e){var t,i,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(i=Pv(e[t]))&&(n&&(n+=" "),n+=i)}else for(i in e)e[i]&&(n&&(n+=" "),n+=i);return n}const Iv=function(){for(var e,t,i=0,n="",r=arguments.length;i<r;i++)(e=arguments[i])&&(t=Pv(e))&&(n&&(n+=" "),n+=t);return n};var kv=i(579);const Mv=e.createContext();function Rv(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const r=e.useRef(void 0),s=e.useCallback(e=>{const t=i.map(t=>{if(null==t)return null;if("function"===typeof t){const i=t,n=i(e);return"function"===typeof n?n:()=>{i(null)}}return t.current=e,()=>{t.current=null}});return()=>{t.forEach(e=>null===e||void 0===e?void 0:e())}},i);return e.useMemo(()=>i.every(e=>null==e)?null:e=>{r.current&&(r.current(),r.current=void 0),null!=e&&(r.current=s(e))},i)}const Fv=function(e){return"string"===typeof e};const Lv=function(e,t,i){return void 0===e||Fv(e)?t:(0,r.A)((0,r.A)({},t),{},{ownerState:(0,r.A)((0,r.A)({},t.ownerState),i)})};const Ov=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const i={};return Object.keys(e).filter(i=>i.match(/^on[A-Z]/)&&"function"===typeof e[i]&&!t.includes(i)).forEach(t=>{i[t]=e[t]}),i};const Bv=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t])).forEach(i=>{t[i]=e[i]}),t};const zv=function(e){const{getSlotProps:t,additionalProps:i,externalSlotProps:n,externalForwardedProps:s,className:o}=e;if(!t){const e=Iv(null===i||void 0===i?void 0:i.className,o,null===s||void 0===s?void 0:s.className,null===n||void 0===n?void 0:n.className),t=(0,r.A)((0,r.A)((0,r.A)({},null===i||void 0===i?void 0:i.style),null===s||void 0===s?void 0:s.style),null===n||void 0===n?void 0:n.style),a=(0,r.A)((0,r.A)((0,r.A)({},i),s),n);return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}const a=Ov((0,r.A)((0,r.A)({},s),n)),l=Bv(n),c=Bv(s),u=t(a),h=Iv(null===u||void 0===u?void 0:u.className,null===i||void 0===i?void 0:i.className,o,null===s||void 0===s?void 0:s.className,null===n||void 0===n?void 0:n.className),d=(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},null===u||void 0===u?void 0:u.style),null===i||void 0===i?void 0:i.style),null===s||void 0===s?void 0:s.style),null===n||void 0===n?void 0:n.style),p=(0,r.A)((0,r.A)((0,r.A)((0,r.A)({},u),i),c),l);return h.length>0&&(p.className=h),Object.keys(d).length>0&&(p.style=d),{props:p,internalRef:u.ref}};const Nv=function(e,t,i){return"function"===typeof e?e(t,i):e},Uv=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const jv=function(e){var t;const{elementType:i,externalSlotProps:n,ownerState:s,skipResolvingSlotProps:o=!1}=e,a=bg(e,Uv),l=o?{}:Nv(n,s),{props:c,internalRef:u}=zv((0,r.A)((0,r.A)({},a),{},{externalSlotProps:l})),h=Rv(u,null===l||void 0===l?void 0:l.ref,null===(t=e.additionalProps)||void 0===t?void 0:t.ref);return Lv(i,(0,r.A)((0,r.A)({},c),{},{ref:h}),s)};function Vv(e){return e&&e.ownerDocument||document}const Gv="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;const Wv=function(t){const i=e.useRef(t);return Gv(()=>{i.current=t}),e.useRef(function(){return(0,i.current)(...arguments)}).current};function Hv(e){try{return e.matches(":focus-visible")}catch(t){0}return!1}const Xv={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};const qv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,i))};const Zv=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every((e,n)=>i(e,t[n]))};function Yv(e,t,i,n,r){return 1===i?Math.min(e+t,r):Math.max(e-t,n)}function Kv(e,t){return e-t}function Jv(e,t){var i;const{index:n}=null!==(i=e.reduce((e,i,n)=>{const r=Math.abs(t-i);return null===e||r<e.distance||r===e.distance?{distance:r,index:n}:e},null))&&void 0!==i?i:{};return n}function $v(e,t){if(void 0!==t.current&&e.changedTouches){const i=e;for(let e=0;e<i.changedTouches.length;e+=1){const n=i.changedTouches[e];if(n.identifier===t.current)return{x:n.clientX,y:n.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function Qv(e,t,i){return 100*(e-t)/(i-t)}function ey(e,t,i){const n=Math.round((e-i)/t)*t+i;return Number(n.toFixed(function(e){if(Math.abs(e)<1){const t=e.toExponential().split("e-"),i=t[0].split(".")[1];return(i?i.length:0)+parseInt(t[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}(t)))}function ty(e){let{values:t,newValue:i,index:n}=e;const r=t.slice();return r[n]=i,r.sort(Kv)}function iy(e){var t,i;let{sliderRef:n,activeIndex:r,setActive:s}=e;const o=Vv(n.current);var a;null!==(t=n.current)&&void 0!==t&&t.contains(o.activeElement)&&Number(null===o||void 0===o||null===(i=o.activeElement)||void 0===i?void 0:i.getAttribute("data-index"))===r||(null===(a=n.current)||void 0===a||a.querySelector('[type="range"][data-index="'.concat(r,'"]')).focus());s&&s(r)}function ny(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&Zv(e,t)}const ry={horizontal:{offset:e=>({left:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},"horizontal-reverse":{offset:e=>({right:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},vertical:{offset:e=>({bottom:"".concat(e,"%")}),leap:e=>({height:"".concat(e,"%")})}},sy=e=>e;let oy;function ay(){return void 0===oy&&(oy="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),oy}function ly(t){const{"aria-labelledby":i,defaultValue:n,disabled:s=!1,disableSwap:o=!1,isRtl:a=!1,marks:l=!1,max:c=100,min:u=0,name:h,onChange:d,onChangeCommitted:p,orientation:m="horizontal",rootRef:f,scale:g=sy,step:_=1,shiftStep:v=10,tabIndex:y,value:b}=t,x=e.useRef(void 0),[w,E]=e.useState(-1),[A,T]=e.useState(-1),[D,S]=e.useState(!1),C=e.useRef(0),P=e.useRef(null),[I,k]=function(t){const{controlled:i,default:n,name:r,state:s="value"}=t,{current:o}=e.useRef(void 0!==i),[a,l]=e.useState(n);return[o?i:a,e.useCallback(e=>{o||l(e)},[])]}({controlled:b,default:null!==n&&void 0!==n?n:u,name:"Slider"}),M=d&&((e,t,i)=>{const n=e.nativeEvent||e,r=new n.constructor(n.type,n);Object.defineProperty(r,"target",{writable:!0,value:{value:t,name:h}}),P.current=t,d(r,t,i)}),R=Array.isArray(I);let F=R?I.slice().sort(Kv):[I];F=F.map(e=>null==e?u:qv(e,u,c));const L=!0===l&&null!==_?[...Array(Math.floor((c-u)/_)+1)].map((e,t)=>({value:u+_*t})):l||[],O=L.map(e=>e.value),[B,z]=e.useState(-1),N=e.useRef(null),U=Rv(f,N),j=e=>t=>{var i;const n=Number(t.currentTarget.getAttribute("data-index"));Hv(t.target)&&z(n),T(n),null===e||void 0===e||null===(i=e.onFocus)||void 0===i||i.call(e,t)},V=e=>t=>{var i;Hv(t.target)||z(-1),T(-1),null===e||void 0===e||null===(i=e.onBlur)||void 0===i||i.call(e,t)},G=(e,t)=>{const i=Number(e.currentTarget.getAttribute("data-index")),n=F[i],r=O.indexOf(n);let s=t;if(L&&null==_){const e=O[O.length-1];s=s>=e?e:s<=O[0]?O[0]:s<n?O[r-1]:O[r+1]}if(s=qv(s,u,c),R){o&&(s=qv(s,F[i-1]||-1/0,F[i+1]||1/0));const e=s;s=ty({values:F,newValue:s,index:i});let t=i;o||(t=s.indexOf(e)),iy({sliderRef:N,activeIndex:t})}var a;(k(s),z(i),M&&!ny(s,I)&&M(e,s,i),p)&&p(e,null!==(a=P.current)&&void 0!==a?a:s)},W=e=>t=>{var i;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(t.key)){t.preventDefault();const e=Number(t.currentTarget.getAttribute("data-index")),i=F[e];let n=null;if(null!=_){const e=t.shiftKey?v:_;switch(t.key){case"ArrowUp":n=Yv(i,e,1,u,c);break;case"ArrowRight":n=Yv(i,e,a?-1:1,u,c);break;case"ArrowDown":n=Yv(i,e,-1,u,c);break;case"ArrowLeft":n=Yv(i,e,a?1:-1,u,c);break;case"PageUp":n=Yv(i,v,1,u,c);break;case"PageDown":n=Yv(i,v,-1,u,c);break;case"Home":n=u;break;case"End":n=c}}else if(L){const e=O[O.length-1],r=O.indexOf(i),s=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"].includes(t.key)?n=0===r?O[0]:O[r-1]:s.includes(t.key)&&(n=r===O.length-1?e:O[r+1])}null!=n&&G(t,n)}null===e||void 0===e||null===(i=e.onKeyDown)||void 0===i||i.call(e,t)};Gv(()=>{var e;s&&N.current.contains(document.activeElement)&&(null===(e=document.activeElement)||void 0===e||e.blur())},[s]),s&&-1!==w&&E(-1),s&&-1!==B&&z(-1);const H=e.useRef(void 0);let X=m;a&&"horizontal"===m&&(X+="-reverse");const q=e=>{let{finger:t,move:i=!1}=e;const{current:n}=N,{width:r,height:s,bottom:a,left:l}=n.getBoundingClientRect();let h,d;if(h=X.startsWith("vertical")?(a-t.y)/s:(t.x-l)/r,X.includes("-reverse")&&(h=1-h),d=function(e,t,i){return(i-t)*e+t}(h,u,c),_)d=ey(d,_,u);else{const e=Jv(O,d);d=O[e]}d=qv(d,u,c);let p=0;if(R){p=i?H.current:Jv(F,d),o&&(d=qv(d,F[p-1]||-1/0,F[p+1]||1/0));const e=d;d=ty({values:F,newValue:d,index:p}),o&&i||(p=d.indexOf(e),H.current=p)}return{newValue:d,activeIndex:p}},Z=Wv(e=>{const t=$v(e,x);if(!t)return;if(C.current+=1,"mousemove"===e.type&&0===e.buttons)return void Y(e);const{newValue:i,activeIndex:n}=q({finger:t,move:!0});iy({sliderRef:N,activeIndex:n,setActive:E}),k(i),!D&&C.current>2&&S(!0),M&&!ny(i,I)&&M(e,i,n)}),Y=Wv(e=>{const t=$v(e,x);if(S(!1),!t)return;const{newValue:i}=q({finger:t,move:!0});var n;(E(-1),"touchend"===e.type&&T(-1),p)&&p(e,null!==(n=P.current)&&void 0!==n?n:i);x.current=void 0,J()}),K=Wv(e=>{if(s)return;ay()||e.preventDefault();const t=e.changedTouches[0];null!=t&&(x.current=t.identifier);const i=$v(e,x);if(!1!==i){const{newValue:t,activeIndex:n}=q({finger:i});iy({sliderRef:N,activeIndex:n,setActive:E}),k(t),M&&!ny(t,I)&&M(e,t,n)}C.current=0;const n=Vv(N.current);n.addEventListener("touchmove",Z,{passive:!0}),n.addEventListener("touchend",Y,{passive:!0})}),J=e.useCallback(()=>{const e=Vv(N.current);e.removeEventListener("mousemove",Z),e.removeEventListener("mouseup",Y),e.removeEventListener("touchmove",Z),e.removeEventListener("touchend",Y)},[Y,Z]);e.useEffect(()=>{const{current:e}=N;return e.addEventListener("touchstart",K,{passive:ay()}),()=>{e.removeEventListener("touchstart",K),J()}},[J,K]),e.useEffect(()=>{s&&J()},[s,J]);const $=Qv(R?F[0]:u,u,c),Q=Qv(F[F.length-1],u,c)-$,ee=e=>t=>{var i;null===(i=e.onMouseLeave)||void 0===i||i.call(e,t),T(-1)};let te;"vertical"===m&&(te=a?"vertical-rl":"vertical-lr");return{active:w,axis:X,axisProps:ry,dragging:D,focusedThumbIndex:B,getHiddenInputProps:function(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=Ov(n),l={onChange:(d=o||{},e=>{var t;null===(t=d.onChange)||void 0===t||t.call(d,e),G(e,e.target.valueAsNumber)}),onFocus:j(o||{}),onBlur:V(o||{}),onKeyDown:W(o||{})};var d;const p=(0,r.A)((0,r.A)({},o),l);return(0,r.A)((0,r.A)((0,r.A)({tabIndex:y,"aria-labelledby":i,"aria-orientation":m,"aria-valuemax":g(c),"aria-valuemin":g(u),name:h,type:"range",min:t.min,max:t.max,step:null===t.step&&t.marks?"any":null!==(e=t.step)&&void 0!==e?e:void 0,disabled:s},n),p),{},{style:(0,r.A)((0,r.A)({},Xv),{},{direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:te})})},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Ov(e),i={onMouseDown:(n=t||{},e=>{var t;if(null===(t=n.onMouseDown)||void 0===t||t.call(n,e),s)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const i=$v(e,x);if(!1!==i){const{newValue:t,activeIndex:n}=q({finger:i});iy({sliderRef:N,activeIndex:n,setActive:E}),k(t),M&&!ny(t,I)&&M(e,t,n)}C.current=0;const r=Vv(N.current);r.addEventListener("mousemove",Z,{passive:!0}),r.addEventListener("mouseup",Y)})};var n;const o=(0,r.A)((0,r.A)({},t),i);return(0,r.A)((0,r.A)({},e),{},{ref:U},o)},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Ov(e),i={onMouseOver:(n=t||{},e=>{var t;null===(t=n.onMouseOver)||void 0===t||t.call(n,e);const i=Number(e.currentTarget.getAttribute("data-index"));T(i)}),onMouseLeave:ee(t||{})};var n;return(0,r.A)((0,r.A)((0,r.A)({},e),t),i)},marks:L,open:A,range:R,rootRef:U,trackLeap:Q,trackOffset:$,values:F,getThumbStyle:e=>({pointerEvents:-1!==w&&w!==e?"none":void 0})}}var cy=function(){function e(e){var t=this;this._insertTag=function(e){var i;i=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,i),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{i.insertRule(e,i.cssRules.length)}catch(hl){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),uy=Math.abs,hy=String.fromCharCode,dy=Object.assign;function py(e){return e.trim()}function my(e,t,i){return e.replace(t,i)}function fy(e,t){return e.indexOf(t)}function gy(e,t){return 0|e.charCodeAt(t)}function _y(e,t,i){return e.slice(t,i)}function vy(e){return e.length}function yy(e){return e.length}function by(e,t){return t.push(e),e}var xy=1,wy=1,Ey=0,Ay=0,Ty=0,Dy="";function Sy(e,t,i,n,r,s,o){return{value:e,root:t,parent:i,type:n,props:r,children:s,line:xy,column:wy,length:o,return:""}}function Cy(e,t){return dy(Sy("",null,null,"",null,null,0),e,{length:-e.length},t)}function Py(){return Ty=Ay>0?gy(Dy,--Ay):0,wy--,10===Ty&&(wy=1,xy--),Ty}function Iy(){return Ty=Ay<Ey?gy(Dy,Ay++):0,wy++,10===Ty&&(wy=1,xy++),Ty}function ky(){return gy(Dy,Ay)}function My(){return Ay}function Ry(e,t){return _y(Dy,e,t)}function Fy(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ly(e){return xy=wy=1,Ey=vy(Dy=e),Ay=0,[]}function Oy(e){return Dy="",e}function By(e){return py(Ry(Ay-1,Uy(91===e?e+2:40===e?e+1:e)))}function zy(e){for(;(Ty=ky())&&Ty<33;)Iy();return Fy(e)>2||Fy(Ty)>3?"":" "}function Ny(e,t){for(;--t&&Iy()&&!(Ty<48||Ty>102||Ty>57&&Ty<65||Ty>70&&Ty<97););return Ry(e,My()+(t<6&&32==ky()&&32==Iy()))}function Uy(e){for(;Iy();)switch(Ty){case e:return Ay;case 34:case 39:34!==e&&39!==e&&Uy(Ty);break;case 40:41===e&&Uy(e);break;case 92:Iy()}return Ay}function jy(e,t){for(;Iy()&&e+Ty!==57&&(e+Ty!==84||47!==ky()););return"/*"+Ry(t,Ay-1)+"*"+hy(47===e?e:Iy())}function Vy(e){for(;!Fy(ky());)Iy();return Ry(e,Ay)}var Gy="-ms-",Wy="-moz-",Hy="-webkit-",Xy="comm",qy="rule",Zy="decl",Yy="@keyframes";function Ky(e,t){for(var i="",n=yy(e),r=0;r<n;r++)i+=t(e[r],r,e,t)||"";return i}function Jy(e,t,i,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case Zy:return e.return=e.return||e.value;case Xy:return"";case Yy:return e.return=e.value+"{"+Ky(e.children,n)+"}";case qy:e.value=e.props.join(",")}return vy(i=Ky(e.children,n))?e.return=e.value+"{"+i+"}":""}function $y(e){return Oy(Qy("",null,null,null,[""],e=Ly(e),0,[0],e))}function Qy(e,t,i,n,r,s,o,a,l){for(var c=0,u=0,h=o,d=0,p=0,m=0,f=1,g=1,_=1,v=0,y="",b=r,x=s,w=n,E=y;g;)switch(m=v,v=Iy()){case 40:if(108!=m&&58==gy(E,h-1)){-1!=fy(E+=my(By(v),"&","&\f"),"&\f")&&(_=-1);break}case 34:case 39:case 91:E+=By(v);break;case 9:case 10:case 13:case 32:E+=zy(m);break;case 92:E+=Ny(My()-1,7);continue;case 47:switch(ky()){case 42:case 47:by(tb(jy(Iy(),My()),t,i),l);break;default:E+="/"}break;case 123*f:a[c++]=vy(E)*_;case 125*f:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+u:-1==_&&(E=my(E,/\f/g,"")),p>0&&vy(E)-h&&by(p>32?ib(E+";",n,i,h-1):ib(my(E," ","")+";",n,i,h-2),l);break;case 59:E+=";";default:if(by(w=eb(E,t,i,c,u,r,a,y,b=[],x=[],h),s),123===v)if(0===u)Qy(E,t,w,w,b,s,h,a,x);else switch(99===d&&110===gy(E,3)?100:d){case 100:case 108:case 109:case 115:Qy(e,w,w,n&&by(eb(e,w,w,0,0,r,a,y,r,b=[],h),x),r,x,h,a,n?b:x);break;default:Qy(E,w,w,w,[""],x,0,a,x)}}c=u=p=0,f=_=1,y=E="",h=o;break;case 58:h=1+vy(E),p=m;default:if(f<1)if(123==v)--f;else if(125==v&&0==f++&&125==Py())continue;switch(E+=hy(v),v*f){case 38:_=u>0?1:(E+="\f",-1);break;case 44:a[c++]=(vy(E)-1)*_,_=1;break;case 64:45===ky()&&(E+=By(Iy())),d=ky(),u=h=vy(y=E+=Vy(My())),v++;break;case 45:45===m&&2==vy(E)&&(f=0)}}return s}function eb(e,t,i,n,r,s,o,a,l,c,u){for(var h=r-1,d=0===r?s:[""],p=yy(d),m=0,f=0,g=0;m<n;++m)for(var _=0,v=_y(e,h+1,h=uy(f=o[m])),y=e;_<p;++_)(y=py(f>0?d[_]+" "+v:my(v,/&\f/g,d[_])))&&(l[g++]=y);return Sy(e,t,i,0===r?qy:a,l,c,u)}function tb(e,t,i){return Sy(e,t,i,Xy,hy(Ty),_y(e,2,-2),0)}function ib(e,t,i,n){return Sy(e,t,i,Zy,_y(e,0,n),_y(e,n+1,-1),n)}var nb=function(e,t,i){for(var n=0,r=0;n=r,r=ky(),38===n&&12===r&&(t[i]=1),!Fy(r);)Iy();return Ry(e,Ay)},rb=function(e,t){return Oy(function(e,t){var i=-1,n=44;do{switch(Fy(n)){case 0:38===n&&12===ky()&&(t[i]=1),e[i]+=nb(Ay-1,t,i);break;case 2:e[i]+=By(n);break;case 4:if(44===n){e[++i]=58===ky()?"&\f":"",t[i]=e[i].length;break}default:e[i]+=hy(n)}}while(n=Iy());return e}(Ly(e),t))},sb=new WeakMap,ob=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,i=e.parent,n=e.column===i.column&&e.line===i.line;"rule"!==i.type;)if(!(i=i.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||sb.get(i))&&!n){sb.set(e,!0);for(var r=[],s=rb(t,r),o=i.props,a=0,l=0;a<s.length;a++)for(var c=0;c<o.length;c++,l++)e.props[l]=r[a]?s[a].replace(/&\f/g,o[c]):o[c]+" "+s[a]}}},ab=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function lb(e,t){switch(function(e,t){return 45^gy(e,0)?(((t<<2^gy(e,0))<<2^gy(e,1))<<2^gy(e,2))<<2^gy(e,3):0}(e,t)){case 5103:return Hy+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Hy+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Hy+e+Wy+e+Gy+e+e;case 6828:case 4268:return Hy+e+Gy+e+e;case 6165:return Hy+e+Gy+"flex-"+e+e;case 5187:return Hy+e+my(e,/(\w+).+(:[^]+)/,Hy+"box-$1$2"+Gy+"flex-$1$2")+e;case 5443:return Hy+e+Gy+"flex-item-"+my(e,/flex-|-self/,"")+e;case 4675:return Hy+e+Gy+"flex-line-pack"+my(e,/align-content|flex-|-self/,"")+e;case 5548:return Hy+e+Gy+my(e,"shrink","negative")+e;case 5292:return Hy+e+Gy+my(e,"basis","preferred-size")+e;case 6060:return Hy+"box-"+my(e,"-grow","")+Hy+e+Gy+my(e,"grow","positive")+e;case 4554:return Hy+my(e,/([^-])(transform)/g,"$1"+Hy+"$2")+e;case 6187:return my(my(my(e,/(zoom-|grab)/,Hy+"$1"),/(image-set)/,Hy+"$1"),e,"")+e;case 5495:case 3959:return my(e,/(image-set\([^]*)/,Hy+"$1$`$1");case 4968:return my(my(e,/(.+:)(flex-)?(.*)/,Hy+"box-pack:$3"+Gy+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Hy+e+e;case 4095:case 3583:case 4068:case 2532:return my(e,/(.+)-inline(.+)/,Hy+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(vy(e)-1-t>6)switch(gy(e,t+1)){case 109:if(45!==gy(e,t+4))break;case 102:return my(e,/(.+:)(.+)-([^]+)/,"$1"+Hy+"$2-$3$1"+Wy+(108==gy(e,t+3)?"$3":"$2-$3"))+e;case 115:return~fy(e,"stretch")?lb(my(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==gy(e,t+1))break;case 6444:switch(gy(e,vy(e)-3-(~fy(e,"!important")&&10))){case 107:return my(e,":",":"+Hy)+e;case 101:return my(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Hy+(45===gy(e,14)?"inline-":"")+"box$3$1"+Hy+"$2$3$1"+Gy+"$2box$3")+e}break;case 5936:switch(gy(e,t+11)){case 114:return Hy+e+Gy+my(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Hy+e+Gy+my(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Hy+e+Gy+my(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Hy+e+Gy+e+e}return e}var cb=[function(e,t,i,n){if(e.length>-1&&!e.return)switch(e.type){case Zy:e.return=lb(e.value,e.length);break;case Yy:return Ky([Cy(e,{value:my(e.value,"@","@"+Hy)})],n);case qy:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ky([Cy(e,{props:[my(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Ky([Cy(e,{props:[my(t,/:(plac\w+)/,":"+Hy+"input-$1")]}),Cy(e,{props:[my(t,/:(plac\w+)/,":-moz-$1")]}),Cy(e,{props:[my(t,/:(plac\w+)/,Gy+"input-$1")]})],n)}return""})}}],ub=function(e){var t=e.key;if("css"===t){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var n,r,s=e.stylisPlugins||cb,o={},a=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),i=1;i<t.length;i++)o[t[i]]=!0;a.push(e)});var l,c,u=[Jy,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=yy(e);return function(i,n,r,s){for(var o="",a=0;a<t;a++)o+=e[a](i,n,r,s)||"";return o}}([ob,ab].concat(s,u));r=function(e,t,i,n){l=i,Ky($y(e?e+"{"+t.styles+"}":t.styles),h),n&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new cy({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:r};return d.sheet.hydrate(a),d};var hb={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function db(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}var pb=/[A-Z]|^ms/g,mb=/_EMO_([^_]+?)_([^]*?)_EMO_/g,fb=function(e){return 45===e.charCodeAt(1)},gb=function(e){return null!=e&&"boolean"!==typeof e},_b=db(function(e){return fb(e)?e:e.replace(pb,"-$&").toLowerCase()}),vb=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(mb,function(e,t,i){return bb={name:t,styles:i,next:bb},t})}return 1===hb[e]||fb(e)||"number"!==typeof t||0===t?t:t+"px"};function yb(e,t,i){if(null==i)return"";var n=i;if(void 0!==n.__emotion_styles)return n;switch(typeof i){case"boolean":return"";case"object":var r=i;if(1===r.anim)return bb={name:r.name,styles:r.styles,next:bb},r.name;var s=i;if(void 0!==s.styles){var o=s.next;if(void 0!==o)for(;void 0!==o;)bb={name:o.name,styles:o.styles,next:bb},o=o.next;return s.styles+";"}return function(e,t,i){var n="";if(Array.isArray(i))for(var r=0;r<i.length;r++)n+=yb(e,t,i[r])+";";else for(var s in i){var o=i[s];if("object"!==typeof o){var a=o;null!=t&&void 0!==t[a]?n+=s+"{"+t[a]+"}":gb(a)&&(n+=_b(s)+":"+vb(s,a)+";")}else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var l=yb(e,t,o);switch(s){case"animation":case"animationName":n+=_b(s)+":"+l+";";break;default:n+=s+"{"+l+"}"}}else for(var c=0;c<o.length;c++)gb(o[c])&&(n+=_b(s)+":"+vb(s,o[c])+";")}return n}(e,t,i);case"function":if(void 0!==e){var a=bb,l=i(e);return bb=a,yb(e,t,l)}}var c=i;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var bb,xb=/label:\s*([^\s;{]+)\s*(;|$)/g;function wb(e,t,i){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,r="";bb=void 0;var s=e[0];null==s||void 0===s.raw?(n=!1,r+=yb(i,t,s)):r+=s[0];for(var o=1;o<e.length;o++){if(r+=yb(i,t,e[o]),n)r+=s[o]}xb.lastIndex=0;for(var a,l="";null!==(a=xb.exec(r));)l+="-"+a[1];var c=function(e){for(var t,i=0,n=0,r=e.length;r>=4;++n,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),i=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(r){case 3:i^=(255&e.charCodeAt(n+2))<<16;case 2:i^=(255&e.charCodeAt(n+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(n)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}(r)+l;return{name:c,styles:r,next:bb}}var Eb=!!t.useInsertionEffect&&t.useInsertionEffect,Ab=Eb||function(e){return e()},Tb=(Eb||e.useLayoutEffect,e.createContext("undefined"!==typeof HTMLElement?ub({key:"css"}):null)),Db=(Tb.Provider,function(t){return(0,e.forwardRef)(function(i,n){var r=(0,e.useContext)(Tb);return t(i,r,n)})}),Sb=e.createContext({});var Cb=function(e,t,i){var n=e.key+"-"+t.name;!1===i&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},Pb=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ib=db(function(e){return Pb.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}),kb=function(e){return"theme"!==e},Mb=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Ib:kb},Rb=function(e,t,i){var n;if(t){var r=t.shouldForwardProp;n=e.__emotion_forwardProp&&r?function(t){return e.__emotion_forwardProp(t)&&r(t)}:r}return"function"!==typeof n&&i&&(n=e.__emotion_forwardProp),n},Fb=function(e){var t=e.cache,i=e.serialized,n=e.isStringTag;return Cb(t,i,n),Ab(function(){return function(e,t,i){Cb(e,t,i);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+n:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}}(t,i,n)}),null},Lb=function t(i,n){var r,s,o=i.__emotion_real===i,a=o&&i.__emotion_base||i;void 0!==n&&(r=n.label,s=n.target);var l=Rb(i,n,o),c=l||Mb(a),u=!c("as");return function(){var h=arguments,d=o&&void 0!==i.__emotion_styles?i.__emotion_styles.slice(0):[];if(void 0!==r&&d.push("label:"+r+";"),null==h[0]||void 0===h[0].raw)d.push.apply(d,h);else{var p=h[0];d.push(p[0]);for(var m=h.length,f=1;f<m;f++)d.push(h[f],p[f])}var g=Db(function(t,i,n){var r=u&&t.as||a,o="",h=[],p=t;if(null==t.theme){for(var m in p={},t)p[m]=t[m];p.theme=e.useContext(Sb)}"string"===typeof t.className?o=function(e,t,i){var n="";return i.split(" ").forEach(function(i){void 0!==e[i]?t.push(e[i]+";"):i&&(n+=i+" ")}),n}(i.registered,h,t.className):null!=t.className&&(o=t.className+" ");var f=wb(d.concat(h),i.registered,p);o+=i.key+"-"+f.name,void 0!==s&&(o+=" "+s);var g=u&&void 0===l?Mb(r):c,_={};for(var v in t)u&&"as"===v||g(v)&&(_[v]=t[v]);return _.className=o,n&&(_.ref=n),e.createElement(e.Fragment,null,e.createElement(Fb,{cache:i,serialized:f,isStringTag:"string"===typeof r}),e.createElement(r,_))});return g.displayName=void 0!==r?r:"Styled("+("string"===typeof a?a:a.displayName||a.name||"Component")+")",g.defaultProps=i.defaultProps,g.__emotion_real=g,g.__emotion_base=a,g.__emotion_styles=d,g.__emotion_forwardProp=l,Object.defineProperty(g,"toString",{value:function(){return"."+s}}),g.withComponent=function(e,i){return t(e,vd({},n,i,{shouldForwardProp:Rb(g,i,!0)})).apply(void 0,d)},g}}.bind(null);function Ob(e,t){return Lb(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(e){Lb[e]=Lb(e)});const Bb=[];function zb(e){return Bb[0]=e,wb(Bb)}var Nb=i(191);function Ub(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function jb(t){if(e.isValidElement(t)||(0,Nb.Hy)(t)||!Ub(t))return t;const i={};return Object.keys(t).forEach(e=>{i[e]=jb(t[e])}),i}function Vb(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const s=n.clone?(0,r.A)({},t):t;return Ub(t)&&Ub(i)&&Object.keys(i).forEach(r=>{e.isValidElement(i[r])||(0,Nb.Hy)(i[r])?s[r]=i[r]:Ub(i[r])&&Object.prototype.hasOwnProperty.call(t,r)&&Ub(t[r])?s[r]=Vb(t[r],i[r],n):n.clone?s[r]=Ub(i[r])?jb(i[r]):i[r]:s[r]=i[r]}),s}const Gb=["values","unit","step"];function Wb(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:n=5}=e,s=bg(e,Gb),o=(e=>{const t=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return t.sort((e,t)=>e.val-t.val),t.reduce((e,t)=>(0,r.A)((0,r.A)({},e),{},{[t.key]:t.val}),{})})(t),a=Object.keys(o);function l(e){const n="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(n).concat(i,")")}function c(e){const r="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(r-n/100).concat(i,")")}function u(e,r){const s=a.indexOf(r);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(i,") and ")+"(max-width:".concat((-1!==s&&"number"===typeof t[a[s]]?t[a[s]]:r)-n/100).concat(i,")")}return(0,r.A)({keys:a,values:o,up:l,down:c,between:u,only:function(e){return a.indexOf(e)+1<a.length?u(e,a[a.indexOf(e)+1]):l(e)},not:function(e){const t=a.indexOf(e);return 0===t?l(a[1]):t===a.length-1?c(a[t]):u(e,a[a.indexOf(e)+1]).replace("@media","@media not all and")},unit:i},s)}function Hb(e,t){if(!e.containerQueries)return t;const i=Object.keys(t).filter(e=>e.startsWith("@container")).sort((e,t)=>{var i,n;const r=/min-width:\s*([0-9.]+)/;return+((null===(i=e.match(r))||void 0===i?void 0:i[1])||0)-+((null===(n=t.match(r))||void 0===n?void 0:n[1])||0)});return i.length?i.reduce((e,i)=>{const n=t[i];return delete e[i],e[i]=n,e},(0,r.A)({},t)):t}const Xb={borderRadius:4},qb={xs:0,sm:600,md:900,lg:1200,xl:1536},Zb={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(qb[e],"px)")},Yb={containerQueries:e=>({up:t=>{let i="number"===typeof t?t:qb[t]||t;return"number"===typeof i&&(i="".concat(i,"px")),e?"@container ".concat(e," (min-width:").concat(i,")"):"@container (min-width:".concat(i,")")}})};function Kb(e,t,i){const n=e.theme||{};if(Array.isArray(t)){const e=n.breakpoints||Zb;return t.reduce((n,r,s)=>(n[e.up(e.keys[s])]=i(t[s]),n),{})}if("object"===typeof t){const e=n.breakpoints||Zb;return Object.keys(t).reduce((r,s)=>{if(function(e,t){return"@"===t||t.startsWith("@")&&(e.some(e=>t.startsWith("@".concat(e)))||!!t.match(/^@\d/))}(e.keys,s)){const e=function(e,t){const i=t.match(/^@([^/]+)?\/?(.+)?$/);if(!i)return null;const[,n,r]=i,s=Number.isNaN(+n)?n||0:+n;return e.containerQueries(r).up(s)}(n.containerQueries?n:Yb,s);e&&(r[e]=i(t[s],s))}else if(Object.keys(e.values||qb).includes(s)){r[e.up(s)]=i(t[s],s)}else{const e=s;r[e]=t[e]}return r},{})}return i(t)}function Jb(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null===(e=t.keys)||void 0===e?void 0:e.reduce((e,i)=>(e[t.up(i)]={},e),{}))||{}}function $b(e,t){return e.reduce((e,t)=>{const i=e[t];return(!i||0===Object.keys(i).length)&&delete e[t],e},t)}function Qb(e){const t=new URL("https://mui.com/production-error/?code=".concat(e));for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n.forEach(e=>t.searchParams.append("args[]",e)),"Minified MUI error #".concat(e,"; visit ").concat(t," for the full message.")}function ex(e){if("string"!==typeof e)throw new Error(Qb(7));return e.charAt(0).toUpperCase()+e.slice(1)}function tx(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&i){const i="vars.".concat(t).split(".").reduce((e,t)=>e&&e[t]?e[t]:null,e);if(null!=i)return i}return t.split(".").reduce((e,t)=>e&&null!=e[t]?e[t]:null,e)}function ix(e,t,i){let n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;return n="function"===typeof e?e(i):Array.isArray(e)?e[i]||r:tx(e,i)||r,t&&(n=t(n,r,e)),n}const nx=function(e){const{prop:t,cssProperty:i=e.prop,themeKey:n,transform:r}=e,s=e=>{if(null==e[t])return null;const s=e[t],o=tx(e.theme,n)||{};return Kb(e,s,e=>{let n=ix(o,r,e);return e===n&&"string"===typeof e&&(n=ix(o,r,"".concat(t).concat("default"===e?"":ex(e)),e)),!1===i?n:{[i]:n}})};return s.propTypes={},s.filterProps=[t],s};const rx=function(e,t){return t?Vb(e,t,{clone:!1}):e};const sx={m:"margin",p:"padding"},ox={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},ax={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},lx=function(e){const t={};return i=>(void 0===t[i]&&(t[i]=e(i)),t[i])}(e=>{if(e.length>2){if(!ax[e])return[e];e=ax[e]}const[t,i]=e.split(""),n=sx[t],r=ox[i]||"";return Array.isArray(r)?r.map(e=>n+e):[n+r]}),cx=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],ux=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],hx=[...cx,...ux];function dx(e,t,i,n){var r;const s=null!==(r=tx(e,t,!0))&&void 0!==r?r:i;return"number"===typeof s||"string"===typeof s?e=>"string"===typeof e?e:"string"===typeof s?s.startsWith("var(")&&0===e?0:s.startsWith("var(")&&1===e?s:"calc(".concat(e," * ").concat(s,")"):s*e:Array.isArray(s)?e=>{if("string"===typeof e)return e;const t=Math.abs(e);const i=s[t];return e>=0?i:"number"===typeof i?-i:"string"===typeof i&&i.startsWith("var(")?"calc(-1 * ".concat(i,")"):"-".concat(i)}:"function"===typeof s?s:()=>{}}function px(e){return dx(e,"spacing",8)}function mx(e,t){return"string"===typeof t||null==t?t:e(t)}function fx(e,t,i,n){if(!t.includes(i))return null;const r=function(e,t){return i=>e.reduce((e,n)=>(e[n]=mx(t,i),e),{})}(lx(i),n);return Kb(e,e[i],r)}function gx(e,t){const i=px(e.theme);return Object.keys(e).map(n=>fx(e,t,n,i)).reduce(rx,{})}function _x(e){return gx(e,cx)}function vx(e){return gx(e,ux)}function yx(e){return gx(e,hx)}_x.propTypes={},_x.filterProps=cx,vx.propTypes={},vx.filterProps=ux,yx.propTypes={},yx.filterProps=hx;function bx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:px({spacing:e});if(e.mui)return e;const i=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(0===i.length?[1]:i).map(e=>{const i=t(e);return"number"===typeof i?"".concat(i,"px"):i}).join(" ")};return i.mui=!0,i}const xx=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=t.reduce((e,t)=>(t.filterProps.forEach(i=>{e[i]=t}),e),{}),r=e=>Object.keys(e).reduce((t,i)=>n[i]?rx(t,n[i](e)):t,{});return r.propTypes={},r.filterProps=t.reduce((e,t)=>e.concat(t.filterProps),[]),r};function wx(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function Ex(e,t){return nx({prop:e,themeKey:"borders",transform:t})}const Ax=Ex("border",wx),Tx=Ex("borderTop",wx),Dx=Ex("borderRight",wx),Sx=Ex("borderBottom",wx),Cx=Ex("borderLeft",wx),Px=Ex("borderColor"),Ix=Ex("borderTopColor"),kx=Ex("borderRightColor"),Mx=Ex("borderBottomColor"),Rx=Ex("borderLeftColor"),Fx=Ex("outline",wx),Lx=Ex("outlineColor"),Ox=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=dx(e.theme,"shape.borderRadius",4),i=e=>({borderRadius:mx(t,e)});return Kb(e,e.borderRadius,i)}return null};Ox.propTypes={},Ox.filterProps=["borderRadius"];xx(Ax,Tx,Dx,Sx,Cx,Px,Ix,kx,Mx,Rx,Ox,Fx,Lx);const Bx=e=>{if(void 0!==e.gap&&null!==e.gap){const t=dx(e.theme,"spacing",8),i=e=>({gap:mx(t,e)});return Kb(e,e.gap,i)}return null};Bx.propTypes={},Bx.filterProps=["gap"];const zx=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=dx(e.theme,"spacing",8),i=e=>({columnGap:mx(t,e)});return Kb(e,e.columnGap,i)}return null};zx.propTypes={},zx.filterProps=["columnGap"];const Nx=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=dx(e.theme,"spacing",8),i=e=>({rowGap:mx(t,e)});return Kb(e,e.rowGap,i)}return null};Nx.propTypes={},Nx.filterProps=["rowGap"];xx(Bx,zx,Nx,nx({prop:"gridColumn"}),nx({prop:"gridRow"}),nx({prop:"gridAutoFlow"}),nx({prop:"gridAutoColumns"}),nx({prop:"gridAutoRows"}),nx({prop:"gridTemplateColumns"}),nx({prop:"gridTemplateRows"}),nx({prop:"gridTemplateAreas"}),nx({prop:"gridArea"}));function Ux(e,t){return"grey"===t?t:e}xx(nx({prop:"color",themeKey:"palette",transform:Ux}),nx({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Ux}),nx({prop:"backgroundColor",themeKey:"palette",transform:Ux}));function jx(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const Vx=nx({prop:"width",transform:jx}),Gx=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var i,n;const r=(null===(i=e.theme)||void 0===i||null===(i=i.breakpoints)||void 0===i||null===(i=i.values)||void 0===i?void 0:i[t])||qb[t];return r?"px"!==(null===(n=e.theme)||void 0===n||null===(n=n.breakpoints)||void 0===n?void 0:n.unit)?{maxWidth:"".concat(r).concat(e.theme.breakpoints.unit)}:{maxWidth:r}:{maxWidth:jx(t)}};return Kb(e,e.maxWidth,t)}return null};Gx.filterProps=["maxWidth"];const Wx=nx({prop:"minWidth",transform:jx}),Hx=nx({prop:"height",transform:jx}),Xx=nx({prop:"maxHeight",transform:jx}),qx=nx({prop:"minHeight",transform:jx}),Zx=(nx({prop:"size",cssProperty:"width",transform:jx}),nx({prop:"size",cssProperty:"height",transform:jx}),xx(Vx,Gx,Wx,Hx,Xx,qx,nx({prop:"boxSizing"})),{border:{themeKey:"borders",transform:wx},borderTop:{themeKey:"borders",transform:wx},borderRight:{themeKey:"borders",transform:wx},borderBottom:{themeKey:"borders",transform:wx},borderLeft:{themeKey:"borders",transform:wx},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:wx},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Ox},color:{themeKey:"palette",transform:Ux},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Ux},backgroundColor:{themeKey:"palette",transform:Ux},p:{style:vx},pt:{style:vx},pr:{style:vx},pb:{style:vx},pl:{style:vx},px:{style:vx},py:{style:vx},padding:{style:vx},paddingTop:{style:vx},paddingRight:{style:vx},paddingBottom:{style:vx},paddingLeft:{style:vx},paddingX:{style:vx},paddingY:{style:vx},paddingInline:{style:vx},paddingInlineStart:{style:vx},paddingInlineEnd:{style:vx},paddingBlock:{style:vx},paddingBlockStart:{style:vx},paddingBlockEnd:{style:vx},m:{style:_x},mt:{style:_x},mr:{style:_x},mb:{style:_x},ml:{style:_x},mx:{style:_x},my:{style:_x},margin:{style:_x},marginTop:{style:_x},marginRight:{style:_x},marginBottom:{style:_x},marginLeft:{style:_x},marginX:{style:_x},marginY:{style:_x},marginInline:{style:_x},marginInlineStart:{style:_x},marginInlineEnd:{style:_x},marginBlock:{style:_x},marginBlockStart:{style:_x},marginBlockEnd:{style:_x},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Bx},rowGap:{style:Nx},columnGap:{style:zx},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:jx},maxWidth:{style:Gx},minWidth:{transform:jx},height:{transform:jx},maxHeight:{transform:jx},minHeight:{transform:jx},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const Yx=function(){function e(e,t,i,n){const r={[e]:t,theme:i},s=n[e];if(!s)return{[e]:t};const{cssProperty:o=e,themeKey:a,transform:l,style:c}=s;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=tx(i,a)||{};if(c)return c(r);return Kb(r,t,t=>{let i=ix(u,l,t);return t===i&&"string"===typeof t&&(i=ix(u,l,"".concat(e).concat("default"===t?"":ex(t)),t)),!1===o?i:{[o]:i}})}return function t(i){var n;const{sx:r,theme:s={},nested:o}=i||{};if(!r)return null;const a=null!==(n=s.unstable_sxConfig)&&void 0!==n?n:Zx;function l(i){let n=i;if("function"===typeof i)n=i(s);else if("object"!==typeof i)return i;if(!n)return null;const r=Jb(s.breakpoints),l=Object.keys(r);let c=r;return Object.keys(n).forEach(i=>{const r=function(e,t){return"function"===typeof e?e(t):e}(n[i],s);if(null!==r&&void 0!==r)if("object"===typeof r)if(a[i])c=rx(c,e(i,r,s,a));else{const e=Kb({theme:s},r,e=>({[i]:e}));!function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=t.reduce((e,t)=>e.concat(Object.keys(t)),[]),r=new Set(n);return t.every(e=>r.size===Object.keys(e).length)}(e,r)?c=rx(c,e):c[i]=t({sx:r,theme:s,nested:!0})}else c=rx(c,e(i,r,s,a))}),!o&&s.modularCssLayers?{"@layer sx":Hb(s,$b(l,c))}:Hb(s,$b(l,c))}return Array.isArray(r)?r.map(l):l(r)}}();Yx.filterProps=["sx"];const Kx=Yx;function Jx(e,t){const i=this;if(i.vars){var n;if(null===(n=i.colorSchemes)||void 0===n||!n[e]||"function"!==typeof i.getColorSchemeSelector)return{};let r=i.getColorSchemeSelector(e);return"&"===r?t:((r.includes("data-")||r.includes("."))&&(r="*:where(".concat(r.replace(/\s*&$/,""),") &")),{[r]:t})}return i.palette.mode===e?t:{}}const $x=["breakpoints","palette","spacing","shape"];const Qx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:i={},spacing:n,shape:s={}}=e,o=bg(e,$x),a=Wb(t),l=bx(n);let c=Vb({breakpoints:a,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},i),spacing:l,shape:(0,r.A)((0,r.A)({},Xb),s)},o);c=function(e){const t=(e,t)=>e.replace("@media",t?"@container ".concat(t):"@container");function i(i,n){i.up=function(){return t(e.breakpoints.up(...arguments),n)},i.down=function(){return t(e.breakpoints.down(...arguments),n)},i.between=function(){return t(e.breakpoints.between(...arguments),n)},i.only=function(){return t(e.breakpoints.only(...arguments),n)},i.not=function(){const i=t(e.breakpoints.not(...arguments),n);return i.includes("not all and")?i.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):i}}const n={},s=e=>(i(n,e),n);return i(s),(0,r.A)((0,r.A)({},e),{},{containerQueries:s})}(c),c.applyStyles=Jx;for(var u=arguments.length,h=new Array(u>1?u-1:0),d=1;d<u;d++)h[d-1]=arguments[d];return c=h.reduce((e,t)=>Vb(e,t),c),c.unstable_sxConfig=(0,r.A)((0,r.A)({},Zx),null===o||void 0===o?void 0:o.unstable_sxConfig),c.unstable_sx=function(e){return Kx({sx:e,theme:this})},c},ew=["variants"];function tw(e){const{variants:t}=e,i=bg(e,ew),n={variants:t,style:zb(i),isProcessed:!0};return n.style===i||t&&t.forEach(e=>{"function"!==typeof e.style&&(e.style=zb(e.style))}),n}const iw=["variants"],nw=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],rw=Qx();function sw(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function ow(e,t){return t&&e&&"object"===typeof e&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles="@layer ".concat(t,"{").concat(String(e.styles),"}")),e}function aw(e){return e?(t,i)=>i[e]:null}function lw(e,t,i){const n="function"===typeof t?t(e):t;if(Array.isArray(n))return n.flatMap(t=>lw(e,t,i));if(Array.isArray(null===n||void 0===n?void 0:n.variants)){let t;if(n.isProcessed)t=i?ow(n.style,i):n.style;else{const{variants:e}=n,r=bg(n,iw);t=i?ow(zb(r),i):r}return cw(e,n.variants,[t],i)}return null!==n&&void 0!==n&&n.isProcessed?i?ow(zb(n.style),i):n.style:i?ow(zb(n),i):n}function cw(e,t){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;e:for(let a=0;a<t.length;a+=1){const l=t[a];if("function"===typeof l.props){if(null!==i&&void 0!==i||(i=(0,r.A)((0,r.A)((0,r.A)({},e),e.ownerState),{},{ownerState:e.ownerState})),!l.props(i))continue}else for(const t in l.props){var o;if(e[t]!==l.props[t]&&(null===(o=e.ownerState)||void 0===o?void 0:o[t])!==l.props[t])continue e}"function"===typeof l.style?(null!==i&&void 0!==i||(i=(0,r.A)((0,r.A)((0,r.A)({},e),e.ownerState),{},{ownerState:e.ownerState})),n.push(s?ow(zb(l.style(i)),s):l.style(i))):n.push(s?ow(zb(l.style),s):l.style)}return n}function uw(e,t){}function hw(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}function dw(e){return qv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function pw(e){if(e.type)return e;if("#"===e.charAt(0))return pw(function(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let i=e.match(t);return i&&1===i[0].length&&(i=i.map(e=>e+e)),i?"rgb".concat(4===i.length?"a":"","(").concat(i.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", "),")"):""}(e));const t=e.indexOf("("),i=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw new Error(Qb(9,e));let n,r=e.substring(t+1,e.length-1);if("color"===i){if(r=r.split(" "),n=r.shift(),4===r.length&&"/"===r[3].charAt(0)&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(n))throw new Error(Qb(10,n))}else r=r.split(",");return r=r.map(e=>parseFloat(e)),{type:i,values:r,colorSpace:n}}const mw=(e,t)=>{try{return(e=>{const t=pw(e);return t.values.slice(0,3).map((e,i)=>t.type.includes("hsl")&&0!==i?"".concat(e,"%"):e).join(" ")})(e)}catch(i){return e}};function fw(e){const{type:t,colorSpace:i}=e;let{values:n}=e;return t.includes("rgb")?n=n.map((e,t)=>t<3?parseInt(e,10):e):t.includes("hsl")&&(n[1]="".concat(n[1],"%"),n[2]="".concat(n[2],"%")),n=t.includes("color")?"".concat(i," ").concat(n.join(" ")):"".concat(n.join(", ")),"".concat(t,"(").concat(n,")")}function gw(e){e=pw(e);const{values:t}=e,i=t[0],n=t[1]/100,r=t[2]/100,s=n*Math.min(r,1-r),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+i/30)%12;return r-s*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const l=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),fw({type:a,values:l})}function _w(e){let t="hsl"===(e=pw(e)).type||"hsla"===e.type?pw(gw(e)).values:e.values;return t=t.map(t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function vw(e,t){return e=pw(e),t=dw(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,fw(e)}function yw(e,t,i){try{return vw(e,t)}catch(n){return e}}function bw(e,t){if(e=pw(e),t=dw(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return fw(e)}function xw(e,t,i){try{return bw(e,t)}catch(n){return e}}function ww(e,t){if(e=pw(e),t=dw(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return fw(e)}function Ew(e,t,i){try{return ww(e,t)}catch(n){return e}}function Aw(e,t,i){try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return _w(e)>.5?bw(e,t):ww(e,t)}(e,t)}catch(n){return e}}const Tw={black:"#000",white:"#fff"},Dw={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Sw={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Cw={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Pw={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Iw={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},kw={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Mw={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Rw=["mode","contrastThreshold","tonalOffset","colorSpace"];function Fw(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Tw.white,default:Tw.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Lw=Fw();function Ow(){return{text:{primary:Tw.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Tw.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Bw=Ow();function zw(e,t,i,n){const r=n.light||n,s=n.dark||1.5*n;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:"light"===t?e.light=ww(e.main,r):"dark"===t&&(e.dark=bw(e.main,s)))}function Nw(e,t,i,n,r){const s=r.light||r,o=r.dark||1.5*r;t[i]||(t.hasOwnProperty(n)?t[i]=t[n]:"light"===i?t.light="color-mix(in ".concat(e,", ").concat(t.main,", #fff ").concat((100*s).toFixed(0),"%)"):"dark"===i&&(t.dark="color-mix(in ".concat(e,", ").concat(t.main,", #000 ").concat((100*o).toFixed(0),"%)")))}function Uw(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:n=.2,colorSpace:s}=e,o=bg(e,Rw),a=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Iw[200],light:Iw[50],dark:Iw[400]}:{main:Iw[700],light:Iw[400],dark:Iw[800]}}(t),l=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Sw[200],light:Sw[50],dark:Sw[400]}:{main:Sw[500],light:Sw[300],dark:Sw[700]}}(t),c=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Cw[500],light:Cw[300],dark:Cw[700]}:{main:Cw[700],light:Cw[400],dark:Cw[800]}}(t),u=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:kw[400],light:kw[300],dark:kw[700]}:{main:kw[700],light:kw[500],dark:kw[900]}}(t),h=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Mw[400],light:Mw[300],dark:Mw[700]}:{main:Mw[800],light:Mw[500],dark:Mw[900]}}(t),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Pw[400],light:Pw[300],dark:Pw[700]}:{main:"#ed6c02",light:Pw[500],dark:Pw[900]}}(t);function p(e){if(s)return function(e){return"oklch(from ".concat(e," var(--__l) 0 h / var(--__a))")}(e);const t=function(e,t){const i=_w(e),n=_w(t);return(Math.max(i,n)+.05)/(Math.min(i,n)+.05)}(e,Bw.text.primary)>=i?Bw.text.primary:Lw.text.primary;return t}const m=e=>{let{color:t,name:i,mainShade:o=500,lightShade:a=300,darkShade:l=700}=e;if(t=(0,r.A)({},t),!t.main&&t[o]&&(t.main=t[o]),!t.hasOwnProperty("main"))throw new Error(Qb(11,i?" (".concat(i,")"):"",o));if("string"!==typeof t.main)throw new Error(Qb(12,i?" (".concat(i,")"):"",JSON.stringify(t.main)));return s?(Nw(s,t,"light",a,n),Nw(s,t,"dark",l,n)):(zw(t,"light",a,n),zw(t,"dark",l,n)),t.contrastText||(t.contrastText=p(t.main)),t};let f;"light"===t?f=Fw():"dark"===t&&(f=Ow());return Vb((0,r.A)({common:(0,r.A)({},Tw),mode:t,primary:m({color:a,name:"primary"}),secondary:m({color:l,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:c,name:"error"}),warning:m({color:d,name:"warning"}),info:m({color:u,name:"info"}),success:m({color:h,name:"success"}),grey:Dw,contrastThreshold:i,getContrastText:p,augmentColor:m,tonalOffset:n},f),o)}function jw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";function t(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];if(!n.length)return"";const s=n[0];return"string"!==typeof s||s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?", ".concat(s):", var(--".concat(e?"".concat(e,"-"):"").concat(s).concat(t(...n.slice(1)),")")}return function(i){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return"var(--".concat(e?"".concat(e,"-"):"").concat(i).concat(t(...r),")")}}function Vw(e){const t={};return Object.entries(e).forEach(e=>{const[i,n]=e;"object"===typeof n&&(t[i]="".concat(n.fontStyle?"".concat(n.fontStyle," "):"").concat(n.fontVariant?"".concat(n.fontVariant," "):"").concat(n.fontWeight?"".concat(n.fontWeight," "):"").concat(n.fontStretch?"".concat(n.fontStretch," "):"").concat(n.fontSize||"").concat(n.lineHeight?"/".concat(n.lineHeight," "):"").concat(n.fontFamily||""))}),t}const Gw=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=e;t.forEach((e,s)=>{s===t.length-1?Array.isArray(r)?r[Number(e)]=i:r&&"object"===typeof r&&(r[e]=i):r&&"object"===typeof r&&(r[e]||(r[e]=n.includes(e)?[]:{}),r=r[e])})};function Ww(e,t){const{prefix:i,shouldSkipGeneratingVar:n}=t||{},r={},s={},o={};var a,l;return a=(e,t,a)=>{if(("string"===typeof t||"number"===typeof t)&&(!n||!n(e,t))){const n="--".concat(i?"".concat(i,"-"):"").concat(e.join("-")),l=((e,t)=>"number"===typeof t?["lineHeight","fontWeight","opacity","zIndex"].some(t=>e.includes(t))||e[e.length-1].toLowerCase().includes("opacity")?t:"".concat(t,"px"):t)(e,t);Object.assign(r,{[n]:l}),Gw(s,e,"var(".concat(n,")"),a),Gw(o,e,"var(".concat(n,", ").concat(l,")"),a)}},l=e=>"vars"===e[0],function e(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.entries(t).forEach(t=>{let[r,s]=t;(!l||l&&!l([...i,r]))&&void 0!==s&&null!==s&&("object"===typeof s&&Object.keys(s).length>0?e(s,[...i,r],Array.isArray(s)?[...n,r]:n):a([...i,r],s,n))})}(e),{css:r,vars:s,varsWithDefaults:o}}const Hw=["colorSchemes","components","defaultColorScheme"];const Xw=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getSelector:i=v,disableCssColorScheme:n,colorSchemeSelector:s,enableContrastVars:o}=t,{colorSchemes:a={},components:l,defaultColorScheme:c="light"}=e,u=bg(e,Hw),{vars:h,css:d,varsWithDefaults:p}=Ww(u,t);let m=p;const f={},{[c]:g}=a,_=bg(a,[c].map(Lp.A));if(Object.entries(_||{}).forEach(e=>{let[i,n]=e;const{vars:r,css:s,varsWithDefaults:o}=Ww(n,t);m=Vb(m,o),f[i]={css:s,vars:r}}),g){const{css:e,vars:i,varsWithDefaults:n}=Ww(g,t);m=Vb(m,n),f[c]={css:e,vars:i}}function v(t,i){let n=s;if("class"===s&&(n=".%s"),"data"===s&&(n="[data-%s]"),null!==s&&void 0!==s&&s.startsWith("data-")&&!s.includes("%s")&&(n="[".concat(s,'="%s"]')),t){if("media"===n){var r;if(e.defaultColorScheme===t)return":root";const n=(null===(r=a[t])||void 0===r||null===(r=r.palette)||void 0===r?void 0:r.mode)||t;return{["@media (prefers-color-scheme: ".concat(n,")")]:{":root":i}}}if(n)return e.defaultColorScheme===t?":root, ".concat(n.replace("%s",String(t))):n.replace("%s",String(t))}return":root"}return{vars:m,generateThemeVars:()=>{let e=(0,r.A)({},h);return Object.entries(f).forEach(t=>{let[,{vars:i}]=t;e=Vb(e,i)}),e},generateStyleSheets:()=>{const t=[],s=e.defaultColorScheme||"light";function l(e,i){Object.keys(i).length&&t.push("string"===typeof e?{[e]:(0,r.A)({},i)}:e)}l(i(void 0,(0,r.A)({},d)),d);const{[s]:c}=f,u=bg(f,[s].map(Lp.A));if(c){var h;const{css:e}=c,t=null===(h=a[s])||void 0===h||null===(h=h.palette)||void 0===h?void 0:h.mode,o=!n&&t?(0,r.A)({colorScheme:t},e):(0,r.A)({},e);l(i(s,(0,r.A)({},o)),o)}return Object.entries(u).forEach(e=>{var t;let[s,{css:o}]=e;const c=null===(t=a[s])||void 0===t||null===(t=t.palette)||void 0===t?void 0:t.mode,u=!n&&c?(0,r.A)({colorScheme:c},o):(0,r.A)({},o);l(i(s,(0,r.A)({},u)),u)}),o&&t.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),t}}};function qw(e,t){return(0,r.A)({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const Zw=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const Yw={textTransform:"uppercase"},Kw='"Roboto", "Helvetica", "Arial", sans-serif';function Jw(e,t){const i="function"===typeof t?t(e):t,{fontFamily:n=Kw,fontSize:s=14,fontWeightLight:o=300,fontWeightRegular:a=400,fontWeightMedium:l=500,fontWeightBold:c=700,htmlFontSize:u=16,allVariants:h,pxToRem:d}=i,p=bg(i,Zw);const m=s/14,f=d||(e=>"".concat(e/u*m,"rem")),g=(e,t,i,s,o)=>{return(0,r.A)((0,r.A)((0,r.A)({fontFamily:n,fontWeight:e,fontSize:f(t),lineHeight:i},n===Kw?{letterSpacing:"".concat((a=s/t,Math.round(1e5*a)/1e5),"em")}:{}),o),h);var a},_={h1:g(o,96,1.167,-1.5),h2:g(o,60,1.2,-.5),h3:g(a,48,1.167,0),h4:g(a,34,1.235,.25),h5:g(a,24,1.334,0),h6:g(l,20,1.6,.15),subtitle1:g(a,16,1.75,.15),subtitle2:g(l,14,1.57,.1),body1:g(a,16,1.5,.15),body2:g(a,14,1.43,.15),button:g(l,14,1.75,.4,Yw),caption:g(a,12,1.66,.4),overline:g(a,12,2.66,1,Yw),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Vb((0,r.A)({htmlFontSize:u,pxToRem:f,fontFamily:n,fontSize:s,fontWeightLight:o,fontWeightRegular:a,fontWeightMedium:l,fontWeightBold:c},_),p,{clone:!1})}function $w(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const Qw=["none",$w(0,2,1,-1,0,1,1,0,0,1,3,0),$w(0,3,1,-2,0,2,2,0,0,1,5,0),$w(0,3,3,-2,0,3,4,0,0,1,8,0),$w(0,2,4,-1,0,4,5,0,0,1,10,0),$w(0,3,5,-1,0,5,8,0,0,1,14,0),$w(0,3,5,-1,0,6,10,0,0,1,18,0),$w(0,4,5,-2,0,7,10,1,0,2,16,1),$w(0,5,5,-3,0,8,10,1,0,3,14,2),$w(0,5,6,-3,0,9,12,1,0,3,16,2),$w(0,6,6,-3,0,10,14,1,0,4,18,3),$w(0,6,7,-4,0,11,15,1,0,4,20,3),$w(0,7,8,-4,0,12,17,2,0,5,22,4),$w(0,7,8,-4,0,13,19,2,0,5,24,4),$w(0,7,9,-4,0,14,21,2,0,5,26,4),$w(0,8,9,-5,0,15,22,2,0,6,28,5),$w(0,8,10,-5,0,16,24,2,0,6,30,5),$w(0,8,11,-5,0,17,26,2,0,6,32,5),$w(0,9,11,-5,0,18,28,2,0,7,34,6),$w(0,9,12,-6,0,19,29,2,0,7,36,6),$w(0,10,13,-6,0,20,31,3,0,8,38,7),$w(0,10,13,-6,0,21,33,3,0,8,40,7),$w(0,10,14,-6,0,22,35,3,0,8,42,7),$w(0,11,14,-7,0,23,36,3,0,9,44,8),$w(0,11,15,-7,0,24,38,3,0,9,46,8)],eE=["duration","easing","delay"],tE={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},iE={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function nE(e){return"".concat(Math.round(e),"ms")}function rE(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function sE(e){const t=(0,r.A)((0,r.A)({},tE),e.easing),i=(0,r.A)((0,r.A)({},iE),e.duration);return(0,r.A)((0,r.A)({getAutoHeightDuration:rE,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:r=i.standard,easing:s=t.easeInOut,delay:o=0}=n;bg(n,eE);return(Array.isArray(e)?e:[e]).map(e=>"".concat(e," ").concat("string"===typeof r?r:nE(r)," ").concat(s," ").concat("string"===typeof o?o:nE(o))).join(",")}},e),{},{easing:t,duration:i})}const oE={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function aE(e){return Ub(e)||"undefined"===typeof e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)}function lE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,r.A)({},e);return function e(t){const i=Object.entries(t);for(let n=0;n<i.length;n++){const[s,o]=i[n];!aE(o)||s.startsWith("unstable_")?delete t[s]:Ub(o)&&(t[s]=(0,r.A)({},o),e(t[s]))}}(t),"import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ".concat(JSON.stringify(t,null,2),";\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;")}const cE=["breakpoints","mixins","spacing","palette","transitions","typography","shape","colorSpace"];function uE(e){return"number"===typeof e?"".concat((100*e).toFixed(0),"%"):"calc((".concat(e,") * 100%)")}function hE(e){Object.assign(e,{alpha(t,i){const n=this||e;return n.colorSpace?"oklch(from ".concat(t," l c h / ").concat("string"===typeof i?"calc(".concat(i,")"):i,")"):n.vars?"rgba(".concat(t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")," / ").concat("string"===typeof i?"calc(".concat(i,")"):i,")"):vw(t,(e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let i=0;for(let n=0;n<t.length;n+=1)i+=+t[n];return i})(i))},lighten(t,i){const n=this||e;return n.colorSpace?"color-mix(in ".concat(n.colorSpace,", ").concat(t,", #fff ").concat(uE(i),")"):ww(t,i)},darken(t,i){const n=this||e;return n.colorSpace?"color-mix(in ".concat(n.colorSpace,", ").concat(t,", #000 ").concat(uE(i),")"):bw(t,i)}})}const dE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t,mixins:i={},spacing:n,palette:s={},transitions:o={},typography:a={},shape:l,colorSpace:c}=e,u=bg(e,cE);if(e.vars&&void 0===e.generateThemeVars)throw new Error(Qb(20));const h=Uw((0,r.A)((0,r.A)({},s),{},{colorSpace:c})),d=Qx(e);let p=Vb(d,{mixins:qw(d.breakpoints,i),palette:h,shadows:Qw.slice(),typography:Jw(h,a),transitions:sE(o),zIndex:(0,r.A)({},oE)});p=Vb(p,u);for(var m=arguments.length,f=new Array(m>1?m-1:0),g=1;g<m;g++)f[g-1]=arguments[g];return p=f.reduce((e,t)=>Vb(e,t),p),p.unstable_sxConfig=(0,r.A)((0,r.A)({},Zx),null===u||void 0===u?void 0:u.unstable_sxConfig),p.unstable_sx=function(e){return Kx({sx:e,theme:this})},p.toRuntimeSource=lE,hE(p),p};const pE=["palette","opacity","overlays","colorSpace"],mE=[...Array(25)].map((e,t)=>{if(0===t)return"none";const i=function(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}(t);return"linear-gradient(rgba(255 255 255 / ".concat(i,"), rgba(255 255 255 / ").concat(i,"))")});function fE(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function gE(e){return"dark"===e?mE:[]}function _E(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!(null===(t=e[1])||void 0===t||!t.match(/(mode|contrastThreshold|tonalOffset)/))}const vE=e=>[...[...Array(25)].map((t,i)=>"--".concat(e?"".concat(e,"-"):"","overlays-").concat(i)),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkBg"),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkColor")],yE=e=>(t,i)=>{const n=e.rootSelector||":root",s=e.colorSchemeSelector;let o=s;if("class"===s&&(o=".%s"),"data"===s&&(o="[data-%s]"),null!==s&&void 0!==s&&s.startsWith("data-")&&!s.includes("%s")&&(o="[".concat(s,'="%s"]')),e.defaultColorScheme===t){if("dark"===t){const s={};return vE(e.cssVarPrefix).forEach(e=>{s[e]=i[e],delete i[e]}),"media"===o?{[n]:i,"@media (prefers-color-scheme: dark)":{[n]:s}}:o?{[o.replace("%s",t)]:s,["".concat(n,", ").concat(o.replace("%s",t))]:i}:{[n]:(0,r.A)((0,r.A)({},i),s)}}if(o&&"media"!==o)return"".concat(n,", ").concat(o.replace("%s",String(t)))}else if(t){if("media"===o)return{["@media (prefers-color-scheme: ".concat(String(t),")")]:{[n]:i}};if(o)return o.replace("%s",String(t))}return n},bE=["palette"],xE=["colorSchemes","defaultColorScheme","disableCssColorScheme","cssVarPrefix","nativeColor","shouldSkipGeneratingVar","colorSchemeSelector","rootSelector"];function wE(e,t,i){!e[t]&&i&&(e[t]=i)}function EE(e){return"string"===typeof e&&e.startsWith("hsl")?gw(e):e}function AE(e,t){"".concat(t,"Channel")in e||(e["".concat(t,"Channel")]=mw(EE(e[t]),("MUI: Can't create `palette.".concat(t,"Channel` because `palette.").concat(t,"` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()."),"To suppress this warning, you need to explicitly provide the `palette.".concat(t,'Channel` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.'))))}const TE=e=>{try{return e()}catch(t){}};function DE(e,t,i,n,s){var o,a,l;if(!i)return;i=!0===i?{}:i;const c="dark"===s?"dark":"light";var u;if(!n)return void(t[s]=function(e){const{palette:t={mode:"light"},opacity:i,overlays:n,colorSpace:s}=e,o=bg(e,pE),a=Uw((0,r.A)((0,r.A)({},t),{},{colorSpace:s}));return(0,r.A)({palette:a,opacity:(0,r.A)((0,r.A)({},fE(a.mode)),i),overlays:n||gE(a.mode)},o)}((0,r.A)((0,r.A)({},i),{},{palette:(0,r.A)({mode:c},null===(u=i)||void 0===u?void 0:u.palette),colorSpace:e})));const h=dE((0,r.A)((0,r.A)({},n),{},{palette:(0,r.A)({mode:c},null===(o=i)||void 0===o?void 0:o.palette),colorSpace:e})),{palette:d}=h,p=bg(h,bE);return t[s]=(0,r.A)((0,r.A)({},i),{},{palette:d,opacity:(0,r.A)((0,r.A)({},fE(c)),null===(a=i)||void 0===a?void 0:a.opacity),overlays:(null===(l=i)||void 0===l?void 0:l.overlays)||gE(c)}),p}function SE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{colorSchemes:t={light:!0},defaultColorScheme:i,disableCssColorScheme:n=!1,cssVarPrefix:s="mui",nativeColor:o=!1,shouldSkipGeneratingVar:a=_E,colorSchemeSelector:l=(t.light&&t.dark?"media":void 0),rootSelector:c=":root"}=e,u=bg(e,xE),h=Object.keys(t)[0],d=i||(t.light&&"light"!==h?"light":h),p=function(){return jw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui")}(s),{[d]:m,light:f,dark:g}=t,_=bg(t,[d,"light","dark"].map(Lp.A)),v=(0,r.A)({},_);let y,b=m;if(("dark"===d&&!("dark"in t)||"light"===d&&!("light"in t))&&(b=!0),!b)throw new Error(Qb(21,d));o&&(y="oklch");const x=DE(y,v,b,u,d);f&&!v.light&&DE(y,v,f,void 0,"light"),g&&!v.dark&&DE(y,v,g,void 0,"dark");let w=(0,r.A)((0,r.A)({defaultColorScheme:d},x),{},{cssVarPrefix:s,colorSchemeSelector:l,rootSelector:c,getCssVar:p,colorSchemes:v,font:(0,r.A)((0,r.A)({},Vw(x.typography)),x.font),spacing:(E=u.spacing,"number"===typeof E?"".concat(E,"px"):"string"===typeof E||"function"===typeof E||Array.isArray(E)?E:"8px")});var E;Object.keys(w.colorSchemes).forEach(e=>{const t=w.colorSchemes[e].palette,i=e=>{const i=e.split("-"),n=i[1],r=i[2];return p(e,t[n][r])};function n(e,t,i){if(y){let n;return e===yw&&(n="transparent ".concat((100*(1-i)).toFixed(0),"%")),e===xw&&(n="#000 ".concat((100*i).toFixed(0),"%")),e===Ew&&(n="#fff ".concat((100*i).toFixed(0),"%")),"color-mix(in ".concat(y,", ").concat(t,", ").concat(n,")")}return e(t,i)}var r;if("light"===t.mode&&(wE(t.common,"background","#fff"),wE(t.common,"onBackground","#000")),"dark"===t.mode&&(wE(t.common,"background","#000"),wE(t.common,"onBackground","#fff")),r=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach(e=>{r[e]||(r[e]={})}),"light"===t.mode){wE(t.Alert,"errorColor",n(xw,t.error.light,.6)),wE(t.Alert,"infoColor",n(xw,t.info.light,.6)),wE(t.Alert,"successColor",n(xw,t.success.light,.6)),wE(t.Alert,"warningColor",n(xw,t.warning.light,.6)),wE(t.Alert,"errorFilledBg",i("palette-error-main")),wE(t.Alert,"infoFilledBg",i("palette-info-main")),wE(t.Alert,"successFilledBg",i("palette-success-main")),wE(t.Alert,"warningFilledBg",i("palette-warning-main")),wE(t.Alert,"errorFilledColor",TE(()=>t.getContrastText(t.error.main))),wE(t.Alert,"infoFilledColor",TE(()=>t.getContrastText(t.info.main))),wE(t.Alert,"successFilledColor",TE(()=>t.getContrastText(t.success.main))),wE(t.Alert,"warningFilledColor",TE(()=>t.getContrastText(t.warning.main))),wE(t.Alert,"errorStandardBg",n(Ew,t.error.light,.9)),wE(t.Alert,"infoStandardBg",n(Ew,t.info.light,.9)),wE(t.Alert,"successStandardBg",n(Ew,t.success.light,.9)),wE(t.Alert,"warningStandardBg",n(Ew,t.warning.light,.9)),wE(t.Alert,"errorIconColor",i("palette-error-main")),wE(t.Alert,"infoIconColor",i("palette-info-main")),wE(t.Alert,"successIconColor",i("palette-success-main")),wE(t.Alert,"warningIconColor",i("palette-warning-main")),wE(t.AppBar,"defaultBg",i("palette-grey-100")),wE(t.Avatar,"defaultBg",i("palette-grey-400")),wE(t.Button,"inheritContainedBg",i("palette-grey-300")),wE(t.Button,"inheritContainedHoverBg",i("palette-grey-A100")),wE(t.Chip,"defaultBorder",i("palette-grey-400")),wE(t.Chip,"defaultAvatarColor",i("palette-grey-700")),wE(t.Chip,"defaultIconColor",i("palette-grey-700")),wE(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),wE(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),wE(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),wE(t.LinearProgress,"primaryBg",n(Ew,t.primary.main,.62)),wE(t.LinearProgress,"secondaryBg",n(Ew,t.secondary.main,.62)),wE(t.LinearProgress,"errorBg",n(Ew,t.error.main,.62)),wE(t.LinearProgress,"infoBg",n(Ew,t.info.main,.62)),wE(t.LinearProgress,"successBg",n(Ew,t.success.main,.62)),wE(t.LinearProgress,"warningBg",n(Ew,t.warning.main,.62)),wE(t.Skeleton,"bg",y?n(yw,t.text.primary,.11):"rgba(".concat(i("palette-text-primaryChannel")," / 0.11)")),wE(t.Slider,"primaryTrack",n(Ew,t.primary.main,.62)),wE(t.Slider,"secondaryTrack",n(Ew,t.secondary.main,.62)),wE(t.Slider,"errorTrack",n(Ew,t.error.main,.62)),wE(t.Slider,"infoTrack",n(Ew,t.info.main,.62)),wE(t.Slider,"successTrack",n(Ew,t.success.main,.62)),wE(t.Slider,"warningTrack",n(Ew,t.warning.main,.62));const e=y?n(xw,t.background.default,.6825):Aw(t.background.default,.8);wE(t.SnackbarContent,"bg",e),wE(t.SnackbarContent,"color",TE(()=>y?Bw.text.primary:t.getContrastText(e))),wE(t.SpeedDialAction,"fabHoverBg",Aw(t.background.paper,.15)),wE(t.StepConnector,"border",i("palette-grey-400")),wE(t.StepContent,"border",i("palette-grey-400")),wE(t.Switch,"defaultColor",i("palette-common-white")),wE(t.Switch,"defaultDisabledColor",i("palette-grey-100")),wE(t.Switch,"primaryDisabledColor",n(Ew,t.primary.main,.62)),wE(t.Switch,"secondaryDisabledColor",n(Ew,t.secondary.main,.62)),wE(t.Switch,"errorDisabledColor",n(Ew,t.error.main,.62)),wE(t.Switch,"infoDisabledColor",n(Ew,t.info.main,.62)),wE(t.Switch,"successDisabledColor",n(Ew,t.success.main,.62)),wE(t.Switch,"warningDisabledColor",n(Ew,t.warning.main,.62)),wE(t.TableCell,"border",n(Ew,n(yw,t.divider,1),.88)),wE(t.Tooltip,"bg",n(yw,t.grey[700],.92))}if("dark"===t.mode){wE(t.Alert,"errorColor",n(Ew,t.error.light,.6)),wE(t.Alert,"infoColor",n(Ew,t.info.light,.6)),wE(t.Alert,"successColor",n(Ew,t.success.light,.6)),wE(t.Alert,"warningColor",n(Ew,t.warning.light,.6)),wE(t.Alert,"errorFilledBg",i("palette-error-dark")),wE(t.Alert,"infoFilledBg",i("palette-info-dark")),wE(t.Alert,"successFilledBg",i("palette-success-dark")),wE(t.Alert,"warningFilledBg",i("palette-warning-dark")),wE(t.Alert,"errorFilledColor",TE(()=>t.getContrastText(t.error.dark))),wE(t.Alert,"infoFilledColor",TE(()=>t.getContrastText(t.info.dark))),wE(t.Alert,"successFilledColor",TE(()=>t.getContrastText(t.success.dark))),wE(t.Alert,"warningFilledColor",TE(()=>t.getContrastText(t.warning.dark))),wE(t.Alert,"errorStandardBg",n(xw,t.error.light,.9)),wE(t.Alert,"infoStandardBg",n(xw,t.info.light,.9)),wE(t.Alert,"successStandardBg",n(xw,t.success.light,.9)),wE(t.Alert,"warningStandardBg",n(xw,t.warning.light,.9)),wE(t.Alert,"errorIconColor",i("palette-error-main")),wE(t.Alert,"infoIconColor",i("palette-info-main")),wE(t.Alert,"successIconColor",i("palette-success-main")),wE(t.Alert,"warningIconColor",i("palette-warning-main")),wE(t.AppBar,"defaultBg",i("palette-grey-900")),wE(t.AppBar,"darkBg",i("palette-background-paper")),wE(t.AppBar,"darkColor",i("palette-text-primary")),wE(t.Avatar,"defaultBg",i("palette-grey-600")),wE(t.Button,"inheritContainedBg",i("palette-grey-800")),wE(t.Button,"inheritContainedHoverBg",i("palette-grey-700")),wE(t.Chip,"defaultBorder",i("palette-grey-700")),wE(t.Chip,"defaultAvatarColor",i("palette-grey-300")),wE(t.Chip,"defaultIconColor",i("palette-grey-300")),wE(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),wE(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),wE(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),wE(t.LinearProgress,"primaryBg",n(xw,t.primary.main,.5)),wE(t.LinearProgress,"secondaryBg",n(xw,t.secondary.main,.5)),wE(t.LinearProgress,"errorBg",n(xw,t.error.main,.5)),wE(t.LinearProgress,"infoBg",n(xw,t.info.main,.5)),wE(t.LinearProgress,"successBg",n(xw,t.success.main,.5)),wE(t.LinearProgress,"warningBg",n(xw,t.warning.main,.5)),wE(t.Skeleton,"bg",y?n(yw,t.text.primary,.13):"rgba(".concat(i("palette-text-primaryChannel")," / 0.13)")),wE(t.Slider,"primaryTrack",n(xw,t.primary.main,.5)),wE(t.Slider,"secondaryTrack",n(xw,t.secondary.main,.5)),wE(t.Slider,"errorTrack",n(xw,t.error.main,.5)),wE(t.Slider,"infoTrack",n(xw,t.info.main,.5)),wE(t.Slider,"successTrack",n(xw,t.success.main,.5)),wE(t.Slider,"warningTrack",n(xw,t.warning.main,.5));const e=y?n(Ew,t.background.default,.985):Aw(t.background.default,.98);wE(t.SnackbarContent,"bg",e),wE(t.SnackbarContent,"color",TE(()=>y?Lw.text.primary:t.getContrastText(e))),wE(t.SpeedDialAction,"fabHoverBg",Aw(t.background.paper,.15)),wE(t.StepConnector,"border",i("palette-grey-600")),wE(t.StepContent,"border",i("palette-grey-600")),wE(t.Switch,"defaultColor",i("palette-grey-300")),wE(t.Switch,"defaultDisabledColor",i("palette-grey-600")),wE(t.Switch,"primaryDisabledColor",n(xw,t.primary.main,.55)),wE(t.Switch,"secondaryDisabledColor",n(xw,t.secondary.main,.55)),wE(t.Switch,"errorDisabledColor",n(xw,t.error.main,.55)),wE(t.Switch,"infoDisabledColor",n(xw,t.info.main,.55)),wE(t.Switch,"successDisabledColor",n(xw,t.success.main,.55)),wE(t.Switch,"warningDisabledColor",n(xw,t.warning.main,.55)),wE(t.TableCell,"border",n(xw,n(yw,t.divider,1),.68)),wE(t.Tooltip,"bg",n(yw,t.grey[700],.92))}AE(t.background,"default"),AE(t.background,"paper"),AE(t.common,"background"),AE(t.common,"onBackground"),AE(t,"divider"),Object.keys(t).forEach(e=>{const i=t[e];"tonalOffset"!==e&&i&&"object"===typeof i&&(i.main&&wE(t[e],"mainChannel",mw(EE(i.main))),i.light&&wE(t[e],"lightChannel",mw(EE(i.light))),i.dark&&wE(t[e],"darkChannel",mw(EE(i.dark))),i.contrastText&&wE(t[e],"contrastTextChannel",mw(EE(i.contrastText))),"text"===e&&(AE(t[e],"primary"),AE(t[e],"secondary")),"action"===e&&(i.active&&AE(t[e],"active"),i.selected&&AE(t[e],"selected")))})});for(var A=arguments.length,T=new Array(A>1?A-1:0),D=1;D<A;D++)T[D-1]=arguments[D];w=T.reduce((e,t)=>Vb(e,t),w);const S={prefix:s,disableCssColorScheme:n,shouldSkipGeneratingVar:a,getSelector:yE(w),enableContrastVars:o},{vars:C,generateThemeVars:P,generateStyleSheets:I}=Xw(w,S);return w.vars=C,Object.entries(w.colorSchemes[w.defaultColorScheme]).forEach(e=>{let[t,i]=e;w[t]=i}),w.generateThemeVars=P,w.generateStyleSheets=I,w.generateSpacing=function(){return bx(u.spacing,px(this))},w.getColorSchemeSelector=function(e){return function(t){return"media"===e?"@media (prefers-color-scheme: ".concat(t,")"):e?e.startsWith("data-")&&!e.includes("%s")?"[".concat(e,'="').concat(t,'"] &'):"class"===e?".".concat(t," &"):"data"===e?"[data-".concat(t,"] &"):"".concat(e.replace("%s",t)," &"):"&"}}(l),w.spacing=w.generateSpacing(),w.shouldSkipGeneratingVar=a,w.unstable_sxConfig=(0,r.A)((0,r.A)({},Zx),null===u||void 0===u?void 0:u.unstable_sxConfig),w.unstable_sx=function(e){return Kx({sx:e,theme:this})},w.toRuntimeSource=lE,w}const CE=["palette","cssVariables","colorSchemes","defaultColorScheme"];function PE(e,t,i){e.colorSchemes&&i&&(e.colorSchemes[t]=(0,r.A)((0,r.A)({},!0!==i&&i),{},{palette:Uw((0,r.A)((0,r.A)({},!0===i?{}:i.palette),{},{mode:t}))}))}const IE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{palette:t,cssVariables:i=!1,colorSchemes:n=(t?void 0:{light:!0}),defaultColorScheme:s=(null===t||void 0===t?void 0:t.mode)}=e,o=bg(e,CE),a=s||"light",l=null===n||void 0===n?void 0:n[a],c=(0,r.A)((0,r.A)({},n),t?{[a]:(0,r.A)((0,r.A)({},"boolean"!==typeof l&&l),{},{palette:t})}:void 0);for(var u=arguments.length,h=new Array(u>1?u-1:0),d=1;d<u;d++)h[d-1]=arguments[d];if(!1===i){if(!("colorSchemes"in e))return dE(e,...h);let i=t;"palette"in e||c[a]&&(!0!==c[a]?i=c[a].palette:"dark"===a&&(i={mode:"dark"}));const n=dE((0,r.A)((0,r.A)({},e),{},{palette:i}),...h);return n.defaultColorScheme=a,n.colorSchemes=c,"light"===n.palette.mode&&(n.colorSchemes.light=(0,r.A)((0,r.A)({},!0!==c.light&&c.light),{},{palette:n.palette}),PE(n,"dark",c.dark)),"dark"===n.palette.mode&&(n.colorSchemes.dark=(0,r.A)((0,r.A)({},!0!==c.dark&&c.dark),{},{palette:n.palette}),PE(n,"light",c.light)),n}return t||"light"in c||"light"!==a||(c.light=!0),SE((0,r.A)((0,r.A)({},o),{},{colorSchemes:c,defaultColorScheme:a},"boolean"!==typeof i&&i),...h)}();const kE=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},ME=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:i=rw,rootShouldForwardProp:n=sw,slotShouldForwardProp:s=sw}=e;function o(e){!function(e,t,i){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?i:e.theme[t]||e.theme}(e,t,i)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,e=>e.filter(e=>e!==Kx));const{name:i,slot:a,skipVariantsResolver:l,skipSx:c,overridesResolver:u=aw(hw(a))}=t,h=bg(t,nw),d=i&&i.startsWith("Mui")||a?"components":"custom",p=void 0!==l?l:a&&"Root"!==a&&"root"!==a||!1,m=c||!1;let f=sw;"Root"===a||"root"===a?f=n:a?f=s:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(f=void 0);const g=Ob(e,(0,r.A)({shouldForwardProp:f,label:uw(i,a)},h)),_=e=>{if(e.__emotion_real===e)return e;if("function"===typeof e)return function(t){return lw(t,e,t.theme.modularCssLayers?d:void 0)};if(Ub(e)){const t=tw(e);return function(e){return t.variants?lw(e,t,e.theme.modularCssLayers?d:void 0):e.theme.modularCssLayers?ow(t.style,d):t.style}}return e},v=function(){const t=[];for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];const a=r.map(_),l=[];if(t.push(o),i&&u&&l.push(function(e){var t;const n=null===(t=e.theme.components)||void 0===t||null===(t=t[i])||void 0===t?void 0:t.styleOverrides;if(!n)return null;const r={};for(const i in n)r[i]=lw(e,n[i],e.theme.modularCssLayers?"theme":void 0);return u(e,r)}),i&&!p&&l.push(function(e){var t;const n=e.theme,r=null===n||void 0===n||null===(t=n.components)||void 0===t||null===(t=t[i])||void 0===t?void 0:t.variants;return r?cw(e,r,[],e.theme.modularCssLayers?"theme":void 0):null}),m||l.push(Kx),Array.isArray(a[0])){const e=a.shift(),i=new Array(t.length).fill(""),n=new Array(l.length).fill("");let r;r=[...i,...e,...n],r.raw=[...i,...e.raw,...n],t.unshift(r)}const c=[...t,...a,...l],h=g(...c);return e.muiName&&(h.muiName=e.muiName),h};return g.withConfig&&(v.withConfig=g.withConfig),v}}({themeId:"$$material",defaultTheme:IE,rootShouldForwardProp:e=>kE(e)&&"classes"!==e}),RE=ME,FE={theme:void 0};const LE=function(e){let t,i;return function(n){let r=t;return void 0!==r&&n.theme===i||(FE.theme=n.theme,r=tw(e(FE)),t=r,i=n.theme),r}};function OE(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=(0,r.A)({},t);for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const o=s;if("components"===o||"slots"===o)n[o]=(0,r.A)((0,r.A)({},e[o]),n[o]);else if("componentsProps"===o||"slotProps"===o){const s=e[o],a=t[o];if(a)if(s){n[o]=(0,r.A)({},a);for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)){const t=e;n[o][t]=OE(s[t],a[t],i)}}else n[o]=a;else n[o]=s||{}}else"className"===o&&i&&t.className?n.className=Iv(null===e||void 0===e?void 0:e.className,null===t||void 0===t?void 0:t.className):"style"===o&&i&&t.style?n.style=(0,r.A)((0,r.A)({},null===e||void 0===e?void 0:e.style),null===t||void 0===t?void 0:t.style):void 0===n[o]&&(n[o]=e[o])}return n}const BE=e.createContext(void 0);function zE(t){let{props:i,name:n}=t;return function(e){const{theme:t,name:i,props:n}=e;if(!t||!t.components||!t.components[i])return n;const r=t.components[i];return r.defaultProps?OE(r.defaultProps,n,t.components.mergeClassNameAndStyle):r.styleOverrides||r.variants?n:OE(r,n,t.components.mergeClassNameAndStyle)}({props:i,name:n,theme:{components:e.useContext(BE)}})}const NE=e=>!e||!Fv(e),UE=ex;function jE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,i]=t;return i&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!function(e){return"string"===typeof e.main}(e))return!1;for(const i of t)if(!e.hasOwnProperty(i)||"string"!==typeof e[i])return!1;return!0}(i,e)}}const VE=e=>e,GE=(()=>{let e=VE;return{configure(t){e=t},generate:t=>e(t),reset(){e=VE}}})(),WE={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function HE(e,t){const i=WE[t];return i?"".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui","-").concat(i):"".concat(GE.generate(e),"-").concat(t)}function XE(e){return HE("MuiSlider",e)}const qE=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const n={};return t.forEach(t=>{n[t]=HE(e,t,i)}),n}("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);const ZE=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function YE(e){return e}const KE=RE("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t["color".concat(UE(i.color))],"medium"!==i.size&&t["size".concat(UE(i.size))],i.marked&&t.marked,"vertical"===i.orientation&&t.vertical,"inverted"===i.track&&t.trackInverted,!1===i.track&&t.trackFalse]}})(LE(e=>{let{theme:t}=e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},["&.".concat(qE.disabled)]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},["&.".concat(qE.dragging)]:{["& .".concat(qE.thumb,", & .").concat(qE.track)]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(jE()).map(e=>{let[i]=e;return{props:{color:i},style:{color:(t.vars||t).palette[i].main}}}),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}})),JE=RE("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),$E=RE("span",{name:"MuiSlider",slot:"Track"})(LE(e=>{let{theme:t}=e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(jE()).map(e=>{let[i]=e;return{props:{color:i,track:"inverted"},style:(0,r.A)({},t.vars?{backgroundColor:t.vars.palette.Slider["".concat(i,"Track")],borderColor:t.vars.palette.Slider["".concat(i,"Track")]}:(0,r.A)((0,r.A)({backgroundColor:t.lighten(t.palette[i].main,.62),borderColor:t.lighten(t.palette[i].main,.62)},t.applyStyles("dark",{backgroundColor:t.darken(t.palette[i].main,.5)})),t.applyStyles("dark",{borderColor:t.darken(t.palette[i].main,.5)})))}})]}})),QE=RE("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.thumb,t["thumbColor".concat(UE(i.color))],"medium"!==i.size&&t["thumbSize".concat(UE(i.size))]]}})(LE(e=>{let{theme:t}=e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},["&.".concat(qE.disabled)]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(jE()).map(e=>{let[i]=e;return{props:{color:i},style:{["&:hover, &.".concat(qE.focusVisible)]:{boxShadow:"0px 0px 0px 8px ".concat(t.alpha((t.vars||t).palette[i].main,.16)),"@media (hover: none)":{boxShadow:"none"}},["&.".concat(qE.active)]:{boxShadow:"0px 0px 0px 14px ".concat(t.alpha((t.vars||t).palette[i].main,.16))}}}})]}})),eA=RE(function(t){const{children:i,className:n,value:r}=t,s=(e=>{const{open:t}=e;return{offset:Iv(t&&qE.valueLabelOpen),circle:qE.valueLabelCircle,label:qE.valueLabelLabel}})(t);return i?e.cloneElement(i,{className:i.props.className},(0,kv.jsxs)(e.Fragment,{children:[i.props.children,(0,kv.jsx)("span",{className:Iv(s.offset,n),"aria-hidden":!0,children:(0,kv.jsx)("span",{className:s.circle,children:(0,kv.jsx)("span",{className:s.label,children:r})})})]})):null},{name:"MuiSlider",slot:"ValueLabel"})(LE(e=>{let{theme:t}=e;return(0,r.A)((0,r.A)({zIndex:1,whiteSpace:"nowrap"},t.typography.body2),{},{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},["&.".concat(qE.valueLabelOpen)]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},["&.".concat(qE.valueLabelOpen)]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})})),tA=RE("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>kE(e)&&"markActive"!==e,overridesResolver:(e,t)=>{const{markActive:i}=e;return[t.mark,i&&t.markActive]}})(LE(e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}})),iA=RE("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>kE(e)&&"markLabelActive"!==e})(LE(e=>{let{theme:t}=e;return(0,r.A)((0,r.A)({},t.typography.body2),{},{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})})),nA=e=>{let{children:t}=e;return t},rA=e.forwardRef(function(t,i){var n,s,o,a,l,c,u,h,d,p,m,f,g,_,v,y,b,x,w,E,A,T,D,S;const C=zE({props:t,name:"MuiSlider"});const P=(()=>{const t=e.useContext(Mv);return null!==t&&void 0!==t&&t})(),{"aria-label":I,"aria-valuetext":k,"aria-labelledby":M,component:R="span",components:F={},componentsProps:L={},color:O="primary",classes:B,className:z,disableSwap:N=!1,disabled:U=!1,getAriaLabel:j,getAriaValueText:V,marks:G=!1,max:W=100,min:H=0,name:X,onChange:q,onChangeCommitted:Z,orientation:Y="horizontal",shiftStep:K=10,size:J="medium",step:$=1,scale:Q=YE,slotProps:ee,slots:te,tabIndex:ie,track:ne="normal",value:re,valueLabelDisplay:se="off",valueLabelFormat:oe=YE}=C,ae=bg(C,ZE),le=(0,r.A)((0,r.A)({},C),{},{isRtl:P,max:W,min:H,classes:B,disabled:U,disableSwap:N,orientation:Y,marks:G,color:O,size:J,step:$,shiftStep:K,scale:Q,track:ne,valueLabelDisplay:se,valueLabelFormat:oe}),{axisProps:ce,getRootProps:ue,getHiddenInputProps:he,getThumbProps:de,open:pe,active:me,axis:fe,focusedThumbIndex:ge,range:_e,dragging:ve,marks:ye,values:be,trackOffset:xe,trackLeap:we,getThumbStyle:Ee}=ly((0,r.A)((0,r.A)({},le),{},{rootRef:i}));le.marked=ye.length>0&&ye.some(e=>e.label),le.dragging=ve,le.focusedThumbIndex=ge;const Ae=(e=>{const{disabled:t,dragging:i,marked:n,orientation:r,track:s,classes:o,color:a,size:l}=e;return function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const n={};for(const r in e){const s=e[r];let o="",a=!0;for(let e=0;e<s.length;e+=1){const n=s[e];n&&(o+=(!0===a?"":" ")+t(n),a=!1,i&&i[n]&&(o+=" "+i[n]))}n[r]=o}return n}({root:["root",t&&"disabled",i&&"dragging",n&&"marked","vertical"===r&&"vertical","inverted"===s&&"trackInverted",!1===s&&"trackFalse",a&&"color".concat(UE(a)),l&&"size".concat(UE(l))],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&"thumbSize".concat(UE(l)),a&&"thumbColor".concat(UE(a))],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},XE,o)})(le),Te=null!==(n=null!==(s=null===te||void 0===te?void 0:te.root)&&void 0!==s?s:F.Root)&&void 0!==n?n:KE,De=null!==(o=null!==(a=null===te||void 0===te?void 0:te.rail)&&void 0!==a?a:F.Rail)&&void 0!==o?o:JE,Se=null!==(l=null!==(c=null===te||void 0===te?void 0:te.track)&&void 0!==c?c:F.Track)&&void 0!==l?l:$E,Ce=null!==(u=null!==(h=null===te||void 0===te?void 0:te.thumb)&&void 0!==h?h:F.Thumb)&&void 0!==u?u:QE,Pe=null!==(d=null!==(p=null===te||void 0===te?void 0:te.valueLabel)&&void 0!==p?p:F.ValueLabel)&&void 0!==d?d:eA,Ie=null!==(m=null!==(f=null===te||void 0===te?void 0:te.mark)&&void 0!==f?f:F.Mark)&&void 0!==m?m:tA,ke=null!==(g=null!==(_=null===te||void 0===te?void 0:te.markLabel)&&void 0!==_?_:F.MarkLabel)&&void 0!==g?g:iA,Me=null!==(v=null!==(y=null===te||void 0===te?void 0:te.input)&&void 0!==y?y:F.Input)&&void 0!==v?v:"input",Re=null!==(b=null===ee||void 0===ee?void 0:ee.root)&&void 0!==b?b:L.root,Fe=null!==(x=null===ee||void 0===ee?void 0:ee.rail)&&void 0!==x?x:L.rail,Le=null!==(w=null===ee||void 0===ee?void 0:ee.track)&&void 0!==w?w:L.track,Oe=null!==(E=null===ee||void 0===ee?void 0:ee.thumb)&&void 0!==E?E:L.thumb,Be=null!==(A=null===ee||void 0===ee?void 0:ee.valueLabel)&&void 0!==A?A:L.valueLabel,ze=null!==(T=null===ee||void 0===ee?void 0:ee.mark)&&void 0!==T?T:L.mark,Ne=null!==(D=null===ee||void 0===ee?void 0:ee.markLabel)&&void 0!==D?D:L.markLabel,Ue=null!==(S=null===ee||void 0===ee?void 0:ee.input)&&void 0!==S?S:L.input,je=jv({elementType:Te,getSlotProps:ue,externalSlotProps:Re,externalForwardedProps:ae,additionalProps:(0,r.A)({},NE(Te)&&{as:R}),ownerState:(0,r.A)((0,r.A)({},le),null===Re||void 0===Re?void 0:Re.ownerState),className:[Ae.root,z]}),Ve=jv({elementType:De,externalSlotProps:Fe,ownerState:le,className:Ae.rail}),Ge=jv({elementType:Se,externalSlotProps:Le,additionalProps:{style:(0,r.A)((0,r.A)({},ce[fe].offset(xe)),ce[fe].leap(we))},ownerState:(0,r.A)((0,r.A)({},le),null===Le||void 0===Le?void 0:Le.ownerState),className:Ae.track}),We=jv({elementType:Ce,getSlotProps:de,externalSlotProps:Oe,ownerState:(0,r.A)((0,r.A)({},le),null===Oe||void 0===Oe?void 0:Oe.ownerState),className:Ae.thumb}),He=jv({elementType:Pe,externalSlotProps:Be,ownerState:(0,r.A)((0,r.A)({},le),null===Be||void 0===Be?void 0:Be.ownerState),className:Ae.valueLabel}),Xe=jv({elementType:Ie,externalSlotProps:ze,ownerState:le,className:Ae.mark}),qe=jv({elementType:ke,externalSlotProps:Ne,ownerState:le,className:Ae.markLabel}),Ze=jv({elementType:Me,getSlotProps:he,externalSlotProps:Ue,ownerState:le});return(0,kv.jsxs)(Te,(0,r.A)((0,r.A)({},je),{},{children:[(0,kv.jsx)(De,(0,r.A)({},Ve)),(0,kv.jsx)(Se,(0,r.A)({},Ge)),ye.filter(e=>e.value>=H&&e.value<=W).map((t,i)=>{const n=Qv(t.value,H,W),s=ce[fe].offset(n);let o;return o=!1===ne?be.includes(t.value):"normal"===ne&&(_e?t.value>=be[0]&&t.value<=be[be.length-1]:t.value<=be[0])||"inverted"===ne&&(_e?t.value<=be[0]||t.value>=be[be.length-1]:t.value>=be[0]),(0,kv.jsxs)(e.Fragment,{children:[(0,kv.jsx)(Ie,(0,r.A)((0,r.A)((0,r.A)({"data-index":i},Xe),!Fv(Ie)&&{markActive:o}),{},{style:(0,r.A)((0,r.A)({},s),Xe.style),className:Iv(Xe.className,o&&Ae.markActive)})),null!=t.label?(0,kv.jsx)(ke,(0,r.A)((0,r.A)((0,r.A)({"aria-hidden":!0,"data-index":i},qe),!Fv(ke)&&{markLabelActive:o}),{},{style:(0,r.A)((0,r.A)({},s),qe.style),className:Iv(Ae.markLabel,qe.className,o&&Ae.markLabelActive),children:t.label})):null]},i)}),be.map((e,t)=>{const i=Qv(e,H,W),n=ce[fe].offset(i),s="off"===se?nA:Pe;return(0,kv.jsx)(s,(0,r.A)((0,r.A)((0,r.A)({},!Fv(s)&&{valueLabelFormat:oe,valueLabelDisplay:se,value:"function"===typeof oe?oe(Q(e),t):oe,index:t,open:pe===t||me===t||"on"===se,disabled:U}),He),{},{children:(0,kv.jsx)(Ce,(0,r.A)((0,r.A)({"data-index":t},We),{},{className:Iv(Ae.thumb,We.className,me===t&&Ae.active,ge===t&&Ae.focusVisible),style:(0,r.A)((0,r.A)((0,r.A)({},n),Ee(t)),We.style),children:(0,kv.jsx)(Me,(0,r.A)({"data-index":t,"aria-label":j?j(t):I,"aria-valuenow":Q(e),"aria-labelledby":M,"aria-valuetext":V?V(Q(e),t):k,value:be[t]},Ze))}))}),t)})]}))}),sA=rA,oA=new ws({color:[255,255,255],intensity:1}),aA=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="point";const{color:t=O_}=e,{intensity:i=B_}=e,{position:n=N_}=e;this.id=e.id||"point-".concat(U_++),this.color=t,this.intensity=i,this.type="point",this.position=n,this.attenuation=function(e){if(e.attenuation)return e.attenuation;return z_}(e),this.projectedLight=(0,r.A)({},this)}getProjectedLight(e){let{layer:t}=e;const{projectedLight:i}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:s}=t.props,o=Bh(this.position,{viewport:n,coordinateSystem:r,coordinateOrigin:s,fromCoordinateSystem:n.isGeospatial?Dr.LNGLAT:Dr.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return i.color=this.color,i.intensity=this.intensity,i.position=o,i}}({color:[255,255,255],intensity:2,position:[127.1262,37.4202,8e3]}),lA={buildingColor:[228,228,228],buildingColor2:[255,255,255],trailColor0:[253,128,93],trailColor1:[23,184,190],material:{ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]},material2:{ambient:.3,diffuse:.6,shininess:32,specularCol:[60,64,70]},effects:[new ho({ambientLight:oA,pointLight:aA})]},cA={longitude:127.1262,latitude:37.4202,zoom:13.5,pitch:30,bearing:0},uA=420,hA=e=>{const t=e.toString();return t.length<2?"0"+t:t},dA=t=>{const[i,n]=(0,e.useState)(uA),[r]=(0,e.useState)({}),s=t.trip,o=t.passengers||[],a=e.useMemo(()=>{if(!s||0===s.length)return uA;let e=uA;for(const t of s)if(t&&t.timestamp&&t.timestamp.length){const i=t.timestamp[t.timestamp.length-1];"number"===typeof i&&i>e&&(e=i)}return e},[s]),l=e.useMemo(()=>{if(!o||0===o.length)return uA;let e=uA;for(const t of o)if(t&&t.timestamp&&t.timestamp.length){const i=t.timestamp[t.timestamp.length-1];"number"===typeof i&&i>e&&(e=i)}return e},[o]),c=e.useMemo(()=>{const e=Math.max(480,a,l);return Number.isFinite(e)&&e>uA?e:480},[a,l]),u=(0,e.useCallback)(e=>e>c?uA:e+.005,[c]),h=(0,e.useCallback)(()=>{n(e=>u(e)),r.id=window.requestAnimationFrame(h)},[r,u]);(0,e.useEffect)(()=>(r.id=window.requestAnimationFrame(h),()=>window.cancelAnimationFrame(r.id)),[r,h]);const d=e.useMemo(()=>o&&0!==o.length?o.filter(e=>Array.isArray(e.timestamp)&&2===e.timestamp.length&&e.timestamp[0]<=i&&e.timestamp[1]>i):[],[o,i]),p=[new fv({id:"trips",data:s,getPath:e=>e.route,getTimestamps:e=>e.timestamp,getColor:[255,255,0],opacity:1,widthMinPixels:7,rounded:!0,capRounded:!0,jointRounded:!0,trailLength:.5,currentTime:i,shadowEnabled:!1}),new wv({id:"passengers",data:d,getPosition:e=>e.location,getFillColor:[255,255,255],getRadius:6,radiusUnits:"pixels",pickable:!0,updateTriggers:{getPosition:[i]}}),new wv({id:"destinations",data:(()=>{if(!s||0===s.length)return[];const e=[];for(const t of s){if(!t||!t.route||!t.timestamp||t.route.length<2||t.timestamp.length<2)continue;const n=t.route[t.route.length-1],r=t.timestamp.length>1?t.timestamp[1]:t.timestamp[0],s=t.timestamp[t.timestamp.length-1];"number"===typeof r&&"number"===typeof s&&(i>=r&&i<=s&&e.push({location:n}))}return e})(),getPosition:e=>e.location,getFillColor:[255,165,0],getRadius:5,radiusUnits:"pixels",pickable:!1,updateTriggers:{getPosition:[i]}}),new Cv({id:"match-arcs",data:(()=>{if(!s||0===s.length)return[];const e=[];for(const t of s){if(!t||!t.route||!t.timestamp||t.route.length<2||t.timestamp.length<2)continue;const n=t.timestamp,r=t.route,s=n[0],o=n[1];if("number"!==typeof s||"number"!==typeof o)continue;if(i<s||i>o)continue;let a=0;for(let e=0;e<n.length-1;e++){if("number"===typeof n[e]&&"number"===typeof n[e+1]&&n[e]<=i&&i<n[e+1]){a=e;break}i>=n[n.length-1]&&(a=n.length-2)}const l=r[Math.max(0,Math.min(a,r.length-1))],c=r[Math.max(0,Math.min(a+1,r.length-1))],u=n[Math.max(0,Math.min(a,n.length-1))],h=n[Math.max(0,Math.min(a+1,n.length-1))];let d=l;if("number"===typeof u&&"number"===typeof h&&h>u){const e=Math.max(0,Math.min(1,(i-u)/(h-u)));d=[l[0]+(c[0]-l[0])*e,l[1]+(c[1]-l[1])*e]}const p=r[1];Array.isArray(d)&&Array.isArray(p)&&e.push({source:d,target:p})}return e})(),getSourcePosition:e=>e.source,getTargetPosition:e=>e.target,getSourceColor:[255,255,255],getTargetColor:[255,255,255],getWidth:3,pickable:!1,updateTriggers:{getSourcePosition:[i],getTargetPosition:[i]}}),new Cv({id:"occupied-arcs",data:(()=>{if(!s||0===s.length)return[];const e=[];for(const t of s){if(!t||!t.route||!t.timestamp||t.route.length<2||t.timestamp.length<2)continue;const n=t.timestamp,r=t.route,s=n[1],o=n[n.length-1];if("number"!==typeof s||"number"!==typeof o)continue;if(i<s||i>o)continue;let a=0;for(let e=0;e<n.length-1;e++){if("number"===typeof n[e]&&"number"===typeof n[e+1]&&n[e]<=i&&i<n[e+1]){a=e;break}i>=n[n.length-1]&&(a=n.length-2)}const l=r[Math.max(0,Math.min(a,r.length-1))],c=r[Math.max(0,Math.min(a+1,r.length-1))],u=n[Math.max(0,Math.min(a,n.length-1))],h=n[Math.max(0,Math.min(a+1,n.length-1))];let d=l;if("number"===typeof u&&"number"===typeof h&&h>u){const e=Math.max(0,Math.min(1,(i-u)/(h-u)));d=[l[0]+(c[0]-l[0])*e,l[1]+(c[1]-l[1])*e]}const p=r[r.length-1];Array.isArray(d)&&Array.isArray(p)&&e.push({source:d,target:p})}return e})(),getSourcePosition:e=>e.source,getTargetPosition:e=>e.target,getSourceColor:[255,165,0],getTargetColor:[255,165,0],getWidth:1.5,pickable:!1,updateTriggers:{getSourcePosition:[i],getTargetPosition:[i]}})],[m,f]=(e=>[hA(parseInt(Math.round(e)/60%24)),hA(Math.round(e)%60)])(i);return(0,kv.jsxs)("div",{className:"trip-container",style:{position:"relative"},children:[(0,kv.jsx)(_d,{effects:lA.effects,initialViewState:cA,controller:!0,layers:p,children:(0,kv.jsx)(Dm,{reuseMaps:!0,mapStyle:"mapbox://styles/spear5306/ckzcz5m8w002814o2coz02sjc",mapboxApiAccessToken:"pk.eyJ1Ijoic2hlcnJ5MTAyNCIsImEiOiJjbG00dmtic3YwbGNoM2Zxb3V5NmhxZDZ6In0.ZBrAsHLwNihh7xqTify5hQ",preventStyleDiffing:!0})}),(0,kv.jsxs)("h1",{className:"time",children:["TIME : ","".concat(m," : ").concat(f)]}),(0,kv.jsx)(sA,{id:"slider",value:i,min:uA,max:c,onChange:e=>{const t=e.target.value;n(t)},track:"inverted"})]})},pA=JSON.parse('[{"passenger_id":23594,"vehicle_id":71,"route":[[127.1262311,37.3663447],[127.12106,37.372699],[127.107856,37.364864]],"timestamp":[420,421.68292698503427,424.5953635345201]},{"passenger_id":14954,"vehicle_id":85,"route":[[127.1699854,37.4620296],[127.16778685,37.46143317],[127.16873158,37.43266197]],"timestamp":[420,420.41013744262955,426.8107341781764]},{"passenger_id":17607,"vehicle_id":87,"route":[[127.1370734,37.4469378],[127.13710277,37.44693516],[127.12683018,37.44840693]],"timestamp":[420,420.0052186695423,421.84821631546936]},{"passenger_id":14959,"vehicle_id":72,"route":[[127.1373395,37.4111316],[127.1422348,37.41281509],[127.10033417,37.40275574]],"timestamp":[420,420.9422832197536,428.6747677448002]},{"passenger_id":20721,"vehicle_id":51,"route":[[127.1116284,37.3697189],[127.119448015473,37.3736347037785],[127.128436848962,37.3930206962668]],"timestamp":[420,421.63349605661676,426.2280471892738]},{"passenger_id":14960,"vehicle_id":10,"route":[[127.1222663,37.3391013],[127.11643219,37.35129166],[127.12721252,37.41239166]],"timestamp":[420,422.90060444614096,436.62151502982994]},{"passenger_id":14961,"vehicle_id":67,"route":[[127.1304851,37.4138245],[127.13217826,37.41132712],[127.1111988,37.39623118]],"timestamp":[420,420.63080033221655,425.6314968213125]},{"passenger_id":12623,"vehicle_id":35,"route":[[127.1018346,37.3461221],[127.10900983,37.35069467],[127.12380317,37.38784711]],"timestamp":[420,421.6257952982935,430.2919475440247]},{"passenger_id":12640,"vehicle_id":29,"route":[[127.1671044,37.454869],[127.17330536,37.45001209],[127.12428452,37.38227229]],"timestamp":[420,421.53790893779154,438.91362236739946]},{"passenger_id":3243,"vehicle_id":18,"route":[[127.1202387,37.3908972],[127.11683062,37.3902932],[127.13111903,37.4337939]],"timestamp":[420,420.61697956828135,430.61491331977857]},{"passenger_id":10078,"vehicle_id":14,"route":[[127.107473,37.3666293],[127.10808809,37.36630563],[127.10455054,37.3247564]],"timestamp":[421,421.1303860025564,430.3916556353293]},{"passenger_id":8308,"vehicle_id":0,"route":[[127.1632428,37.449414],[127.16240248,37.44542298],[127.14329009,37.4720142]],"timestamp":[421,421.8998772931596,428.7082765305939]},{"passenger_id":20728,"vehicle_id":60,"route":[[127.1383091,37.444454],[127.13671776,37.44479346],[127.13587319,37.43415627]],"timestamp":[421,421.2909391394296,423.6612383387013]},{"passenger_id":5815,"vehicle_id":78,"route":[[127.1421138,37.4448136],[127.14125924,37.44664372],[127.12885514,37.43300873]],"timestamp":[421,421.434067614624,425.1746557457828]},{"passenger_id":3242,"vehicle_id":7,"route":[[127.1272428,37.3864023],[127.12550421,37.38906743],[127.13136699,37.39273127]],"timestamp":[421,421.6675826649658,422.9855328320725]},{"passenger_id":5814,"vehicle_id":98,"route":[[127.1299376,37.3822876],[127.12668122,37.38442613],[127.10665763,37.37679019]],"timestamp":[421,421.74652853933236,425.67139258697927]},{"passenger_id":5813,"vehicle_id":58,"route":[[127.1718544,37.4305695],[127.1686554,37.43284988],[127.16391754,37.43736267]],"timestamp":[421,421.7591621156798,423.06575462968345]},{"passenger_id":5812,"vehicle_id":66,"route":[[127.1615007,37.4373692],[127.16299343,37.43299856],[127.18070217,37.44278543]],"timestamp":[421,422.0070947368048,425.81700080569846]},{"passenger_id":20748,"vehicle_id":23,"route":[[127.1599942,37.4389092],[127.15910339,37.43413544],[127.24852753,37.37726974]],"timestamp":[421,422.07322625884945,442.30898934576015]},{"passenger_id":8301,"vehicle_id":56,"route":[[127.1051139,37.4026454],[127.11557117,37.40402148],[127.12885081,37.41312205]],"timestamp":[422,423.8725765373196,426.97080890555844]},{"passenger_id":14966,"vehicle_id":5,"route":[[127.1651888,37.4543351],[127.16911651,37.45157531],[127.1480707,37.43450978]],"timestamp":[422,422.9260211694026,428.2375523147877]},{"passenger_id":10085,"vehicle_id":4,"route":[[127.1642179,37.4413216],[127.16891423,37.43272851],[127.21488635,37.40846743]],"timestamp":[422,424.08319539970347,433.8320029702205]},{"passenger_id":10087,"vehicle_id":17,"route":[[127.1443685,37.36681],[127.14325823,37.36790868],[127.12556697,37.40974376]],"timestamp":[422,422.3133823636682,432.12819316861294]},{"passenger_id":10103,"vehicle_id":88,"route":[[127.1096755,37.3961971],[127.10993958,37.39393616],[127.06646729,37.2702179]],"timestamp":[422,422.50497027870597,451.0723606641236]},{"passenger_id":768,"vehicle_id":59,"route":[[127.1454072,37.4463804],[127.14405956,37.44494685],[127.12602397,37.41128971]],"timestamp":[422,422.3978119108407,430.53233607728055]},{"passenger_id":12616,"vehicle_id":64,"route":[[127.1284946,37.4058179],[127.12828522,37.40186392],[127.11131443,37.39389127]],"timestamp":[422,422.88010267254725,426.3634232174538]},{"passenger_id":3253,"vehicle_id":86,"route":[[127.1332472,37.4298883],[127.1320016,37.42906963],[127.10166621,37.40438829]],"timestamp":[423,423.28554420660436,430.9561087438141]},{"passenger_id":17615,"vehicle_id":39,"route":[[127.1129854,37.3911298],[127.112795279017,37.3909595978314],[127.105789766567,37.3711986076343]],"timestamp":[423,423.0506081167957,427.61629254634687]},{"passenger_id":17620,"vehicle_id":84,"route":[[127.1392229,37.4490116],[127.14019012,37.44792938],[127.12840271,37.4124527]],"timestamp":[423,423.2951034065938,431.45475153780836]},{"passenger_id":10079,"vehicle_id":21,"route":[[127.1757279,37.423249],[127.1735976,37.43447031],[127.12940516,37.43083787]],"timestamp":[423,425.5237046254066,433.3694668416049]},{"passenger_id":17612,"vehicle_id":93,"route":[[127.1439758,37.4394902],[127.14019179,37.44111994],[127.12782771,37.43863844]],"timestamp":[423,423.76013113653147,426.01199584894556]},{"passenger_id":12620,"vehicle_id":49,"route":[[127.1247701,37.4378729],[127.12457443,37.4395055],[127.10248276,37.40370542]],"timestamp":[423,423.3647139600724,432.2309840163582]},{"passenger_id":764,"vehicle_id":40,"route":[[127.1069515,37.3968177],[127.10968993,37.394272],[127.12400389,37.38397028]],"timestamp":[423,423.74471481294336,427.1572767673239]},{"passenger_id":20726,"vehicle_id":79,"route":[[127.1034368,37.3617337],[127.12307739,37.3598938],[127.10821533,37.36696243]],"timestamp":[423,426.49574122340425,429.55712360031396]},{"passenger_id":20722,"vehicle_id":46,"route":[[127.0906838,37.3898233],[127.08985138,37.38970566],[127.10308838,37.40253067]],"timestamp":[423,423.1493921300724,426.8377905279581]},{"passenger_id":3244,"vehicle_id":43,"route":[[127.1102379,37.3843474],[127.11394501,37.37867737],[127.1219101,37.38767624]],"timestamp":[423,424.42097267171897,426.8676244826663]},{"passenger_id":14972,"vehicle_id":31,"route":[[127.1683229,37.4424885],[127.16542809,37.43929386],[127.25312572,37.41745685]],"timestamp":[423,423.8752242308391,440.10640454704946]},{"passenger_id":20733,"vehicle_id":9,"route":[[127.1514836,37.442212],[127.15951538,37.44560623],[127.12904358,37.43126297]],"timestamp":[424,425.606521111125,431.8616426116615]},{"passenger_id":17611,"vehicle_id":16,"route":[[127.1334158,37.3837262],[127.13081971,37.38494991],[127.12228198,37.38586929]],"timestamp":[424,424.5333936856223,426.05583771812314]},{"passenger_id":8302,"vehicle_id":37,"route":[[127.127051,37.4093433],[127.11794124,37.40393636],[127.11283562,37.39576846]],"timestamp":[424,426.0088935292879,428.0369819657227]},{"passenger_id":20745,"vehicle_id":82,"route":[[127.1287226,37.4666379],[127.13280908,37.47316821],[127.136924,37.42973725]],"timestamp":[424,425.62152753355247,435.3074154028291]},{"passenger_id":5824,"vehicle_id":47,"route":[[127.1090734,37.3843534],[127.1118927,37.37540054],[127.13990784,37.30563354]],"timestamp":[424,426.052414030097,442.33939053433875]},{"passenger_id":772,"vehicle_id":60,"route":[[127.13587319,37.43415627],[127.1332634,37.4377006],[127.10232789,37.40391325]],"timestamp":[424,424.91305973921123,434.20355582898935]},{"passenger_id":3273,"vehicle_id":28,"route":[[127.1610473,37.4493561],[127.16413879,37.446064],[127.10874939,37.33101654]],"timestamp":[424,424.9132023774285,452.3066293985854]},{"passenger_id":10082,"vehicle_id":70,"route":[[127.1460043,37.4459503],[127.141225659199,37.4465370355328],[127.137247905884,37.4283454801543]],"timestamp":[424,424.8537503100128,428.9598898272406]},{"passenger_id":5835,"vehicle_id":19,"route":[[127.1135609,37.3917705],[127.11373138,37.39999771],[127.10505676,37.48389053]],"timestamp":[424,425.82989593371065,444.5495759501283]},{"passenger_id":3258,"vehicle_id":15,"route":[[127.1275044,37.3794729],[127.11484528,37.36503601],[127.10573578,37.4040947]],"timestamp":[424,427.9132632100423,436.74741271626823]},{"passenger_id":8305,"vehicle_id":52,"route":[[127.1584121,37.416765],[127.15876216,37.4141573],[127.12944253,37.4305084]],"timestamp":[425,425.58321301121794,431.91077951080035]},{"passenger_id":770,"vehicle_id":30,"route":[[127.157587,37.4206598],[127.16346309,37.41164985],[127.12926195,37.41233542]],"timestamp":[425,427.2565778084252,433.2998411149767]},{"passenger_id":14957,"vehicle_id":38,"route":[[127.1470045,37.4408788],[127.14400085,37.44490506],[127.12850637,37.4399441]],"timestamp":[425,426.0406783349047,428.9906111539476]},{"passenger_id":20900,"vehicle_id":65,"route":[[127.1338608,37.3975972],[127.12856777,37.3973078],[127.48982209,37.25165064]],"timestamp":[425,425.9373621666086,497.56710213773295]},{"passenger_id":12618,"vehicle_id":11,"route":[[127.1363603,37.3739728],[127.13811493,37.3703804],[127.10818481,37.36684036]],"timestamp":[425,425.8569875428261,431.20520953933885]},{"passenger_id":784,"vehicle_id":13,"route":[[127.1638798,37.4547073],[127.16012573,37.45177841],[127.12973022,37.48679733]],"timestamp":[425,425.92925428490423,435.38620147518105]},{"passenger_id":14958,"vehicle_id":58,"route":[[127.16391754,37.43736267],[127.15968323,37.43771744],[127.17583466,37.44167709]],"timestamp":[425,425.75185068972377,428.73666051822227]},{"passenger_id":14974,"vehicle_id":36,"route":[[127.1447786,37.4378516],[127.15966152,37.44204225],[127.12554843,37.40973899]],"timestamp":[426,428.7883179700916,438.1641002128434]},{"passenger_id":8313,"vehicle_id":42,"route":[[127.1437201,37.4375728],[127.14335632,37.4420166],[127.15395355,37.40394211]],"timestamp":[426,426.99034139954534,435.66210870584234]},{"passenger_id":8309,"vehicle_id":75,"route":[[127.119733,37.3840052],[127.125853531548,37.3868762894183],[127.126595193623,37.3863957367993]],"timestamp":[426,427.2559360438666,427.4250395356861]},{"passenger_id":14965,"vehicle_id":24,"route":[[127.0911858,37.383627],[127.07207886,37.39313555],[127.10966706,37.40271487]],"timestamp":[426,429.98370262431433,436.9579175405993]},{"passenger_id":12627,"vehicle_id":96,"route":[[127.105362,37.3946307],[127.10970106,37.39327079],[127.13786943,37.40693092]],"timestamp":[426,426.8241388096301,432.6545894399034]},{"passenger_id":14980,"vehicle_id":67,"route":[[127.1111988,37.39623118],[127.11093903,37.39599228],[127.08628845,37.40497971]],"timestamp":[426,426.07020766230244,430.8619439265853]},{"passenger_id":3262,"vehicle_id":81,"route":[[127.0918044,37.3477464],[127.11164856,37.34503555],[127.11096191,37.40228653]],"timestamp":[426,429.55978952243345,442.2924048777219]},{"passenger_id":10091,"vehicle_id":61,"route":[[127.1507321,37.4297698],[127.15009308,37.42837906],[127.12186432,37.38718796]],"timestamp":[426,426.32923186509845,436.7590505496423]},{"passenger_id":20727,"vehicle_id":8,"route":[[127.0999293,37.4126597],[127.09847476,37.41268552],[127.09789658,37.4047868]],"timestamp":[426,426.25699391498114,428.0165558471245]},{"passenger_id":3254,"vehicle_id":1,"route":[[127.1364503,37.4133217],[127.14304352,37.40972519],[127.17667389,37.43600845]],"timestamp":[427,428.4128404019148,436.74621042483295]},{"passenger_id":12628,"vehicle_id":99,"route":[[127.1370795,37.3831762],[127.1432255,37.37178511],[127.1235012,37.35150634]],"timestamp":[427,429.7562868856846,435.45661158849805]},{"passenger_id":17642,"vehicle_id":97,"route":[[127.1485796,37.3688757],[127.11744594,37.33505464],[127.12704715,37.41233172]],"timestamp":[427,436.32015438691224,453.5893590673069]},{"passenger_id":20753,"vehicle_id":2,"route":[[127.1685638,37.4570254],[127.16979645,37.45610614],[127.10547997,37.44990273]],"timestamp":[427,427.2985738051654,438.7368090640757]},{"passenger_id":17638,"vehicle_id":98,"route":[[127.10665763,37.37679019],[127.113720273013,37.3642208725013],[127.10065646537,37.4050734004477]],"timestamp":[427,430.06133264901683,439.43521057145676]},{"passenger_id":17628,"vehicle_id":44,"route":[[127.14203,37.43666],[127.14222424,37.43836985],[127.10056673,37.40347453]],"timestamp":[427,427.3817970619079,438.07558258886786]},{"passenger_id":17624,"vehicle_id":27,"route":[[127.0990779,37.3866546],[127.10598266,37.36255728],[127.11550511,37.40529221]],"timestamp":[427,432.4961757042362,442.1478045921072]},{"passenger_id":20823,"vehicle_id":64,"route":[[127.11131443,37.39389127],[127.1107065,37.3971795],[127.05984713,37.24588715]],"timestamp":[427,427.73911506315613,462.5665495181121]},{"passenger_id":20731,"vehicle_id":71,"route":[[127.107856,37.364864],[127.11745453,37.33566284],[127.10910797,37.34921646]],"timestamp":[427,433.71208082396004,437.06812998222557]},{"passenger_id":14968,"vehicle_id":68,"route":[[127.0979618,37.3784598],[127.10664368,37.35992813],[127.10601807,37.40125656]],"timestamp":[427,431.39764716900686,440.58933553907497]},{"passenger_id":8312,"vehicle_id":74,"route":[[127.1446507,37.3709373],[127.14152527,37.36875916],[127.11167145,37.39376068]],"timestamp":[427,427.73469419388863,435.39931029694577]},{"passenger_id":14953,"vehicle_id":89,"route":[[127.1313591,37.444089],[127.13929354,37.43866253],[127.15049423,37.44206763]],"timestamp":[427,428.8490946530588,430.96686802002864]},{"passenger_id":3247,"vehicle_id":6,"route":[[127.1108295,37.3852446],[127.11440265,37.37182444],[127.10600236,37.35976203]],"timestamp":[427,430.050575592327,433.11661709820476]},{"passenger_id":3245,"vehicle_id":16,"route":[[127.12228198,37.38586929],[127.1149292,37.36895752],[127.12726593,37.36907578]],"timestamp":[427,430.97914820222417,433.1597346145747]},{"passenger_id":769,"vehicle_id":43,"route":[[127.1219101,37.38767624],[127.11309814,37.38931656],[127.0997467,37.40332031]],"timestamp":[427,428.59920715060315,432.50603159688654]},{"passenger_id":20742,"vehicle_id":34,"route":[[127.1279438,37.4392603],[127.13336954,37.44137874],[127.16551191,37.43915767]],"timestamp":[428,429.06761881131814,434.7646040306185]},{"passenger_id":5827,"vehicle_id":48,"route":[[127.1300135,37.4448478],[127.13437946,37.44590022],[127.11552619,37.37870759]],"timestamp":[428,428.8056130158532,444.11517297500825]},{"passenger_id":3248,"vehicle_id":40,"route":[[127.12400389,37.38397028],[127.13832092,37.37543869],[127.10824585,37.36682892]],"timestamp":[428,431.16246021427014,436.8122090843462]},{"passenger_id":12613,"vehicle_id":92,"route":[[127.133754,37.4459526],[127.13797083,37.44719298],[127.12683491,37.44824649]],"timestamp":[428,428.79398153942316,430.7740184523438]},{"passenger_id":23598,"vehicle_id":45,"route":[[127.1464985,37.4265339],[127.146303,37.428546],[127.123151,37.384176]],"timestamp":[428,428.44880064658435,439.13026576190106]},{"passenger_id":3312,"vehicle_id":56,"route":[[127.12885081,37.41312205],[127.13249826,37.40888438],[127.01242001,37.48037124]],"timestamp":[428,429.1416074028302,455.6416184864198]},{"passenger_id":12624,"vehicle_id":53,"route":[[127.1447912,37.4255325],[127.151772815897,37.4139650125179],[127.177408768499,37.4315315716794]],"timestamp":[428,430.8527683787517,436.8329007048319]},{"passenger_id":20743,"vehicle_id":75,"route":[[127.126595193623,37.3863957367993],[127.146950623159,37.3697430608163],[127.120053567027,37.3480793045467]],"timestamp":[428,433.1628684082613,439.9316545634391]},{"passenger_id":783,"vehicle_id":3,"route":[[127.0468636,37.3773798],[127.05856323,37.39274597],[127.10673523,37.36845016]],"timestamp":[428,431.9939799067834,442.07667028955495]},{"passenger_id":8314,"vehicle_id":57,"route":[[127.1415267,37.4291786],[127.14238019,37.43845977],[127.10785934,37.40321796]],"timestamp":[428,430.069533488784,439.99927238427676]},{"passenger_id":10084,"vehicle_id":87,"route":[[127.12683018,37.44840693],[127.13793182,37.44721222],[127.12749481,37.4402771]],"timestamp":[428,429.97799752852274,432.3810584706941]},{"passenger_id":20757,"vehicle_id":70,"route":[[127.137247905884,37.4283454801543],[127.14723969,37.429039],[127.10148621,37.39796066]],"timestamp":[429,430.77129739772033,441.40541296407355]},{"passenger_id":12614,"vehicle_id":22,"route":[[127.1208083,37.4130869],[127.12910155,37.41234146],[127.12511962,37.41003428]],"timestamp":[429,430.47426815546123,431.3449061138363]},{"passenger_id":14991,"vehicle_id":58,"route":[[127.17583466,37.44167709],[127.16288822,37.44507844],[127.14115192,37.47829118]],"timestamp":[429,431.40782244252216,439.73116570683317]},{"passenger_id":14979,"vehicle_id":51,"route":[[127.128436848962,37.3930206962668],[127.12322506,37.38225413],[127.15126659,37.41564311]],"timestamp":[429,431.5653695268348,440.4917249153121]},{"passenger_id":12632,"vehicle_id":38,"route":[[127.12850637,37.4399441],[127.13044771,37.44051937],[127.12175009,37.3877993]],"timestamp":[429,429.3658871532822,441.1905234741116]},{"passenger_id":23595,"vehicle_id":7,"route":[[127.13136699,37.39273127],[127.126688,37.383875],[127.121531,37.388065]],"timestamp":[429,431.13603516955783,432.4393634803929]},{"passenger_id":23605,"vehicle_id":63,"route":[[127.1682582,37.4578079],[127.16994473,37.46151175],[127.10921333,37.40241439]],"timestamp":[429,429.87585247126907,446.8390814655457]},{"passenger_id":5823,"vehicle_id":5,"route":[[127.1480707,37.43450978],[127.15007019,37.42834091],[127.12547302,37.40980911]],"timestamp":[429,430.41660646390784,436.40487826705385]},{"passenger_id":17627,"vehicle_id":93,"route":[[127.12782771,37.43863844],[127.12851847,37.43628522],[127.15796946,37.46112067]],"timestamp":[429,429.53735894369703,437.1230198328909]},{"passenger_id":8311,"vehicle_id":12,"route":[[127.136028,37.399272],[127.12791724,37.40633461],[127.10600237,37.3596857]],"timestamp":[429,431.1260464182418,442.19951728431937]},{"passenger_id":15075,"vehicle_id":37,"route":[[127.11283562,37.39576846],[127.11206111,37.39179174],[127.48984477,37.25162413]],"timestamp":[429,429.89490674012217,503.62141132159286]},{"passenger_id":12644,"vehicle_id":85,"route":[[127.16873158,37.43266197],[127.15884803,37.43701248],[127.2366523,37.43002244]],"timestamp":[429,430.99554231575223,444.8227133526817]},{"passenger_id":766,"vehicle_id":50,"route":[[127.1280006,37.4389622],[127.132164,37.441185],[127.14155579,37.44607544]],"timestamp":[429,429.88589545459376,431.86900606835314]},{"passenger_id":17625,"vehicle_id":66,"route":[[127.18070217,37.44278543],[127.16853765,37.44484011],[127.14614725,37.44232189]],"timestamp":[430,432.1959132566831,436.1887868254473]},{"passenger_id":14978,"vehicle_id":73,"route":[[127.1289128,37.4300067],[127.13449097,37.43379974],[127.10115051,37.4037056]],"timestamp":[430,431.2968886404702,440.2114273719282]},{"passenger_id":775,"vehicle_id":78,"route":[[127.12885514,37.43300873],[127.13002014,37.43293381],[127.1785965,37.43874741]],"timestamp":[430,430.20640324936664,438.8811573995153]},{"passenger_id":776,"vehicle_id":20,"route":[[127.1275702,37.4434873],[127.13996124,37.44338989],[127.1739502,37.4402771]],"timestamp":[430,432.18795964759613,438.229219869076]},{"passenger_id":23597,"vehicle_id":55,"route":[[127.1204883,37.4397879],[127.125133,37.440159],[127.129513,37.432317]],"timestamp":[430,430.8242819795653,432.73207616979175]},{"passenger_id":12637,"vehicle_id":41,"route":[[127.1650567,37.4589137],[127.16459849,37.45825922],[127.21853963,37.40290359]],"timestamp":[430,430.16651627762764,445.7322311623918]},{"passenger_id":23596,"vehicle_id":54,"route":[[127.1643701,37.4566154],[127.159573,37.450426],[127.159255,37.444446]],"timestamp":[430,431.6161298487591,432.9472058180434]},{"passenger_id":10080,"vehicle_id":26,"route":[[127.1025394,37.4009194],[127.1168314,37.39032965],[127.1130747,37.39322232]],"timestamp":[430,433.4528918894434,434.3772422253452]},{"passenger_id":8310,"vehicle_id":46,"route":[[127.10308838,37.40253067],[127.12413025,37.38896561],[127.12602997,37.41063309]],"timestamp":[430,434.78766762351097,439.61796951186363]},{"passenger_id":12612,"vehicle_id":80,"route":[[127.1743214,37.4231074],[127.15818787,37.43616867],[127.15974426,37.44196701]],"timestamp":[430,434.06879196303305,435.387244690674]},{"passenger_id":8319,"vehicle_id":8,"route":[[127.09789658,37.4047868],[127.0887888,37.40742544],[127.07313099,37.32821597]],"timestamp":[430,431.7126073707172,449.5440533859726]},{"passenger_id":17626,"vehicle_id":86,"route":[[127.10166621,37.40438829],[127.11392544,37.40070713],[127.12455404,37.41020768]],"timestamp":[431,433.3153217695037,436.1418873159309]},{"passenger_id":10093,"vehicle_id":89,"route":[[127.15049423,37.44206763],[127.1505127,37.41568756],[127.12677765,37.40238953]],"timestamp":[431,436.86666080383566,441.99746321643323]},{"passenger_id":5880,"vehicle_id":59,"route":[[127.12602397,37.41128971],[127.13145447,37.4071846],[127.00008392,37.50027084]],"timestamp":[431,432.32426627077353,463.41194060325245]},{"passenger_id":5822,"vehicle_id":25,"route":[[127.1704101,37.4575268],[127.16532616,37.44221829],[127.16752813,37.46124247]],"timestamp":[431,434.520792510531,438.7694001713425]},{"passenger_id":14962,"vehicle_id":92,"route":[[127.12683491,37.44824649],[127.14352481,37.43909919],[127.14294341,37.43554602]],"timestamp":[431,434.5808309217201,435.37766127246033]},{"passenger_id":20741,"vehicle_id":18,"route":[[127.13111903,37.4337939],[127.13634569,37.43130214],[127.13425903,37.41339048]],"timestamp":[431,432.0765625201759,436.0769461976931]},{"passenger_id":5820,"vehicle_id":94,"route":[[127.124471,37.4329439],[127.12900543,37.43166733],[127.09629059,37.41238403]],"timestamp":[431,431.8495878190823,439.0451431592609]},{"passenger_id":17650,"vehicle_id":91,"route":[[127.1498607,37.4557775],[127.16600544,37.43801427],[127.11304456,37.37612678]],"timestamp":[431,435.87141852777813,452.5133366486661]},{"passenger_id":10088,"vehicle_id":35,"route":[[127.12380317,37.38784711],[127.13378524,37.37361929],[127.12857299,37.39732562]],"timestamp":[431,434.6226108688178,439.9745049216007]},{"passenger_id":5819,"vehicle_id":39,"route":[[127.105789766567,37.3711986076343],[127.09382386,37.38258968],[127.1144332,37.37916361]],"timestamp":[432,435.2998803429315,439.0207022042823]},{"passenger_id":14983,"vehicle_id":22,"route":[[127.12511962,37.41003428],[127.12541962,37.38759613],[127.10654449,37.40009689]],"timestamp":[432,436.9902983593314,441.332008613896]},{"passenger_id":8307,"vehicle_id":9,"route":[[127.12904358,37.43126297],[127.1289292,37.4324143],[127.144522,37.43018659]],"timestamp":[432,432.25683960291485,435.0546766497991]},{"passenger_id":774,"vehicle_id":67,"route":[[127.08628845,37.40497971],[127.11080933,37.39189529],[127.0957489,37.4107933]],"timestamp":[432,437.21871968560424,442.1928620908025]},{"passenger_id":20776,"vehicle_id":14,"route":[[127.10455054,37.3247564],[127.11323157,37.34596216],[127.15509466,37.40543245]],"timestamp":[432,436.95947195218713,452.11373270814994]},{"passenger_id":10086,"vehicle_id":50,"route":[[127.14155579,37.44607544],[127.14352537,37.43909952],[127.13137215,37.43434021]],"timestamp":[432,433.58987511682454,435.9827405031122]},{"passenger_id":12657,"vehicle_id":33,"route":[[127.1203632,37.4588811],[127.13310242,37.44586945],[127.14837646,37.35383987]],"timestamp":[432,435.66490613529237,456.3084784365994]},{"passenger_id":20827,"vehicle_id":72,"route":[[127.10033417,37.40275574],[127.11063385,37.39762115],[127.07146454,37.2238121]],"timestamp":[432,434.14824848520595,473.41762263511447]},{"passenger_id":20734,"vehicle_id":11,"route":[[127.10818481,37.36684036],[127.10739136,37.3560791],[127.12381744,37.35131454]],"timestamp":[432,434.39730113156196,437.4883672177131]},{"passenger_id":3250,"vehicle_id":84,"route":[[127.12840271,37.4124527],[127.14833069,37.42788696],[127.12941742,37.43099976]],"timestamp":[432,436.9162973280492,440.32736968333154]},{"passenger_id":20737,"vehicle_id":76,"route":[[127.1403447,37.4662273],[127.17472909,37.43126787],[127.17898819,37.44388888]],"timestamp":[432,441.86399963480073,444.7697970936568]},{"passenger_id":20739,"vehicle_id":52,"route":[[127.12944253,37.4305084],[127.14011251,37.43558979],[127.13410707,37.4415969]],"timestamp":[432,434.19712055787323,435.90275859774044]},{"passenger_id":8317,"vehicle_id":79,"route":[[127.10821533,37.36696243],[127.10991406,37.34694998],[127.12602398,37.41100801]],"timestamp":[432,436.4606847112445,450.98822543215465]},{"passenger_id":20744,"vehicle_id":0,"route":[[127.14329009,37.4720142],[127.163372744414,37.4573008585225],[127.140378442144,37.4374509800023]],"timestamp":[432,436.82422863619934,442.82166416882205]},{"passenger_id":5828,"vehicle_id":62,"route":[[127.1027596,37.4222514],[127.11553955,37.39622116],[127.16602325,37.45042801]],"timestamp":[432,438.2134898939943,453.2075657480061]},{"passenger_id":17623,"vehicle_id":17,"route":[[127.12556697,37.40974376],[127.14299011,37.43312454],[127.14892578,37.43709564]],"timestamp":[433,439.04200941402763,440.4126173005494]},{"passenger_id":773,"vehicle_id":87,"route":[[127.12749481,37.4402771],[127.13555908,37.45013809],[127.12887573,37.43297958]],"timestamp":[433,435.6146769880094,439.6088656232649]},{"passenger_id":17660,"vehicle_id":96,"route":[[127.13786943,37.40693092],[127.16366106,37.4440001],[127.19781733,37.38879175]],"timestamp":[433,442.41853978851464,456.09851054466657]},{"passenger_id":17643,"vehicle_id":54,"route":[[127.159255,37.444446],[127.15956879,37.44491577],[127.12775421,37.43919754]],"timestamp":[433,433.1182541058607,438.8779128978827]},{"passenger_id":10102,"vehicle_id":7,"route":[[127.121531,37.388065],[127.11831988,37.33973423],[127.16762983,37.25760476]],"timestamp":[433,443.7632484560419,464.00425019925586]},{"passenger_id":788,"vehicle_id":90,"route":[[127.1296934,37.4646595],[127.14546204,37.47278976],[127.17082977,37.43156052]],"timestamp":[433,436.31901409584793,446.52331044328514]},{"passenger_id":12631,"vehicle_id":55,"route":[[127.129513,37.432317],[127.15059662,37.43947601],[127.13020325,37.43312836]],"timestamp":[433,437.0491823225436,440.9171292429752]},{"passenger_id":10090,"vehicle_id":95,"route":[[127.1011146,37.4225788],[127.1289444,37.43222427],[127.1360321,37.43222427]],"timestamp":[433,438.3625887983864,439.61423235243876]},{"passenger_id":20738,"vehicle_id":32,"route":[[127.0505121,37.3657016],[127.11019135,37.35005188],[127.12341309,37.35154724]],"timestamp":[433,444.1087117445999,446.46966424721046]},{"passenger_id":20735,"vehicle_id":77,"route":[[127.1031323,37.4500066],[127.1417139,37.46439754],[127.15373537,37.45667423]],"timestamp":[433,440.5254376039205,443.25554122341686]},{"passenger_id":12638,"vehicle_id":30,"route":[[127.12926195,37.41233542],[127.11819701,37.40158741],[127.15725566,37.44569784]],"timestamp":[434,437.087713946271,449.0800884597499]},{"passenger_id":17652,"vehicle_id":21,"route":[[127.12940516,37.43083787],[127.13245168,37.44354325],[127.12528542,37.40967284]],"timestamp":[434,436.87630334412637,444.5143238720295]},{"passenger_id":14973,"vehicle_id":69,"route":[[127.0689135,37.4264445],[127.13265953,37.44561729],[127.16445071,37.4460912]],"timestamp":[434,446.03706053201125,451.651151254278]},{"passenger_id":778,"vehicle_id":43,"route":[[127.0997467,37.40332031],[127.10654579,37.37244158],[127.11302267,37.39596602]],"timestamp":[434,440.9714143356458,446.3267394972181]},{"passenger_id":14970,"vehicle_id":4,"route":[[127.21488635,37.40846743],[127.16539217623,37.4373037586143],[127.17401712283,37.4331787838308]],"timestamp":[434,444.8415108349406,446.6194922524846]},{"passenger_id":10095,"vehicle_id":83,"route":[[127.0939333,37.4302943],[127.12667251,37.44063287],[127.13696818,37.46580877]],"timestamp":[434,440.2217039445779,446.1082228049768]},{"passenger_id":10100,"vehicle_id":49,"route":[[127.10248276,37.40370542],[127.11379613,37.40651551],[127.14773244,37.35751285]],"timestamp":[434,436.09402057113107,448.532800350775]},{"passenger_id":15020,"vehicle_id":16,"route":[[127.12726593,37.36907578],[127.11330414,37.36051941],[127.2411499,37.39093018]],"timestamp":[434,437.1162150628271,460.70049309597124]},{"passenger_id":20758,"vehicle_id":6,"route":[[127.10600236,37.35976203],[127.10808809,37.36627078],[127.08955039,37.38952866]],"timestamp":[434,435.4936913043479,441.6162023439102]},{"passenger_id":5825,"vehicle_id":34,"route":[[127.16551191,37.43915767],[127.16164398,37.4353981],[127.12947845,37.41210938]],"timestamp":[434.7646040306185,435.8442077889222,443.5316122145467]},{"passenger_id":12630,"vehicle_id":26,"route":[[127.1130747,37.39322232],[127.11068206,37.39376212],[127.10344673,37.40319887]],"timestamp":[435,435.4394580617871,437.8967541593727]},{"passenger_id":5840,"vehicle_id":60,"route":[[127.10232789,37.40391325],[127.1138382,37.40037155],[127.19799805,37.38869858]],"timestamp":[435,437.1806777915093,452.2751624386721]},{"passenger_id":12642,"vehicle_id":13,"route":[[127.12973022,37.48679733],[127.1272535,37.45649598],[127.10607578,37.40122974]],"timestamp":[435.38620147518105,442.1390781796499,454.9861734302313]},{"passenger_id":15001,"vehicle_id":9,"route":[[127.144522,37.43018659],[127.14385709,37.43765201],[127.12008312,37.37317513]],"timestamp":[435.0546766497991,436.7190571312659,451.6604648881795]},{"passenger_id":17630,"vehicle_id":52,"route":[[127.13410707,37.4415969],[127.13535789,37.44641458],[127.12996371,37.43396009]],"timestamp":[435.90275859774044,436.9966874863107,439.9256361005092]},{"passenger_id":23601,"vehicle_id":82,"route":[[127.136924,37.42973725],[127.138302,37.438038],[127.121158,37.416053]],"timestamp":[435.3074154028291,437.16938754109145,442.9201998547477]},{"passenger_id":23602,"vehicle_id":80,"route":[[127.15974426,37.44196701],[127.159979,37.451672],[127.138729,37.444571]],"timestamp":[435.387244690674,437.5459338942694,441.6165599559055]},{"passenger_id":12634,"vehicle_id":74,"route":[[127.11167145,37.39376068],[127.11089325,37.39605331],[127.07614136,37.37529373]],"timestamp":[435.39931029694577,435.9273816482035,443.6100437098797]},{"passenger_id":15027,"vehicle_id":92,"route":[[127.14294341,37.43554602],[127.1434278,37.43803266],[127.08400218,37.31951296]],"timestamp":[435.37766127246033,435.93724068410165,464.3098891346242]},{"passenger_id":20766,"vehicle_id":50,"route":[[127.13137215,37.43434021],[127.13728333,37.44698715],[127.12483215,37.41685104]],"timestamp":[436,438.9999797164279,446.05342562976426]},{"passenger_id":3251,"vehicle_id":42,"route":[[127.15395355,37.40394211],[127.12346235,37.38876605],[127.12159555,37.38915889]],"timestamp":[436,442.3570321094981,442.6982610072908]},{"passenger_id":17631,"vehicle_id":99,"route":[[127.1235012,37.35150634],[127.10733032,37.34050751],[127.12380219,37.3509407]],"timestamp":[436,439.76254169625236,443.48602518285185]},{"passenger_id":20751,"vehicle_id":53,"route":[[127.177408768499,37.4315315716794],[127.16594239,37.45062542],[127.16596939,37.43595029]],"timestamp":[436.8329007048319,441.53716373341433,444.80076722306393]},{"passenger_id":3255,"vehicle_id":15,"route":[[127.10573578,37.4040947],[127.11276245,37.39027786],[127.10668182,37.3768959]],"timestamp":[436.74741271626823,440.0614478410775,443.22549515855235]},{"passenger_id":17636,"vehicle_id":61,"route":[[127.12186432,37.38718796],[127.1284678,37.37794358],[127.12371201,37.35097288]],"timestamp":[436.7590505496423,439.1229913270251,445.1796188355623]},{"passenger_id":14989,"vehicle_id":1,"route":[[127.17667389,37.43600845],[127.16570282,37.45504761],[127.11571503,37.41609955]],"timestamp":[436.74621042483295,441.4023901415429,453.7693852351544]},{"passenger_id":17645,"vehicle_id":10,"route":[[127.12721252,37.41239166],[127.10102844,37.43096161],[127.09874725,37.35645294]],"timestamp":[436.62151502982994,442.8216666038606,459.39654001249824]},{"passenger_id":23604,"vehicle_id":24,"route":[[127.10966706,37.40271487],[127.113418,37.390283],[127.098673,37.356398]],"timestamp":[437,439.84303869206985,447.8165764391549]},{"passenger_id":23600,"vehicle_id":86,"route":[[127.12455404,37.41020768],[127.117835,37.39106],[127.125228,37.409976]],"timestamp":[437,441.42060599868574,445.825429716883]},{"passenger_id":3260,"vehicle_id":5,"route":[[127.12547302,37.40980911],[127.12609863,37.38847351],[127.10457611,37.3998909]],"timestamp":[437,441.74610811511934,446.3185705901842]},{"passenger_id":3263,"vehicle_id":40,"route":[[127.10824585,37.36682892],[127.10706329,37.36849976],[127.09804535,37.37844467]],"timestamp":[437,437.42632899804653,440.1523988694038]},{"passenger_id":20749,"vehicle_id":18,"route":[[127.13425903,37.41339048],[127.12935638,37.43124771],[127.1437912,37.44468307]],"timestamp":[437,441.06456990195915,444.9919586366783]},{"passenger_id":17629,"vehicle_id":66,"route":[[127.14614725,37.44232189],[127.15039717,37.44203092],[127.13841732,37.44416521]],"timestamp":[437,437.7531943259745,439.9210525660829]},{"passenger_id":17622,"vehicle_id":93,"route":[[127.15796946,37.46112067],[127.16331735,37.4571524],[127.15465424,37.4439958]],"timestamp":[437.1230198328909,438.41533131124817,441.7168695180426]},{"passenger_id":14976,"vehicle_id":26,"route":[[127.10344673,37.40319887],[127.11145522,37.39177306],[127.10237278,37.40386653]],"timestamp":[438,440.9083600217789,444.04014684087855]},{"passenger_id":20761,"vehicle_id":71,"route":[[127.10910797,37.34921646],[127.10871124,37.34992218],[127.13707733,37.33237076]],"timestamp":[438,438.17190394948335,444.52716060861974]},{"passenger_id":3266,"vehicle_id":11,"route":[[127.12381744,37.35131454],[127.1220932,37.36859894],[127.12754059,37.41243744]],"timestamp":[438,441.85593951351996,451.652574668034]},{"passenger_id":17661,"vehicle_id":78,"route":[[127.1785965,37.43874741],[127.16764832,37.45623016],[127.1114502,37.39188766]],"timestamp":[438.8811573995153,443.2231466961246,460.6375897325135]},{"passenger_id":797,"vehicle_id":29,"route":[[127.12428452,37.38227229],[127.13617194,37.37845351],[126.95008347,37.37334155]],"timestamp":[438.91362236739946,441.1794930496685,474.085905950079]},{"passenger_id":17634,"vehicle_id":25,"route":[[127.16752813,37.46124247],[127.163686631359,37.4572008591335],[127.148045061421,37.4446370471337]],"timestamp":[438.7694001713425,439.89533933500786,443.8237935237664]},{"passenger_id":782,"vehicle_id":36,"route":[[127.12554843,37.40973899],[127.12862374,37.41137295],[127.10966999,37.40155819]],"timestamp":[438.1641002128434,438.8176669035093,442.81454986416804]},{"passenger_id":20769,"vehicle_id":2,"route":[[127.10547997,37.44990273],[127.12913513,37.44464111],[127.1710434,37.44882965]],"timestamp":[438.7368090640757,443.07414373421017,450.53184893547655]},{"passenger_id":14977,"vehicle_id":20,"route":[[127.1739502,37.4402771],[127.15819274,37.43784989],[127.17299571,37.43684268]],"timestamp":[438.229219869076,441.0635102053891,443.6870230321793]},{"passenger_id":20760,"vehicle_id":54,"route":[[127.12775421,37.43919754],[127.12973785,37.43293381],[127.14820099,37.43450165]],"timestamp":[439,440.43635564074424,443.71535645401224]},{"passenger_id":781,"vehicle_id":44,"route":[[127.10056673,37.40347453],[127.11226654,37.39724731],[127.10244751,37.40389633]],"timestamp":[439,441.4880363057607,443.7674453162655]},{"passenger_id":14990,"vehicle_id":94,"route":[[127.09629059,37.41238403],[127.07764319,37.39153936],[127.10388,37.44947102]],"timestamp":[439.0451431592609,444.73213686356513,458.42359861087976]},{"passenger_id":15026,"vehicle_id":57,"route":[[127.10785934,37.40321796],[127.12116664,37.40544586],[127.10109504,37.51197378]],"timestamp":[439.99927238427676,442.4017778645654,466.35601196152436]},{"passenger_id":8321,"vehicle_id":46,"route":[[127.12602997,37.41063309],[127.12891151,37.41234861],[127.16448383,37.45055587]],"timestamp":[439.61796951186363,440.2540803922655,450.8210038283602]},{"passenger_id":17678,"vehicle_id":87,"route":[[127.12887573,37.43297958],[127.12892495,37.43244983],[127.24029235,37.4320529]],"timestamp":[439.6088656232649,439.7269968489013,459.3939739936196]},{"passenger_id":17654,"vehicle_id":58,"route":[[127.14115192,37.47829118],[127.14124061,37.46283423],[127.17898979,37.44011314]],"timestamp":[439.73116570683317,443.16867019341237,451.5321915095707]},{"passenger_id":10108,"vehicle_id":52,"route":[[127.12996371,37.43396009],[127.12818841,37.43663612],[127.10669649,37.37670772]],"timestamp":[440,440.67264299427603,454.5303423773097]},{"passenger_id":17633,"vehicle_id":39,"route":[[127.1144332,37.37916361],[127.11781062,37.37397914],[127.10808803,37.36834758]],"timestamp":[440,441.2983093027871,443.4246279849048]},{"passenger_id":17653,"vehicle_id":35,"route":[[127.12857299,37.39732562],[127.12333565,37.40037646],[127.15754862,37.44504737]],"timestamp":[440,441.1473874653765,452.7751143362097]},{"passenger_id":17684,"vehicle_id":98,"route":[[127.10065646537,37.4050734004477],[127.11031755,37.3973965],[127.10480406,37.4839254]],"timestamp":[440,442.4141036198606,461.68186358170675]},{"passenger_id":12648,"vehicle_id":66,"route":[[127.13841732,37.44416521],[127.13843402,37.44413124],[127.17395335,37.44020565]],"timestamp":[440,440.0081096387971,446.3402378795399]},{"passenger_id":12654,"vehicle_id":75,"route":[[127.120053567027,37.3480793045467],[127.11224365,37.35535431],[127.10656738,37.40000916]],"timestamp":[440,442.1269213234312,452.10824180915483]},{"passenger_id":10098,"vehicle_id":45,"route":[[127.123151,37.384176],[127.11683136,37.39032763],[127.11334092,37.41410799]],"timestamp":[440,441.7659447003137,447.0902838378141]},{"passenger_id":20754,"vehicle_id":95,"route":[[127.1360321,37.43222427],[127.13680979,37.44069816],[127.12884537,37.43313451]],"timestamp":[440,441.8895041767729,444.08205765235385]},{"passenger_id":17641,"vehicle_id":40,"route":[[127.09804535,37.37844467],[127.10596311,37.37293067],[127.15073921,37.44217018]],"timestamp":[440.1523988694038,442.0129630282136,459.32388880281644]},{"passenger_id":17639,"vehicle_id":51,"route":[[127.15126659,37.41564311],[127.16282552528,37.4119205805524],[127.157358892573,37.4317871257097]],"timestamp":[440.4917249153121,442.69491277124797,447.2172982939783]},{"passenger_id":14975,"vehicle_id":17,"route":[[127.14892578,37.43709564],[127.14717314,37.4358307],[127.1584206,37.444101]],"timestamp":[440.4126173005494,440.83084915337275,443.5377049302026]},{"passenger_id":840,"vehicle_id":73,"route":[[127.10115051,37.4037056],[127.12864866,37.413126],[127.39890235,37.06875762]],"timestamp":[440.2114273719282,445.5014916987222,535.8032677245909]},{"passenger_id":20752,"vehicle_id":31,"route":[[127.25312572,37.41745685],[127.16801453,37.44072723],[127.17316437,37.43421173]],"timestamp":[440.10640454704946,456.0030881268088,457.71378752850813]},{"passenger_id":3281,"vehicle_id":84,"route":[[127.12941742,37.43099976],[127.12426758,37.44061661],[127.10668945,37.37689972]],"timestamp":[440.32736968333154,442.65136995805796,457.15759733625464]},{"passenger_id":12636,"vehicle_id":68,"route":[[127.10601807,37.40125656],[127.11694594,37.39057372],[127.11108193,37.39623059]],"timestamp":[441,444.0613605584471,445.69111869166045]},{"passenger_id":15012,"vehicle_id":55,"route":[[127.13020325,37.43312836],[127.13082123,37.44296265],[127.23233032,37.50677872]],"timestamp":[441,443.1897669682357,466.04550349505706]},{"passenger_id":17657,"vehicle_id":6,"route":[[127.08955039,37.38952866],[127.10645087356,37.3684402911705],[127.097942593263,37.4045456259131]],"timestamp":[441.6162023439102,447.1762939221624,455.3452914684205]},{"passenger_id":20771,"vehicle_id":93,"route":[[127.15465424,37.4439958],[127.14725008,37.44371164],[127.09504518,37.4107964]],"timestamp":[441.7168695180426,443.02572123217163,454.7979324840678]},{"passenger_id":20750,"vehicle_id":80,"route":[[127.138729,37.444571],[127.1362381,37.44670868],[127.12706757,37.44799805]],"timestamp":[441.6165599559055,442.26419128088855,443.90851681136377]},{"passenger_id":3275,"vehicle_id":22,"route":[[127.10654449,37.40009689],[127.13086408,37.38459972],[127.10948599,37.33808604]],"timestamp":[441.332008613896,446.84034366811807,457.85312078393093]},{"passenger_id":5837,"vehicle_id":89,"route":[[127.12677765,37.40238953],[127.12740326,37.41595459],[127.09844208,37.41275787]],"timestamp":[441.99746321643323,445.0162184658253,450.1809648431666]},{"passenger_id":8325,"vehicle_id":38,"route":[[127.12175009,37.3877993],[127.122734106399,37.387204065204],[127.136828463881,37.4107483655736]],"timestamp":[442,442.2185301160918,448.01648999697903]},{"passenger_id":5833,"vehicle_id":70,"route":[[127.10148621,37.39796066],[127.10432434,37.38063431],[127.11162567,37.39376831]],"timestamp":[442,445.88570069996985,449.07880959683064]},{"passenger_id":5830,"vehicle_id":42,"route":[[127.12159555,37.38915889],[127.11785366,37.36855713],[127.10712025,37.37709347]],"timestamp":[442.6982610072908,447.32735761067715,450.01107671229295]},{"passenger_id":3272,"vehicle_id":12,"route":[[127.10600237,37.3596857],[127.1059837,37.36238898],[127.10146307,37.40450436]],"timestamp":[442.19951728431937,442.8007083847668,452.2007464021128]},{"passenger_id":20770,"vehicle_id":3,"route":[[127.10673523,37.36845016],[127.10808809,37.36624883],[127.09660827,37.31012296]],"timestamp":[442.07667028955495,442.6214985820933,455.2672904737021]},{"passenger_id":20755,"vehicle_id":67,"route":[[127.0957489,37.4107933],[127.1326485,37.43889549],[127.13683349,37.43033184]],"timestamp":[442.1928620908025,451.2221346555701,453.26496394158335]},{"passenger_id":10117,"vehicle_id":47,"route":[[127.13990784,37.30563354],[127.11348659,37.34592551],[127.11860508,37.40083279]],"timestamp":[443,453.1055848209974,465.3498683782951]},{"passenger_id":23607,"vehicle_id":81,"route":[[127.11096191,37.40228653],[127.13177122,37.40912308],[127.10211864,37.40408937]],"timestamp":[443,446.97809415412456,452.33462698224474]},{"passenger_id":10113,"vehicle_id":27,"route":[[127.11550511,37.40529221],[127.12831971,37.41232266],[127.14858736,37.35977665]],"timestamp":[443,445.75114689840285,457.9733241384026]},{"passenger_id":5834,"vehicle_id":23,"route":[[127.24852753,37.37726974],[127.16113014,37.41224287],[127.12887369,37.41117657]],"timestamp":[443,460.2897003023611,465.99248110388726]},{"passenger_id":20783,"vehicle_id":0,"route":[[127.140378442144,37.4374509800023],[127.13813723,37.43460823],[127.1757539,37.43981986]],"timestamp":[443,443.74585814174924,450.4886422088251]},{"passenger_id":8318,"vehicle_id":36,"route":[[127.10966999,37.40155819],[127.11110672,37.37641835],[127.12520076,37.38366132]],"timestamp":[443,448.5966059747119,451.5627335581417]},{"passenger_id":15155,"vehicle_id":82,"route":[[127.121158,37.416053],[127.14326779,37.42732334],[127.48346937,37.2467913]],"timestamp":[443,447.64016323798944,519.9614318962506]},{"passenger_id":3265,"vehicle_id":54,"route":[[127.14820099,37.43450165],[127.14549145,37.43993325],[127.18067848,37.44383259]],"timestamp":[443.71535645401224,445.0145952856375,451.2878285963586]},{"passenger_id":780,"vehicle_id":77,"route":[[127.15373537,37.45667423],[127.15856171,37.45863724],[127.16822052,37.45664215]],"timestamp":[443.25554122341686,444.2128829314733,445.9747699909107]},{"passenger_id":10123,"vehicle_id":80,"route":[[127.12706757,37.44799805],[127.12936401,37.44610596],[127.17019653,37.43546295]],"timestamp":[443.90851681136377,444.49285595572206,452.08136600148663]},{"passenger_id":20775,"vehicle_id":99,"route":[[127.12380219,37.3509407],[127.12308543,37.36118486],[127.12561329,37.40975567]],"timestamp":[443.48602518285185,445.76774308163215,456.5786303292286]},{"passenger_id":8320,"vehicle_id":39,"route":[[127.10808803,37.36834758],[127.10811024,37.36249518],[127.12371277,37.35146608]],"timestamp":[443.4246279849048,444.72614828257076,448.4170855884436]},{"passenger_id":14985,"vehicle_id":25,"route":[[127.148045061421,37.4446370471337],[127.14564914,37.44024474],[127.13528989,37.42921469]],"timestamp":[443.8237935237664,444.88827268001955,447.94825154095616]},{"passenger_id":12643,"vehicle_id":20,"route":[[127.17299571,37.43684268],[127.169567150392,37.4373009808456],[127.148611724442,37.4267510454268]],"timestamp":[443.6870230321793,444.3009652068624,448.6826476384044]},{"passenger_id":17648,"vehicle_id":17,"route":[[127.1584206,37.444101],[127.15581946,37.44420767],[127.17397874,37.43531367]],"timestamp":[443.5377049302026,443.99758903323556,447.76505801880893]},{"passenger_id":3276,"vehicle_id":15,"route":[[127.10668182,37.3768959],[127.1080423,37.37176187],[127.10073965,37.40352738]],"timestamp":[444,445.16679800751723,452.34800766936826]},{"passenger_id":786,"vehicle_id":44,"route":[[127.10244751,37.40389633],[127.10944366,37.40407181],[127.12626648,37.38703537]],"timestamp":[444,445.23655831858446,450.05203476427624]},{"passenger_id":12646,"vehicle_id":74,"route":[[127.07614136,37.37529373],[127.07786029,37.39152319],[127.10592924,37.40322368]],"timestamp":[444,447.6220262398217,453.2223408189803]},{"passenger_id":8328,"vehicle_id":34,"route":[[127.12947845,37.41210938],[127.13180673,37.42029131],[127.10842599,37.40027419]],"timestamp":[444,445.8654730092591,451.93791312730866]},{"passenger_id":17632,"vehicle_id":19,"route":[[127.10505676,37.48389053],[127.133725,37.44955307],[127.15875875,37.44874603]],"timestamp":[444.5495759501283,453.7103473266312,458.1337939854669]},{"passenger_id":20873,"vehicle_id":85,"route":[[127.2366523,37.43002244],[127.17035351,37.45179882],[127.19140801,37.54942413]],"timestamp":[444.8227133526817,457.4914732341359,479.5178478528038]},{"passenger_id":12665,"vehicle_id":21,"route":[[127.12528542,37.40967284],[127.12160714,37.40057155],[127.10277827,37.3387572]],"timestamp":[444.5143238720295,446.6401063630042,460.7840565846326]},{"passenger_id":20774,"vehicle_id":95,"route":[[127.12884537,37.43313451],[127.1292164,37.43226407],[127.16599395,37.43745913]],"timestamp":[444.08205765235385,444.28642273556994,450.88284242809067]},{"passenger_id":20765,"vehicle_id":53,"route":[[127.16596939,37.43595029],[127.16481358,37.43514018],[127.1765106,37.43698611]],"timestamp":[445,445.27223965591605,447.37815385024857]},{"passenger_id":20767,"vehicle_id":18,"route":[[127.1437912,37.44468307],[127.14094533,37.44805932],[127.14988058,37.45555937]],"timestamp":[445,445.9034601735904,448.1992175852076]},{"passenger_id":17656,"vehicle_id":71,"route":[[127.13707733,37.33237076],[127.1230066,37.35150788],[127.10980247,37.3500089]],"timestamp":[445,449.92968862741753,452.2876739590667]},{"passenger_id":12653,"vehicle_id":26,"route":[[127.10237278,37.40386653],[127.10971069,37.39333344],[127.12368011,37.35147476]],"timestamp":[445,447.6772680670264,457.3080442579296]},{"passenger_id":15032,"vehicle_id":76,"route":[[127.17898819,37.44388888],[127.17134669,37.44822289],[127.10674294,37.40321794]],"timestamp":[445,446.65810304507943,461.83545906241216]},{"passenger_id":20756,"vehicle_id":48,"route":[[127.11552619,37.37870759],[127.11490631,37.36896515],[127.12133789,37.36346054]],"timestamp":[445,447.16938771708107,448.8399727510698]},{"passenger_id":10128,"vehicle_id":41,"route":[[127.21853963,37.40290359],[127.1640625,37.43300629],[127.11345673,37.37453461]],"timestamp":[445.7322311623918,457.45411879081416,473.234355222376]},{"passenger_id":10099,"vehicle_id":77,"route":[[127.16822052,37.45664215],[127.16932563,37.45787507],[127.16274823,37.45787905]],"timestamp":[445.9747699909107,446.3112811376638,447.47241105109197]},{"passenger_id":14988,"vehicle_id":86,"route":[[127.125228,37.409976],[127.13378906,37.40826416],[127.12423706,37.38880539]],"timestamp":[446,447.5594772450639,452.20432502321734]},{"passenger_id":3279,"vehicle_id":68,"route":[[127.11108193,37.39623059],[127.11075365,37.39165739],[127.09350016,37.42894985]],"timestamp":[446,447.0186858687568,455.854428047755]},{"passenger_id":20803,"vehicle_id":61,"route":[[127.12371201,37.35097288],[127.11112213,37.35339737],[127.14345551,37.44203568]],"timestamp":[446,448.2900483158821,468.8133499668197]},{"passenger_id":8322,"vehicle_id":32,"route":[[127.12341309,37.35154724],[127.10901079,37.35066496],[127.10668218,37.37680629]],"timestamp":[446.46966424721046,449.023323229824,454.8514417532997]},{"passenger_id":15010,"vehicle_id":66,"route":[[127.17395335,37.44020565],[127.16408551,37.44150506],[127.10596803,37.3685305]],"timestamp":[446.3402378795399,448.1064364937115,467.3101722784352]},{"passenger_id":15048,"vehicle_id":5,"route":[[127.10457611,37.3998909],[127.09236145,37.38770676],[127.16178894,37.49980927]],"timestamp":[446.3185705901842,449.78262254204293,477.5639168725008]},{"passenger_id":12647,"vehicle_id":43,"route":[[127.11302267,37.39596602],[127.12407159,37.38856943],[127.11940421,37.37368477]],"timestamp":[446.3267394972181,448.8795639095093,452.2909696530428]},{"passenger_id":20768,"vehicle_id":4,"route":[[127.17401712283,37.4331787838308],[127.16599344,37.43745176],[127.17825416,37.43257212]],"timestamp":[446.6194922524846,448.32552207622433,450.747343293483]},{"passenger_id":20820,"vehicle_id":83,"route":[[127.13696818,37.46580877],[127.14055634,37.4515686],[127.11486816,37.38814163]],"timestamp":[446.1082228049768,449.3378180417272,464.15507176631417]},{"passenger_id":3268,"vehicle_id":63,"route":[[127.10921333,37.40241439],[127.11226654,37.39705276],[127.10955048,37.40386963]],"timestamp":[447,448.3087078746791,449.89883782268004]},{"passenger_id":17669,"vehicle_id":50,"route":[[127.12483215,37.41685104],[127.13007888,37.41542461],[127.17094281,37.44746412]],"timestamp":[447,447.97952828121305,458.1208121158967]},{"passenger_id":23606,"vehicle_id":90,"route":[[127.17082977,37.43156052],[127.163282,37.433502],[127.159178,37.44459]],"timestamp":[447,448.401071030622,450.97120965170757]},{"passenger_id":20780,"vehicle_id":77,"route":[[127.16274823,37.45787905],[127.16191735,37.45688759],[127.12529371,37.43284468]],"timestamp":[447.47241105109197,447.73723329332813,456.1279325761458]},{"passenger_id":12649,"vehicle_id":51,"route":[[127.157358892573,37.4317871257097],[127.15818787,37.43603897],[127.15796661,37.46166611]],"timestamp":[447.2172982939783,448.1741299009532,453.87347968501854]},{"passenger_id":14995,"vehicle_id":53,"route":[[127.1765106,37.43698611],[127.16248322,37.44045258],[127.15737915,37.43179321]],"timestamp":[447.37815385024857,449.972280783002,452.09851638506535]},{"passenger_id":10096,"vehicle_id":24,"route":[[127.098673,37.356398],[127.10732736,37.35551544],[127.11584191,37.35989164]],"timestamp":[447.8165764391549,449.35897712739103,451.15132871545995]},{"passenger_id":5868,"vehicle_id":17,"route":[[127.17397874,37.43531367],[127.16172791,37.43335724],[127.13666534,37.33272171]],"timestamp":[447.76505801880893,449.9717355715514,472.78605150834574]},{"passenger_id":12667,"vehicle_id":25,"route":[[127.13528989,37.42921469],[127.13377814,37.43374007],[127.11169743,37.39814461]],"timestamp":[447.94825154095616,448.9894576631369,457.8141630053254]},{"passenger_id":10142,"vehicle_id":45,"route":[[127.11334092,37.41410799],[127.12743378,37.40312576],[127.10463715,37.4841423]],"timestamp":[448,451.48749146346165,469.9488885881944]},{"passenger_id":10110,"vehicle_id":39,"route":[[127.12371277,37.35146608],[127.11745118,37.362559],[127.15968944,37.33430272]],"timestamp":[448.4170855884436,451.1209740264469,460.88052882108263]},{"passenger_id":8347,"vehicle_id":49,"route":[[127.14773244,37.35751285],[127.12944965,37.36476513],[127.11734815,37.2795928]],"timestamp":[448.532800350775,452.1445939769463,471.20658182053853]},{"passenger_id":17698,"vehicle_id":18,"route":[[127.14988058,37.45555937],[127.14901733,37.45196152],[127.09775543,37.4041481]],"timestamp":[448.1992175852076,449.01372757227307,462.9787837738096]},{"passenger_id":790,"vehicle_id":48,"route":[[127.12133789,37.36346054],[127.11825321,37.36244813],[127.12697419,37.39918115]],"timestamp":[448.8399727510698,449.4298692561651,457.7430195317333]},{"passenger_id":17658,"vehicle_id":20,"route":[[127.148611724442,37.4267510454268],[127.15248393,37.42848505],[127.12921553,37.43227015]],"timestamp":[448.6826476384044,449.46773148972386,453.6622197575592]},{"passenger_id":15007,"vehicle_id":38,"route":[[127.136828463881,37.4107483655736],[127.1304893,37.41380041],[127.10247739,37.40371382]],"timestamp":[449,450.30940611834103,455.7423802884767]},{"passenger_id":5857,"vehicle_id":63,"route":[[127.10955048,37.40386963],[127.11437225,37.39826202],[127.17081451,37.4341011]],"timestamp":[449.89883782268004,451.4090841016715,464.17291963731594]},{"passenger_id":23611,"vehicle_id":70,"route":[[127.11162567,37.39376831],[127.110675847714,37.393929024122],[127.095856495133,37.4108816982783]],"timestamp":[449.07880959683064,449.25039202166363,453.84036435047585]},{"passenger_id":12650,"vehicle_id":8,"route":[[127.07313099,37.32821597],[127.11658392,37.34564181],[127.12377588,37.3511123]],"timestamp":[450,458.6052826713627,460.3650335161544]},{"passenger_id":10138,"vehicle_id":30,"route":[[127.15725566,37.44569784],[127.16049194,37.44486618],[127.13128662,37.3841095]],"timestamp":[450,450.60059438833815,465.06355988364874]},{"passenger_id":23603,"vehicle_id":46,"route":[[127.16448383,37.45055587],[127.163466,37.450937],[127.156267,37.444374]],"timestamp":[450.8210038283602,451.01968827978794,452.9550961829484]},{"passenger_id":12749,"vehicle_id":90,"route":[[127.159178,37.44459],[127.16263324,37.44549915],[127.18050133,37.34437883]],"timestamp":[450.97120965170757,451.61390989329806,474.32255466497224]},{"passenger_id":17688,"vehicle_id":0,"route":[[127.1757539,37.43981986],[127.16795349,37.44268799],[127.12747192,37.41882706]],"timestamp":[450.4886422088251,452.00650330008153,460.9096161877885]},{"passenger_id":12660,"vehicle_id":4,"route":[[127.17825416,37.43257212],[127.16259766,37.43319321],[127.13386536,37.41114807]],"timestamp":[450.747343293483,453.51560712779826,460.5716306363986]},{"passenger_id":20777,"vehicle_id":2,"route":[[127.1710434,37.44882965],[127.17233276,37.44781113],[127.1572876,37.44519043]],"timestamp":[451,451.3211352914641,454.0406942720355]},{"passenger_id":5845,"vehicle_id":79,"route":[[127.12602398,37.41100801],[127.12286377,37.40761948],[127.10374451,37.40063858]],"timestamp":[451,451.93782264149485,455.6551387816227]},{"passenger_id":5843,"vehicle_id":42,"route":[[127.10712025,37.37709347],[127.10723967,37.37609618],[127.12181164,37.38939311]],"timestamp":[451,451.22278902857,455.1439083446295]},{"passenger_id":5838,"vehicle_id":95,"route":[[127.16599395,37.43745913],[127.16596938,37.43651508],[127.15425975,37.44380191]],"timestamp":[451,451.2099919659058,453.83699831666337]},{"passenger_id":12680,"vehicle_id":44,"route":[[127.12626648,37.38703537],[127.12998179,37.38238572],[127.09998288,37.4047904]],"timestamp":[451,452.2248439217222,459.4994424332192]},{"passenger_id":829,"vehicle_id":89,"route":[[127.09844208,37.41275787],[127.10919207,37.40397623],[127.04275166,37.51321482]],"timestamp":[451,453.72399563406833,480.7006896177683]},{"passenger_id":3274,"vehicle_id":24,"route":[[127.11584191,37.35989164],[127.10598301,37.36249953],[127.12484115,37.38538682]],"timestamp":[451.15132871545995,452.9879737806703,459.0719517651543]},{"passenger_id":10133,"vehicle_id":69,"route":[[127.16445071,37.4460912],[127.16553971,37.44732683],[127.12515266,37.41000948]],"timestamp":[451.651151254278,451.9865308324206,462.9293408008327]},{"passenger_id":20791,"vehicle_id":54,"route":[[127.18067848,37.44383259],[127.17514638,37.44962721],[127.2100706,37.43271408]],"timestamp":[451.2878285963586,452.9048281014451,460.12806559017775]},{"passenger_id":8332,"vehicle_id":34,"route":[[127.10842599,37.40027419],[127.11094666,37.39632797],[127.15419006,37.40529633]],"timestamp":[451.93791312730866,452.9220395783621,460.8178111059289]},{"passenger_id":12663,"vehicle_id":58,"route":[[127.17898979,37.44011314],[127.16940616,37.44469134],[127.15796945,37.46117734]],"timestamp":[451.5321915095707,453.50705597256945,457.69258232861193]},{"passenger_id":23610,"vehicle_id":9,"route":[[127.12008312,37.37317513],[127.1190033,37.37440872],[127.12380981,37.35106659]],"timestamp":[451.6604648881795,451.9946512313203,457.2547679468265]},{"passenger_id":8330,"vehicle_id":36,"route":[[127.12520076,37.38366132],[127.12822308,37.38080818],[127.12348497,37.35150733]],"timestamp":[451.5627335581417,452.3920963370215,458.9619024367938]},{"passenger_id":17651,"vehicle_id":88,"route":[[127.06646729,37.2702179],[127.12089539,37.3393898],[127.11659241,37.3382225]],"timestamp":[451.0723606641236,469.2200605118701,470.0239555525667]},{"passenger_id":8341,"vehicle_id":11,"route":[[127.12754059,37.41243744],[127.1319338,37.41369433],[127.10618543,37.37649375]],"timestamp":[452,452.8248186346067,462.26615210801367]},{"passenger_id":785,"vehicle_id":35,"route":[[127.15754862,37.44504737],[127.15820312,37.4483757],[127.14501953,37.42821884]],"timestamp":[452.7751143362097,453.52426734836166,458.5753845259558]},{"passenger_id":8382,"vehicle_id":28,"route":[[127.10874939,37.33101654],[127.12297055,37.35150788],[127.14654158,37.52854381]],"timestamp":[452.3066293985854,457.51135251410835,497.1017293321549]},{"passenger_id":12668,"vehicle_id":75,"route":[[127.10656738,37.40000916],[127.10968537,37.39453428],[127.09813289,37.41274142]],"timestamp":[452.10824180915483,453.4446211305839,457.9789616647219]},{"passenger_id":20801,"vehicle_id":60,"route":[[127.19799805,37.38869858],[127.167139387475,37.4108705869664],[127.129406287765,37.4310232415814]],"timestamp":[452.2751624386721,459.62603220730125,467.65726616593196]},{"passenger_id":20788,"vehicle_id":43,"route":[[127.11940421,37.37368477],[127.11869049,37.37023544],[127.12638092,37.39921951]],"timestamp":[452.2909696530428,453.06836757950236,459.65582445769786]},{"passenger_id":20821,"vehicle_id":71,"route":[[127.10980247,37.3500089],[127.11632313,37.34990795],[127.12664972,37.40986448]],"timestamp":[452.2876739590667,453.4406647447699,466.8986883763996]},{"passenger_id":23660,"vehicle_id":81,"route":[[127.10211864,37.40408937],[127.1173258,37.4026682],[127.49154696,37.24755121]],"timestamp":[452.33462698224474,455.03967806465107,529.6702847216122]},{"passenger_id":20778,"vehicle_id":53,"route":[[127.15737915,37.43179321],[127.16025543,37.43350983],[127.13156891,37.42870712]],"timestamp":[452.09851638506535,452.7339161865596,457.9112211961903]},{"passenger_id":8334,"vehicle_id":46,"route":[[127.156267,37.444374],[127.15033387,37.44177217],[127.15051637,37.41424312]],"timestamp":[452.9550961829484,454.15187159081427,460.2741378186628]},{"passenger_id":10122,"vehicle_id":86,"route":[[127.12423706,37.38880539],[127.12418365,37.38863754],[127.09985352,37.40474319]],"timestamp":[452.20432502321734,452.2428276647201,457.83806396157655]},{"passenger_id":17716,"vehicle_id":15,"route":[[127.10073965,37.40352738],[127.09582492,37.39404326],[127.12785835,37.45565008]],"timestamp":[452.34800766936826,454.6289172501701,469.45176806558436]},{"passenger_id":12658,"vehicle_id":12,"route":[[127.10146307,37.40450436],[127.11670915,37.40368518],[127.12072406,37.38411493]],"timestamp":[453,455.6995280916772,460.1091845085512]},{"passenger_id":3311,"vehicle_id":14,"route":[[127.15509466,37.40543245],[127.14628601,37.40826416],[127.18096924,37.3486824]],"timestamp":[453,454.6786784185166,469.2779962233458]},{"passenger_id":17665,"vehicle_id":80,"route":[[127.17019653,37.43546295],[127.16651035,37.44267289],[127.15449819,37.4439191]],"timestamp":[453,454.7304954139268,456.8694845568236]},{"passenger_id":17670,"vehicle_id":91,"route":[[127.11304456,37.37612678],[127.11172458,37.37603777],[127.07547347,37.39083029]],"timestamp":[453,453.23411330406503,460.4353350218045]},{"passenger_id":17647,"vehicle_id":62,"route":[[127.16602325,37.45042801],[127.16745556,37.45119987],[127.17651152,37.43696196]],"timestamp":[453.2075657480061,453.51319687216517,457.0603917639682]},{"passenger_id":17659,"vehicle_id":20,"route":[[127.12921553,37.43227015],[127.12921942,37.43224283],[127.14380354,37.4447684]],"timestamp":[453.6622197575592,453.66833416007233,457.46191383861617]},{"passenger_id":10121,"vehicle_id":95,"route":[[127.15425975,37.44380191],[127.147931173256,37.4471398096029],[127.130197949519,37.4294649177771]],"timestamp":[453.83699831666337,455.1784864658803,460.2039925913034]},{"passenger_id":12677,"vehicle_id":97,"route":[[127.12704715,37.41233172],[127.1327165,37.41208609],[127.10114236,37.40365102]],"timestamp":[453.5893590673069,454.5922872474676,460.4768970604864]},{"passenger_id":15013,"vehicle_id":1,"route":[[127.11571503,37.41609955],[127.1285881,37.41685834],[127.10891347,37.34076612]],"timestamp":[453.7693852351544,456.04942023609146,473.32505431272904]},{"passenger_id":17695,"vehicle_id":67,"route":[[127.13683349,37.43033184],[127.13539994,37.43406066],[127.1033017,37.39984032]],"timestamp":[453.26496394158335,454.1319970625206,463.6219542847593]},{"passenger_id":8342,"vehicle_id":74,"route":[[127.10592924,37.40322368],[127.11090851,37.39640808],[127.09772491,37.41295624]],"timestamp":[454,455.7525010485773,460.10769130931465]},{"passenger_id":20812,"vehicle_id":70,"route":[[127.095856495133,37.4108816982783],[127.09639855,37.42953954],[127.10806298,37.37056254]],"timestamp":[454,458.1504190475405,471.4272095939093]},{"passenger_id":23626,"vehicle_id":51,"route":[[127.15796661,37.46166611],[127.15820528,37.45977954],[127.11544186,37.35993071]],"timestamp":[454,454.42166414396644,477.8767557264742]},{"passenger_id":10114,"vehicle_id":52,"route":[[127.10669649,37.37670772],[127.10976268,37.37498382],[127.12590631,37.40981601]],"timestamp":[454.5303423773097,455.1941269021746,463.4489214733475]},{"passenger_id":3282,"vehicle_id":32,"route":[[127.10668218,37.37680629],[127.11141205,37.37612915],[127.12558746,37.40981674]],"timestamp":[454.8514417532997,455.700785392593,463.60013764850595]},{"passenger_id":3346,"vehicle_id":13,"route":[[127.10607578,37.40122974],[127.11477661,37.39642334],[127.00957489,37.56888962]],"timestamp":[454.9861734302313,456.8584746649961,499.47023129488]},{"passenger_id":5852,"vehicle_id":93,"route":[[127.09504518,37.4107964],[127.11684331,37.40028744],[127.15921406,37.44532079]],"timestamp":[454.7979324840678,459.30243237001423,471.80443080407895]},{"passenger_id":17680,"vehicle_id":2,"route":[[127.1572876,37.44519043],[127.15596188,37.44446668],[127.15999628,37.43111403]],"timestamp":[455,455.2840726086898,458.33782491579433]},{"passenger_id":10129,"vehicle_id":68,"route":[[127.09350016,37.42894985],[127.12892993,37.4324082],[127.18126529,37.44367118]],"timestamp":[455.854428047755,462.1583260066525,471.73313565364805]},{"passenger_id":10111,"vehicle_id":56,"route":[[127.01242001,37.48037124],[127.12876892,37.44449234],[127.13240814,37.44551086]],"timestamp":[455.6416184864198,477.675308666977,478.3566173331636]},{"passenger_id":17734,"vehicle_id":3,"route":[[127.09660827,37.31012296],[127.10552979,37.34396744],[127.12526703,37.41001892]],"timestamp":[455.2672904737021,462.95753555181284,478.05516522988495]},{"passenger_id":20830,"vehicle_id":38,"route":[[127.10247739,37.40371382],[127.1111668,37.39623102],[127.08826528,37.40709228]],"timestamp":[456,458.2640517129114,462.976138143142]},{"passenger_id":3302,"vehicle_id":6,"route":[[127.097942593263,37.4045456259131],[127.09645844,37.39807892],[127.12379456,37.35109711]],"timestamp":[456,457.4618366219816,468.9729642486539]},{"passenger_id":20802,"vehicle_id":79,"route":[[127.10374451,37.40063858],[127.11103722,37.39597125],[127.10238052,37.40385847]],"timestamp":[456,457.65451746564503,459.98167187810367]},{"passenger_id":17682,"vehicle_id":42,"route":[[127.12181164,37.38939311],[127.1239624,37.38864899],[127.09222412,37.38314438]],"timestamp":[456,456.41449718791705,462.15479755880716]},{"passenger_id":20800,"vehicle_id":96,"route":[[127.19781733,37.38879175],[127.16271021,37.41162949],[127.1369278,37.43015244]],"timestamp":[456.09851054466657,464.11500394980305,470.2554408565675]},{"passenger_id":8350,"vehicle_id":33,"route":[[127.14837646,37.35383987],[127.12941369,37.36495906],[127.13741182,37.41033596]],"timestamp":[456.3084784365994,460.47385532872454,470.66369805112225]},{"passenger_id":8344,"vehicle_id":77,"route":[[127.12529371,37.43284468],[127.12888247,37.43278515],[127.11282019,37.39510409]],"timestamp":[456.1279325761458,456.7618184416047,465.6089722613889]},{"passenger_id":8349,"vehicle_id":80,"route":[[127.15449819,37.4439191],[127.15111542,37.44227219],[127.10416412,37.44924164]],"timestamp":[456.8694845568236,457.570125690963,466.00358280632804]},{"passenger_id":17687,"vehicle_id":99,"route":[[127.12561329,37.40975567],[127.12803181,37.41232691],[127.17056292,37.4344795]],"timestamp":[457,457.71378518375576,466.6968162034268]},{"passenger_id":10130,"vehicle_id":48,"route":[[127.12697419,37.39918115],[127.13088226,37.40612793],[127.12666321,37.46737671]],"timestamp":[457.7430195317333,459.4351678965223,473.0766342856462]},{"passenger_id":10132,"vehicle_id":27,"route":[[127.14858736,37.35977665],[127.14434814,37.37437439],[127.1272583,37.41814041]],"timestamp":[457.9733241384026,461.3050579249444,471.49576092864265]},{"passenger_id":20806,"vehicle_id":58,"route":[[127.15796945,37.46117734],[127.16419989,37.45822188],[127.13845049,37.44409697]],"timestamp":[457.69258232861193,458.9738600400808,464.49959805308146]},{"passenger_id":12699,"vehicle_id":20,"route":[[127.14380354,37.4447684],[127.14365517,37.44493445],[127.10501131,37.39984332]],"timestamp":[457.46191383861617,457.5071900692779,469.6373089201329]},{"passenger_id":17677,"vehicle_id":22,"route":[[127.10948599,37.33808604],[127.10901642,37.35058594],[127.0694809,37.35699463]],"timestamp":[457.85312078393093,460.63421113902,467.76708470812173]},{"passenger_id":15028,"vehicle_id":31,"route":[[127.17316437,37.43421173],[127.16596998,37.43658735],[127.11983948,37.41106993]],"timestamp":[457.71378752850813,459.089690493626,469.0185153175733]},{"passenger_id":17671,"vehicle_id":62,"route":[[127.17651152,37.43696196],[127.16976122,37.44192276],[127.15755023,37.44504713]],"timestamp":[457.0603917639682,458.68453918953827,460.9497944663695]},{"passenger_id":17712,"vehicle_id":9,"route":[[127.12380981,37.35106659],[127.11388119,37.35201326],[127.15129131,37.40485188]],"timestamp":[457.2547679468265,459.0225693307574,472.50544011321085]},{"passenger_id":17666,"vehicle_id":53,"route":[[127.13156891,37.42870712],[127.12945303,37.43040026],[127.14295289,37.43878604]],"timestamp":[457.9112211961903,458.441697780554,461.46840413294177]},{"passenger_id":8331,"vehicle_id":26,"route":[[127.12368011,37.35147476],[127.12409068,37.35836528],[127.1080881,37.36591945]],"timestamp":[457.3080442579296,458.84214382134866,462.13201864762374]},{"passenger_id":12661,"vehicle_id":84,"route":[[127.10668945,37.37689972],[127.10484314,37.38055038],[127.10634613,37.36342239]],"timestamp":[457.15759733625464,458.03257786480344,461.85091992019073]},{"passenger_id":15004,"vehicle_id":25,"route":[[127.11169743,37.39814461],[127.11283676,37.39714077],[127.12519185,37.38565153]],"timestamp":[458,458.30059285953166,461.66125777590884]},{"passenger_id":15002,"vehicle_id":86,"route":[[127.09985352,37.40474319],[127.11107312,37.39623055],[127.10966594,37.40199006]],"timestamp":[458,460.74095679603437,462.0457173368304]},{"passenger_id":17961,"vehicle_id":75,"route":[[127.09813289,37.41274142],[127.11083973563,37.3977262231159],[127.016359757633,37.0277340428751]],"timestamp":[458,462.0236028988929,545.9903470246683]},{"passenger_id":5839,"vehicle_id":19,"route":[[127.15875875,37.44874603],[127.15951307,37.45071999],[127.16491681,37.44206089]],"timestamp":[458.1337939854669,458.59253920834885,460.7416286193462]},{"passenger_id":10134,"vehicle_id":94,"route":[[127.10388,37.44947102],[127.12767033,37.4407242],[127.12676025,37.40281868]],"timestamp":[458.42359861087976,463.05264036649294,471.4839756993951]},{"passenger_id":17714,"vehicle_id":35,"route":[[127.14501953,37.42821884],[127.14588206,37.42865623],[127.10012671,37.40258018]],"timestamp":[458.5753845259558,458.75611805242613,468.7032831031284]},{"passenger_id":3295,"vehicle_id":50,"route":[[127.17094281,37.44746412],[127.17331879,37.44986146],[127.13036542,37.45254799]],"timestamp":[458.1208121158967,458.79920387301934,466.4060758095011]},{"passenger_id":796,"vehicle_id":2,"route":[[127.15999628,37.43111403],[127.15904999,37.43427277],[127.14638519,37.44992447]],"timestamp":[458.33782491579433,459.0598993997766,463.1971142414077]},{"passenger_id":12706,"vehicle_id":36,"route":[[127.12348497,37.35150733],[127.12330337,37.35150788],[127.12293972,37.40111849]],"timestamp":[459,459.0321042088505,470.0651876611236]},{"passenger_id":5897,"vehicle_id":10,"route":[[127.09874725,37.35645294],[127.10591125,37.36270905],[127.04920959,37.5037384]],"timestamp":[459.39654001249824,461.2778510000937,494.2009347495413]},{"passenger_id":17676,"vehicle_id":40,"route":[[127.15073921,37.44217018],[127.14726101,37.44092116],[127.17650801,37.43705457]],"timestamp":[459.32388880281644,459.99793507751565,465.2334042198774]},{"passenger_id":5903,"vehicle_id":44,"route":[[127.09998288,37.4047904],[127.11009216,37.39385605],[127.04891205,37.25811768]],"timestamp":[459.4994424332192,462.5165564056046,494.5837212340882]},{"passenger_id":804,"vehicle_id":24,"route":[[127.12484115,37.38538682],[127.12471008,37.38529587],[127.04457855,37.37504578]],"timestamp":[459.0719517651543,459.1027010812932,473.4455637801242]},{"passenger_id":12675,"vehicle_id":79,"route":[[127.10238052,37.40385847],[127.1107824,37.39376311],[127.12234848,37.38591917]],"timestamp":[459.98167187810367,462.6731190740625,465.36003085407594]},{"passenger_id":20784,"vehicle_id":87,"route":[[127.24029235,37.4320529],[127.17873607,37.43879723],[127.17874705,37.43884877]],"timestamp":[459.3939739936196,470.36695373021183,470.37857852620095]},{"passenger_id":3297,"vehicle_id":43,"route":[[127.12638092,37.39921951],[127.12269169,37.40327656],[127.14383206,37.4447875]],"timestamp":[460,461.1130346607694,471.07109252791525]},{"passenger_id":10115,"vehicle_id":34,"route":[[127.15419006,37.40529633],[127.14549255,37.40724182],[127.10884094,37.40241241]],"timestamp":[460.8178111059289,462.414024316493,468.977309553472]},{"passenger_id":10105,"vehicle_id":95,"route":[[127.130197949519,37.4294649177771],[127.12934875,37.43217468],[127.1286087,37.4444313]],"timestamp":[460.2039925913034,460.8249958730418,463.5538744662692]},{"passenger_id":15046,"vehicle_id":91,"route":[[127.07547347,37.39083029],[127.07518482,37.39317376],[127.00026189,37.31008646]],"timestamp":[460.4353350218045,460.95898851519775,483.693589724057]},{"passenger_id":20786,"vehicle_id":16,"route":[[127.2411499,37.39093018],[127.16103388,37.41213938],[127.16419004,37.43322741]],"timestamp":[460.70049309597124,475.6195091935107,480.34228514600534]},{"passenger_id":10126,"vehicle_id":12,"route":[[127.12072406,37.38411493],[127.12183628,37.38323177],[127.12778313,37.44016029]],"timestamp":[460.1091845085512,460.3870380713268,473.09086859142064]},{"passenger_id":3277,"vehicle_id":97,"route":[[127.10114236,37.40365102],[127.10977936,37.39302444],[127.1213913,37.38703156]],"timestamp":[460.4768970604864,463.2899708208694,465.73658520997026]},{"passenger_id":15029,"vehicle_id":19,"route":[[127.16491681,37.44206089],[127.16379496392,37.4414926218838],[127.140036777042,37.3724430443219]],"timestamp":[460.7416286193462,460.97659482319557,476.89573221272565]},{"passenger_id":17675,"vehicle_id":21,"route":[[127.10277827,37.3387572],[127.10901121,37.35065175],[127.1061821,37.37649174]],"timestamp":[460.7840565846326,463.64964478520545,469.4179128209308]},{"passenger_id":17681,"vehicle_id":0,"route":[[127.12747192,37.41882706],[127.12457392,37.41812765],[127.14279394,37.4337795]],"timestamp":[460.9096161877885,461.44458965779944,466.1848813867594]},{"passenger_id":15047,"vehicle_id":46,"route":[[127.15051637,37.41424312],[127.15004842,37.41378944],[127.12680953,37.46113813]],"timestamp":[460.2741378186628,460.404566988167,471.7057744585547]},{"passenger_id":15008,"vehicle_id":78,"route":[[127.1114502,37.39188766],[127.11147308,37.39185333],[127.10341644,37.40330887]],"timestamp":[460.6375897325135,460.6462286410741,463.564505900955]},{"passenger_id":12679,"vehicle_id":62,"route":[[127.15755023,37.44504713],[127.15484466,37.44375792],[127.17647309,37.43786485]],"timestamp":[460.9497944663695,461.5069362246277,465.54455713396004]},{"passenger_id":17697,"vehicle_id":4,"route":[[127.13386536,37.41114807],[127.12915039,37.41238785],[127.15963745,37.40182877]],"timestamp":[460.5716306363986,461.44894311074887,467.3242480902249]},{"passenger_id":12670,"vehicle_id":54,"route":[[127.2100706,37.43271408],[127.17910451,37.4315516],[127.17794519,37.43603417]],"timestamp":[461,466.4745322910766,467.49221494684775]},{"passenger_id":23614,"vehicle_id":8,"route":[[127.12377588,37.3511123],[127.12348938,37.35155487],[127.12055206,37.32272339]],"timestamp":[461,461.1106905442467,467.54351977143017]},{"passenger_id":5860,"vehicle_id":74,"route":[[127.09772491,37.41295624],[127.09775543,37.41286087],[127.11141968,37.39186478]],"timestamp":[461,461.0218837495112,466.2782932680662]},{"passenger_id":20825,"vehicle_id":39,"route":[[127.15968944,37.33430272],[127.14707184,37.36959457],[127.12732697,37.38583755]],"timestamp":[461,469.1593626710043,474.18172705012165]},{"passenger_id":5841,"vehicle_id":25,"route":[[127.12519185,37.38565153],[127.12421417,37.3841362],[127.09520721,37.38230515]],"timestamp":[461.66125777590884,462.03995479424145,467.1819037352446]},{"passenger_id":5848,"vehicle_id":84,"route":[[127.10634613,37.36342239],[127.10639954,37.36283112],[127.12341309,37.35152054]],"timestamp":[461.85091992019073,461.9827508286734,465.90347292849157]},{"passenger_id":15043,"vehicle_id":53,"route":[[127.14295289,37.43878604],[127.1439209,37.43773651],[127.11153412,37.40430832]],"timestamp":[461.46840413294177,461.7577052330883,471.1377858745699]},{"passenger_id":20844,"vehicle_id":98,"route":[[127.10480406,37.4839254],[127.128089629534,37.4614813886136],[127.111839729472,37.400287318556]],"timestamp":[461.68186358170675,468.1474833605647,482.05569420854204]},{"passenger_id":17703,"vehicle_id":76,"route":[[127.10674294,37.40321794],[127.11746216,37.40162277],[127.12915039,37.4310112]],"timestamp":[462,463.92664212213725,470.7806493282638]},{"passenger_id":17649,"vehicle_id":26,"route":[[127.1080881,37.36591945],[127.10808809,37.36628446],[127.12281596,37.3598105]],"timestamp":[462.13201864762374,462.21319316799213,465.18805095118483]},{"passenger_id":5836,"vehicle_id":42,"route":[[127.09222412,37.38314438],[127.08964539,37.38776016],[127.10790253,37.3708725]],"timestamp":[462.15479755880716,463.2778935682745,468.22909091733885]},{"passenger_id":8338,"vehicle_id":69,"route":[[127.12515266,37.41000948],[127.1280899,37.41230011],[127.10662079,37.37238312]],"timestamp":[462.9293408008327,463.6564589367675,473.3101033319857]},{"passenger_id":23615,"vehicle_id":38,"route":[[127.08826528,37.40709228],[127.086071,37.389751],[127.121286,37.387721]],"timestamp":[462.976138143142,466.8520988924016,473.0908147390097]},{"passenger_id":8356,"vehicle_id":86,"route":[[127.10966594,37.40199006],[127.11403665,37.39688329],[127.13129445,37.39277647]],"timestamp":[463,464.37333878553517,467.5563261705428]},{"passenger_id":20842,"vehicle_id":11,"route":[[127.10618543,37.37649375],[127.106914759624,37.372359711637],[127.138078456113,37.406695612582]],"timestamp":[463,463.9283596482174,473.3426483702527]},{"passenger_id":10127,"vehicle_id":18,"route":[[127.09775543,37.4041481],[127.10931396,37.39567566],[127.10547638,37.4026947]],"timestamp":[463,465.7785067512701,467.4803525308093]},{"passenger_id":3290,"vehicle_id":64,"route":[[127.05984713,37.24588715],[127.11061096,37.33797073],[127.10827637,37.36601257]],"timestamp":[463,485.3613882004759,491.6112507991109]},{"passenger_id":17664,"vehicle_id":2,"route":[[127.14638519,37.44992447],[127.14643192,37.44986891],[127.12862866,37.41090199]],"timestamp":[463.1971142414077,463.2119714728349,472.4305281250669]},{"passenger_id":14999,"vehicle_id":95,"route":[[127.1286087,37.4444313],[127.13159909,37.44530202],[127.17395106,37.44020478]],"timestamp":[463.5538744662692,464.1162576881544,471.67972848748747]},{"passenger_id":12674,"vehicle_id":52,"route":[[127.12590631,37.40981601],[127.1282959,37.41228867],[127.13082886,37.44300079]],"timestamp":[463.4489214733475,464.1421439701235,470.98684107827256]},{"passenger_id":15021,"vehicle_id":59,"route":[[127.00008392,37.50027084],[127.09894865,37.43088109],[127.10203452,37.37851437]],"timestamp":[463.41194060325245,486.70732042348374,498.3658998586168]},{"passenger_id":15022,"vehicle_id":67,"route":[[127.1033017,37.39984032],[127.11114502,37.39156723],[127.1022644,37.40645218]],"timestamp":[463.6219542847593,465.9252941798334,469.588552508136]},{"passenger_id":5890,"vehicle_id":32,"route":[[127.12558746,37.40981674],[127.12561758,37.40975677],[127.08878366,37.31913134]],"timestamp":[464,464.014358859595,485.19401263678077]},{"passenger_id":12678,"vehicle_id":78,"route":[[127.10341644,37.40330887],[127.11108398,37.39605331],[127.10256958,37.40140152]],"timestamp":[464,466.10679916393104,468.02446663431175]},{"passenger_id":787,"vehicle_id":83,"route":[[127.11486816,37.38814163],[127.11283112,37.39038849],[127.1216507,37.38793945]],"timestamp":[464.15507176631417,464.77089000072544,466.42170112727047]},{"passenger_id":14998,"vehicle_id":58,"route":[[127.13845049,37.44409697],[127.13760767,37.44263348],[127.12775952,37.41878458]],"timestamp":[464.49959805308146,464.8574715805892,470.43909022934173]},{"passenger_id":3298,"vehicle_id":92,"route":[[127.08400218,37.31951296],[127.11426984,37.33685794],[127.10711307,37.37042477]],"timestamp":[464.3098891346242,470.9074937729675,478.4788683264096]},{"passenger_id":8348,"vehicle_id":63,"route":[[127.17081451,37.4341011],[127.16593056,37.43410827],[127.15745168,37.44447782]],"timestamp":[464.17291963731594,465.0353745116942,467.78483862609846]},{"passenger_id":8368,"vehicle_id":7,"route":[[127.16762983,37.25760476],[127.12023951,37.34008845],[127.11215207,37.39623556]],"timestamp":[465,485.16859184335624,497.7366899651928]},{"passenger_id":10118,"vehicle_id":40,"route":[[127.17650801,37.43705457],[127.16834916,37.44042669],[127.16205781,37.44530921]],"timestamp":[465.2334042198774,466.8575768495248,468.41096362503674]},{"passenger_id":5859,"vehicle_id":23,"route":[[127.12887369,37.41117657],[127.12886256,37.41210337],[127.14001647,37.38913622]],"timestamp":[465.99248110388726,466.1986013963742,471.6732007912871]},{"passenger_id":12697,"vehicle_id":62,"route":[[127.17647309,37.43786485],[127.17618493,37.43998509],[127.14113912,37.43615888]],"timestamp":[465.54455713396004,466.0188144797007,472.2654287188624]},{"passenger_id":17674,"vehicle_id":26,"route":[[127.12281596,37.3598105],[127.12293213,37.35997307],[127.10808807,37.36685066]],"timestamp":[465.18805095118483,465.22962955027236,468.26666610408034]},{"passenger_id":20835,"vehicle_id":30,"route":[[127.13128662,37.3841095],[127.13492584,37.38513947],[127.11080933,37.35137939]],"timestamp":[465.06355988364874,465.7462074568615,474.3796963009156]},{"passenger_id":5851,"vehicle_id":47,"route":[[127.11860508,37.40083279],[127.12104653,37.40544929],[127.11168529,37.39177597]],"timestamp":[465.3498683782951,466.46345120142934,469.9249285271836]},{"passenger_id":12703,"vehicle_id":79,"route":[[127.12234848,37.38591917],[127.12250828,37.3837117],[127.09826392,37.39794938]],"timestamp":[465.36003085407594,465.85176122152035,471.1786957431024]},{"passenger_id":12688,"vehicle_id":84,"route":[[127.12341309,37.35152054],[127.12296382,37.36001964],[127.11672225,37.37689081]],"timestamp":[465.90347292849157,467.7952543230185,471.70604642718115]},{"passenger_id":3288,"vehicle_id":77,"route":[[127.11282019,37.39510409],[127.10967691,37.39496519],[127.09794898,37.40459193]],"timestamp":[465.6089722613889,466.16518995870985,469.1445345095613]},{"passenger_id":5864,"vehicle_id":97,"route":[[127.1213913,37.38703156],[127.12298584,37.38848877],[127.10958862,37.39538193]],"timestamp":[466,466.4294243599437,469.2495904439586]},{"passenger_id":20793,"vehicle_id":0,"route":[[127.14279394,37.4337795],[127.14037904,37.43573994],[127.12704837,37.39918056]],"timestamp":[466.1848813867594,466.7947443977392,475.2592591278946]},{"passenger_id":10173,"vehicle_id":55,"route":[[127.23233032,37.50677872],[127.17155108,37.46157611],[127.11340399,37.35203494]],"timestamp":[466.04550349505706,480.74574641345527,507.1836466966885]},{"passenger_id":795,"vehicle_id":74,"route":[[127.11141968,37.39186478],[127.11271667,37.39109802],[127.10661316,37.37686539]],"timestamp":[466.2782932680662,466.56393906403224,469.9078415014336]},{"passenger_id":12673,"vehicle_id":83,"route":[[127.1216507,37.38793945],[127.123909099145,37.3885179460509],[127.106103653853,37.4012706459027]],"timestamp":[466.42170112727047,466.8409801822988,471.07654063961996]},{"passenger_id":808,"vehicle_id":50,"route":[[127.13036542,37.45254799],[127.12773132,37.44802094],[127.1071167,37.39996338]],"timestamp":[466.4060758095011,467.51506653229666,478.80570291879184]},{"passenger_id":15094,"vehicle_id":57,"route":[[127.10109504,37.51197378],[127.14895879,37.46694175],[127.14303737,37.37235297]],"timestamp":[466.35601196152436,479.4566982463401,500.51826651406554]},{"passenger_id":20826,"vehicle_id":99,"route":[[127.17056292,37.4344795],[127.165986616993,37.4368037616715],[127.17725321394,37.4378843105987]],"timestamp":[466.6968162034268,467.6560965261813,469.6600313102898]},{"passenger_id":3309,"vehicle_id":80,"route":[[127.10416412,37.44924164],[127.10088601,37.43094793],[127.15063517,37.41425447]],"timestamp":[467,471.10930664414275,480.6479263456254]},{"passenger_id":12708,"vehicle_id":71,"route":[[127.12664972,37.40986448],[127.128961845896,37.4122844673175],[127.140053444185,37.4409426253122]],"timestamp":[467,467.6756087529732,474.3431308715723]},{"passenger_id":3284,"vehicle_id":66,"route":[[127.10596803,37.3685305],[127.10793304,37.36660385],[127.1388092,37.30606079]],"timestamp":[467.3101722784352,467.8617220770644,482.3906571867953]},{"passenger_id":17691,"vehicle_id":22,"route":[[127.0694809,37.35699463],[127.09762914,37.37020556],[127.10806132,37.37069708]],"timestamp":[467.76708470812173,473.5451366738106,475.392151156382]},{"passenger_id":8362,"vehicle_id":4,"route":[[127.15963745,37.40182877],[127.148570057875,37.4063928366232],[127.105889766309,37.4031623009992]],"timestamp":[467.3242480902249,469.52717885091914,477.1011656257386]},{"passenger_id":802,"vehicle_id":25,"route":[[127.09520721,37.38230515],[127.10507202,37.3723793],[127.12715149,37.41057968]],"timestamp":[467.1819037352446,469.9947114022654,479.3430229329426]},{"passenger_id":20818,"vehicle_id":18,"route":[[127.10547638,37.4026947],[127.10842823,37.3962091],[127.10251289,37.40363923]],"timestamp":[467.4803525308093,469.0140700672881,470.9692002304972]},{"passenger_id":12722,"vehicle_id":60,"route":[[127.129406287765,37.4310232415814],[127.1294466,37.43046454],[127.10032317,37.40178824]],"timestamp":[467.65726616593196,467.7817195082749,475.9751420673682]},{"passenger_id":17685,"vehicle_id":63,"route":[[127.15745168,37.44447782],[127.15585327,37.44300079],[127.15961456,37.45044327]],"timestamp":[467.78483862609846,468.217906981149,470.0012969485482]},{"passenger_id":12689,"vehicle_id":86,"route":[[127.13129445,37.39277647],[127.13249893,37.39228709],[127.13193743,37.41063384]],"timestamp":[467.5563261705428,467.79535643634324,471.87669317563507]},{"passenger_id":12682,"vehicle_id":54,"route":[[127.17794519,37.43603417],[127.17841048,37.44273158],[127.18095318,37.44278112]],"timestamp":[467.49221494684775,468.9839152701547,469.43301217910016]},{"passenger_id":20919,"vehicle_id":8,"route":[[127.12055206,37.32272339],[127.11129616,37.35001389],[127.16680516,37.46103666]],"timestamp":[468,474.2859274417555,500.8522795663775]},{"passenger_id":12701,"vehicle_id":6,"route":[[127.12379456,37.35109711],[127.12297176,37.3600313],[127.14303598,37.43273083]],"timestamp":[468.9729642486539,470.9651542081745,487.51685829667514]},{"passenger_id":3287,"vehicle_id":34,"route":[[127.10884094,37.40241241],[127.12099457,37.40616226],[127.10588074,37.36381149]],"timestamp":[468.977309553472,471.2806302181922,481.0703443268239]},{"passenger_id":20805,"vehicle_id":40,"route":[[127.16205781,37.44530921],[127.16231738,37.44539489],[127.17928001,37.44492752]],"timestamp":[468.41096362503674,468.4605972259488,471.4573769534105]},{"passenger_id":20832,"vehicle_id":61,"route":[[127.14345551,37.44203568],[127.14308929,37.44260788],[127.12590027,37.44120789]],"timestamp":[468.8133499668197,468.95608853227924,472.0070966428273]},{"passenger_id":8345,"vehicle_id":26,"route":[[127.10808807,37.36685066],[127.10808809,37.36624064],[127.11478316,37.3599229]],"timestamp":[468.26666610408034,468.4023283624291,470.23929904813764]},{"passenger_id":10210,"vehicle_id":42,"route":[[127.10790253,37.3708725],[127.10707855,37.37095642],[127.09051514,37.2144928]],"timestamp":[468.22909091733885,468.375910737984,503.29501154043663]},{"passenger_id":23617,"vehicle_id":35,"route":[[127.10012671,37.40258018],[127.11281194,37.39094666],[127.10684946,37.3666551]],"timestamp":[468.7032831031284,472.1262103274079,477.63020746685964]},{"passenger_id":17708,"vehicle_id":78,"route":[[127.10256958,37.40140152],[127.1099472,37.39439011],[127.10218048,37.40419769]],"timestamp":[469,471.03230528046646,473.6091328949009]},{"passenger_id":14992,"vehicle_id":20,"route":[[127.10501131,37.39984332],[127.11843109,37.39518356],[127.10300446,37.39990997]],"timestamp":[469.6373089201329,472.2248322300475,475.1459993588374]},{"passenger_id":8323,"vehicle_id":15,"route":[[127.12785835,37.45565008],[127.13337945,37.44805019],[127.12840691,37.43991302]],"timestamp":[469.45176806558436,471.4028391344756,473.4142045394457]},{"passenger_id":15071,"vehicle_id":47,"route":[[127.11168529,37.39177597],[127.11100769,37.38803101],[127.08288574,37.22668076]],"timestamp":[469.9249285271836,470.7663315176229,506.99215267917134]},{"passenger_id":8355,"vehicle_id":21,"route":[[127.1061821,37.37649174],[127.11088653,37.37457631],[127.13807571,37.4066826]],"timestamp":[469.4179128209308,470.35208687961415,478.9579366484726]},{"passenger_id":812,"vehicle_id":74,"route":[[127.10661316,37.37686539],[127.11276245,37.37893677],[127.15106201,37.41563034]],"timestamp":[469.9078415014336,471.08815880217264,481.68897286972873]},{"passenger_id":3293,"vehicle_id":97,"route":[[127.10958862,37.39538193],[127.11843872,37.39403152],[127.12683868,37.39466095]],"timestamp":[469.2495904439586,470.8418243406212,472.3325417148233]},{"passenger_id":17689,"vehicle_id":45,"route":[[127.10463715,37.4841423],[127.13583268,37.45017449],[127.12682315,37.44865962]],"timestamp":[469.9488885881944,479.2968514144437,480.9227970265743]},{"passenger_id":17701,"vehicle_id":99,"route":[[127.17725321394,37.4378843105987],[127.18045887,37.44207224],[127.17055653,37.45184473]],"timestamp":[469.6600313102898,470.74990282500926,473.53916113288165]},{"passenger_id":20861,"vehicle_id":54,"route":[[127.18095318,37.44278112],[127.17941785,37.44422729],[127.13056917,37.44055442]],"timestamp":[469.43301217910016,469.8536360215905,478.51742564819176]},{"passenger_id":20868,"vehicle_id":31,"route":[[127.11983948,37.41106993],[127.12556551,37.40974338],[127.14878013,37.43726897]],"timestamp":[470,471.0536199177632,478.4212494211712]},{"passenger_id":5867,"vehicle_id":77,"route":[[127.09794898,37.40459193],[127.10183716,37.38718033],[127.1062088,37.37662506]],"timestamp":[470,473.9326280911327,476.40386420002073]},{"passenger_id":12714,"vehicle_id":14,"route":[[127.18096924,37.3486824],[127.14571381,37.36924362],[127.12360382,37.35151672]],"timestamp":[470,477.7295711557404,483.28077455079574]},{"passenger_id":12729,"vehicle_id":67,"route":[[127.1022644,37.40645218],[127.11543624,37.40658346],[127.10591027,37.34397634]],"timestamp":[470,472.32704643134736,486.35164486871884]},{"passenger_id":5842,"vehicle_id":63,"route":[[127.15961456,37.45044327],[127.16075897,37.45038223],[127.17842865,37.44161987]],"timestamp":[470.0012969485482,470.2037989895374,473.88215560211825]},{"passenger_id":10271,"vehicle_id":36,"route":[[127.12293972,37.40111849],[127.1270744,37.39247032],[127.05255259,37.54505974]],"timestamp":[470.0651876611236,472.1225125098759,508.5169874111979]},{"passenger_id":15011,"vehicle_id":76,"route":[[127.12915039,37.4310112],[127.12922747,37.43218631],[127.14718159,37.4358198]],"timestamp":[470.7806493282638,471.0423361299718,474.31419817783126]},{"passenger_id":15049,"vehicle_id":58,"route":[[127.12775952,37.41878458],[127.12757646,37.41611119],[127.12894632,37.36926395]],"timestamp":[470.43909022934173,471.0345036185108,481.45566553347254]},{"passenger_id":833,"vehicle_id":26,"route":[[127.11478316,37.3599229],[127.11284637,37.36491394],[127.04891205,37.25814438]],"timestamp":[470.23929904813764,471.40085102767034,497.70072964473064]},{"passenger_id":814,"vehicle_id":52,"route":[[127.13082886,37.44300079],[127.13339996,37.44136047],[127.10202026,37.38645935]],"timestamp":[470.98684107827256,471.56922393114206,484.9779339968783]},{"passenger_id":8364,"vehicle_id":87,"route":[[127.17874705,37.43884877],[127.16714478,37.43962097],[127.12891388,37.4326973]],"timestamp":[470.37857852620095,472.43445993883114,479.3588094611546]},{"passenger_id":20856,"vehicle_id":33,"route":[[127.13741182,37.41033596],[127.13537312,37.40902831],[127.12682347,37.44864804]],"timestamp":[470.66369805112225,471.126583589716,480.06604245738504]},{"passenger_id":20855,"vehicle_id":96,"route":[[127.1369278,37.43015244],[127.13635884,37.4295541],[127.1599562,37.40497155]],"timestamp":[470.2554408565675,470.42218031736854,477.2967094786162]},{"passenger_id":15067,"vehicle_id":88,"route":[[127.11659241,37.3382225],[127.11428141,37.33809269],[127.13666777,37.37416871]],"timestamp":[470.0239555525667,470.43359452262234,479.37942337980155]},{"passenger_id":15099,"vehicle_id":18,"route":[[127.10251289,37.40363923],[127.11281244,37.39477049],[127.09606958,37.26712886]],"timestamp":[471,473.6834904055318,502.22367539611633]},{"passenger_id":12655,"vehicle_id":83,"route":[[127.106103653853,37.4012706459027],[127.11451721,37.38537598],[127.09793854,37.40486526]],"timestamp":[471.07654063961996,474.9112165679139,480.1424027375156]},{"passenger_id":20781,"vehicle_id":68,"route":[[127.18126529,37.44367118],[127.17367323,37.45063429],[127.15749511,37.44505539]],"timestamp":[471.73313565364805,473.78123647983824,476.8954134510016]},{"passenger_id":12656,"vehicle_id":93,"route":[[127.15921406,37.44532079],[127.16338142,37.44574463],[127.15374768,37.44323173]],"timestamp":[471.80443080407895,472.54624244782264,474.33667184185]},{"passenger_id":17705,"vehicle_id":95,"route":[[127.17395106,37.44020478],[127.16844877,37.44493343],[127.13691889,37.46203398]],"timestamp":[471.67972848748747,473.11142406069246,479.85290095854526]},{"passenger_id":803,"vehicle_id":23,"route":[[127.14001647,37.38913622],[127.13282776,37.39489746],[127.12509918,37.41497803]],"timestamp":[471.6732007912871,473.47733301148315,478.14709737819015]},{"passenger_id":10146,"vehicle_id":70,"route":[[127.10806298,37.37056254],[127.10981281,37.37042728],[127.10152043,37.36572434]],"timestamp":[471.4272095939093,471.7379327376757,473.5384794250364]},{"passenger_id":5878,"vehicle_id":84,"route":[[127.11672225,37.37689081],[127.11611938,37.37896347],[127.17089081,37.43517685]],"timestamp":[471.70604642718115,472.1791375136565,487.9873070055041]},{"passenger_id":17737,"vehicle_id":86,"route":[[127.13193743,37.41063384],[127.132395157991,37.4125900209909],[127.101825902573,37.4044039600919]],"timestamp":[471.87669317563507,472.3191778366272,478.01784014288114]},{"passenger_id":20932,"vehicle_id":40,"route":[[127.17928001,37.44492752],[127.17306229,37.44924199],[127.12167012,37.38786529]],"timestamp":[471.4573769534105,472.91538167465654,489.3076291788108]},{"passenger_id":3308,"vehicle_id":94,"route":[[127.12676025,37.40281868],[127.12677002,37.41227341],[127.10094452,37.40479279]],"timestamp":[471.4839756993951,473.58661242530667,478.442541692851]},{"passenger_id":12712,"vehicle_id":53,"route":[[127.11153412,37.40430832],[127.12606004,37.41258873],[127.1438641,37.44103544]],"timestamp":[471.1377858745699,474.29617284584475,481.3607510879367]},{"passenger_id":15056,"vehicle_id":49,"route":[[127.11734815,37.2795928],[127.11165619,37.34749222],[127.12158966,37.38449478]],"timestamp":[471.20658182053853,486.34024785485616,494.75445976866666]},{"passenger_id":12728,"vehicle_id":27,"route":[[127.1272583,37.41814041],[127.12711334,37.41565323],[127.17933655,37.44335938]],"timestamp":[471.49576092864265,472.04947682186486,483.14099413471297]},{"passenger_id":8367,"vehicle_id":43,"route":[[127.14383206,37.4447875],[127.1439209,37.44478607],[127.17209625,37.4366951]],"timestamp":[471.07109252791525,471.08678170709146,476.37720035635493]},{"passenger_id":10165,"vehicle_id":46,"route":[[127.12680953,37.46113813],[127.12792969,37.46149826],[127.11536407,37.40687561]],"timestamp":[471.7057744585547,471.91911445128454,484.26763922682034]},{"passenger_id":12756,"vehicle_id":79,"route":[[127.09826392,37.39794938],[127.0941925,37.40047455],[127.14543915,37.44783401]],"timestamp":[472,472.91255795750624,486.7994506740953]},{"passenger_id":20808,"vehicle_id":61,"route":[[127.12590027,37.44120789],[127.12779662,37.43881716],[127.17108662,37.43161304]],"timestamp":[472.0070966428273,472.63542856707744,480.445949190206]},{"passenger_id":15003,"vehicle_id":62,"route":[[127.14113912,37.43615888],[127.13954163,37.43548965],[127.13690948,37.44057465]],"timestamp":[472.2654287188624,472.5843753045602,473.80701688135326]},{"passenger_id":17706,"vehicle_id":9,"route":[[127.15129131,37.40485188],[127.1431908,37.40973597],[127.17451128,37.43981062]],"timestamp":[472.50544011321085,474.3019537988068,482.981318898828]},{"passenger_id":5856,"vehicle_id":97,"route":[[127.12683868,37.39466095],[127.12395286,37.38867508],[127.13622502,37.40774973]],"timestamp":[472.3325417148233,473.7580509068263,478.52204116433984]},{"passenger_id":23618,"vehicle_id":17,"route":[[127.13666534,37.33272171],[127.10901344,37.35059941],[127.11852489,37.3362618]],"timestamp":[472.78605150834574,479.0876381296139,482.69245963961487]},{"passenger_id":5869,"vehicle_id":2,"route":[[127.12862866,37.41090199],[127.1289444,37.4121933],[127.16917419,37.43173218]],"timestamp":[472.4305281250669,472.7230681818216,481.05172481606957]},{"passenger_id":10107,"vehicle_id":24,"route":[[127.04457855,37.37504578],[127.06797414,37.39125721],[127.1108277,37.39598311]],"timestamp":[473.4455637801242,478.93096935849957,486.57513641702303]},{"passenger_id":12676,"vehicle_id":62,"route":[[127.13690948,37.44057465],[127.13654327,37.44157028],[127.10588074,37.4030838]],"timestamp":[473.80701688135326,474.03768375517643,484.1660823229167]},{"passenger_id":8351,"vehicle_id":15,"route":[[127.12840691,37.43991302],[127.1298472,37.44034038],[127.12351347,37.38585539]],"timestamp":[473.4142045394457,473.68570231273094,485.8541515563052]},{"passenger_id":8333,"vehicle_id":11,"route":[[127.138078456113,37.406695612582],[127.13816416,37.40662301],[127.12887369,37.41124598]],"timestamp":[473.3426483702527,473.3647823614603,475.30136801969877]},{"passenger_id":3286,"vehicle_id":38,"route":[[127.121286,37.387721],[127.12402765,37.38860913],[127.12834166,37.39176852]],"timestamp":[473.0908147390097,473.61397413920423,474.6506525271183]},{"passenger_id":15051,"vehicle_id":12,"route":[[127.12778313,37.44016029],[127.12778473,37.43859863],[127.11062622,37.39989471]],"timestamp":[473.09086859142064,473.43816604462336,482.5634732927523]},{"passenger_id":23619,"vehicle_id":72,"route":[[127.07146454,37.2238121],[127.098741,37.356358],[127.12338,37.351516]],"timestamp":[473.41762263511447,503.2869307129482,507.7737029238726]},{"passenger_id":12719,"vehicle_id":48,"route":[[127.12666321,37.46737671],[127.13444519,37.47439575],[127.16065216,37.45497894]],"timestamp":[473.0766342856462,475.1558686557026,481.4840346689835]},{"passenger_id":20917,"vehicle_id":70,"route":[[127.10152043,37.36572434],[127.10504433,37.36851361],[127.15032933,37.40492111]],"timestamp":[473.5384794250364,474.4175174683951,485.80111956212]},{"passenger_id":17707,"vehicle_id":63,"route":[[127.17842865,37.44161987],[127.17355951,37.43755431],[127.16112942,37.43322487]],"timestamp":[473.88215560211825,475.1298258823035,477.52669496744653]},{"passenger_id":17724,"vehicle_id":99,"route":[[127.17055653,37.45184473],[127.16989422,37.45169323],[127.15495967,37.44414239]],"timestamp":[473.53916113288165,473.66084764710865,476.7869479363091]},{"passenger_id":5866,"vehicle_id":1,"route":[[127.10891347,37.34076612],[127.11423492,37.35235977],[127.11399078,37.35985565]],"timestamp":[474,476.74459561070023,478.41216182472425]},{"passenger_id":8359,"vehicle_id":41,"route":[[127.11345673,37.37453461],[127.11295155,37.37784509],[127.10212963,37.3788843]],"timestamp":[474,474.7416106370295,476.66798192765265]},{"passenger_id":20901,"vehicle_id":78,"route":[[127.10218048,37.40419769],[127.10452271,37.39988327],[127.15094757,37.44339371]],"timestamp":[474,475.04490677605816,487.7280525013193]},{"passenger_id":3316,"vehicle_id":69,"route":[[127.10662079,37.37238312],[127.10677338,37.37031937],[127.07840729,37.38905716]],"timestamp":[474,474.45974870746966,480.9783926329056]},{"passenger_id":10144,"vehicle_id":71,"route":[[127.140053444185,37.4409426253122],[127.13867961,37.43884411],[127.12887371,37.41080337]],"timestamp":[474.3431308715723,474.869102333402,481.3410911221555]},{"passenger_id":20815,"vehicle_id":76,"route":[[127.14718159,37.4358198],[127.14711761,37.43599701],[127.13709259,37.44245148]],"timestamp":[474.31419817783126,474.35519534531454,476.6342240456035]},{"passenger_id":12751,"vehicle_id":30,"route":[[127.11080933,37.35137939],[127.1074295,37.35574341],[127.09485626,37.41128159]],"timestamp":[474.3796963009156,475.51938203009354,488.06875447595235]},{"passenger_id":15016,"vehicle_id":38,"route":[[127.12834166,37.39176852],[127.12492453,37.38686215],[127.1157578,37.38836971]],"timestamp":[474.6506525271183,475.89769693902,477.55178225146364]},{"passenger_id":8358,"vehicle_id":39,"route":[[127.12732697,37.38583755],[127.12533569,37.38654709],[127.1268158,37.41228485]],"timestamp":[474.18172705012165,474.56735277800834,480.29713948492247]},{"passenger_id":5882,"vehicle_id":29,"route":[[126.95008347,37.37334155],[127.07246145,37.38967308],[127.05599875,37.44700111]],"timestamp":[474.085905950079,496.0145916329511,509.09115063140615]},{"passenger_id":5883,"vehicle_id":93,"route":[[127.15374768,37.44323173],[127.15376504,37.44355748],[127.10726284,37.37244539]],"timestamp":[474.33667184185,474.4091801547407,492.2300199647174]},{"passenger_id":10235,"vehicle_id":90,"route":[[127.18050133,37.34437883],[127.14543915,37.3701973],[127.2285614,37.38516617]],"timestamp":[475,483.44881784064177,498.51085234676145]},{"passenger_id":20837,"vehicle_id":11,"route":[[127.12887369,37.41124598],[127.1289444,37.41230392],[127.15184784,37.41481781]],"timestamp":[475.30136801969877,475.53697445363446,479.62103300772446]},{"passenger_id":15065,"vehicle_id":20,"route":[[127.10300446,37.39990997],[127.11107011,37.39623053],[127.0632643,37.39253885]],"timestamp":[475.1459993588374,476.78921913610446,485.2754985779267]},{"passenger_id":17720,"vehicle_id":22,"route":[[127.10806132,37.37069708],[127.10808809,37.36636304],[127.11585971,37.35988868]],"timestamp":[475.392151156382,476.3560092891509,478.3460162946558]},{"passenger_id":12739,"vehicle_id":0,"route":[[127.12704837,37.39918056],[127.12241364,37.40538788],[127.14671326,37.43655014]],"timestamp":[475.2592591278946,476.86426632263806,485.01576079167137]},{"passenger_id":12909,"vehicle_id":60,"route":[[127.10032317,37.40178824],[127.11016846,37.39779282],[127.05358124,37.04632568]],"timestamp":[476,477.95318000881235,556.7556549704949]},{"passenger_id":15038,"vehicle_id":76,"route":[[127.13709259,37.44245148],[127.13724518,37.44248581],[127.14097595,37.46593857]],"timestamp":[476.6342240456035,476.6622276115402,481.9193055850263]},{"passenger_id":10160,"vehicle_id":99,"route":[[127.15495967,37.44414239],[127.15473997,37.44403793],[127.1128225,37.40277918]],"timestamp":[476.7869479363091,476.83216355676353,488.6219127191254]},{"passenger_id":12709,"vehicle_id":68,"route":[[127.15749511,37.44505539],[127.15634091,37.44472795],[127.12813584,37.43816078]],"timestamp":[476.8954134510016,477.11182284254363,482.3017771157216]},{"passenger_id":17745,"vehicle_id":19,"route":[[127.140036777042,37.3724430443219],[127.14003505,37.37074616],[127.12008562,37.34720974]],"timestamp":[476.89573221272565,477.27310219156095,483.58443394459994]},{"passenger_id":23620,"vehicle_id":77,"route":[[127.1062088,37.37662506],[127.114549,37.377966],[127.146962,37.367269]],"timestamp":[476.40386420002073,477.90763710756335,484.1104400144971]},{"passenger_id":20841,"vehicle_id":43,"route":[[127.17209625,37.4366951],[127.16975786,37.43746848],[127.16123968,37.4332104]],"timestamp":[476.37720035635493,476.82450640320207,478.60195497179086]},{"passenger_id":3384,"vehicle_id":41,"route":[[127.10212963,37.3788843],[127.09394073,37.38282394],[126.92987061,37.528759]],"timestamp":[476.66798192765265,478.3596420461406,521.8595454012014]},{"passenger_id":15064,"vehicle_id":96,"route":[[127.1599562,37.40497155],[127.161026,37.41229248],[127.10312653,37.39991379]],"timestamp":[477.2967094786162,478.935741100641,489.5279817565951]},{"passenger_id":20824,"vehicle_id":63,"route":[[127.16112942,37.43322487],[127.16157532,37.43334579],[127.14235687,37.42827988]],"timestamp":[477.52669496744653,477.6099022692427,481.1859267912102]},{"passenger_id":12711,"vehicle_id":5,"route":[[127.16178894,37.49980927],[127.16790771,37.46321487],[127.16511536,37.44296646]],"timestamp":[477.5639168725008,485.7734661191281,490.30341104613694]},{"passenger_id":3310,"vehicle_id":35,"route":[[127.10684946,37.3666551],[127.10826874,37.36623383],[127.13405609,37.39117813]],"timestamp":[477.63020746685964,477.89798698414194,485.0771727608656]},{"passenger_id":830,"vehicle_id":4,"route":[[127.105889766309,37.4031623009992],[127.11312866,37.40153885],[127.17713165,37.43938446]],"timestamp":[477.1011656257386,478.4300054488846,492.52342254332183]},{"passenger_id":20852,"vehicle_id":38,"route":[[127.1157578,37.38836971],[127.11588287,37.39116287],[127.12256622,37.39301682]],"timestamp":[477.55178225146364,478.1733456747123,479.42412379978646]},{"passenger_id":15059,"vehicle_id":51,"route":[[127.11544186,37.35993071],[127.11250099,37.36344255],[127.12343206,37.35150789]],"timestamp":[478,478.938178377369,482.2211986479141]},{"passenger_id":10139,"vehicle_id":43,"route":[[127.16123968,37.4332104],[127.16163942165,37.4333176718933],[127.128906290874,37.4325843431454]],"timestamp":[478.60195497179086,478.67646800600676,484.45917844673085]},{"passenger_id":5873,"vehicle_id":22,"route":[[127.11585971,37.35988868],[127.12271826,37.36234822],[127.14676365,37.42862667]],"timestamp":[478.3460162946558,479.67602366960966,495.01570701411487]},{"passenger_id":20809,"vehicle_id":54,"route":[[127.13056917,37.44055442],[127.13013589,37.4404248],[127.14336407,37.44210416]],"timestamp":[478.51742564819176,478.599182179426,480.96458381542976]},{"passenger_id":20884,"vehicle_id":1,"route":[[127.11399078,37.35985565],[127.11478954,37.36514319],[127.10177806,37.40432438]],"timestamp":[478.41216182472425,479.5965027744059,488.6082396190418]},{"passenger_id":3314,"vehicle_id":3,"route":[[127.12526703,37.41001892],[127.12829257,37.41232564],[127.13408225,37.391159]],"timestamp":[478.05516522988495,478.79596737749256,483.6130579072253]},{"passenger_id":5877,"vehicle_id":97,"route":[[127.13622502,37.40774973],[127.13260536,37.40880518],[127.13518932,37.44998251]],"timestamp":[478.52204116433984,479.2031755977319,488.3719587014208]},{"passenger_id":3296,"vehicle_id":94,"route":[[127.10094452,37.40479279],[127.10968301,37.39465426],[127.10966795,37.39571064]],"timestamp":[478.442541692851,481.17514465708877,481.4100879181483]},{"passenger_id":12754,"vehicle_id":50,"route":[[127.1071167,37.39996338],[127.1130756,37.39784133],[127.09630518,37.42707915]],"timestamp":[478.80570291879184,479.9594105527024,487.10461530179475]},{"passenger_id":10212,"vehicle_id":86,"route":[[127.101825902573,37.4044039600919],[127.11277008,37.39811325],[127.00492096,37.30421448]],"timestamp":[478.01784014288114,480.40436264793976,508.68118915307554]},{"passenger_id":8360,"vehicle_id":21,"route":[[127.13807571,37.4066826],[127.13806915,37.40872574],[127.1288681,37.41121674]],"timestamp":[478.9579366484726,479.4123117310638,481.1294566708703]},{"passenger_id":17765,"vehicle_id":56,"route":[[127.13240814,37.44551086],[127.1316608,37.44532233],[127.13717013,37.4619822]],"timestamp":[479,479.13845323975346,482.968980593643]},{"passenger_id":819,"vehicle_id":23,"route":[[127.12509918,37.41497803],[127.12380981,37.41542435],[127.11280823,37.40299988]],"timestamp":[479,479.24843592898924,482.6265155276224]},{"passenger_id":17740,"vehicle_id":31,"route":[[127.14878013,37.43726897],[127.14902292,37.43691454],[127.15117195,37.44235133]],"timestamp":[479,479.0897267727383,480.35696272109277]},{"passenger_id":5887,"vehicle_id":92,"route":[[127.10711307,37.37042477],[127.10803986,37.37147903],[127.13817596,37.40662766]],"timestamp":[479,479.2860072308786,488.74409868880855]},{"passenger_id":5847,"vehicle_id":87,"route":[[127.12891388,37.4326973],[127.12890379,37.43262288],[127.16056267,37.41255181]],"timestamp":[479.3588094611546,479.3754553541971,486.5300619236217]},{"passenger_id":17725,"vehicle_id":11,"route":[[127.15184784,37.41481781],[127.15188446,37.4156783],[127.14812134,37.42836562]],"timestamp":[479.62103300772446,479.81250653983295,482.7112609144305]},{"passenger_id":5894,"vehicle_id":95,"route":[[127.13691889,37.46203398],[127.14338345,37.46173943],[127.1251979,37.40996726]],"timestamp":[479.85290095854526,480.99592786732865,492.94898375707356]},{"passenger_id":20854,"vehicle_id":88,"route":[[127.13666777,37.37416871],[127.13565826,37.37277222],[127.11182404,37.35014343]],"timestamp":[479.37942337980155,479.73758807031226,486.3006768141719]},{"passenger_id":8410,"vehicle_id":85,"route":[[127.19140801,37.54942413],[127.16888325,37.46226391],[127.10174084,37.39983997]],"timestamp":[479.5178478528038,499.30453940262595,517.5614174690586]},{"passenger_id":8373,"vehicle_id":38,"route":[[127.12256622,37.39301682],[127.12724523,37.38847541],[127.12822336,37.36601063]],"timestamp":[479.42412379978646,480.7293164853549,485.7282451521456]},{"passenger_id":15069,"vehicle_id":25,"route":[[127.12715149,37.41057968],[127.12831086,37.41232525],[127.11979832,37.40666605]],"timestamp":[480,480.43890507062997,482.39980072277524]},{"passenger_id":12715,"vehicle_id":69,"route":[[127.07840729,37.38905716],[127.07716293,37.39157512],[127.11886809,37.37428646]],"timestamp":[480.9783926329056,481.5799800839462,489.89234460565507]},{"passenger_id":20860,"vehicle_id":31,"route":[[127.15117195,37.44235133],[127.15007976,37.44169151],[127.17291595,37.4342039]],"timestamp":[480.35696272109277,480.59928986108537,484.96199524744156]},{"passenger_id":23621,"vehicle_id":80,"route":[[127.15063517,37.41425447],[127.151204,37.413781],[127.155099,37.443858]],"timestamp":[480.6479263456254,480.7934684305922,487.51756425613763]},{"passenger_id":3301,"vehicle_id":45,"route":[[127.12682315,37.44865962],[127.12945557,37.44830322],[127.15496826,37.4438324]],"timestamp":[480.9227970265743,481.39427486555144,486.00724771357204]},{"passenger_id":20872,"vehicle_id":54,"route":[[127.14336407,37.44210416],[127.142817315988,37.4432981664504],[127.109395300322,37.4161511104186]],"timestamp":[480.96458381542976,481.2471236033405,489.69019647790765]},{"passenger_id":15060,"vehicle_id":16,"route":[[127.16419004,37.43322741],[127.16410405,37.43287396],[127.13162078,37.44123792]],"timestamp":[480.34228514600534,480.4223421807145,486.45236709714396]},{"passenger_id":8369,"vehicle_id":61,"route":[[127.17108662,37.43161304],[127.16538846,37.43271114],[127.17865377,37.43831036]],"timestamp":[480.445949190206,481.48141841522477,484.1342854939674]},{"passenger_id":12744,"vehicle_id":33,"route":[[127.12682347,37.44864804],[127.12660716,37.44830094],[127.16997571,37.44184336]],"timestamp":[480.06604245738504,480.15216481266265,487.94296908664836]},{"passenger_id":10184,"vehicle_id":39,"route":[[127.1268158,37.41228485],[127.12885978,37.41229779],[127.17626329,37.43439941]],"timestamp":[480.29713948492247,480.65820115452095,490.36654566157637]},{"passenger_id":15061,"vehicle_id":83,"route":[[127.09793854,37.40486526],[127.09510803,37.39931488],[127.07310486,37.39182663]],"timestamp":[481,482.33179090527716,486.560987664608]},{"passenger_id":5938,"vehicle_id":89,"route":[[127.04275166,37.51321482],[127.10531616,37.45447159],[127.0357132,37.57833481]],"timestamp":[481,498.10457117295454,528.2627785944231]},{"passenger_id":20913,"vehicle_id":48,"route":[[127.16065216,37.45497894],[127.15997314,37.45452881],[127.11510468,37.37478256]],"timestamp":[481.4840346689835,481.64021020244513,501.0652643919859]},{"passenger_id":20828,"vehicle_id":53,"route":[[127.1438641,37.44103544],[127.14492573,37.43987599],[127.13591907,37.43219378]],"timestamp":[481.3607510879367,481.6795402959617,484.01369585975567]},{"passenger_id":20811,"vehicle_id":34,"route":[[127.10588074,37.36381149],[127.10598259,37.36256862],[127.11469375,37.35992193]],"timestamp":[481.0703443268239,481.347331659372,482.9957891173246]},{"passenger_id":10161,"vehicle_id":2,"route":[[127.16917419,37.43173218],[127.16493984,37.43277539],[127.12602398,37.410898]],"timestamp":[481.05172481606957,481.83464748695263,490.2556224766505]},{"passenger_id":20904,"vehicle_id":74,"route":[[127.15106201,37.41563034],[127.15299245,37.41555643],[127.10081026,37.40354896]],"timestamp":[481.68897286972873,482.0303481827242,491.6271846318517]},{"passenger_id":12730,"vehicle_id":71,"route":[[127.12887371,37.41080337],[127.12908483,37.41234209],[127.13937779,37.38984638]],"timestamp":[481.3410911221555,481.6853129360158,487.00836329615305]},{"passenger_id":12707,"vehicle_id":76,"route":[[127.14097595,37.46593857],[127.14003983,37.45143209],[127.1257388,37.4429493]],"timestamp":[481.9193055850263,485.1496292959568,488.301500494764]},{"passenger_id":8399,"vehicle_id":58,"route":[[127.12894632,37.36926395],[127.1275934,37.37030644],[127.1445118,37.43943893]],"timestamp":[481.45566553347254,481.7887211671676,497.4509001924261]},{"passenger_id":15141,"vehicle_id":94,"route":[[127.10966795,37.39571064],[127.11082876,37.39718028],[127.09093298,37.21144104]],"timestamp":[481.4100879181483,481.7959397384427,523.2521262145066]},{"passenger_id":20869,"vehicle_id":63,"route":[[127.14235687,37.42827988],[127.14511126,37.42845739],[127.12920799,37.43232462]],"timestamp":[481.1859267912102,481.6739591399173,484.6111780859175]},{"passenger_id":8371,"vehicle_id":21,"route":[[127.1288681,37.41121674],[127.12905884,37.41233063],[127.13627625,37.41975784]],"timestamp":[482,482.24999864540985,484.33648157566694]},{"passenger_id":798,"vehicle_id":68,"route":[[127.12813584,37.43816078],[127.12849177,37.43640038],[127.17867832,37.43847351]],"timestamp":[482.3017771157216,482.6982851619218,491.57228382164493]},{"passenger_id":15014,"vehicle_id":56,"route":[[127.13717013,37.4619822],[127.1376935,37.45073201],[127.12816926,37.43155846]],"timestamp":[482.968980593643,485.4726141329268,490.05627055661876]},{"passenger_id":15070,"vehicle_id":12,"route":[[127.11062622,37.39989471],[127.11188207,37.39383908],[127.0889909,37.40753772]],"timestamp":[482.5634732927523,483.92833971398403,488.99152616609916]},{"passenger_id":5904,"vehicle_id":17,"route":[[127.11852489,37.3362618],[127.12042999,37.33942032],[127.09806824,37.40450668]],"timestamp":[482.69245963961487,483.4714765884301,498.47586760394654]},{"passenger_id":10223,"vehicle_id":51,"route":[[127.12343206,37.35150789],[127.11792654,37.34802093],[127.15168034,37.4518151]],"timestamp":[482.2211986479141,483.4656577824396,507.30627410183627]},{"passenger_id":12775,"vehicle_id":66,"route":[[127.1388092,37.30606079],[127.10917664,37.33698273],[127.07000732,37.35132599]],"timestamp":[482.3906571867953,491.0366859498028,498.66118703903385]},{"passenger_id":15058,"vehicle_id":11,"route":[[127.14812134,37.42836562],[127.14730072,37.42902374],[127.1326828,37.44561386]],"timestamp":[482.7112609144305,482.917231184902,487.42002054571014]},{"passenger_id":10191,"vehicle_id":23,"route":[[127.11280823,37.40299988],[127.12191706,37.4004609],[127.15464106,37.40540615]],"timestamp":[482.6265155276224,484.3319196837905,490.21671257072023]},{"passenger_id":8415,"vehicle_id":98,"route":[[127.111839729472,37.400287318556],[127.11301422,37.39719772],[127.23407745,37.38583374]],"timestamp":[482.05569420854204,482.7734382267329,504.3128434534182]},{"passenger_id":817,"vehicle_id":25,"route":[[127.11979832,37.40666605],[127.12729645,37.40976334],[127.15635681,37.40399933]],"timestamp":[482.39980072277524,483.89274402351305,489.1839784584038]},{"passenger_id":5875,"vehicle_id":9,"route":[[127.17451128,37.43981062],[127.17214203,37.44150162],[127.16844177,37.45279312]],"timestamp":[482.981318898828,483.54384604221065,486.13855525847384]},{"passenger_id":3313,"vehicle_id":34,"route":[[127.11469375,37.35992193],[127.11491394,37.36244965],[127.10661316,37.37685776]],"timestamp":[482.9957891173246,483.55927418220585,487.0833859466182]},{"passenger_id":5871,"vehicle_id":3,"route":[[127.13408225,37.391159],[127.14057185,37.39109637],[127.13431918,37.39918687]],"timestamp":[483.6130579072253,484.7597942374406,486.8711231310847]},{"passenger_id":15078,"vehicle_id":91,"route":[[127.00026189,37.31008646],[127.10279478,37.34122348],[127.1227898,37.35977964]],"timestamp":[483.693589724057,503.10322481340506,508.5368986084196]},{"passenger_id":12840,"vehicle_id":14,"route":[[127.12360382,37.35151672],[127.12458801,37.35784149],[127.25772095,37.40973663]],"timestamp":[483.28077455079574,484.6980585061795,510.90205849546913]},{"passenger_id":15086,"vehicle_id":27,"route":[[127.17933655,37.44335938],[127.18080902,37.44142151],[127.14280701,37.433815]],"timestamp":[483.14099413471297,483.6443086493682,490.56467498551825]},{"passenger_id":20941,"vehicle_id":19,"route":[[127.12008562,37.34720974],[127.114003604398,37.3457265411887],[127.162100530039,37.4530869954115]],"timestamp":[483.58443394459994,484.70916362116503,510.0520551568063]},{"passenger_id":23612,"vehicle_id":21,"route":[[127.13627625,37.41975784],[127.137564,37.41823],[127.152156,37.404252]],"timestamp":[484.33648157566694,484.74535901726273,488.7835626074909]},{"passenger_id":17690,"vehicle_id":63,"route":[[127.12920799,37.43232462],[127.12908173,37.43238831],[127.17285919,37.4312973]],"timestamp":[484.6111780859175,484.63759326094083,492.37226508624644]},{"passenger_id":20909,"vehicle_id":77,"route":[[127.146962,37.367269],[127.14178503,37.36889246],[127.17648571,37.4377186]],"timestamp":[484.1104400144971,485.0940974184304,501.58231377872266]},{"passenger_id":20887,"vehicle_id":53,"route":[[127.13591907,37.43219378],[127.13672638,37.43083572],[127.11109161,37.40419388]],"timestamp":[484.01369585975567,484.3476730389227,491.804574768932]},{"passenger_id":20877,"vehicle_id":61,"route":[[127.17865377,37.43831036],[127.179028202968,37.4402648515905],[127.141795100037,37.4366009851969]],"timestamp":[484.1342854939674,484.57394433271446,491.19883052811946]},{"passenger_id":5899,"vehicle_id":31,"route":[[127.17291595,37.4342039],[127.16934204,37.43819427],[127.12057495,37.38425446]],"timestamp":[484.96199524744156,486.05093663966903,500.8192650005138]},{"passenger_id":10179,"vehicle_id":43,"route":[[127.128906290874,37.4325843431454],[127.12892781,37.43242591],[127.17539385,37.43451047]],"timestamp":[484.45917844673085,484.49461670823035,492.7131778762452]},{"passenger_id":20859,"vehicle_id":52,"route":[[127.10202026,37.38645935],[127.10950823,37.39118836],[127.10010932,37.40179258]],"timestamp":[484.9779339968783,486.6680876684729,489.55235022789105]},{"passenger_id":12787,"vehicle_id":62,"route":[[127.10588074,37.4030838],[127.11392545,37.40036825],[127.12835475,37.43326681]],"timestamp":[485,486.5442105980935,494.2917225797412]},{"passenger_id":10193,"vehicle_id":46,"route":[[127.11536407,37.40687561],[127.11543624,37.40654737],[127.15073246,37.44939908]],"timestamp":[485,485.0741022114962,496.4614923910254]},{"passenger_id":17750,"vehicle_id":20,"route":[[127.0632643,37.39253885],[127.07238926,37.39268199],[127.1248528,37.38539562]],"timestamp":[485.2754985779267,486.88807616593994,496.29871121187233]},{"passenger_id":17760,"vehicle_id":0,"route":[[127.14671326,37.43655014],[127.14737071,37.43689154],[127.11701849,37.36856053]],"timestamp":[485.01576079167137,485.15447773939684,501.26889761798816]},{"passenger_id":3319,"vehicle_id":38,"route":[[127.12822336,37.36601063],[127.12812128,37.36610372],[127.12202709,37.38755428]],"timestamp":[485.7282451521456,485.7557063965191,490.6461565267799]},{"passenger_id":10186,"vehicle_id":15,"route":[[127.12351347,37.38585539],[127.12438935,37.38647949],[127.1567423,37.3615369]],"timestamp":[485.8541515563052,486.06203952857487,494.0283348552324]},{"passenger_id":813,"vehicle_id":35,"route":[[127.13405609,37.39117813],[127.12407684,37.38866043],[127.10647583,37.36406326]],"timestamp":[485.0771727608656,486.9272043580322,493.21991137451295]},{"passenger_id":10174,"vehicle_id":70,"route":[[127.15032933,37.40492111],[127.14673865,37.40541455],[127.12814923,37.39477343]],"timestamp":[485.80111956212,486.4448624213829,490.49283461775025]},{"passenger_id":3358,"vehicle_id":32,"route":[[127.08878366,37.31913134],[127.10892272,37.34006906],[127.04592427,37.29026398]],"timestamp":[486,491.8621108877596,507.5731396477523]},{"passenger_id":3294,"vehicle_id":83,"route":[[127.07310486,37.39182663],[127.0736956,37.39314291],[127.12833532,37.39467686]],"timestamp":[486.560987664608,486.87176685446,496.53176220079746]},{"passenger_id":10147,"vehicle_id":45,"route":[[127.15496826,37.4438324],[127.15476227,37.44265366],[127.14183044,37.43993759]],"timestamp":[486.00724771357204,486.2718987036752,488.6338428204673]},{"passenger_id":17735,"vehicle_id":79,"route":[[127.14543915,37.44783401],[127.14564365,37.44609944],[127.172143,37.43672156]],"timestamp":[486.7994506740953,487.1868875340103,492.3096762778103]},{"passenger_id":8346,"vehicle_id":9,"route":[[127.16844177,37.45279312],[127.1678201,37.45128784],[127.16357174,37.45036672]],"timestamp":[486.13855525847384,486.49084707039003,487.26836467316417]},{"passenger_id":20839,"vehicle_id":87,"route":[[127.16056267,37.41255181],[127.15978321,37.41250235],[127.16026153,37.43266873]],"timestamp":[486.5300619236217,486.6681845704831,491.15377844791743]},{"passenger_id":15135,"vehicle_id":67,"route":[[127.10591027,37.34397634],[127.11248977,37.34585343],[127.17234363,37.43551348]],"timestamp":[486.35164486871884,487.5875321591101,510.15804475485396]},{"passenger_id":17747,"vehicle_id":88,"route":[[127.11182404,37.35014343],[127.10901137,37.35064704],[127.1056948,37.36343305]],"timestamp":[486.3006768141719,486.81037627890083,489.7136655505792]},{"passenger_id":8404,"vehicle_id":3,"route":[[127.13431918,37.39918687],[127.12902404,37.39855666],[127.16435419,37.45973598]],"timestamp":[486.8711231310847,487.81706845340017,502.7851458769807]},{"passenger_id":10172,"vehicle_id":24,"route":[[127.1108277,37.39598311],[127.11165895,37.39623352],[127.11308657,37.40287772]],"timestamp":[486.57513641702303,486.7322044410996,488.2311787356691]},{"passenger_id":12757,"vehicle_id":16,"route":[[127.13162078,37.44123792],[127.13211373,37.4401737],[127.1260214,37.4105663]],"timestamp":[486.45236709714396,486.70453732140163,493.3762562127691]},{"passenger_id":20807,"vehicle_id":33,"route":[[127.16997571,37.44184336],[127.16607396,37.44250887],[127.16436781,37.43552216]],"timestamp":[487.94296908664836,488.64762045932747,490.23033151347664]},{"passenger_id":10195,"vehicle_id":78,"route":[[127.15094757,37.44339371],[127.15033187,37.4435971],[127.10593816,37.37125512]],"timestamp":[487.7280525013193,487.8457992986256,505.7435230762108]},{"passenger_id":17727,"vehicle_id":6,"route":[[127.14303598,37.43273083],[127.14097711,37.43303274],[127.1375615,37.444221]],"timestamp":[487.51685829667514,487.88658618366054,490.4467963514427]},{"passenger_id":10176,"vehicle_id":50,"route":[[127.09630518,37.42707915],[127.10053253,37.42707443],[127.10601044,37.40114212]],"timestamp":[487.10461530179475,487.8511909822503,493.6988819144977]},{"passenger_id":3315,"vehicle_id":34,"route":[[127.10661316,37.37685776],[127.11361694,37.37860107],[127.09712982,37.37875366]],"timestamp":[487.0833859466182,488.3804082774628,491.29420983759593]},{"passenger_id":21050,"vehicle_id":80,"route":[[127.155099,37.443858],[127.15707123,37.44360608],[127.1570756,37.44360836]],"timestamp":[487.51756425613763,487.8702721187834,487.87119540692885]},{"passenger_id":17806,"vehicle_id":11,"route":[[127.1326828,37.44561386],[127.13275311,37.44564509],[127.15820695,37.43285193]],"timestamp":[487.42002054571014,487.43424537420884,492.7536017793665]},{"passenger_id":3332,"vehicle_id":9,"route":[[127.16357174,37.45036672],[127.16310883,37.45029449],[127.14801025,37.43452454]],"timestamp":[487.26836467316417,487.35165553844047,491.7569805559115]},{"passenger_id":8377,"vehicle_id":84,"route":[[127.17089081,37.43517685],[127.16598511,37.43503952],[127.16825104,37.43676376]],"timestamp":[488,488.8668207940923,489.4210230405913]},{"passenger_id":17796,"vehicle_id":71,"route":[[127.13937779,37.38984638],[127.1346157,37.37947968],[127.14226658,37.40705812]],"timestamp":[488,490.4542206519498,496.73459325842356]},{"passenger_id":3305,"vehicle_id":12,"route":[[127.0889909,37.40753772],[127.07813094,37.39388283],[127.12218877,37.38770171]],"timestamp":[488.99152616609916,492.583553308464,500.4886293575869]},{"passenger_id":23624,"vehicle_id":30,"route":[[127.09485626,37.41128159],[127.104861995105,37.4221955179128],[127.172803241458,37.4341176669786]],"timestamp":[488.06875447595235,491.0711613255117,503.35926014416657]},{"passenger_id":15050,"vehicle_id":97,"route":[[127.13518932,37.44998251],[127.13557771,37.45009865],[127.1268318,37.44834865]],"timestamp":[488.3719587014208,488.4452326744184,490.0376447961041]},{"passenger_id":15077,"vehicle_id":80,"route":[[127.1570756,37.44360836],[127.1598602,37.44159695],[127.14721569,37.43577582]],"timestamp":[487.87119540692885,488.5359034212257,491.116805009668]},{"passenger_id":12819,"vehicle_id":45,"route":[[127.14183044,37.43993759],[127.14081573,37.44129181],[127.3670578,37.35611343]],"timestamp":[488.6338428204673,488.98427484739375,533.2165594159029]},{"passenger_id":17791,"vehicle_id":1,"route":[[127.10177806,37.40432438],[127.10988617,37.39541626],[127.08718109,37.40509796]],"timestamp":[488.6082396190418,491.05294870186356,495.60556491089375]},{"passenger_id":20911,"vehicle_id":92,"route":[[127.13817596,37.40662766],[127.133303485657,37.4073011644503],[127.109898074456,37.3673736310115]],"timestamp":[488.74409868880855,489.6177722758052,499.41314714419866]},{"passenger_id":12755,"vehicle_id":76,"route":[[127.1257388,37.4429493],[127.12807842,37.43981445],[127.12602226,37.41062196]],"timestamp":[488.301500494764,489.11186568151396,495.6141274808238]},{"passenger_id":3337,"vehicle_id":99,"route":[[127.1128225,37.40277918],[127.11432195,37.40119333],[127.10592933,37.34123577]],"timestamp":[488.6219127191254,489.06299465201135,502.47919585726055]},{"passenger_id":17779,"vehicle_id":21,"route":[[127.152156,37.404252],[127.14808952,37.40575433],[127.12550061,37.41880804]],"timestamp":[488.7835626074909,489.5758308183087,494.51025720286896]},{"passenger_id":15111,"vehicle_id":24,"route":[[127.11308657,37.40287772],[127.11694336,37.39990997],[127.1237793,37.35096741]],"timestamp":[488.2311787356691,489.17978590727716,500.13095553892015]},{"passenger_id":5901,"vehicle_id":54,"route":[[127.109395300322,37.4161511104186],[127.12267303,37.41546249],[127.24106598,37.42998505]],"timestamp":[489.69019647790765,492.0404694232297,513.1985260156812]},{"passenger_id":3300,"vehicle_id":88,"route":[[127.1056948,37.36343305],[127.10597229,37.36238861],[127.11566925,37.35984421]],"timestamp":[489.7136655505792,489.9510606233528,491.75609396920686]},{"passenger_id":3303,"vehicle_id":84,"route":[[127.16825104,37.43676376],[127.16599274,37.43667221],[127.15775299,37.44425583]],"timestamp":[489.4210230405913,489.82032017481663,492.04768773146714]},{"passenger_id":5885,"vehicle_id":69,"route":[[127.11886809,37.37428646],[127.1153717,37.37265396],[127.10308075,37.40309906]],"timestamp":[489.89234460565507,490.6090297545138,497.71950079554153]},{"passenger_id":17758,"vehicle_id":25,"route":[[127.15635681,37.40399933],[127.14805292,37.4078348],[127.16009968,37.43298632]],"timestamp":[489.1839784584038,490.88087025299484,496.86533244736137]},{"passenger_id":8379,"vehicle_id":96,"route":[[127.10312653,37.39991379],[127.109823075221,37.39493179577],[127.109692520573,37.4040317401063]],"timestamp":[489.5279817565951,491.1488794847802,493.1727462075569]},{"passenger_id":12768,"vehicle_id":40,"route":[[127.12167012,37.38786529],[127.12123108,37.3860321],[127.10319519,37.39989471]],"timestamp":[489.3076291788108,489.7226276711234,494.1565111863525]},{"passenger_id":20922,"vehicle_id":52,"route":[[127.10010932,37.40179258],[127.10970106,37.39331035],[127.10597665,37.37794558]],"timestamp":[489.55235022789105,492.08811783330765,495.5678871412805]},{"passenger_id":17789,"vehicle_id":6,"route":[[127.1375615,37.444221],[127.13573456,37.44324112],[127.11206818,37.34797287]],"timestamp":[490.4467963514427,490.83608129275717,512.4314474446778]},{"passenger_id":23623,"vehicle_id":23,"route":[[127.15464106,37.40540615],[127.145666,37.407236],[127.123603,37.407888]],"timestamp":[490.21671257072023,491.8535912999121,495.7537589082733]},{"passenger_id":8391,"vehicle_id":5,"route":[[127.16511536,37.44296646],[127.16344164,37.44393066],[127.14329673,37.43494316]],"timestamp":[490.30341104613694,490.6685329855694,494.74873359542914]},{"passenger_id":20903,"vehicle_id":39,"route":[[127.17626329,37.43439941],[127.17863066,37.43161547],[127.12680005,37.44949028]],"timestamp":[490.36654566157637,491.113594786926,501.0915751991946]},{"passenger_id":12763,"vehicle_id":38,"route":[[127.12202709,37.38755428],[127.123922987948,37.3885318348547],[127.125570200189,37.4099039263371]],"timestamp":[490.6461565267799,491.04551582878804,495.80735302196024]},{"passenger_id":10190,"vehicle_id":33,"route":[[127.16436781,37.43552216],[127.16478385,37.43684953],[127.12937227,37.43110915]],"timestamp":[490.23033151347664,490.5345297255074,496.9168247120366]},{"passenger_id":5902,"vehicle_id":56,"route":[[127.12816926,37.43155846],[127.12911224,37.43164444],[127.1688385,37.46257782]],"timestamp":[490.05627055661876,490.2238905012872,500.04838748071614]},{"passenger_id":23637,"vehicle_id":70,"route":[[127.12814923,37.39477343],[127.127656,37.398561],[127.107431,37.364536]],"timestamp":[490.49283461775025,491.3396474708504,499.70806078154186]},{"passenger_id":824,"vehicle_id":27,"route":[[127.14280701,37.433815],[127.1417998,37.43263524],[127.16209071,37.4529693]],"timestamp":[490.56467498551825,490.88164830118626,496.6509915937231]},{"passenger_id":20939,"vehicle_id":2,"route":[[127.12602398,37.410898],[127.1255919,37.40975017],[127.13517759,37.44191533]],"timestamp":[491,491.26643216485076,498.61723581777085]},{"passenger_id":20994,"vehicle_id":97,"route":[[127.1268318,37.44834865],[127.13101572,37.44875831],[127.11284617,37.3767937]],"timestamp":[491,491.7442897445506,508.0671275362306]},{"passenger_id":8352,"vehicle_id":64,"route":[[127.10827637,37.36601257],[127.10827637,37.36624527],[127.12172699,37.38791275]],"timestamp":[491.6112507991109,491.6630009179711,497.0360365929369]},{"passenger_id":17732,"vehicle_id":87,"route":[[127.16026153,37.43266873],[127.16063684,37.43329052],[127.14025851,37.43480577]],"timestamp":[491.15377844791743,491.3071208909081,494.92146195700116]},{"passenger_id":20874,"vehicle_id":61,"route":[[127.141795100037,37.4366009851969],[127.14112804,37.43615253],[127.16507464,37.44212001]],"timestamp":[491.19883052811946,491.3531724475072,495.7849699035653]},{"passenger_id":10359,"vehicle_id":88,"route":[[127.11566925,37.35984421],[127.11830902,37.36001587],[127.05608368,37.54895401]],"timestamp":[491.75609396920686,492.22426975251886,535.6544824855108]},{"passenger_id":20899,"vehicle_id":68,"route":[[127.17867832,37.43847351],[127.17897034,37.44003677],[127.15997314,37.45141983]],"timestamp":[491.57228382164493,491.92374018277417,496.12599073988815]},{"passenger_id":10188,"vehicle_id":80,"route":[[127.14721569,37.43577582],[127.14716653,37.43583922],[127.12980276,37.42983905]],"timestamp":[491.116805009668,491.13336263556516,494.47743311931174]},{"passenger_id":23634,"vehicle_id":9,"route":[[127.14801025,37.43452454],[127.149705,37.43629],[127.129177,37.432371]],"timestamp":[491.7569805559115,492.2506535525663,495.978967223568]},{"passenger_id":12818,"vehicle_id":34,"route":[[127.09712982,37.37875366],[127.1002544,37.3780181],[127.23347535,37.38672972]],"timestamp":[491.29420983759593,491.8701084848678,515.4913375032606]},{"passenger_id":3379,"vehicle_id":53,"route":[[127.11109161,37.40419388],[127.11031342,37.39759445],[127.08499908,37.17055893]],"timestamp":[491.804574768932,493.27864620401954,543.9673346029996]},{"passenger_id":17784,"vehicle_id":74,"route":[[127.10081026,37.40354896],[127.109848075062,37.3944845762833],[127.101317572388,37.4047845133223]],"timestamp":[492,494.5715954937822,497.31352415911095]},{"passenger_id":20895,"vehicle_id":79,"route":[[127.172143,37.43672156],[127.16600543,37.4383074],[127.12794289,37.43929228]],"timestamp":[492.3096762778103,493.4493948328018,500.1739790471548]},{"passenger_id":12733,"vehicle_id":11,"route":[[127.15820695,37.43285193],[127.15753174,37.43250275],[127.14762115,37.45108414]],"timestamp":[492.7536017793665,492.8958960337474,497.3834614303927]},{"passenger_id":12743,"vehicle_id":4,"route":[[127.17713165,37.43938446],[127.17925084,37.44458844],[127.17001794,37.44860699]],"timestamp":[492.52342254332183,493.7397233748555,495.59878009249263]},{"passenger_id":20933,"vehicle_id":93,"route":[[127.10726284,37.37244539],[127.10997772,37.37042236],[127.09352112,37.41238785]],"timestamp":[492.2300199647174,492.88777250194426,502.66294973057853]},{"passenger_id":12762,"vehicle_id":63,"route":[[127.17285919,37.4312973],[127.17874868,37.43163077],[127.14279675,37.43377546]],"timestamp":[492.37226508624644,493.414963415749,499.7816995755444]},{"passenger_id":12767,"vehicle_id":84,"route":[[127.15775299,37.44425583],[127.15473938,37.4440918],[127.14825439,37.43441772]],"timestamp":[492.04768773146714,492.5810364131753,495.0182177286896]},{"passenger_id":21008,"vehicle_id":43,"route":[[127.17539385,37.43451047],[127.17885571,37.43528201],[126.98186244,37.31736255]],"timestamp":[493,493.63494410430786,537.2204715605083]},{"passenger_id":3336,"vehicle_id":95,"route":[[127.1251979,37.40996726],[127.12822723,37.41226959],[127.10198212,37.40319443]],"timestamp":[493,493.7406102698095,498.7970847567519]},{"passenger_id":8397,"vehicle_id":35,"route":[[127.10647583,37.36406326],[127.10795593,37.36631393],[127.13897705,37.37295914]],"timestamp":[493.21991137451295,493.78468248436906,499.4630729588624]},{"passenger_id":12758,"vehicle_id":96,"route":[[127.109692520573,37.4040317401063],[127.11283674,37.39762009],[127.10190495,37.40424509]],"timestamp":[493.1727462075569,494.70301131707976,497.13212648427907]},{"passenger_id":10208,"vehicle_id":16,"route":[[127.1260214,37.4105663],[127.12843006,37.4098392],[127.09799352,37.40455538]],"timestamp":[494,494.4551697681698,499.9587759973225]},{"passenger_id":10292,"vehicle_id":50,"route":[[127.10601044,37.40114212],[127.11069489,37.39781952],[127.07361603,37.20251465]],"timestamp":[494,495.10947013876205,539.0358044220478]},{"passenger_id":3299,"vehicle_id":49,"route":[[127.12158966,37.38449478],[127.12379681,37.38382359],[127.10629887,37.35129991]],"timestamp":[494.75445976866666,495.1720662253963,503.03845845757706]},{"passenger_id":20833,"vehicle_id":87,"route":[[127.14025851,37.43480577],[127.13908386,37.43520737],[127.12921906,37.43218231]],"timestamp":[494.92146195700116,495.1473004522297,497.0147167634453]},{"passenger_id":15073,"vehicle_id":21,"route":[[127.12550061,37.41880804],[127.12627544,37.41880105],[127.16021315,37.43825777]],"timestamp":[494.51025720286896,494.647120697572,502.03931749181703]},{"passenger_id":17850,"vehicle_id":15,"route":[[127.1567423,37.3615369],[127.14616394,37.37188721],[127.16879272,37.44848251]],"timestamp":[494.0283348552324,496.9938199776313,514.4905617948594]},{"passenger_id":20995,"vehicle_id":80,"route":[[127.12980276,37.42983905],[127.12940979,37.43046188],[126.98771667,37.298069]],"timestamp":[494.47743311931174,494.63235695686393,533.2862384500128]},{"passenger_id":5893,"vehicle_id":62,"route":[[127.12835475,37.43326681],[127.12893151,37.43239498],[127.1436238,37.40905798]],"timestamp":[494.2917225797412,494.51073295131965,500.3132350371986]},{"passenger_id":17751,"vehicle_id":5,"route":[[127.14329673,37.43494316],[127.14282744,37.43709006],[127.14516725,37.43836937]],"timestamp":[494.74873359542914,495.2333207239568,495.73496710981306]},{"passenger_id":15145,"vehicle_id":10,"route":[[127.04920959,37.5037384],[127.12857871,37.46266451],[127.11280581,37.40288768]],"timestamp":[494.2009347495413,510.92279731165644,524.5052263829043]},{"passenger_id":17787,"vehicle_id":40,"route":[[127.10319519,37.39989471],[127.11121472,37.39608556],[127.10212814,37.37887849]],"timestamp":[494.1565111863525,495.80728665900267,499.95715270536715]},{"passenger_id":12852,"vehicle_id":44,"route":[[127.04891205,37.25811768],[127.10969597,37.33588054],[127.11183498,37.40431623]],"timestamp":[494.5837212340882,514.9480797694221,530.1721774615853]},{"passenger_id":8357,"vehicle_id":22,"route":[[127.14676365,37.42862667],[127.14704132,37.42898941],[127.13800049,37.41327286]],"timestamp":[495.01570701411487,495.11011162014535,498.9527893638596]},{"passenger_id":12693,"vehicle_id":4,"route":[[127.17001794,37.44860699],[127.1711863,37.44885137],[127.17868056,37.43848638]],"timestamp":[495.59878009249263,495.8120989351447,498.4699736090522]},{"passenger_id":17755,"vehicle_id":84,"route":[[127.14825439,37.43441772],[127.15067834,37.43246258],[127.1293563,37.43124083]],"timestamp":[495.0182177286896,495.6283640645999,499.4035121547668]},{"passenger_id":17792,"vehicle_id":5,"route":[[127.14516725,37.43836937],[127.14484855,37.43916132],[127.17427539,37.43779534]],"timestamp":[495.73496710981306,495.91986104357807,501.1248952491555]},{"passenger_id":10206,"vehicle_id":76,"route":[[127.12602226,37.41062196],[127.12830428,37.41232558],[127.11200446,37.40324204]],"timestamp":[495.6141274808238,496.16732922574704,499.6846599910773]},{"passenger_id":17816,"vehicle_id":23,"route":[[127.123603,37.407888],[127.12737274,37.40472031],[127.1133728,37.37846375]],"timestamp":[495.7537589082733,496.723164368031,503.0647005121381]},{"passenger_id":15092,"vehicle_id":38,"route":[[127.125570200189,37.4099039263371],[127.12831506,37.41232402],[127.12449677,37.38949993]],"timestamp":[495.80735302196024,496.5317526207763,501.652226723432]},{"passenger_id":5908,"vehicle_id":52,"route":[[127.10597665,37.37794558],[127.11274719,37.37659454],[127.10109711,37.40477753]],"timestamp":[495.5678871412805,496.8015469420922,503.39853539379504]},{"passenger_id":12792,"vehicle_id":9,"route":[[127.129177,37.432371],[127.12921327,37.43228604],[127.16792554,37.44978616]],"timestamp":[495.978967223568,495.99891758696634,503.86473592993826]},{"passenger_id":3324,"vehicle_id":1,"route":[[127.08718109,37.40509796],[127.09422302,37.40049362],[127.07384491,37.39185715]],"timestamp":[496,497.6112574026621,501.69190426739567]},{"passenger_id":3454,"vehicle_id":61,"route":[[127.16507464,37.44212001],[127.16307126,37.44087525],[127.1293638,37.43117903]],"timestamp":[496,496.4491801433174,502.77996066493733]},{"passenger_id":15063,"vehicle_id":33,"route":[[127.12937227,37.43110915],[127.12933944,37.43137996],[127.16575499,37.45960165]],"timestamp":[496.9168247120366,496.9773285224615,505.96236612721117]},{"passenger_id":12766,"vehicle_id":27,"route":[[127.16209071,37.4529693],[127.161025536699,37.4538869905204],[127.125445200961,37.4098039269493]],"timestamp":[496.6509915937231,496.9285044482216,508.57285489458195]},{"passenger_id":10194,"vehicle_id":20,"route":[[127.1248528,37.38539562],[127.124189652924,37.3842401944392],[127.099170363584,37.416226110013]],"timestamp":[496.29871121187233,496.58112473175856,504.95592424452656]},{"passenger_id":8395,"vehicle_id":46,"route":[[127.15073246,37.44939908],[127.15152406,37.44883628],[127.14715339,37.43585616]],"timestamp":[496.4614923910254,496.6491040985788,499.63712951531824]},{"passenger_id":20907,"vehicle_id":71,"route":[[127.14226658,37.40705812],[127.14268636,37.4081878],[127.12552104,37.40973195]],"timestamp":[496.73459325842356,496.9965381816929,500.04815180891063]},{"passenger_id":15100,"vehicle_id":83,"route":[[127.12833532,37.39467686],[127.12708562,37.39467571],[127.13097267,37.37320168]],"timestamp":[496.53176220079746,496.75256222016213,501.5773117979366]},{"passenger_id":12760,"vehicle_id":25,"route":[[127.16009968,37.43298632],[127.16068131,37.43328394],[127.14901389,37.43422424]],"timestamp":[496.86533244736137,496.98752226657405,499.05845833038626]},{"passenger_id":20915,"vehicle_id":68,"route":[[127.15997314,37.45141983],[127.159892210363,37.4512258956892],[127.165378287577,37.4608702811296]],"timestamp":[496.12599073988815,496.17142486986626,498.5247659433791]},{"passenger_id":15053,"vehicle_id":58,"route":[[127.1445118,37.43943893],[127.14472234,37.43933938],[127.12699285,37.46538959]],"timestamp":[497.4509001924261,497.49416938162807,504.07897909161204]},{"passenger_id":8400,"vehicle_id":7,"route":[[127.11215207,37.39623556],[127.11308706,37.3949142],[127.09617693,37.41229535]],"timestamp":[497.7366899651928,498.0737969136172,502.9590398512005]},{"passenger_id":20935,"vehicle_id":64,"route":[[127.12172699,37.38791275],[127.1240101,37.38862465],[127.10649907,37.37668624]],"timestamp":[497.0360365929369,497.46940986553614,501.5466816230606]},{"passenger_id":15134,"vehicle_id":11,"route":[[127.14762115,37.45108414],[127.14655288,37.45003062],[127.12837345,37.40276594]],"timestamp":[497.3834614303927,497.68423398859915,508.67482623823355]},{"passenger_id":15096,"vehicle_id":69,"route":[[127.10308075,37.40309906],[127.11103821,37.3960762],[127.10174561,37.39529419]],"timestamp":[497.71950079554153,499.82085132521746,501.4718523377618]},{"passenger_id":15119,"vehicle_id":96,"route":[[127.10190495,37.40424509],[127.11104787,37.39623042],[127.06457186,37.39221016]],"timestamp":[497.13212648427907,499.537534464901,507.79760181462484]},{"passenger_id":15205,"vehicle_id":65,"route":[[127.48982209,37.25165064],[127.14549179,37.37393133],[126.96111193,37.39290045]],"timestamp":[497.56710213773295,564.2659591356193,597.1194702976566]},{"passenger_id":20940,"vehicle_id":87,"route":[[127.12921906,37.43218231],[127.12922142,37.43222877],[127.15955335,37.43341392]],"timestamp":[497.0147167634453,497.0250573978653,502.38792460236743]},{"passenger_id":12820,"vehicle_id":26,"route":[[127.04891205,37.25814438],[127.120224,37.33497238],[127.12274933,37.38812637]],"timestamp":[497.70072964473064,518.9395550034542,530.7688880500938]},{"passenger_id":17833,"vehicle_id":28,"route":[[127.14654158,37.52854381],[127.13472135,37.47402091],[127.13818035,37.44466321]],"timestamp":[498,510.30337232649805,516.8607189499055]},{"passenger_id":8434,"vehicle_id":74,"route":[[127.101317572388,37.4047845133223],[127.11309052,37.40167236],[127.16497803,37.45911026]],"timestamp":[498,500.1919689817483,515.9123335032073]},{"passenger_id":10166,"vehicle_id":68,"route":[[127.165378287577,37.4608702811296],[127.16597493,37.46031019],[127.14384963,37.44774389]],"timestamp":[498.5247659433791,498.6878850905872,503.4907098052297]},{"passenger_id":3321,"vehicle_id":2,"route":[[127.13517759,37.44191533],[127.13494232,37.44184535],[127.12902943,37.43163301]],"timestamp":[498.61723581777085,498.66159714721744,501.1612308876515]},{"passenger_id":12783,"vehicle_id":66,"route":[[127.07000732,37.35132599],[127.10725431,37.35134928],[127.12516198,37.41880804]],"timestamp":[498.66118703903385,505.245876118324,520.5781157706124]},{"passenger_id":20912,"vehicle_id":90,"route":[[127.2285614,37.38516617],[127.16156006,37.41156769],[127.12929535,37.43236542]],"timestamp":[498.51085234676145,511.724366658085,519.0636937304971]},{"passenger_id":10250,"vehicle_id":59,"route":[[127.10203452,37.37851437],[127.10192108,37.37099075],[127.12690735,37.45967865]],"timestamp":[498.3658998586168,500.03919671185105,520.2502419536252]},{"passenger_id":20943,"vehicle_id":22,"route":[[127.13800049,37.41327286],[127.13845703,37.41212621],[127.12965829,37.38259472]],"timestamp":[498.9527893638596,499.2202403155594,505.9692147574445]},{"passenger_id":10211,"vehicle_id":17,"route":[[127.09806824,37.40450668],[127.11098784,37.39623011],[127.12463858,37.38441986]],"timestamp":[499,501.93217795398334,505.4981369363758]},{"passenger_id":8407,"vehicle_id":4,"route":[[127.17868056,37.43848638],[127.17433929,37.43781281],[127.14894104,37.43429947]],"timestamp":[499,499.78107887591034,504.333571531023]},{"passenger_id":21083,"vehicle_id":95,"route":[[127.10198212,37.40319443],[127.11227569,37.39769545],[127.09100087,37.21411509]],"timestamp":[499,501.1914965100218,542.1909883193543]},{"passenger_id":12723,"vehicle_id":25,"route":[[127.14901389,37.43422424],[127.15095382,37.43254591],[127.1368634,37.4619844]],"timestamp":[499.05845833038626,499.56508229937725,506.5686471613632]},{"passenger_id":8394,"vehicle_id":40,"route":[[127.10212814,37.37887849],[127.09794439,37.371182],[127.10825551,37.2878245]],"timestamp":[499.95715270536715,501.82164792925744,520.4489673980255]},{"passenger_id":10155,"vehicle_id":84,"route":[[127.1293563,37.43124083],[127.12931561,37.43156732],[127.14318986,37.43471845]],"timestamp":[499.4035121547668,499.47647491800063,502.0248004941559]},{"passenger_id":3325,"vehicle_id":35,"route":[[127.13897705,37.37295914],[127.13688129,37.37431833],[127.1239159,37.34838765]],"timestamp":[499.4630729588624,499.9411463503663,506.1465701129844]},{"passenger_id":15280,"vehicle_id":70,"route":[[127.107431,37.364536],[127.10784375,37.36343115],[126.63446112,37.397577]],"timestamp":[499.70806078154186,499.9643704412192,583.962374436947]},{"passenger_id":17800,"vehicle_id":92,"route":[[127.109898074456,37.3673736310115],[127.10808809,37.36635784],[127.12376983,37.35105385]],"timestamp":[499.41314714419866,499.8047776856225,504.19425979463244]},{"passenger_id":20958,"vehicle_id":13,"route":[[127.00957489,37.56888962],[127.12824249,37.46486664],[127.14207458,37.43854141]],"timestamp":[499.47023129488,530.6683729429986,537.0117343858593]},{"passenger_id":20997,"vehicle_id":46,"route":[[127.14715339,37.43585616],[127.14893516,37.43704345],[127.12098305,37.38793687]],"timestamp":[499.63712951531824,500.0478738177445,512.0329721338313]},{"passenger_id":20931,"vehicle_id":16,"route":[[127.09799352,37.40455538],[127.11128235,37.39602661],[127.11225891,37.40332794]],"timestamp":[500,503.01816657935234,504.65104854413937]},{"passenger_id":8403,"vehicle_id":63,"route":[[127.14279675,37.43377546],[127.13868063,37.43479491],[127.12953617,37.43289324]],"timestamp":[500,500.76139796463593,502.4306783259566]},{"passenger_id":5917,"vehicle_id":76,"route":[[127.11200446,37.40324204],[127.11854553,37.40089417],[127.15835571,37.44868088]],"timestamp":[500,501.2680661200867,514.010632650794]},{"passenger_id":10177,"vehicle_id":31,"route":[[127.12057495,37.38425446],[127.1236051,37.38349774],[127.06350823,37.39130507]],"timestamp":[500.8192650005138,501.3805387697281,512.1406304062589]},{"passenger_id":17790,"vehicle_id":8,"route":[[127.16680516,37.46103666],[127.16632745,37.46026805],[127.14676231,37.43636057]],"timestamp":[500.8522795663775,501.0428805471523,507.38327605773867]},{"passenger_id":20894,"vehicle_id":56,"route":[[127.1688385,37.46257782],[127.16877157,37.46252245],[127.17265519,37.44172757]],"timestamp":[500.04838748071614,500.06545245448154,504.7405731665644]},{"passenger_id":17798,"vehicle_id":12,"route":[[127.12218877,37.38770171],[127.12445831,37.38950729],[127.13639832,37.44216919]],"timestamp":[500.4886293575869,501.0561270057597,512.9559770358571]},{"passenger_id":8396,"vehicle_id":79,"route":[[127.12794289,37.43929228],[127.12794496,37.43928075],[127.13844683,37.44410519]],"timestamp":[500.1739790471548,500.17656912279165,502.31892021764776]},{"passenger_id":3360,"vehicle_id":24,"route":[[127.1237793,37.35096741],[127.12340546,37.35053253],[127.13715363,37.44011688]],"timestamp":[500.13095553892015,500.24809315117886,520.3182755106886]},{"passenger_id":836,"vehicle_id":62,"route":[[127.1436238,37.40905798],[127.14089203,37.41006088],[127.12112427,37.38791275]],"timestamp":[500.3132350371986,500.8448441405427,506.8828641342391]},{"passenger_id":17814,"vehicle_id":71,"route":[[127.12552104,37.40973195],[127.12628174,37.41220093],[127.12952423,37.42992783]],"timestamp":[501,501.56527928451095,505.54894158364556]},{"passenger_id":8422,"vehicle_id":57,"route":[[127.14303737,37.37235297],[127.14213562,37.37379456],[127.12428284,37.38851166]],"timestamp":[501,501.3580218982915,505.9039107630588]},{"passenger_id":17719,"vehicle_id":0,"route":[[127.11701849,37.36856053],[127.11439949,37.36853898],[127.11182338,37.35001565]],"timestamp":[501.26889761798816,501.73181461672243,505.8763075377604]},{"passenger_id":10171,"vehicle_id":2,"route":[[127.12902943,37.43163301],[127.12931181,37.431594],[127.14705459,37.44084421]],"timestamp":[501.1612308876515,501.2118468523924,504.95993622948]},{"passenger_id":15128,"vehicle_id":83,"route":[[127.13097267,37.37320168],[127.13027558,37.37361686],[127.12776233,37.40984465]],"timestamp":[501.5773117979366,501.73126962054846,509.80019108301525]},{"passenger_id":10244,"vehicle_id":1,"route":[[127.07384491,37.39185715],[127.07391461,37.3916728],[127.12405782,37.38400848]],"timestamp":[501.69190426739567,501.7347115764214,510.7573942901602]},{"passenger_id":8439,"vehicle_id":39,"route":[[127.12680005,37.44949028],[127.12820671,37.44799979],[127.07666487,37.39173391]],"timestamp":[501.0915751991946,501.5057626499116,516.9798482147896]},{"passenger_id":17891,"vehicle_id":77,"route":[[127.17648571,37.4377186],[127.16993111,37.44113356],[127.1521845,37.40394449]],"timestamp":[501.58231377872266,502.96662579175074,511.8111058613857]},{"passenger_id":15117,"vehicle_id":5,"route":[[127.17427539,37.43779534],[127.17017206,37.44075999],[127.15994709,37.45171277]],"timestamp":[501.1248952491555,502.10452062573444,505.13639584118107]},{"passenger_id":3333,"vehicle_id":69,"route":[[127.10174561,37.39529419],[127.10967255,37.39467621],[127.11112213,37.40419006]],"timestamp":[501.4718523377618,502.87912338901987,505.01035010679783]},{"passenger_id":8492,"vehicle_id":48,"route":[[127.11510468,37.37478256],[127.11253766,37.37556655],[127.04757311,37.27872176]],"timestamp":[501.0652643919859,501.55127913498075,525.9610912681636]},{"passenger_id":17844,"vehicle_id":38,"route":[[127.12449677,37.38949993],[127.12702588,37.39072725],[127.11492927,37.35992534]],"timestamp":[501.652226723432,502.17586445745525,509.35173839029784]},{"passenger_id":20956,"vehicle_id":64,"route":[[127.10649907,37.37668624],[127.10736847,37.37545013],[127.11025238,37.34997559]],"timestamp":[502,502.31492236197636,508.0030887391876]},{"passenger_id":17754,"vehicle_id":87,"route":[[127.15955335,37.43341392],[127.15885925,37.43339157],[127.15498352,37.40538788]],"timestamp":[502.38792460236743,502.51059713390396,508.7758430736048]},{"passenger_id":821,"vehicle_id":21,"route":[[127.16021315,37.43825777],[127.16064008,37.43865379],[127.12864869,37.41223693]],"timestamp":[502.03931749181703,502.1552470175307,510.3060852300111]},{"passenger_id":8402,"vehicle_id":3,"route":[[127.16435419,37.45973598],[127.16591143,37.46023847],[127.13531649,37.42922318]],"timestamp":[502.7851458769807,503.0818882453077,511.84297348670685]},{"passenger_id":12776,"vehicle_id":61,"route":[[127.1293638,37.43117903],[127.12943716,37.43056636],[127.16930744,37.4382178]],"timestamp":[502.77996066493733,502.91682677513336,510.1601714019368]},{"passenger_id":20896,"vehicle_id":63,"route":[[127.12953617,37.43289324],[127.12971593,37.43293033],[127.14739605,37.43552746]],"timestamp":[502.4306783259566,502.4634766658787,505.6385666334486]},{"passenger_id":3320,"vehicle_id":99,"route":[[127.10592933,37.34123577],[127.11608797,37.34312379],[127.10900237,37.34907498]],"timestamp":[502.47919585726055,504.3237285844724,506.14606100852745]},{"passenger_id":20960,"vehicle_id":93,"route":[[127.09352112,37.41238785],[127.09334328,37.42877345],[127.12553184,37.40973472]],"timestamp":[502.66294973057853,506.3070762827681,513.3957556779834]},{"passenger_id":17884,"vehicle_id":79,"route":[[127.13844683,37.44410519],[127.13874054,37.44298172],[127.11286163,37.40216064]],"timestamp":[502.31892021764776,502.57409387564593,512.7379702351839]},{"passenger_id":3343,"vehicle_id":18,"route":[[127.09606958,37.26712886],[127.11803772,37.33809634],[127.10900237,37.34918237]],"timestamp":[502.22367539611633,518.4775289961427,521.4152522536974]},{"passenger_id":12839,"vehicle_id":84,"route":[[127.14318986,37.43471845],[127.14154654,37.43638107],[127.11849077,37.3850658]],"timestamp":[503,503.4700250131848,515.5869681242973]},{"passenger_id":6017,"vehicle_id":7,"route":[[127.09617693,37.41229535],[127.10276794,37.39990997],[126.68227386,37.16508865]],"timestamp":[503,505.99036888764454,596.8924293308115]},{"passenger_id":20889,"vehicle_id":9,"route":[[127.16792554,37.44978616],[127.16620813,37.44987086],[127.16661761,37.44871714]],"timestamp":[503.86473592993826,504.16853299007073,504.435099367406]},{"passenger_id":10226,"vehicle_id":37,"route":[[127.48984477,37.25162413],[127.14778643,37.36858521],[127.11478277,37.35985776]],"timestamp":[503.62141132159286,569.4793620775317,575.6273017566313]},{"passenger_id":3344,"vehicle_id":49,"route":[[127.10629887,37.35129991],[127.1063637,37.35052081],[127.10664827,37.37678405]],"timestamp":[503.03845845757706,503.21210103747023,509.05299570993265]},{"passenger_id":15114,"vehicle_id":68,"route":[[127.14384963,37.44774389],[127.14533308,37.44793558],[127.14604716,37.43735942]],"timestamp":[503.4907098052297,503.756069767193,506.1114774981054]},{"passenger_id":17830,"vehicle_id":23,"route":[[127.1133728,37.37846375],[127.1133194,37.37844849],[127.09870148,37.35640717]],"timestamp":[503.0647005121381,503.0747290525405,508.61572542048157]},{"passenger_id":23640,"vehicle_id":42,"route":[[127.09051514,37.2144928],[127.121695,37.339068],[127.123477,37.351586]],"timestamp":[503.29501154043663,531.5433696087559,534.3450166743071]},{"passenger_id":5906,"vehicle_id":52,"route":[[127.10109711,37.40477753],[127.11529541,37.40407181],[127.1184845,37.39372635]],"timestamp":[503.39853539379504,505.91170272516206,508.2804120081515]},{"passenger_id":12803,"vehicle_id":30,"route":[[127.172803241458,37.4341176669786],[127.17604276,37.43139757],[127.12934481,37.43133561]],"timestamp":[504,504.8325863383204,513.0792585780471]},{"passenger_id":10163,"vehicle_id":4,"route":[[127.14894104,37.43429947],[127.151883926458,37.4324093441399],[127.14359786646,37.4123678000896]],"timestamp":[504.333571531023,505.0019762605075,509.69312554113407]},{"passenger_id":816,"vehicle_id":9,"route":[[127.16661761,37.44871714],[127.16661835,37.44664383],[127.14702606,37.43600464]],"timestamp":[504.435099367406,504.89618249263924,509.0873653922893]},{"passenger_id":23631,"vehicle_id":56,"route":[[127.17265519,37.44172757],[127.170736587636,37.443506498441],[127.157292226414,37.4452259323958]],"timestamp":[504.7405731665644,505.2614130971797,507.6658191452012]},{"passenger_id":10205,"vehicle_id":2,"route":[[127.14705459,37.44084421],[127.146795,37.44074354],[127.16976085,37.43737206]],"timestamp":[504.95993622948,505.010948259465,509.13493549422583]},{"passenger_id":20979,"vehicle_id":58,"route":[[127.12699285,37.46538959],[127.1284386,37.46100584],[127.15517281,37.44833392]],"timestamp":[504.07897909161204,505.08673026650007,510.5837374788814]},{"passenger_id":17886,"vehicle_id":16,"route":[[127.11225891,37.40332794],[127.1164856,37.40425491],[127.12380981,37.35100555]],"timestamp":[504.65104854413937,505.42567360274677,517.3383177934359]},{"passenger_id":15177,"vehicle_id":92,"route":[[127.12376983,37.35105385],[127.12452857,37.34525156],[127.12826618,37.43630699]],"timestamp":[504.19425979463244,505.4915836252949,525.7521533030501]},{"passenger_id":12826,"vehicle_id":20,"route":[[127.099170363584,37.416226110013],[127.1006012,37.42725372],[127.1463623,37.44983673]],"timestamp":[504.95592424452656,507.42133887767767,516.9353473056178]},{"passenger_id":10241,"vehicle_id":98,"route":[[127.23407745,37.38583374],[127.16268459,37.41298926],[127.17577828,37.43446407]],"timestamp":[504.3128434534182,518.297123462963,523.603332192234]},{"passenger_id":20890,"vehicle_id":63,"route":[[127.14739605,37.43552746],[127.15056801,37.43938932],[127.13235184,37.37879514]],"timestamp":[505.6385666334486,506.6639084288715,520.5183128933409]},{"passenger_id":17824,"vehicle_id":17,"route":[[127.12463858,37.38441986],[127.12887573,37.38512039],[127.14351654,37.40872192]],"timestamp":[505.4981369363758,506.262901534003,512.1144199856884]},{"passenger_id":20934,"vehicle_id":78,"route":[[127.10593816,37.37125512],[127.10594669,37.36811022],[127.12030121,37.35396407]],"timestamp":[505.7435230762108,506.44291855070173,510.4845885062839]},{"passenger_id":15127,"vehicle_id":71,"route":[[127.12952423,37.42992783],[127.12945171,37.43041308],[127.14389157,37.44770137]],"timestamp":[505.54894158364556,505.6576135433724,510.27099460541757]},{"passenger_id":843,"vehicle_id":22,"route":[[127.12965829,37.38259472],[127.13213348,37.38035965],[127.15392303,37.40395737]],"timestamp":[505.9692147574445,506.6313202372529,513.1399725877159]},{"passenger_id":21044,"vehicle_id":0,"route":[[127.11182338,37.35001565],[127.11036669,37.35001079],[127.18018736,37.2422803]],"timestamp":[505.8763075377604,506.1338344284978,533.0888407868991]},{"passenger_id":21023,"vehicle_id":33,"route":[[127.16575499,37.45960165],[127.16774977,37.45986558],[127.24307753,37.424878]],"timestamp":[505.96236612721117,506.319360578778,521.7287179879991]},{"passenger_id":5912,"vehicle_id":69,"route":[[127.11112213,37.40419006],[127.10621643,37.40076447],[127.08594513,37.40612793]],"timestamp":[505.01035010679783,506.16424096966176,509.9388183907212]},{"passenger_id":5914,"vehicle_id":57,"route":[[127.12428284,37.38851166],[127.12301636,37.38850021],[127.11056519,37.39987183]],"timestamp":[506,506.2237975063304,509.5756821843354]},{"passenger_id":21047,"vehicle_id":5,"route":[[127.15994709,37.45171277],[127.15997873,37.45179267],[127.12336532,37.38824027]],"timestamp":[506,506.0186262879001,521.5612174829004]},{"passenger_id":17793,"vehicle_id":25,"route":[[127.1368634,37.4619844],[127.14410325,37.46725384],[127.14331439,37.47240308]],"timestamp":[506.5686471613632,508.302561198672,509.45613384627313]},{"passenger_id":8418,"vehicle_id":99,"route":[[127.10900237,37.34907498],[127.10881347,37.35034717],[127.1400807,37.372408]],"timestamp":[506.14606100852745,506.430947279637,513.8211837716203]},{"passenger_id":23638,"vehicle_id":62,"route":[[127.12112427,37.38791275],[127.117723,37.390637],[127.096881,37.397755]],"timestamp":[506.8828641342391,507.73623089563335,511.7444889582362]},{"passenger_id":872,"vehicle_id":35,"route":[[127.1239159,37.34838765],[127.12496948,37.34297562],[126.88353729,37.41616821]],"timestamp":[506.1465701129844,507.3644793362448,553.0293883841778]},{"passenger_id":5935,"vehicle_id":47,"route":[[127.08288574,37.22668076],[127.10893734,37.3392695],[127.16509556,37.46057505]],"timestamp":[506.99215267917134,532.4515427094318,561.1952487010134]},{"passenger_id":12800,"vehicle_id":68,"route":[[127.14604716,37.43735942],[127.14468758,37.43939267],[127.15796946,37.46111546]],"timestamp":[507,507.51195391812644,512.881923370439]},{"passenger_id":10183,"vehicle_id":55,"route":[[127.11340399,37.35203494],[127.11372375,37.35199356],[127.12367249,37.38347244]],"timestamp":[507.1836466966885,507.24091893154235,514.4589610813107]},{"passenger_id":15109,"vehicle_id":96,"route":[[127.06457186,37.39221016],[127.06867358,37.39280223],[127.09841896,37.40536792]],"timestamp":[507.79760181462484,508.5341882027646,514.4861603529317]},{"passenger_id":12770,"vehicle_id":72,"route":[[127.12338,37.351516],[127.1239336,37.35731211],[127.10808816,37.36560631]],"timestamp":[507.7737029238726,509.0664086731391,512.4200790201018]},{"passenger_id":20981,"vehicle_id":51,"route":[[127.15168034,37.4518151],[127.14990234,37.45158005],[127.14681244,37.42864227]],"timestamp":[507.30627410183627,507.6244987079458,512.7547230034639]},{"passenger_id":20986,"vehicle_id":56,"route":[[127.157292226414,37.4452259323958],[127.15634914,37.44484966],[127.14385704,37.43513368]],"timestamp":[507.6658191452012,507.85217722345743,510.939946916216]},{"passenger_id":17928,"vehicle_id":32,"route":[[127.04592427,37.29026398],[127.11946525,37.33967788],[127.11590788,37.41494472]],"timestamp":[507.5731396477523,524.6010131182425,541.3513962927084]},{"passenger_id":8429,"vehicle_id":8,"route":[[127.14676231,37.43636057],[127.14588115,37.44012038],[127.15206813,37.45891333]],"timestamp":[507.38327605773867,508.23377348047836,512.5535241110063]},{"passenger_id":15057,"vehicle_id":91,"route":[[127.1227898,37.35977964],[127.12032674,37.35922356],[127.10808807,37.36699132]],"timestamp":[508.5368986084196,508.98950438360623,511.75787560113673]},{"passenger_id":10362,"vehicle_id":11,"route":[[127.12837345,37.40276594],[127.12729939,37.40272671],[127.03983696,37.29847034]],"timestamp":[508.67482623823355,508.8647736588978,536.733176979494]},{"passenger_id":3341,"vehicle_id":87,"route":[[127.15498352,37.40538788],[127.15499115,37.40548706],[127.13404083,37.41677094]],"timestamp":[508.7758430736048,508.7979408460917,513.2692553075196]},{"passenger_id":828,"vehicle_id":52,"route":[[127.1184845,37.39372635],[127.11675262,37.39498901],[127.07233429,37.39321899]],"timestamp":[508.2804120081515,508.6957220480198,516.5535802641293]},{"passenger_id":5911,"vehicle_id":23,"route":[[127.09870148,37.35640717],[127.10605621,37.35747147],[127.11550903,37.37496567]],"timestamp":[508.61572542048157,509.9371995261121,514.1713167940649]},{"passenger_id":20965,"vehicle_id":86,"route":[[127.00492096,37.30421448],[127.10600281,37.35430527],[127.12822723,37.3659935]],"timestamp":[508.68118915307554,529.7431515919209,534.453720782574]},{"passenger_id":17912,"vehicle_id":27,"route":[[127.125445200961,37.4098039269493],[127.12531281,37.40829086],[127.17666626,37.44033432]],"timestamp":[508.57285489458195,508.9101573576422,520.4444777358216]},{"passenger_id":21018,"vehicle_id":97,"route":[[127.11284617,37.3767937],[127.11357117,37.37854004],[127.09085846,37.40761948]],"timestamp":[508.0671275362306,508.4760842871114,516.0870011241602]},{"passenger_id":17847,"vehicle_id":36,"route":[[127.05255259,37.54505974],[127.12726124,37.4563068],[127.13370269,37.44954657]],"timestamp":[509,532.7343148908114,534.6193790379708]},{"passenger_id":3348,"vehicle_id":64,"route":[[127.11025238,37.34997559],[127.1090129,37.35059958],[127.11376785,37.35991189]],"timestamp":[509,509.2593686350262,511.49441340336836]},{"passenger_id":17785,"vehicle_id":29,"route":[[127.05599875,37.44700111],[127.09412591,37.42927447],[127.11150778,37.40323692]],"timestamp":[509.09115063140615,516.8929137721506,523.4469789688675]},{"passenger_id":15115,"vehicle_id":4,"route":[[127.14359786646,37.4123678000896],[127.14368439,37.4127121],[127.11282349,37.39810944]],"timestamp":[509.69312554113407,509.7712047864578,516.1169280582546]},{"passenger_id":15122,"vehicle_id":38,"route":[[127.11492927,37.35992534],[127.11482043,37.36242887],[127.12549039,37.40972407]],"timestamp":[509.35173839029784,509.9088303546788,520.5944522491743]},{"passenger_id":15175,"vehicle_id":2,"route":[[127.16976085,37.43737206],[127.16600545,37.43791037],[127.1080548,37.37122378]],"timestamp":[509.13493549422583,509.80878704028856,527.8295477417773]},{"passenger_id":15150,"vehicle_id":69,"route":[[127.08594513,37.40612793],[127.08312988,37.39279556],[127.11140442,37.39608765]],"timestamp":[509.9388183907212,512.9452297015042,517.9942190737078]},{"passenger_id":12831,"vehicle_id":83,"route":[[127.12776233,37.40984465],[127.13034458,37.40980607],[127.16690821,37.45661063]],"timestamp":[509.80019108301525,510.25641741052107,522.5052915361292]},{"passenger_id":8445,"vehicle_id":9,"route":[[127.14702606,37.43600464],[127.14296601,37.43879321],[127.12864868,37.41249648]],"timestamp":[509.0873653922893,510.03529687973366,516.406659322348]},{"passenger_id":20957,"vehicle_id":49,"route":[[127.10664827,37.37678405],[127.10717923,37.37575464],[127.10808803,37.36847406]],"timestamp":[509.05299570993265,509.30041028060936,510.9274844976473]},{"passenger_id":10351,"vehicle_id":57,"route":[[127.11056519,37.39987183],[127.11032589,37.39717679],[127.11071494,37.29151497]],"timestamp":[509.5756821843354,510.1765210183756,533.6747383399735]},{"passenger_id":17937,"vehicle_id":25,"route":[[127.14331439,37.47240308],[127.14574432,37.4730072],[127.16767883,37.46308517]],"timestamp":[510,510.44942913923427,514.9057191884191]},{"passenger_id":3331,"vehicle_id":78,"route":[[127.12030121,37.35396407],[127.12485504,37.35850525],[127.11561584,37.3800621]],"timestamp":[510.4845885062839,511.7760751292347,516.8405808327738]},{"passenger_id":21037,"vehicle_id":49,"route":[[127.10808803,37.36847406],[127.10751343,37.36715698],[127.09371948,37.21289825]],"timestamp":[510.9274844976473,511.2374966007618,545.6297750895123]},{"passenger_id":8408,"vehicle_id":56,"route":[[127.14385704,37.43513368],[127.14183807,37.43787766],[127.1658783,37.43858337]],"timestamp":[510.939946916216,511.646692368019,515.8946063385716]},{"passenger_id":20962,"vehicle_id":1,"route":[[127.12405782,37.38400848],[127.12426149,37.38415275],[127.13831888,37.37436333]],"timestamp":[510.7573942901602,510.8056091514165,514.1087723724795]},{"passenger_id":23643,"vehicle_id":71,"route":[[127.14389157,37.44770137],[127.145351,37.447643],[127.153391,37.450296]],"timestamp":[510.27099460541757,510.5289943949082,512.0662222592983]},{"passenger_id":17834,"vehicle_id":67,"route":[[127.17234363,37.43551348],[127.173728235756,37.4379454213412],[127.162700526276,37.4456648185878]],"timestamp":[510.15804475485396,510.7515817680895,513.3474639443468]},{"passenger_id":17939,"vehicle_id":58,"route":[[127.15517281,37.44833392],[127.15538844,37.44816116],[127.12686427,37.40986539]],"timestamp":[510.5837374788814,510.6378252271235,520.5326610838886]},{"passenger_id":15186,"vehicle_id":21,"route":[[127.12864869,37.41223693],[127.12863922,37.41215897],[127.1233902,37.35155869]],"timestamp":[510.3060852300111,510.32350325466086,523.832273541177]},{"passenger_id":17882,"vehicle_id":19,"route":[[127.162100530039,37.4530869954115],[127.16036189,37.4527138],[127.17900664,37.44028435]],"timestamp":[511,511.3179706132565,515.6165095901442]},{"passenger_id":12804,"vehicle_id":14,"route":[[127.25772095,37.40973663],[127.17898982,37.44011332],[127.17184145,37.44869616]],"timestamp":[511,526.4589543263589,528.7472512746286]},{"passenger_id":17848,"vehicle_id":61,"route":[[127.16930744,37.4382178],[127.16597917,37.43718098],[127.16806775,37.44533256]],"timestamp":[511,511.63132229967454,513.481281946675]},{"passenger_id":17926,"vehicle_id":91,"route":[[127.10808807,37.36699132],[127.10746313,37.36711893],[126.97261947,37.26883626]],"timestamp":[511.75787560113673,511.87191953371257,544.2215471842798]},{"passenger_id":837,"vehicle_id":64,"route":[[127.11376785,37.35991189],[127.11174011,37.36123276],[127.13880157,37.41106415]],"timestamp":[511.49441340336836,511.95783446619373,524.0274852568239]},{"passenger_id":10242,"vehicle_id":77,"route":[[127.1521845,37.40394449],[127.15059302,37.40867909],[127.12886631,37.41187285]],"timestamp":[511.8111058613857,512.9009207444395,516.8040150598899]},{"passenger_id":12815,"vehicle_id":3,"route":[[127.13531649,37.42922318],[127.13644031,37.43110751],[127.16705603,37.44666005]],"timestamp":[511.84297348670685,512.3066503148373,518.724462961352]},{"passenger_id":15267,"vehicle_id":62,"route":[[127.096881,37.397755],[127.09532928,37.39904785],[127.04147339,37.46776581]],"timestamp":[512,512.3972693041262,530.3970976376271]},{"passenger_id":12780,"vehicle_id":72,"route":[[127.10808816,37.36560631],[127.10808809,37.36624839],[127.10539755,37.37600812]],"timestamp":[512.4200790201018,512.5628710976396,514.7848155946064]},{"passenger_id":826,"vehicle_id":71,"route":[[127.153391,37.450296],[127.15440369,37.44750977],[127.14414215,37.44508362]],"timestamp":[512.0662222592983,512.7111315960871,514.6015478391912]},{"passenger_id":17826,"vehicle_id":12,"route":[[127.13639832,37.44216919],[127.13658905,37.44227219],[127.16465759,37.44061279]],"timestamp":[512.9559770358571,512.9967059890527,517.9665445174192]},{"passenger_id":17862,"vehicle_id":6,"route":[[127.11206818,37.34797287],[127.11414337,37.34701538],[127.12002563,37.38351059]],"timestamp":[512.4314474446778,512.8556439950082,521.038131287503]},{"passenger_id":10262,"vehicle_id":17,"route":[[127.14351654,37.40872192],[127.1468199,37.40672086],[127.12019723,37.38364051]],"timestamp":[512.1144199856884,512.8482877768944,519.8104002639708]},{"passenger_id":3363,"vehicle_id":46,"route":[[127.12098305,37.38793687],[127.12395586,37.38867243],[127.16108914,37.40331998]],"timestamp":[512.0329721338313,512.583141005159,519.9080014195831]},{"passenger_id":10231,"vehicle_id":68,"route":[[127.15796946,37.46111546],[127.158394997462,37.4589925148528],[127.160133875543,37.4526592202547]],"timestamp":[512.881923370439,513.3599836004877,514.8015093365967]},{"passenger_id":12817,"vehicle_id":51,"route":[[127.14681244,37.42864227],[127.14788818,37.42914581],[127.17300415,37.43901062]],"timestamp":[512.7547230034639,512.9752483515207,517.923381876412]},{"passenger_id":3370,"vehicle_id":79,"route":[[127.11286163,37.40216064],[127.11546326,37.403862],[127.15466309,37.4053421]],"timestamp":[512.7379702351839,513.3332872618812,520.2661044896208]},{"passenger_id":3373,"vehicle_id":31,"route":[[127.06350823,37.39130507],[127.06072235,37.39308929],[127.09928894,37.41622925]],"timestamp":[512.1406304062589,512.7728776186595,521.3110830707969]},{"passenger_id":20988,"vehicle_id":8,"route":[[127.15206813,37.45891333],[127.15846458,37.45888075],[127.15927893,37.44254305]],"timestamp":[512.5535241110063,513.6827178457355,517.3189000469002]},{"passenger_id":15104,"vehicle_id":99,"route":[[127.1400807,37.372408],[127.14178914,37.3704613],[127.12864866,37.41307529]],"timestamp":[513.8211837716203,514.3490055181927,524.1061903863405]},{"passenger_id":17805,"vehicle_id":67,"route":[[127.162700526276,37.4456648185878],[127.16215662,37.44534182],[127.14308365,37.43449513]],"timestamp":[513.3474639443468,513.467389736699,517.6099611572608]},{"passenger_id":23636,"vehicle_id":22,"route":[[127.15392303,37.40395737],[127.15018547,37.41293143],[127.16916015,37.43183612]],"timestamp":[513.1399725877159,515.2420890768351,520.6185443555302]},{"passenger_id":12862,"vehicle_id":87,"route":[[127.13404083,37.41677094],[127.13388429,37.41580508],[127.09672817,37.32368289]],"timestamp":[513.2692553075196,513.4858250786397,534.9996448070509]},{"passenger_id":15116,"vehicle_id":54,"route":[[127.24106598,37.42998505],[127.17951965,37.44397354],[127.16980743,37.44282532]],"timestamp":[513.1985260156812,524.5030055987413,526.2367743758043]},{"passenger_id":15142,"vehicle_id":93,"route":[[127.12553184,37.40973472],[127.12504609,37.40961845],[127.11119732,37.41428569]],"timestamp":[513.3957556779834,513.4853732583518,516.1427334230467]},{"passenger_id":17857,"vehicle_id":30,"route":[[127.12934481,37.43133561],[127.12936604,37.43116056],[127.12748512,37.44167297]],"timestamp":[514,514.0391094594451,516.4004385752107]},{"passenger_id":21000,"vehicle_id":61,"route":[[127.16806775,37.44533256],[127.167481052246,37.4460731494139],[127.174072678057,37.435909322684]],"timestamp":[514,514.1945675359277,516.736962477685]},{"passenger_id":3334,"vehicle_id":76,"route":[[127.15835571,37.44868088],[127.15885162,37.44749451],[127.16944885,37.43173218]],"timestamp":[514.010632650794,514.2886179726727,518.2621766478784]},{"passenger_id":838,"vehicle_id":23,"route":[[127.11550903,37.37496567],[127.11473083,37.3731842],[127.10929108,37.34068298]],"timestamp":[514.1713167940649,514.5906904987806,521.8823156103131]},{"passenger_id":5907,"vehicle_id":25,"route":[[127.16767883,37.46308517],[127.16834259,37.46216965],[127.16012573,37.45256042]],"timestamp":[514.9057191884191,515.1406283576284,517.7234309233392]},{"passenger_id":15148,"vehicle_id":1,"route":[[127.13831888,37.37436333],[127.13924276,37.37526647],[127.10808809,37.36640274]],"timestamp":[514.1087723724795,514.3676151846265,520.2160511329132]},{"passenger_id":10238,"vehicle_id":15,"route":[[127.16879272,37.44848251],[127.16746512,37.44624085],[127.17643484,37.44035017]],"timestamp":[514.4905617948594,515.0414404151735,517.0967931107712]},{"passenger_id":8441,"vehicle_id":72,"route":[[127.10539755,37.37600812],[127.10461359,37.38082411],[127.12885023,37.41317211]],"timestamp":[514.7848155946064,515.8647662210321,524.2366056629619]},{"passenger_id":10276,"vehicle_id":71,"route":[[127.14414215,37.44508362],[127.14403534,37.44475937],[127.16843414,37.4318924]],"timestamp":[514.6015478391912,514.6760830164678,519.8480988219387]},{"passenger_id":12808,"vehicle_id":55,"route":[[127.12367249,37.38347244],[127.123817432996,37.3834874212677],[127.157531113452,37.3922457009153]],"timestamp":[514.4589610813107,514.4847895507426,520.7522767972306]},{"passenger_id":12858,"vehicle_id":96,"route":[[127.09841896,37.40536792],[127.1015625,37.39997482],[127.06687164,37.42510605]],"timestamp":[514.4861603529317,515.8078646390609,524.1016016517639]},{"passenger_id":17856,"vehicle_id":68,"route":[[127.160133875543,37.4526592202547],[127.16035576,37.45269881],[127.16604271,37.45035044]],"timestamp":[514.8015093365967,514.84165926915,515.9733865973583]},{"passenger_id":17810,"vehicle_id":19,"route":[[127.17900664,37.44028435],[127.17808737,37.44600121],[127.16871128,37.43265456]],"timestamp":[515.6165095901442,516.8982005095772,520.2968749978008]},{"passenger_id":839,"vehicle_id":74,"route":[[127.16497803,37.45911026],[127.16436459,37.45841186],[127.16220408,37.44007114]],"timestamp":[515.9123335032073,516.1016754939653,520.198262978295]},{"passenger_id":17849,"vehicle_id":68,"route":[[127.16604271,37.45035044],[127.16451263,37.45044327],[127.17931366,37.44485855]],"timestamp":[515.9733865973583,516.2443112546641,519.1376659624234]},{"passenger_id":17870,"vehicle_id":56,"route":[[127.1658783,37.43858337],[127.16533813,37.43945579],[127.17031668,37.4566513]],"timestamp":[515.8946063385716,516.1108017547422,520.0346297222978]},{"passenger_id":5936,"vehicle_id":34,"route":[[127.23347535,37.38672972],[127.16059113,37.41241837],[127.15531921,37.46068573]],"timestamp":[515.4913375032606,529.5782700664297,540.3527337634661]},{"passenger_id":17880,"vehicle_id":84,"route":[[127.11849077,37.3850658],[127.120545230991,37.3816124327511],[127.106325874137,37.3509626203071]],"timestamp":[515.5869681242973,516.4364467136713,523.7012355472201]},{"passenger_id":12773,"vehicle_id":52,"route":[[127.07233429,37.39321899],[127.07357788,37.38965225],[127.11140442,37.40423203]],"timestamp":[516.5535802641293,517.3766587583053,524.8047579453572]},{"passenger_id":17842,"vehicle_id":30,"route":[[127.12748512,37.44167297],[127.12733615,37.44142047],[127.17353679,37.43752989]],"timestamp":[516.4004385752107,516.4624474735991,524.6661556978829]},{"passenger_id":10255,"vehicle_id":39,"route":[[127.07666487,37.39173391],[127.07824117,37.39106246],[127.13823059,37.37236538]],"timestamp":[516.9798482147896,517.2958687726872,528.683072508573]},{"passenger_id":12807,"vehicle_id":9,"route":[[127.12864868,37.41249648],[127.128959068136,37.4124289108784],[127.140000666703,37.4372093148151]],"timestamp":[516.406659322348,516.4635083272877,522.3092680842751]},{"passenger_id":8421,"vehicle_id":20,"route":[[127.1463623,37.44983673],[127.1463378,37.44974055],[127.14211641,37.44840382]],"timestamp":[516.9353473056178,516.9571697494532,517.7595720956156]},{"passenger_id":10303,"vehicle_id":28,"route":[[127.13818035,37.44466321],[127.13736155,37.44625499],[127.16660404,37.44875377]],"timestamp":[516.8607189499055,517.243097401936,522.4359037854765]},{"passenger_id":10260,"vehicle_id":97,"route":[[127.09085846,37.40761948],[127.09384364,37.40031274],[127.10622446,37.39997538]],"timestamp":[516.0870011241602,517.7953797572691,519.9839782553314]},{"passenger_id":17868,"vehicle_id":78,"route":[[127.11561584,37.3800621],[127.11601257,37.37889481],[127.14665222,37.36808395]],"timestamp":[516.8405808327738,517.1094750225765,523.0342259303852]},{"passenger_id":21058,"vehicle_id":61,"route":[[127.174072678057,37.435909322684],[127.168396,37.4318924],[127.25030518,37.41601181]],"timestamp":[516.736962477685,518.0796905035792,532.9707983523114]},{"passenger_id":3417,"vehicle_id":4,"route":[[127.11282349,37.39810944],[127.11052105,37.39774056],[127.07348631,37.22629956]],"timestamp":[516.1169280582546,516.5319003297465,555.2172771771166]},{"passenger_id":12881,"vehicle_id":93,"route":[[127.11119732,37.41428569],[127.11709595,37.40669632],[127.11562347,37.35983276]],"timestamp":[517,518.9835203996657,529.4087482821384]},{"passenger_id":12890,"vehicle_id":77,"route":[[127.12886631,37.41187285],[127.12849426,37.41225433],[127.10969543,37.40392303]],"timestamp":[517,517.1073145079017,520.9100426233234]},{"passenger_id":12769,"vehicle_id":51,"route":[[127.17300415,37.43901062],[127.16912807,37.44214839],[127.15997647,37.45178743]],"timestamp":[517.923381876412,518.9008072381782,521.5851929830752]},{"passenger_id":12765,"vehicle_id":12,"route":[[127.16465759,37.44061279],[127.16410144,37.44147864],[127.16474095,37.43671288]],"timestamp":[517.9665445174192,518.1826957505541,519.248551173391]},{"passenger_id":8420,"vehicle_id":25,"route":[[127.16012573,37.45256042],[127.16013345,37.45218037],[127.15225237,37.45186628]],"timestamp":[517.7234309233392,517.8079611755584,519.2010946909708]},{"passenger_id":10368,"vehicle_id":8,"route":[[127.15927893,37.44254305],[127.159806099736,37.4440509395771],[127.123670211371,37.3515292834271]],"timestamp":[517.3189000469002,517.6669181027692,539.2105037600137]},{"passenger_id":20966,"vehicle_id":69,"route":[[127.11140442,37.39608765],[127.11117554,37.39604187],[127.1078186,37.40394974]],"timestamp":[517.9942190737078,518.0359192977708,519.8918587957536]},{"passenger_id":5920,"vehicle_id":20,"route":[[127.14211641,37.44840382],[127.14160185,37.44825584],[127.12916342,37.43059344]],"timestamp":[517.7595720956156,517.856197525328,522.356486469064]},{"passenger_id":15192,"vehicle_id":15,"route":[[127.17643484,37.44035017],[127.16945648,37.44444656],[127.13082886,37.43212509]],"timestamp":[517.0967931107712,518.6291602715437,525.9798366345464]},{"passenger_id":20989,"vehicle_id":16,"route":[[127.12380981,37.35100555],[127.12326448,37.35887078],[127.11480027,37.36589802]],"timestamp":[517.3383177934359,519.0901196178263,521.2536071452341]},{"passenger_id":17993,"vehicle_id":67,"route":[[127.14308365,37.43449513],[127.1415587,37.43438622],[127.11165223,37.34495801]],"timestamp":[517.6099611572608,517.8803368595816,538.4583201450391]},{"passenger_id":8493,"vehicle_id":85,"route":[[127.10174084,37.39983997],[127.10638364,37.3996266],[127.13304025,37.27585768]],"timestamp":[517.5614174690586,518.3830340948108,546.3086209562343]},{"passenger_id":17807,"vehicle_id":76,"route":[[127.16944885,37.43173218],[127.1651213,37.43275288],[127.14732686,37.43563125]],"timestamp":[518.2621766478784,519.0593938690928,522.266235090686]},{"passenger_id":21067,"vehicle_id":3,"route":[[127.16705603,37.44666005],[127.16660282,37.44655782],[127.1168363,37.39961637]],"timestamp":[518.724462961352,518.8076486831176,532.4544373786808]},{"passenger_id":15095,"vehicle_id":71,"route":[[127.16843414,37.4318924],[127.16513824,37.4328804],[127.14286041,37.4337616]],"timestamp":[519.8480988219387,520.4702250812252,524.4091710286774]},{"passenger_id":12799,"vehicle_id":25,"route":[[127.15225237,37.45186628],[127.1491394,37.45197296],[127.17055511,37.44309235]],"timestamp":[519.2010946909708,519.7511929046632,524.0170137812639]},{"passenger_id":12788,"vehicle_id":12,"route":[[127.16474095,37.43671288],[127.16489028,37.43656263],[127.1718548,37.44613334]],"timestamp":[519.248551173391,519.2911168243506,521.7492607530603]},{"passenger_id":20996,"vehicle_id":97,"route":[[127.10622446,37.39997538],[127.11022949,37.39749908],[127.12337494,37.41242599]],"timestamp":[519.9839782553314,520.8806073556705,524.9318470244027]},{"passenger_id":17946,"vehicle_id":90,"route":[[127.12929535,37.43236542],[127.12922468,37.43220588],[127.17402371,37.43794033]],"timestamp":[519.0636937304971,519.1013046736251,527.1143643502069]},{"passenger_id":17974,"vehicle_id":82,"route":[[127.48346937,37.2467913],[127.14491724,37.36824762],[127.1766753,37.43145995]],"timestamp":[519.9614318962506,585.6566331220349,600.7927204838736]},{"passenger_id":5942,"vehicle_id":69,"route":[[127.1078186,37.40394974],[127.11424255,37.40094376],[127.15349579,37.44305038]],"timestamp":[519.8918587957536,521.208994122991,532.8601799480199]},{"passenger_id":21011,"vehicle_id":46,"route":[[127.16108914,37.40331998],[127.14682282,37.40611469],[127.12915071,37.41133402]],"timestamp":[519.9080014195831,522.5037738582763,525.8343434595497]},{"passenger_id":17888,"vehicle_id":68,"route":[[127.17931366,37.44485855],[127.1810693,37.44136374],[127.16226192,37.44537658]],"timestamp":[519.1376659624234,519.974415387281,523.4130089783065]},{"passenger_id":15164,"vehicle_id":17,"route":[[127.12019723,37.38364051],[127.1204776,37.38641256],[127.10596335,37.36441399]],"timestamp":[519.8104002639708,520.4288635947307,525.9527915012782]},{"passenger_id":8392,"vehicle_id":19,"route":[[127.16871128,37.43265456],[127.16598511,37.43417358],[127.17327881,37.43831253]],"timestamp":[520.2968749978008,520.8849914836862,522.468048553253]},{"passenger_id":12827,"vehicle_id":63,"route":[[127.13235184,37.37879514],[127.13338406,37.37748467],[127.15211766,37.45893323]],"timestamp":[520.5183128933409,520.8621294300369,539.2752054113482]},{"passenger_id":5905,"vehicle_id":79,"route":[[127.15466309,37.4053421],[127.15371351,37.41452881],[127.12936483,37.43117054]],"timestamp":[520.2661044896208,522.3160100185117,527.9896480724608]},{"passenger_id":12866,"vehicle_id":56,"route":[[127.17031668,37.4566513],[127.16994804,37.45626411],[127.10628581,37.37646507]],"timestamp":[520.0346297222978,520.1425632236619,541.1516594902542]},{"passenger_id":15178,"vehicle_id":55,"route":[[127.157531113452,37.3922457009153],[127.14527313,37.37591539],[127.12921272,37.43228993]],"timestamp":[520.7522767972306,524.9808808168526,537.8350401145914]},{"passenger_id":23650,"vehicle_id":1,"route":[[127.10808809,37.36640274],[127.10808809,37.36632358],[127.12359511,37.35150059]],"timestamp":[520.2160511329132,520.2336555136992,524.5209100025301]},{"passenger_id":17859,"vehicle_id":24,"route":[[127.13715363,37.44011688],[127.13703933,37.44018451],[127.14379362,37.4351783]],"timestamp":[520.3182755106886,520.3434457877843,521.9750052548649]},{"passenger_id":21091,"vehicle_id":74,"route":[[127.16220408,37.44007114],[127.1622126,37.44007895],[127.11481058,37.3629566]],"timestamp":[520.198262978295,520.2005607993568,539.2870496208566]},{"passenger_id":12896,"vehicle_id":59,"route":[[127.12690735,37.45967865],[127.12681326,37.46117896],[127.17411964,37.43809692]],"timestamp":[520.2502419536252,520.5843088316745,530.3877207860461]},{"passenger_id":17930,"vehicle_id":77,"route":[[127.10969543,37.40392303],[127.11569977,37.40391541],[127.12854004,37.4390564]],"timestamp":[520.9100426233234,521.9707737492672,530.1081751755804]},{"passenger_id":15232,"vehicle_id":38,"route":[[127.12549039,37.40972407],[127.12649245,37.41233385],[127.12347813,37.35151067]],"timestamp":[520.5944522491743,521.2012327853563,534.738174936496]},{"passenger_id":8450,"vehicle_id":58,"route":[[127.12686427,37.40986539],[127.12884851,37.40941231],[127.15217158,37.406092]],"timestamp":[520.5326610838886,520.8973664200748,525.0830670640238]},{"passenger_id":21042,"vehicle_id":66,"route":[[127.12516198,37.41880804],[127.12460327,37.41656113],[127.12425995,37.38248062]],"timestamp":[520.5781157706124,521.0874570955551,528.6668594146626]},{"passenger_id":21097,"vehicle_id":40,"route":[[127.10825551,37.2878245],[127.10945713,37.33588365],[127.1409235,37.40769145]],"timestamp":[521,531.6899803915147,548.5999432342875]},{"passenger_id":10281,"vehicle_id":22,"route":[[127.16916015,37.43183612],[127.17091235,37.4338541],[127.17236241,37.44161535]],"timestamp":[521,521.5451107943439,523.2900231800811]},{"passenger_id":10282,"vehicle_id":27,"route":[[127.17666626,37.44033432],[127.17903689,37.44062392],[127.16473189,37.44615344]],"timestamp":[521,521.4235178687269,524.2327587196477]},{"passenger_id":12777,"vehicle_id":16,"route":[[127.11480027,37.36589802],[127.11502838,37.36551285],[127.12133789,37.39917755]],"timestamp":[521.2536071452341,521.3482795438334,528.9175353228139]},{"passenger_id":20993,"vehicle_id":41,"route":[[126.92987061,37.528759],[127.0953208,37.42951588],[127.11554184,37.3983187]],"timestamp":[521.8595454012014,558.4615075634155,566.2648779570798]},{"passenger_id":10254,"vehicle_id":51,"route":[[127.15997647,37.45178743],[127.16011047,37.45165634],[127.17655945,37.43744659]],"timestamp":[521.5851929830752,521.6227372887494,525.9147376961857]},{"passenger_id":5946,"vehicle_id":23,"route":[[127.10929108,37.34068298],[127.10913849,37.34047318],[127.10630798,37.40070724]],"timestamp":[521.8823156103131,521.9362118078074,535.3409936181699]},{"passenger_id":12847,"vehicle_id":12,"route":[[127.1718548,37.44613334],[127.17079128,37.44624594],[127.17904421,37.4320423]],"timestamp":[521.7492607530603,521.9386990325152,525.4173971976952]},{"passenger_id":21015,"vehicle_id":31,"route":[[127.09928894,37.41622925],[127.09902954,37.41244125],[127.10594177,37.36803055]],"timestamp":[521.3110830707969,522.1547409870379,532.1064599262857]},{"passenger_id":17883,"vehicle_id":24,"route":[[127.14379362,37.4351783],[127.14186859,37.43686295],[127.13513184,37.44437408]],"timestamp":[521.9750052548649,522.4808857053835,524.5315503750082]},{"passenger_id":10296,"vehicle_id":5,"route":[[127.12336532,37.38824027],[127.12302799,37.38844319],[127.10166271,37.39984044]],"timestamp":[521.5612174829004,521.6359788812907,526.182866365069]},{"passenger_id":10275,"vehicle_id":33,"route":[[127.24307753,37.424878],[127.17539596,37.43133432],[127.14527433,37.42825971]],"timestamp":[521.7287179879991,533.7674472725142,539.1306767007246]},{"passenger_id":17931,"vehicle_id":18,"route":[[127.10900237,37.34918237],[127.10889435,37.34969711],[127.13563538,37.33233261]],"timestamp":[521.4152522536974,521.5313071642237,527.6359830718018]},{"passenger_id":10346,"vehicle_id":6,"route":[[127.12002563,37.38351059],[127.12363866,37.38352234],[127.16093392,37.36821579]],"timestamp":[521.038131287503,521.6765901201132,529.0947774530214]},{"passenger_id":17836,"vehicle_id":28,"route":[[127.16660404,37.44875377],[127.16656494,37.4466095],[127.14316559,37.43528748]],"timestamp":[522.4359037854765,522.9128176425351,527.7512838836135]},{"passenger_id":12798,"vehicle_id":20,"route":[[127.12916342,37.43059344],[127.12941742,37.43044662],[127.14855957,37.45093918]],"timestamp":[522.356486469064,522.4119675640103,528.0859198981852]},{"passenger_id":8416,"vehicle_id":9,"route":[[127.140000666703,37.4372093148151],[127.13958558,37.43855616],[127.1471013,37.45066746]],"timestamp":[522.3092680842751,522.6176304967465,525.6202161645786]},{"passenger_id":15152,"vehicle_id":83,"route":[[127.16690821,37.45661063],[127.16695667,37.45658371],[127.15897778,37.43333442]],"timestamp":[522.5052915361292,522.5157331881258,527.8746293368403]},{"passenger_id":851,"vehicle_id":76,"route":[[127.14732686,37.43563125],[127.14721508,37.4357766],[127.16796105,37.44978714]],"timestamp":[522.266235090686,522.3041096485516,527.1131078811584]},{"passenger_id":17907,"vehicle_id":19,"route":[[127.17327881,37.43831253],[127.17014398,37.44080323],[127.1753373,37.43132859]],"timestamp":[522.468048553253,523.251129451319,525.5491108205949]},{"passenger_id":12795,"vehicle_id":22,"route":[[127.17236241,37.44161535],[127.16779327,37.44271851],[127.12646484,37.41385651]],"timestamp":[523.2900231800811,524.1332743393723,533.8528440078251]},{"passenger_id":21032,"vehicle_id":68,"route":[[127.16226192,37.44537658],[127.16176605,37.44524384],[127.1499939,37.40378952]],"timestamp":[523.4130089783065,523.5054039229391,532.9559593502295]},{"passenger_id":10360,"vehicle_id":94,"route":[[127.09093298,37.21144104],[127.109181411913,37.3393849133384],[127.167136610028,37.4612730564403]],"timestamp":[523.2521262145066,551.8882121834572,580.8641867749975]},{"passenger_id":5930,"vehicle_id":21,"route":[[127.1233902,37.35155869],[127.12400818,37.34719467],[127.1164093,37.33733749]],"timestamp":[523.832273541177,524.808917278914,527.3800114854504]},{"passenger_id":3361,"vehicle_id":84,"route":[[127.106325874137,37.3509626203071],[127.10627747,37.35148621],[127.11597443,37.35980988]],"timestamp":[523.7012355472201,523.8179905846016,526.340877622286]},{"passenger_id":15211,"vehicle_id":29,"route":[[127.11150778,37.40323692],[127.1171875,37.4066391],[127.10639191,37.36849213]],"timestamp":[523.4469789688675,524.7036442776151,533.3989638001135]},{"passenger_id":10310,"vehicle_id":78,"route":[[127.14665222,37.36808395],[127.14547729,37.36736298],[127.10752869,37.34980011]],"timestamp":[523.0342259303852,523.2965846264167,531.0589008161911]},{"passenger_id":10278,"vehicle_id":98,"route":[[127.17577828,37.43446407],[127.16572405,37.43265871],[127.17815857,37.4315293]],"timestamp":[524,525.820311885343,528.030492348157]},{"passenger_id":15136,"vehicle_id":99,"route":[[127.12864866,37.41307529],[127.1283322,37.41231901],[127.10777956,37.37249626]],"timestamp":[524.1061903863405,524.2834255013572,533.8552013154887]},{"passenger_id":17803,"vehicle_id":24,"route":[[127.13513184,37.44437408],[127.135286807047,37.4441037171039],[127.134945142475,37.4418592863895]],"timestamp":[524.5315503750082,524.5976094456103,525.1003804921166]},{"passenger_id":8440,"vehicle_id":72,"route":[[127.12885023,37.41317211],[127.12909621,37.41234166],[127.17550614,37.43449809]],"timestamp":[524.2366056629619,524.4263316215477,533.9900278557544]},{"passenger_id":5916,"vehicle_id":64,"route":[[127.13880157,37.41106415],[127.13813447,37.41067225],[127.16788386,37.43616423]],"timestamp":[524.0274852568239,524.1740527198713,531.9035867818507]},{"passenger_id":17909,"vehicle_id":96,"route":[[127.06687164,37.42510605],[127.09551239,37.42762756],[127.13395691,37.38373566]],"timestamp":[524.1016016517639,529.190763382167,541.082078387]},{"passenger_id":15156,"vehicle_id":71,"route":[[127.14286041,37.4337616],[127.14076869,37.43594996],[127.15313714,37.44471695]],"timestamp":[524.4091710286774,525.0201392990629,527.9477571531767]},{"passenger_id":15223,"vehicle_id":97,"route":[[127.12337494,37.41242599],[127.12606004,37.41253783],[127.12477235,37.47896744]],"timestamp":[524.9318470244027,525.4067956465549,540.1818162470337]},{"passenger_id":21162,"vehicle_id":52,"route":[[127.11140442,37.40423203],[127.11032425,37.39724098],[127.03471538,37.16672927]],"timestamp":[524.8047579453572,526.3711642532049,579.351676766228]},{"passenger_id":21003,"vehicle_id":1,"route":[[127.12359511,37.35150059],[127.11673771,37.35033669],[127.1233177,37.35150788]],"timestamp":[524.5209100025301,525.7605230516745,526.9525722293389]},{"passenger_id":17897,"vehicle_id":27,"route":[[127.16473189,37.44615344],[127.16590118,37.44642258],[127.16537476,37.43286896]],"timestamp":[524.2327587196477,524.4477106082908,527.4633311044074]},{"passenger_id":21012,"vehicle_id":25,"route":[[127.17055511,37.44309235],[127.168644933925,37.445000933748],[127.160719982974,37.4448703790071]],"timestamp":[524.0170137812639,524.5591482983068,525.9587086352283]},{"passenger_id":21046,"vehicle_id":10,"route":[[127.11280581,37.40288768],[127.11251831,37.39704895],[127.12181854,37.38715744]],"timestamp":[524.5052263829043,525.8046937408773,528.5504614231811]},{"passenger_id":12855,"vehicle_id":30,"route":[[127.17353679,37.43752989],[127.16694178,37.43724524],[127.1768221,37.44091588]],"timestamp":[525,526.1662764940473,528.0924504638032]},{"passenger_id":8432,"vehicle_id":17,"route":[[127.10596335,37.36441399],[127.10582225,37.36343218],[127.09963056,37.40557686]],"timestamp":[525.9527915012782,526.172555840731,535.6087497836833]},{"passenger_id":10230,"vehicle_id":24,"route":[[127.134945142475,37.4418592863895],[127.13500214,37.44194412],[127.12935638,37.44605255]],"timestamp":[525.1003804921166,525.1217631308309,526.4739860267085]},{"passenger_id":21029,"vehicle_id":25,"route":[[127.160719982974,37.4448703790071],[127.16186523,37.44507217],[127.1240921,37.38493729]],"timestamp":[525.9587086352283,526.1658375077134,541.1111878572291]},{"passenger_id":852,"vehicle_id":15,"route":[[127.13082886,37.43212509],[127.12997437,37.43154144],[127.15626526,37.40411377]],"timestamp":[525.9798366345464,526.1788788448663,533.8450056288729]},{"passenger_id":15163,"vehicle_id":12,"route":[[127.17904421,37.4320423],[127.16507468,37.43275941],[127.13835878,37.43466471]],"timestamp":[525.4173971976952,527.8894725959157,532.6262295437358]},{"passenger_id":868,"vehicle_id":48,"route":[[127.04757311,37.27872176],[127.10912323,37.3397522],[127.10836792,37.40254593]],"timestamp":[525.9610912681636,543.360666998206,557.3259934255344]},{"passenger_id":5933,"vehicle_id":9,"route":[[127.1471013,37.45066746],[127.14685643,37.45063438],[127.12917594,37.43049616]],"timestamp":[525.6202161645786,525.6640694947973,531.1233407850635]},{"passenger_id":21060,"vehicle_id":58,"route":[[127.15217158,37.406092],[127.14256287,37.40830994],[127.10793304,37.40234375]],"timestamp":[525.0830670640238,526.8506862522025,533.110525329716]},{"passenger_id":15190,"vehicle_id":19,"route":[[127.1753373,37.43132859],[127.16516065,37.43274673],[127.16744383,37.44629967]],"timestamp":[525.5491108205949,527.3737113325965,530.4145911089145]},{"passenger_id":21020,"vehicle_id":51,"route":[[127.17655945,37.43744659],[127.1655693,37.4390647],[127.16050763,37.44116506]],"timestamp":[525.9147376961857,527.8884547215058,528.8969175381844]},{"passenger_id":10294,"vehicle_id":92,"route":[[127.12826618,37.43630699],[127.1282196,37.43755722],[127.12724304,37.45648956]],"timestamp":[525.7521533030501,526.0303134061726,530.2442026714172]},{"passenger_id":5940,"vehicle_id":46,"route":[[127.12915071,37.41133402],[127.1295236,37.41215325],[127.13690174,37.43020201]],"timestamp":[525.8343434595497,526.0280732419966,530.2481700895031]},{"passenger_id":3335,"vehicle_id":1,"route":[[127.1233177,37.35150788],[127.12522102,37.35891104],[127.10596578,37.36372023]],"timestamp":[526.9525722293389,528.6329881427381,532.2006451411748]},{"passenger_id":17933,"vehicle_id":24,"route":[[127.12935638,37.44605255],[127.12939327,37.44465177],[127.17357682,37.43778067]],"timestamp":[526.4739860267085,526.7855733706849,534.7354137566001]},{"passenger_id":10268,"vehicle_id":84,"route":[[127.11597443,37.35980988],[127.11482101,37.36239735],[127.1080881,37.36599981]],"timestamp":[526.340877622286,526.9513556562289,528.3859663281245]},{"passenger_id":13010,"vehicle_id":5,"route":[[127.10166271,37.39984044],[127.11093416,37.39717987],[127.05409412,37.03314912]],"timestamp":[526.182866365069,527.9244720728811,609.5046823415851]},{"passenger_id":3374,"vehicle_id":54,"route":[[127.16980743,37.44282532],[127.16727636,37.44284063],[127.15998008,37.45179582]],"timestamp":[526.2367743758043,526.6836951437218,529.0555614314857]},{"passenger_id":21128,"vehicle_id":71,"route":[[127.15313714,37.44471695],[127.15376282,37.44364929],[126.97336578,37.25852966]],"timestamp":[527.9477571531767,528.2096361527114,580.2858156111553]},{"passenger_id":12781,"vehicle_id":83,"route":[[127.15897778,37.43333442],[127.15882376,37.43328308],[127.17975015,37.43178131]],"timestamp":[527.8746293368403,527.9041271627028,531.6146427677501]},{"passenger_id":23639,"vehicle_id":76,"route":[[127.16796105,37.44978714],[127.167550496293,37.4512536732811],[127.16019498627,37.4517564479988]],"timestamp":[527.1131078811584,527.4472074776156,528.7506146682194]},{"passenger_id":12825,"vehicle_id":90,"route":[[127.17402371,37.43794033],[127.16520694,37.43967842],[127.12851437,37.46007354]],"timestamp":[527.1143643502069,528.7184805157135,536.6266226601562]},{"passenger_id":3382,"vehicle_id":21,"route":[[127.1164093,37.33733749],[127.10891668,37.34052152],[127.09794646,37.404594]],"timestamp":[527.3800114854504,528.8821725151253,543.2625405253838]},{"passenger_id":21031,"vehicle_id":2,"route":[[127.1080548,37.37122378],[127.10981474,37.36958131],[127.07772987,37.39166504]],"timestamp":[527.8295477417773,528.309312133018,535.8104805000272]},{"passenger_id":12908,"vehicle_id":18,"route":[[127.13563538,37.33233261],[127.12057843,37.34014652],[127.09325648,37.42787346]],"timestamp":[527.6359830718018,530.8152802275022,550.9133710754118]},{"passenger_id":10286,"vehicle_id":28,"route":[[127.14316559,37.43528748],[127.1413777,37.43719678],[127.13382313,37.44151245]],"timestamp":[527.7512838836135,528.2804035487704,529.9237532707502]},{"passenger_id":12888,"vehicle_id":27,"route":[[127.16537476,37.43286896],[127.16548833,37.43269554],[127.14212893,37.40922377]],"timestamp":[528,528.0434698632617,534.6969616953246]},{"passenger_id":936,"vehicle_id":79,"route":[[127.12936483,37.43117054],[127.12940979,37.4311676],[127.2270813,37.0058136]],"timestamp":[528,528.0079666423751,624.1708296067035]},{"passenger_id":17877,"vehicle_id":98,"route":[[127.17815857,37.4315293],[127.1644484,37.43283364],[127.16758564,37.44593712]],"timestamp":[528.030492348157,530.4689387474956,533.4352064588853]},{"passenger_id":17878,"vehicle_id":14,"route":[[127.17184145,37.44869616],[127.17193501,37.44900171],[127.15730628,37.44507114]],"timestamp":[528.7472512746286,528.8171814338051,531.5439194333371]},{"passenger_id":12899,"vehicle_id":20,"route":[[127.14855957,37.45093918],[127.14896393,37.45017624],[127.13022614,37.40981674]],"timestamp":[528.0859198981852,528.2699972564147,537.836101710589]},{"passenger_id":15213,"vehicle_id":89,"route":[[127.0357132,37.57833481],[127.14435577,37.47244263],[127.13674164,37.43439865]],"timestamp":[528.2627785944231,558.6229816977408,567.1896972809126]},{"passenger_id":8447,"vehicle_id":10,"route":[[127.12181854,37.38715744],[127.12100983,37.38671875],[127.11128998,37.4041748]],"timestamp":[528.5504614231811,528.7234881805449,532.9684199596259]},{"passenger_id":15169,"vehicle_id":84,"route":[[127.1080881,37.36599981],[127.10808809,37.36620098],[127.12369339,37.3509275]],"timestamp":[528.3859663281245,528.4307044949467,532.8064002738269]},{"passenger_id":21329,"vehicle_id":30,"route":[[127.1768221,37.44091588],[127.17136747,37.44823226],[126.43239941,37.46785018]],"timestamp":[528.0924504638032,529.9832092649419,660.5079297551632]},{"passenger_id":5929,"vehicle_id":66,"route":[[127.12425995,37.38248062],[127.12360742,37.38349944],[127.11489383,37.39109457]],"timestamp":[528.6668594146626,528.9210884045198,531.2066150312372]},{"passenger_id":10305,"vehicle_id":39,"route":[[127.13823059,37.37236538],[127.13690233,37.37056605],[127.10596336,37.36387349]],"timestamp":[528.683072508573,529.1470024972223,534.8143016546761]},{"passenger_id":21068,"vehicle_id":16,"route":[[127.12133789,37.39917755],[127.11910039,37.40007212],[127.10256264,37.40134405]],"timestamp":[528.9175353228139,529.3600745359805,532.2954279485483]},{"passenger_id":861,"vehicle_id":51,"route":[[127.16050763,37.44116506],[127.16110229,37.43967438],[127.1680069,37.4497757]],"timestamp":[529,529.3477436453187,531.9036535161974]},{"passenger_id":10304,"vehicle_id":76,"route":[[127.16019498627,37.4517564479988],[127.160148,37.451851],[127.16758,37.461951]],"timestamp":[529,529.0226045122271,531.6238559785018]},{"passenger_id":8435,"vehicle_id":6,"route":[[127.16093392,37.36821579],[127.14687601,37.37266862],[127.10884534,37.3998184]],"timestamp":[529.0947774530214,531.769435248745,540.8035499712659]},{"passenger_id":8458,"vehicle_id":81,"route":[[127.49154696,37.24755121],[127.14635896,37.37187167],[127.12460341,37.38439495]],"timestamp":[529.6702847216122,596.695817490886,601.4432361493402]},{"passenger_id":21040,"vehicle_id":54,"route":[[127.15998008,37.45179582],[127.16000575,37.45185544],[127.18081722,37.44473088]],"timestamp":[529.0555614314857,529.0695734538649,533.0710149598934]},{"passenger_id":8461,"vehicle_id":28,"route":[[127.13382313,37.44151245],[127.13424665,37.44163842],[127.12677735,37.45006175]],"timestamp":[529.9237532707502,530.0036100390786,532.2945325514555]},{"passenger_id":15296,"vehicle_id":93,"route":[[127.11562347,37.35983276],[127.11833403,37.35922272],[127.04854297,37.25811579]],"timestamp":[529.4087482821384,529.9067175304599,555.5578507200523]},{"passenger_id":20987,"vehicle_id":77,"route":[[127.12854004,37.4390564],[127.12799812,37.43896312],[127.14399648,37.43608797]],"timestamp":[530.1081751755804,530.2060889387558,533.1025559610184]},{"passenger_id":10277,"vehicle_id":46,"route":[[127.13690174,37.43020201],[127.13638306,37.43108749],[127.17636108,37.43438339]],"timestamp":[530.2481700895031,530.4653527300495,537.5631210975785]},{"passenger_id":17978,"vehicle_id":62,"route":[[127.04147339,37.46776581],[127.096420380762,37.4298760265331],[127.164411626887,37.4596008444519]],"timestamp":[530.3970976376271,543.2467965636398,556.9513364501653]},{"passenger_id":5949,"vehicle_id":26,"route":[[127.12274933,37.38812637],[127.12308502,37.3885498],[126.98834991,37.39780807]],"timestamp":[530.7688880500938,530.8801789506696,554.7748341019042]},{"passenger_id":5962,"vehicle_id":92,"route":[[127.12724304,37.45648956],[127.12676704,37.46197766],[127.15226198,37.40487243]],"timestamp":[530.2442026714172,531.4675895767149,544.9416393473043]},{"passenger_id":17908,"vehicle_id":19,"route":[[127.16744383,37.44629967],[127.16708086,37.44666565],[127.16183243,37.45365357]],"timestamp":[530.4145911089145,530.5181835280474,532.3275117766646]},{"passenger_id":21080,"vehicle_id":44,"route":[[127.11183498,37.40431623],[127.1159744,37.40422992],[127.13597982,37.43206429]],"timestamp":[530.1721774615853,530.90369792694,538.0312995902864]},{"passenger_id":21048,"vehicle_id":59,"route":[[127.17411964,37.43809692],[127.16977715,37.44175695],[127.17659257,37.43552486]],"timestamp":[530.3877207860461,531.505964224227,533.341496054162]},{"passenger_id":10257,"vehicle_id":66,"route":[[127.11489383,37.39109457],[127.11427307,37.39057922],[127.12822723,37.43981171]],"timestamp":[531.2066150312372,531.3652513361661,542.5880623647338]},{"passenger_id":3352,"vehicle_id":64,"route":[[127.16788386,37.43616423],[127.16469574,37.43651199],[127.17385864,37.43727112]],"timestamp":[531.9035867818507,532.471845273407,534.0986389127369]},{"passenger_id":8459,"vehicle_id":14,"route":[[127.15730628,37.44507114],[127.1580658,37.4450531],[127.1726532,37.43969345]],"timestamp":[531.5439194333371,531.6780829124615,534.516199025054]},{"passenger_id":15214,"vehicle_id":78,"route":[[127.10752869,37.34980011],[127.10792743,37.3506765],[127.11333538,37.34598171]],"timestamp":[531.0589008161911,531.2661572603375,532.6818471683584]},{"passenger_id":859,"vehicle_id":51,"route":[[127.1680069,37.4497757],[127.16638087,37.44935626],[127.16522518,37.43964778]],"timestamp":[531.9036535161974,532.2055078728405,534.374196490664]},{"passenger_id":10321,"vehicle_id":83,"route":[[127.17975015,37.43178131],[127.17889419,37.43462128],[127.17411306,37.42243182]],"timestamp":[531.6146427677501,532.2640593076899,535.1033278219285]},{"passenger_id":865,"vehicle_id":76,"route":[[127.16758,37.461951],[127.16650391,37.46043015],[127.16894531,37.43281555]],"timestamp":[531.6238559785018,532.0117704000846,538.168086522766]},{"passenger_id":8470,"vehicle_id":9,"route":[[127.12917594,37.43049616],[127.12943942,37.43054197],[127.1395921,37.43464822]],"timestamp":[532,532.0476322167214,534.0596886422064]},{"passenger_id":3372,"vehicle_id":78,"route":[[127.11333538,37.34598171],[127.11330477,37.34597594],[127.12873928,37.4352034]],"timestamp":[532.6818471683584,532.6874089746177,552.7172165557804]},{"passenger_id":21053,"vehicle_id":1,"route":[[127.10596578,37.36372023],[127.107328645853,37.3632708783436],[127.166119949647,37.4600202863273]],"timestamp":[532.2006451411748,532.4614446246882,556.3526725814127]},{"passenger_id":23655,"vehicle_id":68,"route":[[127.1499939,37.40378952],[127.139208,37.408515],[127.123233,37.38734]],"timestamp":[532.9559593502295,535.1319380728597,540.6220641848934]},{"passenger_id":12802,"vehicle_id":28,"route":[[127.12677735,37.45006175],[127.12679702,37.44958996],[127.12647,37.45985546]],"timestamp":[532.2945325514555,532.3995113172801,534.6831842230707]},{"passenger_id":12843,"vehicle_id":19,"route":[[127.16183243,37.45365357],[127.16088441,37.45390586],[127.16193159,37.44526754]],"timestamp":[532.3275117766646,532.5040320501121,534.4339827296227]},{"passenger_id":15247,"vehicle_id":69,"route":[[127.15349579,37.44305038],[127.15356608,37.44345899],[127.12515009,37.41001189]],"timestamp":[532.8601799480199,532.951894281427,541.924804838201]},{"passenger_id":15207,"vehicle_id":10,"route":[[127.11128998,37.4041748],[127.11269228,37.39984317],[127.09880645,37.41258402]],"timestamp":[532.9684199596259,533.9630761966844,537.7108195734015]},{"passenger_id":12976,"vehicle_id":12,"route":[[127.13835878,37.43466471],[127.13844299,37.43467712],[127.04203796,37.2376976]],"timestamp":[532.6262295437358,532.6413539549019,579.647356811585]},{"passenger_id":23664,"vehicle_id":84,"route":[[127.12369339,37.3509275],[127.12295872,37.35150788],[127.1080881,37.36589729]],"timestamp":[532.8064002738269,532.9895057810613,537.1307739902257]},{"passenger_id":17968,"vehicle_id":16,"route":[[127.10256264,37.40134405],[127.10872982,37.39621161],[127.12602398,37.41076453]],"timestamp":[532.2954279485483,533.8733908188626,538.3240930463335]},{"passenger_id":17929,"vehicle_id":61,"route":[[127.25030518,37.41601181],[127.17892456,37.4349556],[127.17684937,37.44075775]],"timestamp":[532.9707983523114,546.2626222722494,547.603984376917]},{"passenger_id":21084,"vehicle_id":31,"route":[[127.10594177,37.36803055],[127.10594856,37.36801716],[127.10597587,37.34389693]],"timestamp":[532.1064599262857,532.1096704608073,537.4737670442656]},{"passenger_id":15242,"vehicle_id":3,"route":[[127.1168363,37.39961637],[127.11685651,37.40194032],[127.10808805,37.36773312]],"timestamp":[532.4544373786808,532.9712726112996,540.7347951500732]},{"passenger_id":10248,"vehicle_id":15,"route":[[127.15626526,37.40411377],[127.15512344,37.41499974],[127.17664967,37.43424106]],"timestamp":[533.8450056288729,536.2743226428462,541.9983105521067]},{"passenger_id":3419,"vehicle_id":29,"route":[[127.10639191,37.36849213],[127.1044583,37.36823193],[126.97642002,37.29641525]],"timestamp":[533.3989638001135,533.7455826664683,561.4528505414596]},{"passenger_id":21069,"vehicle_id":80,"route":[[126.98771667,37.298069],[127.0677948,37.37049484],[127.12343597,37.3515625]],"timestamp":[533.2862384500128,554.7321564592011,565.4306941290467]},{"passenger_id":21024,"vehicle_id":22,"route":[[127.12646484,37.41385651],[127.12647247,37.41378021],[127.12957764,37.43010712]],"timestamp":[533.8528440078251,533.8698657928908,537.5419895897708]},{"passenger_id":17904,"vehicle_id":98,"route":[[127.16758564,37.44593712],[127.16846858,37.44695903],[127.17754024,37.44321728]],"timestamp":[533.4352064588853,533.7107977112112,535.5157777008625]},{"passenger_id":17971,"vehicle_id":45,"route":[[127.3670578,37.35611343],[127.16298286,37.41194678],[127.17319758,37.43838775]],"timestamp":[533.2165594159029,571.3559200846436,577.5066356073223]},{"passenger_id":10339,"vehicle_id":57,"route":[[127.11071494,37.29151497],[127.10891865,37.34037399],[127.12364935,37.35149126]],"timestamp":[533.6747383399735,544.5451323651951,548.136123801039]},{"passenger_id":15203,"vehicle_id":77,"route":[[127.14399648,37.43608797],[127.141614545603,37.4371482040725],[127.138697897036,37.4428620580204]],"timestamp":[533.1025559610184,533.5847462951858,534.9558480784021]},{"passenger_id":10371,"vehicle_id":58,"route":[[127.10793304,37.40234375],[127.1110056,37.3962302],[127.09124397,37.40856955]],"timestamp":[533.110525329716,534.5744779594288,539.0150420501559]},{"passenger_id":12885,"vehicle_id":59,"route":[[127.17659257,37.43552486],[127.17901922,37.4404256],[127.17873734,37.4316293]],"timestamp":[533.341496054162,534.5125801619557,536.4694211976616]},{"passenger_id":5966,"vehicle_id":0,"route":[[127.18018736,37.2422803],[127.11883545,37.33613586],[127.13615417,37.38572311]],"timestamp":[533.0888407868991,556.6152915956396,568.0600144042893]},{"passenger_id":5958,"vehicle_id":99,"route":[[127.10777956,37.37249626],[127.1067276,37.37338257],[127.12333679,37.35157013]],"timestamp":[533.8552013154887,534.1261549938405,539.7962409842416]},{"passenger_id":15325,"vehicle_id":72,"route":[[127.17550614,37.43449809],[127.16881561,37.44054794],[127.11042786,37.32054138]],"timestamp":[534,535.7905103890884,564.4038601709696]},{"passenger_id":12887,"vehicle_id":54,"route":[[127.18081722,37.44473088],[127.17919159,37.44187546],[127.16654205,37.43298721]],"timestamp":[534,534.6968745695489,537.6795700737732]},{"passenger_id":15125,"vehicle_id":86,"route":[[127.12822723,37.3659935],[127.12703103,37.36691075],[127.10808807,37.36709591]],"timestamp":[534.453720782574,534.7475099570405,538.09588418861]},{"passenger_id":17855,"vehicle_id":36,"route":[[127.13370269,37.44954657],[127.13319932,37.44939974],[127.12984264,37.44840724]],"timestamp":[534.6193790379708,534.7140595349518,535.3464647261442]},{"passenger_id":21022,"vehicle_id":27,"route":[[127.14212893,37.40922377],[127.13815571,37.40870757],[127.12602398,37.41079114]],"timestamp":[534.6969616953246,535.4081517481832,537.6007046393956]},{"passenger_id":10334,"vehicle_id":87,"route":[[127.09672817,37.32368289],[127.10891635,37.3405463],[127.11873434,37.38330953]],"timestamp":[534.9996448070509,539.3250822000228,548.9922355619467]},{"passenger_id":21076,"vehicle_id":9,"route":[[127.1395921,37.43464822],[127.13923207,37.43510273],[127.15133663,37.43064574]],"timestamp":[534.0596886422064,534.1790990881256,536.5352965932237]},{"passenger_id":10353,"vehicle_id":77,"route":[[127.138697897036,37.4428620580204],[127.13852845364,37.4428120583268],[127.169169930595,37.4317954589672]],"timestamp":[534.9558480784021,534.9877659794528,540.9273248485807]},{"passenger_id":3407,"vehicle_id":42,"route":[[127.123477,37.351586],[127.12493896,37.35694122],[127.10498047,37.39989853]],"timestamp":[534.3450166743071,535.5636822855049,545.7472589081366]},{"passenger_id":5939,"vehicle_id":19,"route":[[127.16193159,37.44526754],[127.16240692,37.44535446],[127.1739502,37.44026184]],"timestamp":[534.4339827296227,534.5201056964225,536.851811555266]},{"passenger_id":21122,"vehicle_id":39,"route":[[127.10596336,37.36387349],[127.10591888,37.36234283],[127.09706879,37.36302948]],"timestamp":[534.8143016546761,535.1547956894927,536.7265526325767]},{"passenger_id":15226,"vehicle_id":38,"route":[[127.12347813,37.35151067],[127.12417528,37.34707592],[127.1090053,37.35083482]],"timestamp":[534.738174936496,535.7320895538927,538.5412515058805]},{"passenger_id":10338,"vehicle_id":28,"route":[[127.12647,37.45985546],[127.127406300376,37.4556703130501],[127.136600687803,37.4439176071266]],"timestamp":[534.6831842230707,535.6284812272379,538.7052339822193]},{"passenger_id":15224,"vehicle_id":14,"route":[[127.1726532,37.43969345],[127.16971588,37.44201279],[127.16017914,37.45177078]],"timestamp":[534.516199025054,535.2476685953844,537.9943786774203]},{"passenger_id":12877,"vehicle_id":51,"route":[[127.16522518,37.43964778],[127.16524692,37.43961125],[127.1574266,37.44450381]],"timestamp":[534.374196490664,534.3831816960424,536.1411860803317]},{"passenger_id":8490,"vehicle_id":24,"route":[[127.17357682,37.43778067],[127.17435455,37.43813324],[127.16024017,37.45767212]],"timestamp":[535,535.1581386107563,540.1672498922501]},{"passenger_id":10343,"vehicle_id":64,"route":[[127.17385864,37.43727112],[127.1786449,37.43821616],[127.20406054,37.40922537]],"timestamp":[535,535.8709006331729,543.7268558912514]},{"passenger_id":21041,"vehicle_id":98,"route":[[127.17754024,37.44321728],[127.17119598,37.44880295],[127.12825012,37.4384613]],"timestamp":[535.5157777008625,537.1884368009672,545.1123572936594]},{"passenger_id":12867,"vehicle_id":36,"route":[[127.12984264,37.44840724],[127.13189617,37.44901552],[127.16020388,37.45235045]],"timestamp":[535.3464647261442,535.7334397317874,540.7859019330497]},{"passenger_id":3378,"vehicle_id":2,"route":[[127.07772987,37.39166504],[127.077049,37.3915836],[127.11100363,37.39376591]],"timestamp":[535.8104805000272,535.9321387661756,541.9510794671593]},{"passenger_id":15189,"vehicle_id":17,"route":[[127.09963056,37.40557686],[127.09846128,37.41268957],[127.11176175,37.40129303]],"timestamp":[535.6087497836833,537.20397307691,540.6599894140817]},{"passenger_id":23683,"vehicle_id":88,"route":[[127.05608368,37.54895401],[127.146222850706,37.473384093523],[127.136386800153,37.4342843327191]],"timestamp":[535.6544824855108,558.7908056494815,567.6578898990053]},{"passenger_id":10411,"vehicle_id":73,"route":[[127.39890235,37.06875762],[127.11885168,37.33986875],[127.11236277,37.40324304]],"timestamp":[535.8032677245909,613.8791891343003,628.0195706150929]},{"passenger_id":12995,"vehicle_id":23,"route":[[127.10630798,37.40070724],[127.10892696,37.40241202],[126.79891078,37.33557231]],"timestamp":[535.3409936181699,535.9391689124583,592.7127247980036]},{"passenger_id":17997,"vehicle_id":83,"route":[[127.17411306,37.42243182],[127.16972351,37.43188095],[127.1552887,37.44428635]],"timestamp":[536,538.2398232106763,541.9958917190816]},{"passenger_id":17845,"vehicle_id":9,"route":[[127.15133663,37.43064574],[127.15198442,37.42992977],[127.1502334,37.41439489]],"timestamp":[536.5352965932237,536.7313564711485,540.1999704698056]},{"passenger_id":10261,"vehicle_id":90,"route":[[127.12851437,37.46007354],[127.13687109,37.46199185],[127.13195874,37.44049438]],"timestamp":[536.6266226601562,538.1622475503722,543.0210940404943]},{"passenger_id":10328,"vehicle_id":39,"route":[[127.09706879,37.36302948],[127.10482865,37.36640347],[127.09978842,37.38302028]],"timestamp":[536.7265526325767,538.289958315686,542.0912083556798]},{"passenger_id":21057,"vehicle_id":11,"route":[[127.03983696,37.29847034],[127.10991072,37.34549171],[127.1090103,37.35067992]],"timestamp":[536.733176979494,552.9483446820195,554.1130794656362]},{"passenger_id":17962,"vehicle_id":59,"route":[[127.17873734,37.4316293],[127.16600037,37.43385315],[127.15821838,37.43742371]],"timestamp":[536.4694211976616,538.7724049119087,540.3595150193366]},{"passenger_id":21099,"vehicle_id":51,"route":[[127.1574266,37.44450381],[127.15745929,37.44446994],[127.15796946,37.46110637]],"timestamp":[537,537.0094895251025,540.7103589080488]},{"passenger_id":17981,"vehicle_id":19,"route":[[127.1739502,37.44026184],[127.17279816,37.43924713],[127.16874695,37.43478775]],"timestamp":[537,537.3038152980039,538.5266268883585]},{"passenger_id":15188,"vehicle_id":13,"route":[[127.14207458,37.43854141],[127.14183192,37.43814603],[127.15300993,37.45108866]],"timestamp":[537.0117343858593,537.1095476538861,540.599521926698]},{"passenger_id":15208,"vehicle_id":55,"route":[[127.12921272,37.43228993],[127.12922491,37.43220431],[127.17749857,37.43154427]],"timestamp":[537.8350401145914,537.8542024326357,546.3803326967994]},{"passenger_id":15193,"vehicle_id":43,"route":[[126.98186244,37.31736255],[127.07460785,37.38702774],[127.11582184,37.36832047]],"timestamp":[537.2204715605083,559.7781420557068,568.1660239980937]},{"passenger_id":15157,"vehicle_id":84,"route":[[127.1080881,37.36589729],[127.10808809,37.36626126],[127.1141404,37.35991593]],"timestamp":[537.1307739902257,537.2117172251477,538.9825223786593]},{"passenger_id":21038,"vehicle_id":54,"route":[[127.16654205,37.43298721],[127.16427037,37.43285474],[127.16877175,37.44812034]],"timestamp":[537.6795700737732,538.0818111099519,541.568528195821]},{"passenger_id":15194,"vehicle_id":27,"route":[[127.12602398,37.41079114],[127.12660661,37.41233386],[127.14156467,37.37540725]],"timestamp":[537.6007046393956,537.9588937770598,546.5857884973065]},{"passenger_id":3376,"vehicle_id":20,"route":[[127.13022614,37.40981674],[127.13019562,37.40987396],[127.12142944,37.38266373]],"timestamp":[537.836101710589,537.8499218038712,544.0962604897999]},{"passenger_id":10324,"vehicle_id":14,"route":[[127.16017914,37.45177078],[127.16017914,37.45176697],[127.17572021,37.43242264]],"timestamp":[537.9943786774203,537.9952259827604,543.0978828087983]},{"passenger_id":15204,"vehicle_id":31,"route":[[127.10597587,37.34389693],[127.10900237,37.34928925],[127.12027316,37.35401455]],"timestamp":[537.4737670442656,538.7869219892588,541.039548661504]},{"passenger_id":21077,"vehicle_id":10,"route":[[127.09880645,37.41258402],[127.09593964,37.41213226],[127.09316254,37.42772675]],"timestamp":[537.7108195734015,538.2270845805067,541.7296556534391]},{"passenger_id":18001,"vehicle_id":22,"route":[[127.12957764,37.43010712],[127.12945283,37.43040216],[127.14162004,37.44585137]],"timestamp":[537.5419895897708,537.6112066449125,541.6634090064624]},{"passenger_id":881,"vehicle_id":46,"route":[[127.17636108,37.43438339],[127.16596617,37.43841264],[127.12415435,37.38407685]],"timestamp":[537.5631210975785,539.6057327873306,553.7678708858654]},{"passenger_id":17989,"vehicle_id":28,"route":[[127.136600687803,37.4439176071266],[127.13587571,37.44454913],[127.25137546,37.38962764]],"timestamp":[538.7052339822193,538.895260648631,562.6727305023036]},{"passenger_id":12813,"vehicle_id":76,"route":[[127.16894531,37.43281555],[127.16404331,37.43288078],[127.12939161,37.43094963]],"timestamp":[538.168086522766,539.0338634322696,545.1682145475407]},{"passenger_id":12824,"vehicle_id":86,"route":[[127.10808807,37.36709591],[127.10791966,37.36665801],[127.12376499,37.35103065]],"timestamp":[538.09588418861,538.1977162303293,542.6612757638333]},{"passenger_id":12822,"vehicle_id":38,"route":[[127.1090053,37.35083482],[127.10900889,37.35072386],[127.11633182,37.33699565]],"timestamp":[538.5412515058805,538.5659360441879,541.8821340205882]},{"passenger_id":8444,"vehicle_id":19,"route":[[127.16874695,37.43478775],[127.16424561,37.43451309],[127.12943268,37.43097687]],"timestamp":[538.5266268883585,539.3238530623349,545.5216518918238]},{"passenger_id":5927,"vehicle_id":44,"route":[[127.13597982,37.43206429],[127.13426208,37.43373871],[127.12863159,37.43444824]],"timestamp":[538.0312995902864,538.5115882617375,539.5183157051795]},{"passenger_id":8469,"vehicle_id":67,"route":[[127.11165223,37.34495801],[127.115100819839,37.345759874313],[127.107236979836,37.3707124994894]],"timestamp":[538.4583201450391,539.0935689844528,544.8142377887349]},{"passenger_id":18009,"vehicle_id":84,"route":[[127.1141404,37.35991593],[127.11482439,37.36221667],[127.12680153,37.44943736]],"timestamp":[538.9825223786593,539.5082740062223,559.0203272468794]},{"passenger_id":8472,"vehicle_id":16,"route":[[127.12602398,37.41076453],[127.12823486,37.41224289],[127.1233139,37.38876343]],"timestamp":[538.3240930463335,538.8345921128163,544.1280654632442]},{"passenger_id":20955,"vehicle_id":33,"route":[[127.14527433,37.42825971],[127.14540922,37.42853364],[127.13389575,37.43059085]],"timestamp":[539.1306767007246,539.1960880193808,541.2802024504207]},{"passenger_id":23651,"vehicle_id":63,"route":[[127.15211766,37.45893323],[127.154035,37.454841],[127.153635,37.45056]],"timestamp":[539.2752054113482,540.2461822396888,541.2008486529558]},{"passenger_id":8466,"vehicle_id":58,"route":[[127.09124397,37.40856955],[127.08959429,37.40705606],[127.10130767,37.44952712]],"timestamp":[539.0150420501559,539.4602542339014,549.1292622130685]},{"passenger_id":21199,"vehicle_id":99,"route":[[127.12333679,37.35157013],[127.1135025,37.34774017],[126.97251129,37.27884674]],"timestamp":[539.7962409842416,541.7322566952814,571.000437319064]},{"passenger_id":3377,"vehicle_id":74,"route":[[127.11481058,37.3629566],[127.11482092,37.36240236],[127.11935845,37.38657712]],"timestamp":[539.2870496208566,539.4103205228865,544.8460198155313]},{"passenger_id":15225,"vehicle_id":44,"route":[[127.12863159,37.43444824],[127.12912727,37.43301006],[127.13888809,37.43834058]],"timestamp":[539.5183157051795,539.8499139070536,541.9418430031311]},{"passenger_id":12895,"vehicle_id":50,"route":[[127.07361603,37.20251465],[127.11824545,37.33641212],[127.11028862,37.34001752]],"timestamp":[539.0358044220478,569.842950009444,571.4622794536184]},{"passenger_id":15236,"vehicle_id":8,"route":[[127.123670211371,37.3515292834271],[127.12301636,37.35998154],[127.10832214,37.36602402]],"timestamp":[539.2105037600137,541.0937501775243,544.018088764182]},{"passenger_id":12844,"vehicle_id":34,"route":[[127.15531921,37.46068573],[127.15850382,37.45874062],[127.13883163,37.44743885]],"timestamp":[540.3527337634661,541.0620719177949,545.3491482202929]},{"passenger_id":15174,"vehicle_id":51,"route":[[127.15796946,37.46110637],[127.1579895,37.46058273],[127.14791107,37.44125748]],"timestamp":[540.7103589080488,540.8268648508126,545.4783836266836]},{"passenger_id":17901,"vehicle_id":77,"route":[[127.169169930595,37.4317954589672],[127.16370557,37.43291867],[127.17807085,37.4428645]],"timestamp":[540.9273248485807,541.924101142254,545.2896267362992]},{"passenger_id":17887,"vehicle_id":24,"route":[[127.16024017,37.45767212],[127.15945412,37.45692852],[127.14678404,37.45033535]],"timestamp":[540.1672498922501,540.3831263942055,543.0576826346795]},{"passenger_id":12846,"vehicle_id":36,"route":[[127.16020388,37.45235045],[127.16019164,37.45232261],[127.17774501,37.44368494]],"timestamp":[540.7859019330497,540.7924595404378,544.4386599308853]},{"passenger_id":8452,"vehicle_id":68,"route":[[127.123233,37.38734],[127.12400155,37.38707522],[127.11162907,37.37511008]],"timestamp":[540.6220641848934,540.7700836001893,544.2140414758018]},{"passenger_id":21102,"vehicle_id":9,"route":[[127.1502334,37.41439489],[127.14392853,37.41334915],[127.1789093,37.43964005]],"timestamp":[540.1999704698056,541.337667236829,549.8436266362629]},{"passenger_id":15216,"vehicle_id":13,"route":[[127.15300993,37.45108866],[127.15196366,37.45038414],[127.15989592,37.44145841]],"timestamp":[540.599521926698,540.8417390847427,543.2710764524448]},{"passenger_id":17985,"vehicle_id":59,"route":[[127.15821838,37.43742371],[127.15890589,37.43706515],[127.17388642,37.44018024]],"timestamp":[540.3595150193366,540.5047626994574,543.2392145898725]},{"passenger_id":10361,"vehicle_id":17,"route":[[127.11176175,37.40129303],[127.11392545,37.40055751],[127.12709889,37.41050944]],"timestamp":[540.6599894140817,541.0757720723282,544.2873201728821]},{"passenger_id":23671,"vehicle_id":6,"route":[[127.10884534,37.3998184],[127.10876897,37.39621191],[127.12521587,37.38566965]],"timestamp":[540.8035499712659,541.6057102367114,545.3395552756675]},{"passenger_id":3393,"vehicle_id":97,"route":[[127.12477235,37.47896744],[127.13452083,37.4658662],[127.13577903,37.48363077]],"timestamp":[540.1818162470337,543.5655146843272,547.522410912371]},{"passenger_id":15253,"vehicle_id":3,"route":[[127.10808805,37.36773312],[127.10676575,37.36854935],[127.12062836,37.38453674]],"timestamp":[540.7347951500732,541.030717758593,545.3484683505646]},{"passenger_id":15219,"vehicle_id":96,"route":[[127.13395691,37.38373566],[127.1315918,37.38090515],[127.12514496,37.41378403]],"timestamp":[541.082078387,541.8376684841376,549.2377789886135]},{"passenger_id":5928,"vehicle_id":56,"route":[[127.10628581,37.37646507],[127.1056366,37.37615967],[127.11325073,37.3776207]],"timestamp":[541.1516594902542,541.2849871720504,542.669261122064]},{"passenger_id":21049,"vehicle_id":54,"route":[[127.16877175,37.44812034],[127.16912887,37.44709565],[127.17742928,37.43978142]],"timestamp":[541.568528195821,541.8049709464707,543.9944433269261]},{"passenger_id":15215,"vehicle_id":33,"route":[[127.13389575,37.43059085],[127.13280935,37.42896527],[127.1292678,37.45016186]],"timestamp":[541.2802024504207,541.6894709105737,546.4446767777832]},{"passenger_id":10349,"vehicle_id":25,"route":[[127.1240921,37.38493729],[127.1241684,37.38415527],[127.14225006,37.37082291]],"timestamp":[541.1111878572291,541.2856230118196,545.6447471562891]},{"passenger_id":10363,"vehicle_id":83,"route":[[127.1552887,37.44428635],[127.15532497,37.44403109],[127.17238417,37.44162369]],"timestamp":[541.9958917190816,542.0530190374434,545.1123504025709]},{"passenger_id":3420,"vehicle_id":22,"route":[[127.14162004,37.44585137],[127.14126602,37.44455673],[127.10600239,37.35888815]],"timestamp":[541.6634090064624,541.9580308687306,562.0025628193519]},{"passenger_id":870,"vehicle_id":2,"route":[[127.11100363,37.39376591],[127.11099211,37.39376581],[127.09943937,37.40419402]],"timestamp":[541.9510794671593,541.9531149934752,545.0424886981251]},{"passenger_id":17996,"vehicle_id":63,"route":[[127.153635,37.45056],[127.15581997,37.45022975],[127.16722529,37.44690735]],"timestamp":[541.2008486529558,541.5935362868581,543.7384806821232]},{"passenger_id":8528,"vehicle_id":38,"route":[[127.11633182,37.33699565],[127.1161131,37.3383707],[127.10014768,37.40497123]],"timestamp":[541.8821340205882,542.1903669411197,557.2680296109717]},{"passenger_id":10427,"vehicle_id":31,"route":[[127.12027316,37.35401455],[127.11776116,37.35930408],[127.16604548,37.45034338]],"timestamp":[541.039548661504,542.296907746407,564.2665967728697]},{"passenger_id":18045,"vehicle_id":69,"route":[[127.12515009,37.41001189],[127.12526019,37.40990913],[127.16554761,37.44730312]],"timestamp":[541.924804838201,541.9548132310905,552.899112243943]},{"passenger_id":21116,"vehicle_id":15,"route":[[127.17664967,37.43424106],[127.18117071,37.44136036],[127.16001036,37.45186616]],"timestamp":[541.9983105521067,543.7714546508156,548.1779141196465]},{"passenger_id":8514,"vehicle_id":10,"route":[[127.09316254,37.42772675],[127.09466576,37.43013158],[127.13479303,37.44180094]],"timestamp":[541.7296556534391,542.3267287957433,549.8728772134301]},{"passenger_id":15273,"vehicle_id":44,"route":[[127.13888809,37.43834058],[127.14026516,37.43813355],[127.1257862,37.40979502]],"timestamp":[541.9418430031311,542.1893258776932,548.9905678975297]},{"passenger_id":18014,"vehicle_id":32,"route":[[127.11590788,37.41494472],[127.12311026,37.41486215],[127.12500782,37.38551262]],"timestamp":[542,543.2723221003029,549.807963386266]},{"passenger_id":17890,"vehicle_id":56,"route":[[127.11325073,37.3776207],[127.11213185,37.37662406],[127.07816979,37.39163659]],"timestamp":[542.669261122064,542.9662857437816,549.8337852038889]},{"passenger_id":21063,"vehicle_id":66,"route":[[127.12822723,37.43981171],[127.12828827,37.43982315],[127.13700867,37.44235229]],"timestamp":[542.5880623647338,542.5991367500781,544.2384341731712]},{"passenger_id":3405,"vehicle_id":39,"route":[[127.09978842,37.38302028],[127.10195923,37.3765564],[127.09632874,37.41240692]],"timestamp":[542.0912083556798,543.5790169007415,551.613633150122]},{"passenger_id":18020,"vehicle_id":86,"route":[[127.12376499,37.35103065],[127.11360632,37.35192214],[127.1470809,37.29198066]],"timestamp":[542.6612757638333,544.4680771823456,559.0539099814594]},{"passenger_id":5967,"vehicle_id":95,"route":[[127.09100087,37.21411509],[127.11339578,37.34599308],[127.11085523,37.37680568]],"timestamp":[543,572.5948430567128,579.461951660183]},{"passenger_id":12868,"vehicle_id":90,"route":[[127.13195874,37.44049438],[127.13165447,37.44087171],[127.15820842,37.4328531]],"timestamp":[543.0210940404943,543.1207339680873,548.1373521038087]},{"passenger_id":23680,"vehicle_id":63,"route":[[127.16722529,37.44690735],[127.16605851,37.44644108],[127.10125182,37.40090979]],"timestamp":[543.7384806821232,543.9691123658732,559.2509715125938]},{"passenger_id":17917,"vehicle_id":24,"route":[[127.14678404,37.45033535],[127.14642809,37.44986368],[127.14550779,37.44017402]],"timestamp":[543.0576826346795,543.179961788132,545.3409616003368]},{"passenger_id":17953,"vehicle_id":13,"route":[[127.15989592,37.44145841],[127.1609664,37.4411466],[127.1584165,37.43661967]],"timestamp":[543.2710764524448,543.4724119646477,544.5752550417506]},{"passenger_id":12956,"vehicle_id":54,"route":[[127.17742928,37.43978142],[127.17190117,37.44143856],[127.11616403,37.48603333]],"timestamp":[543.9944433269261,545.0378157783733,559.0076055096515]},{"passenger_id":10379,"vehicle_id":53,"route":[[127.08499908,37.17055893],[127.10881348,37.34973689],[127.1360162,37.33134987]],"timestamp":[543.9673346029996,584.0370156795321,590.3500119222531]},{"passenger_id":8519,"vehicle_id":64,"route":[[127.20406054,37.40922537],[127.16125834,37.4121738],[127.11940577,37.37368588]],"timestamp":[543.7268558912514,551.3160093120827,562.6272772577511]},{"passenger_id":21125,"vehicle_id":59,"route":[[127.17388642,37.44018024],[127.16867494,37.44078976],[127.16327758,37.4457113]],"timestamp":[543.2392145898725,544.1693578615713,545.6206124208461]},{"passenger_id":15282,"vehicle_id":21,"route":[[127.09794646,37.404594],[127.09836773,37.41270978],[127.12431979,37.3883452]],"timestamp":[543.2625405253838,545.0689411548815,552.1668884775411]},{"passenger_id":5968,"vehicle_id":14,"route":[[127.17572021,37.43242264],[127.16407013,37.43304825],[127.15933228,37.44993591]],"timestamp":[544,546.0620163700607,549.9097059105876]},{"passenger_id":12863,"vehicle_id":17,"route":[[127.12709889,37.41050944],[127.12933964,37.40983966],[127.15292229,37.45112792]],"timestamp":[544.2873201728821,544.7102379589886,554.7926507960594]},{"passenger_id":12864,"vehicle_id":8,"route":[[127.10832214,37.36602402],[127.10808809,37.36626181],[127.12292667,37.38836719]],"timestamp":[544.018088764182,544.0852292521334,549.6569207779656]},{"passenger_id":15230,"vehicle_id":67,"route":[[127.107236979836,37.3707124994894],[127.10805573,37.37114874],[127.12349727,37.35150658]],"timestamp":[544.8142377887349,544.988454281026,550.1393059825401]},{"passenger_id":8495,"vehicle_id":68,"route":[[127.11162907,37.37511008],[127.10976268,37.37513452],[127.13105448,37.44876994]],"timestamp":[544.2140414758018,544.5439303408327,561.3460461175002]},{"passenger_id":21110,"vehicle_id":74,"route":[[127.11935845,37.38657712],[127.12112427,37.38612747],[127.10967255,37.40157318]],"timestamp":[544.8460198155313,545.1736756742813,549.1602672032787]},{"passenger_id":5947,"vehicle_id":13,"route":[[127.1584165,37.43661967],[127.15812514,37.43618913],[127.15716729,37.44477244]],"timestamp":[544.5752550417506,544.6839503801692,546.600269685877]},{"passenger_id":21081,"vehicle_id":66,"route":[[127.13700867,37.44235229],[127.13702393,37.44235229],[127.14424896,37.44010162]],"timestamp":[544.2384341731712,544.2411286291971,545.6115458437237]},{"passenger_id":21151,"vehicle_id":92,"route":[[127.15226198,37.40487243],[127.15510559,37.40605545],[127.11295319,37.39459991]],"timestamp":[544.9416393473043,545.5087071942468,553.3794359814713]},{"passenger_id":18012,"vehicle_id":16,"route":[[127.1233139,37.38876343],[127.12317496,37.38855613],[127.13422658,37.43446609]],"timestamp":[544.1280654632442,544.180296233704,554.5751642368602]},{"passenger_id":21164,"vehicle_id":91,"route":[[126.97261947,37.26883626],[127.10715723,37.35134928],[127.10101697,37.40206399]],"timestamp":[544.2215471842798,574.2720526192527,585.6025714815141]},{"passenger_id":8494,"vehicle_id":20,"route":[[127.12142944,37.38266373],[127.12359629,37.38349128],[127.14029206,37.38420738]],"timestamp":[544.0962604897999,544.5210959549207,547.4756641113923]},{"passenger_id":18007,"vehicle_id":36,"route":[[127.17774501,37.44368494],[127.16916191,37.44213629],[127.15922089,37.43963987]],"timestamp":[545,546.5541463481572,548.3951697980734]},{"passenger_id":17910,"vehicle_id":59,"route":[[127.16327758,37.4457113],[127.163111634844,37.445820373191],[127.1289812904,37.4315565716541]],"timestamp":[545.6206124208461,545.6586499822548,552.4691791848716]},{"passenger_id":15198,"vehicle_id":25,"route":[[127.14225006,37.37082291],[127.14241791,37.36823273],[127.11554718,37.35986328]],"timestamp":[545.6447471562891,546.2215403158389,551.3227482378361]},{"passenger_id":15221,"vehicle_id":98,"route":[[127.12825012,37.4384613],[127.12781665,37.43870202],[127.10206154,37.42772588]],"timestamp":[545.1123572936594,545.2057621700261,550.3675344633867]},{"passenger_id":21070,"vehicle_id":76,"route":[[127.12939161,37.43094963],[127.12930298,37.43101883],[127.16066742,37.45384979]],"timestamp":[545.1682145475407,545.1901647333965,552.7034372143196]},{"passenger_id":15201,"vehicle_id":24,"route":[[127.14550779,37.44017402],[127.14562988,37.44034576],[127.12737274,37.44269562]],"timestamp":[545.3409616003368,545.3848189960974,548.650598195793]},{"passenger_id":12946,"vehicle_id":34,"route":[[127.13883163,37.44743885],[127.13887935,37.44745237],[127.0766795,37.39218462]],"timestamp":[545.3491482202929,545.3580939826631,561.8432048519585]},{"passenger_id":21089,"vehicle_id":66,"route":[[127.14424896,37.44010162],[127.14426422,37.44016647],[127.15370941,37.43070984]],"timestamp":[545.6115458437237,545.6262173837971,548.3103768709651]},{"passenger_id":3403,"vehicle_id":75,"route":[[127.016359757633,37.0277340428751],[127.10913086,37.34976959],[127.1233902,37.35157013]],"timestamp":[545.9903470246683,619.4695652916193,622.0220208619947]},{"passenger_id":5959,"vehicle_id":3,"route":[[127.12062836,37.38453674],[127.12380219,37.38370895],[127.10723877,37.37073135]],"timestamp":[545.3484683505646,545.938747740421,550.0494253984889]},{"passenger_id":15249,"vehicle_id":42,"route":[[127.10498047,37.39989853],[127.11094318,37.39622989],[127.11130075,37.4009471]],"timestamp":[545.7472589081366,547.0797056157178,548.1306656315729]},{"passenger_id":10420,"vehicle_id":51,"route":[[127.14791107,37.44125748],[127.14727783,37.44107437],[127.10244751,37.40229034]],"timestamp":[545.4783836266836,545.5973810352341,557.3057663508322]},{"passenger_id":21149,"vehicle_id":19,"route":[[127.12943268,37.43097687],[127.12935821,37.43122514],[127.16264567,37.45885956]],"timestamp":[545.5216518918238,545.5784092504834,554.0820454524363]},{"passenger_id":21121,"vehicle_id":77,"route":[[127.17807085,37.4428645],[127.17325931,37.44999788],[127.17625241,37.44008367]],"timestamp":[545.2896267362992,547.089163601449,549.3564335148964]},{"passenger_id":21141,"vehicle_id":49,"route":[[127.09371948,37.21289825],[127.11201325,37.34719736],[127.10596332,37.36531869]],"timestamp":[546,576.0416753934502,580.2111658714844]},{"passenger_id":21150,"vehicle_id":83,"route":[[127.17238417,37.44162369],[127.17016921,37.44076438],[127.13502246,37.43381483]],"timestamp":[546,546.4352930921623,552.8311094453178]},{"passenger_id":15293,"vehicle_id":6,"route":[[127.12521587,37.38566965],[127.12302421,37.38614143],[127.09920954,37.4303458]],"timestamp":[546,546.4012334301634,557.0941519410984]},{"passenger_id":888,"vehicle_id":2,"route":[[127.09943937,37.40419402],[127.10635376,37.40306854],[127.13829803,37.37435913]],"timestamp":[546,547.2468843831468,555.7688450630163]},{"passenger_id":17942,"vehicle_id":85,"route":[[127.13304025,37.27585768],[127.10948142,37.35000783],[127.1065685,37.37673176]],"timestamp":[546.3086209562343,563.3171960207918,569.2825880569005]},{"passenger_id":8480,"vehicle_id":33,"route":[[127.1292678,37.45016186],[127.12709808,37.45049667],[127.13328552,37.45510864]],"timestamp":[546.4446767777832,546.8349123983909,548.3333199984249]},{"passenger_id":5952,"vehicle_id":13,"route":[[127.15716729,37.44477244],[127.15763681,37.44503503],[127.16721197,37.44669523]],"timestamp":[546.600269685877,546.7016733472627,548.4321251311164]},{"passenger_id":10387,"vehicle_id":27,"route":[[127.14156467,37.37540725],[127.13926697,37.37611771],[127.10798645,37.36836243]],"timestamp":[547,547.4357209825297,553.2268718839218]},{"passenger_id":15302,"vehicle_id":55,"route":[[127.17749857,37.43154427],[127.1791458,37.43929262],[127.12887372,37.41045142]],"timestamp":[547,548.7475328988887,559.7005658855995]},{"passenger_id":10433,"vehicle_id":61,"route":[[127.17684937,37.44075775],[127.1681551,37.44073239],[127.10808808,37.36653947]],"timestamp":[547.603984376917,549.1391737251829,568.7566645178582]},{"passenger_id":12920,"vehicle_id":97,"route":[[127.13577903,37.48363077],[127.12795258,37.46644592],[127.12944031,37.44828033]],"timestamp":[547.522410912371,551.586114753198,555.6344857904968]},{"passenger_id":18027,"vehicle_id":20,"route":[[127.14029206,37.38420738],[127.13396848,37.38118946],[127.11086282,37.35001244]],"timestamp":[547.4756641113923,548.7791701556665,556.8259936519338]},{"passenger_id":869,"vehicle_id":44,"route":[[127.1257862,37.40979502],[127.12827301,37.41226578],[127.078125,37.39174652]],"timestamp":[548.9905678975297,549.6940491296073,559.6596114199086]},{"passenger_id":12891,"vehicle_id":24,"route":[[127.12737274,37.44269562],[127.12687062,37.44388715],[127.15607438,37.44580143]],"timestamp":[548.650598195793,548.9300206057277,554.1038967170418]},{"passenger_id":18023,"vehicle_id":87,"route":[[127.11873434,37.38330953],[127.11689758,37.3800087],[127.17223358,37.44022369]],"timestamp":[548.9922355619467,549.7948638213635,566.3741435131383]},{"passenger_id":12965,"vehicle_id":66,"route":[[127.15370941,37.43070984],[127.15248871,37.42897415],[127.07725525,37.39177322]],"timestamp":[548.3103768709651,548.7524949533521,564.4068474147424]},{"passenger_id":18008,"vehicle_id":36,"route":[[127.15922089,37.43963987],[127.16023805,37.43828067],[127.14882382,37.45077409]],"timestamp":[548.3951697980734,548.7467768909244,552.1791519199721]},{"passenger_id":10375,"vehicle_id":33,"route":[[127.13328552,37.45510864],[127.13276672,37.45265579],[127.14420319,37.43955612]],"timestamp":[548.3333199984249,548.8864447438,552.4310517368466]},{"passenger_id":21179,"vehicle_id":15,"route":[[127.16001036,37.45186616],[127.1599635,37.45175559],[127.12264308,37.38524208]],"timestamp":[548.1779141196465,548.203858165452,564.3980697650477]},{"passenger_id":12897,"vehicle_id":90,"route":[[127.15820842,37.4328531],[127.15870144,37.43322981],[127.15490661,37.43435589]],"timestamp":[548.1373521038087,548.2581764287382,548.9735698570279]},{"passenger_id":10401,"vehicle_id":42,"route":[[127.11130075,37.4009471],[127.11268395,37.39832484],[127.10180655,37.32056423]],"timestamp":[548.1306656315729,548.7629609357068,566.1626938575786]},{"passenger_id":21127,"vehicle_id":13,"route":[[127.16721197,37.44669523],[127.167142165453,37.4458425952692],[127.15594223478,37.446725923224]],"timestamp":[548.4321251311164,548.6221425627754,550.6093422623627]},{"passenger_id":21167,"vehicle_id":40,"route":[[127.1409235,37.40769145],[127.14120909,37.40775939],[127.16237716,37.45900323]],"timestamp":[548.5999432342875,548.6526070793268,560.6461323114918]},{"passenger_id":21154,"vehicle_id":57,"route":[[127.12364935,37.35149126],[127.1241684,37.34699631],[127.10996246,37.34999847]],"timestamp":[548.136123801039,549.1399579684198,551.7386704993316]},{"passenger_id":17965,"vehicle_id":58,"route":[[127.10130767,37.44952712],[127.0983261,37.43103992],[127.10814436,37.42188245]],"timestamp":[549.1292622130685,553.2741986999966,555.9489180811503]},{"passenger_id":8499,"vehicle_id":56,"route":[[127.07816979,37.39163659],[127.07699585,37.39176178],[127.12592316,37.41087341]],"timestamp":[549.8337852038889,550.0430679781381,559.6753138987058]},{"passenger_id":15312,"vehicle_id":74,"route":[[127.10967255,37.40157318],[127.11124469,37.40423741],[127.10269146,37.5118671]],"timestamp":[549.1602672032787,549.8146313186935,573.7979598635453]},{"passenger_id":3421,"vehicle_id":10,"route":[[127.13479303,37.44180094],[127.13446045,37.44180679],[127.12166595,37.38787079]],"timestamp":[549.8728772134301,549.9316156563505,562.1374779583132]},{"passenger_id":12901,"vehicle_id":8,"route":[[127.12292667,37.38836719],[127.12224958,37.38775746],[127.12876602,37.39842247]],"timestamp":[549.6569207779656,549.8377537758255,552.4742337866077]},{"passenger_id":10372,"vehicle_id":9,"route":[[127.1789093,37.43964005],[127.16572225,37.43881546],[127.12945013,37.43042854]],"timestamp":[549.8436266362629,552.1793691793479,558.8506318941211]},{"passenger_id":12903,"vehicle_id":14,"route":[[127.15933228,37.44993591],[127.15937162,37.45032879],[127.16604985,37.4503322]],"timestamp":[549.9097059105876,549.9973540633994,551.1764026862854]},{"passenger_id":23675,"vehicle_id":32,"route":[[127.12500782,37.38551262],[127.12415718,37.38488501],[127.11486898,37.38801999]],"timestamp":[549.807963386266,550.0130844133159,551.7962673517162]},{"passenger_id":890,"vehicle_id":96,"route":[[127.12514496,37.41378403],[127.12618256,37.41320038],[127.11721802,37.36188889]],"timestamp":[549.2377789886135,549.4623649697216,560.982937482049]},{"passenger_id":21148,"vehicle_id":77,"route":[[127.17625241,37.44008367],[127.16589802,37.44244472],[127.15049236,37.44206684]],"timestamp":[549.3564335148964,551.2586380861205,553.9801145802463]},{"passenger_id":12954,"vehicle_id":90,"route":[[127.15490661,37.43435589],[127.15545049,37.43441846],[127.12602398,37.41080859]],"timestamp":[549,549.0970458144598,556.4848528083245]},{"passenger_id":858,"vehicle_id":13,"route":[[127.15594223478,37.446725923224],[127.15799224,37.44694765],[127.17401515,37.43439691]],"timestamp":[550.6093422623627,550.9746331058876,554.9489356741724]},{"passenger_id":21157,"vehicle_id":18,"route":[[127.09325648,37.42787346],[127.09640503,37.43009186],[127.1257019,37.38604736]],"timestamp":[550.9133710754118,551.6567232919166,562.7349391510655]},{"passenger_id":15278,"vehicle_id":98,"route":[[127.10206154,37.42772588],[127.1022967,37.42693791],[127.10371254,37.40070647]],"timestamp":[550.3675344633867,550.5476250654208,556.3865894456534]},{"passenger_id":15347,"vehicle_id":3,"route":[[127.10723877,37.37073135],[127.10805585,37.37113949],[126.98972693,37.39427897]],"timestamp":[550.0494253984889,550.2199907653851,571.7538631195387]},{"passenger_id":23685,"vehicle_id":67,"route":[[127.12349727,37.35150658],[127.117023,37.349259],[127.12339,37.351569]],"timestamp":[550.1393059825401,551.3882523448926,552.6255415466904]},{"passenger_id":3402,"vehicle_id":32,"route":[[127.11486898,37.38801999],[127.11445618,37.38726807],[127.09408569,37.40057373]],"timestamp":[551.7962673517162,551.9787029655565,556.6380761033558]},{"passenger_id":10390,"vehicle_id":57,"route":[[127.10996246,37.34999847],[127.10905457,37.35042572],[127.11058044,37.39382172]],"timestamp":[551.7386704993316,551.9251894813469,561.5797866180484]},{"passenger_id":3515,"vehicle_id":39,"route":[[127.09632874,37.41240692],[127.09796143,37.41274643],[126.9907074,37.56263351]],"timestamp":[551.613633150122,551.9117514102616,590.2434526711705]},{"passenger_id":21119,"vehicle_id":25,"route":[[127.11554718,37.35986328],[127.11677636,37.35849025],[127.11070765,37.35001192]],"timestamp":[551.3227482378361,551.6975104711157,553.8668455359971]},{"passenger_id":12981,"vehicle_id":14,"route":[[127.16604985,37.4503322],[127.16607828,37.45025956],[127.10479343,37.48394192]],"timestamp":[551.1764026862854,551.19331890514,564.3510965697247]},{"passenger_id":10306,"vehicle_id":33,"route":[[127.14420319,37.43955612],[127.14529419,37.43985367],[127.1620636,37.44527054]],"timestamp":[552.4310517368466,552.6347443040106,555.8313841437265]},{"passenger_id":17906,"vehicle_id":69,"route":[[127.16554761,37.44730312],[127.16594832,37.44641723],[127.154907,37.44694609]],"timestamp":[552.899112243943,553.1084433899294,555.0614395389343]},{"passenger_id":18101,"vehicle_id":36,"route":[[127.14882382,37.45077409],[127.14959717,37.44935226],[127.1540451,37.27803421]],"timestamp":[552.1791519199721,552.5235716326226,590.6310784738419]},{"passenger_id":3486,"vehicle_id":76,"route":[[127.16066742,37.45384979],[127.16091452,37.45397593],[127.01646227,37.48468864]],"timestamp":[552.7034372143196,552.7553019774332,579.1510175169944]},{"passenger_id":17998,"vehicle_id":8,"route":[[127.12876602,37.39842247],[127.1288147,37.3980217],[127.12892914,37.41048431]],"timestamp":[552.4742337866077,552.5637749663415,555.335406710393]},{"passenger_id":18056,"vehicle_id":83,"route":[[127.13502246,37.43381483],[127.13631439,37.43434525],[127.10240173,37.40327454]],"timestamp":[552.8311094453178,553.0879419493746,562.2325375155347]},{"passenger_id":6008,"vehicle_id":21,"route":[[127.12431979,37.3883452],[127.12400818,37.38874435],[127.13150787,37.32014084]],"timestamp":[552.1668884775411,552.2713452639564,567.5855647277798]},{"passenger_id":21123,"vehicle_id":78,"route":[[127.12873928,37.4352034],[127.13054657,37.43320084],[127.14173889,37.43474579]],"timestamp":[552.7172165557804,553.2651134474165,555.2712024929637]},{"passenger_id":12934,"vehicle_id":67,"route":[[127.12339,37.351569],[127.12301768,37.35150788],[127.10912974,37.35000781]],"timestamp":[552.6255415466904,552.6927505730645,555.170501201193]},{"passenger_id":21210,"vehicle_id":59,"route":[[127.1289812904,37.4315565716541],[127.12933668,37.43140266],[127.11283674,37.39776336]],"timestamp":[553,553.0714872465586,561.1001917631418]},{"passenger_id":17995,"vehicle_id":46,"route":[[127.12415435,37.38407685],[127.12403934,37.38381618],[127.10371255,37.40052467]],"timestamp":[553.7678708858654,553.8293004635059,558.9970911752016]},{"passenger_id":10365,"vehicle_id":27,"route":[[127.10798645,37.36836243],[127.1071422,37.36853086],[127.11414824,37.35991601]],"timestamp":[553.2268718839218,553.380717634764,555.6619458313788]},{"passenger_id":10423,"vehicle_id":77,"route":[[127.15049236,37.44206684],[127.15062714,37.44208145],[127.11167145,37.3917923]],"timestamp":[553.9801145802463,554.0041335276107,567.1350829019392]},{"passenger_id":21203,"vehicle_id":92,"route":[[127.11295319,37.39459991],[127.112854,37.39468002],[127.14626312,37.35301971]],"timestamp":[553.3794359814713,553.4044265289606,564.3907582813277]},{"passenger_id":21214,"vehicle_id":25,"route":[[127.11070765,37.35001192],[127.10901219,37.35062141],[127.13140311,37.42921507]],"timestamp":[554,554.3289579513587,572.2495647064939]},{"passenger_id":907,"vehicle_id":35,"route":[[126.88353729,37.41616821],[127.06433868,37.39020157],[127.11148071,37.39193344]],"timestamp":[554,586.4585945476252,594.7970575058719]},{"passenger_id":23677,"vehicle_id":19,"route":[[127.16264567,37.45885956],[127.162245,37.458495],[127.153473,37.450258]],"timestamp":[554.0820454524363,554.1896368677918,556.5883476222944]},{"passenger_id":5979,"vehicle_id":26,"route":[[126.98834991,37.39780807],[127.07143688,37.38972268],[127.10006651,37.40488217]],"timestamp":[554.7748341019042,569.5647201890471,575.6434434650758]},{"passenger_id":8522,"vehicle_id":11,"route":[[127.1090103,37.35067992],[127.10901029,37.35068033],[127.09792935,37.26880564]],"timestamp":[554.1130794656362,554.1131706626139,572.4264609727202]},{"passenger_id":18002,"vehicle_id":13,"route":[[127.17401515,37.43439691],[127.16537476,37.43587875],[127.16416931,37.44146347]],"timestamp":[554.9489356741724,556.5098981396255,557.7699913216617]},{"passenger_id":21153,"vehicle_id":16,"route":[[127.13422658,37.43446609],[127.13301931,37.43359005],[127.12549845,37.43135846]],"timestamp":[554.5751642368602,554.8639656563797,556.2817923890766]},{"passenger_id":5995,"vehicle_id":17,"route":[[127.15292229,37.45112792],[127.15516235,37.44995186],[127.15044026,37.47330794]],"timestamp":[554.7926507960594,555.2667948607769,560.5274105128425]},{"passenger_id":12951,"vehicle_id":24,"route":[[127.15607438,37.44580143],[127.15564343,37.44658161],[127.1686625,37.44911268]],"timestamp":[554.1038967170418,554.2933517121693,556.6598746056666]},{"passenger_id":21096,"vehicle_id":69,"route":[[127.154907,37.44694609],[127.15616694,37.44460406],[127.16680255,37.4499186]],"timestamp":[555.0614395389343,555.6278010807667,557.8465931881885]},{"passenger_id":18011,"vehicle_id":33,"route":[[127.1620636,37.44527054],[127.16117794,37.44542438],[127.12953303,37.41307012]],"timestamp":[555.8313841437265,555.991457588197,565.1020700472712]},{"passenger_id":17940,"vehicle_id":67,"route":[[127.10912974,37.35000781],[127.10901132,37.35064837],[127.10596335,37.36424581]],"timestamp":[555.170501201193,555.3144853420339,558.3860424798395]},{"passenger_id":18005,"vehicle_id":58,"route":[[127.10814436,37.42188245],[127.10641864,37.4223298],[127.20284547,37.40138709]],"timestamp":[555.9489180811503,556.2695362205914,573.9278240971446]},{"passenger_id":877,"vehicle_id":8,"route":[[127.12892914,37.41048431],[127.13036346,37.40988922],[127.10961151,37.40195465]],"timestamp":[555.335406710393,555.6212545480286,559.6897806234423]},{"passenger_id":12923,"vehicle_id":2,"route":[[127.13829803,37.37435913],[127.1376467,37.37388327],[127.123712,37.3509932]],"timestamp":[555.7688450630163,555.9252085959262,561.5803051569358]},{"passenger_id":15259,"vehicle_id":78,"route":[[127.14173889,37.43474579],[127.14160156,37.43527985],[127.15074921,37.44231033]],"timestamp":[555.2712024929637,555.3924225298646,557.6404599222554]},{"passenger_id":12959,"vehicle_id":4,"route":[[127.07348631,37.22629956],[127.11153989,37.34431688],[127.09071535,37.38941078]],"timestamp":[555.2172771771166,582.313046388362,592.9955937951759]},{"passenger_id":12993,"vehicle_id":97,"route":[[127.12944031,37.44828033],[127.13070679,37.44766998],[127.12106323,37.38409042]],"timestamp":[555.6344857904968,555.8960647178382,570.137745361052]},{"passenger_id":21159,"vehicle_id":93,"route":[[127.04854297,37.25811579],[127.10792743,37.35076443],[127.11501148,37.35992558]],"timestamp":[555.5578507200523,578.6853330431952,581.0767748750021]},{"passenger_id":10396,"vehicle_id":27,"route":[[127.11414824,37.35991601],[127.11482365,37.36225615],[127.11021105,37.37208768]],"timestamp":[555.6619458313788,556.1958874300059,558.5293702553064]},{"passenger_id":8471,"vehicle_id":62,"route":[[127.164411626887,37.4596008444519],[127.16483307,37.45899963],[127.13514709,37.4418602]],"timestamp":[556.9513364501653,557.1043453226118,563.5848945096736]},{"passenger_id":10327,"vehicle_id":19,"route":[[127.153473,37.450258],[127.15864277,37.44847541],[127.17379972,37.44014732]],"timestamp":[556.5883476222944,557.5834611571482,560.8380280329513]},{"passenger_id":21086,"vehicle_id":24,"route":[[127.1686625,37.44911268],[127.16757965,37.45119858],[127.16983032,37.43605423]],"timestamp":[556.6598746056666,557.1616083391978,560.5529218673541]},{"passenger_id":15269,"vehicle_id":60,"route":[[127.05358124,37.04632568],[127.10881346,37.35069784],[127.12496555,37.32142948]],"timestamp":[556.7556549704949,625.1483841686859,632.2563897841071]},{"passenger_id":15300,"vehicle_id":20,"route":[[127.11086282,37.35001244],[127.10901064,37.35066965],[127.10584641,37.40159434]],"timestamp":[556.8259936519338,557.1845732919816,568.5235050883631]},{"passenger_id":3413,"vehicle_id":32,"route":[[127.09408569,37.40057373],[127.09535217,37.40248108],[127.10324097,37.40611649]],"timestamp":[556.6380761033558,557.1176447809482,558.7288084478687]},{"passenger_id":23690,"vehicle_id":16,"route":[[127.12549845,37.43135846],[127.1252,37.432217],[127.138727,37.444542]],"timestamp":[556.2817923890766,556.4798637776443,560.1155457046995]},{"passenger_id":18067,"vehicle_id":90,"route":[[127.12602398,37.41080859],[127.12601654,37.41025067],[127.10712717,37.36278658]],"timestamp":[556.4848528083245,556.6089355154293,567.6796190188229]},{"passenger_id":3435,"vehicle_id":98,"route":[[127.10371254,37.40070647],[127.10601044,37.40125275],[127.09293365,37.33433151]],"timestamp":[556.3865894456534,556.8103417130941,571.8713467213229]},{"passenger_id":6006,"vehicle_id":1,"route":[[127.166119949647,37.4600202863273],[127.16677094,37.4610672],[127.10482025,37.48426437]],"timestamp":[557,557.2596392307872,569.3497140396355]},{"passenger_id":8468,"vehicle_id":13,"route":[[127.16416931,37.44146347],[127.16445261,37.44090256],[127.16485622,37.43708007]],"timestamp":[557.7699913216617,557.9043882827677,558.757453519547]},{"passenger_id":5986,"vehicle_id":69,"route":[[127.16680255,37.4499186],[127.16625977,37.45094681],[127.10377502,37.40070343]],"timestamp":[557.8465931881885,558.094524698755,573.7989469630844]},{"passenger_id":5965,"vehicle_id":48,"route":[[127.10836792,37.40254593],[127.11577616,37.40412764],[127.12891716,37.43251494]],"timestamp":[557.3259934255344,558.6811939802596,565.4073993688514]},{"passenger_id":21147,"vehicle_id":6,"route":[[127.09920954,37.4303458],[127.09886169,37.43035126],[127.11397552,37.37419128]],"timestamp":[557.0941519410984,557.155593617473,569.9272284924396]},{"passenger_id":15290,"vehicle_id":51,"route":[[127.10244751,37.40229034],[127.11072677,37.39622879],[127.10120378,37.40212467]],"timestamp":[557.3057663508322,559.294910822025,561.4279407794095]},{"passenger_id":12933,"vehicle_id":78,"route":[[127.15074921,37.44231033],[127.15089417,37.44226074],[127.13905334,37.43501282]],"timestamp":[557.6404599222554,557.6683302986398,560.3083504622517]},{"passenger_id":3432,"vehicle_id":38,"route":[[127.10014768,37.40497123],[127.09992218,37.40216827],[127.07865906,37.39163589]],"timestamp":[557.2680296109717,557.8926511355202,562.3197470853719]},{"passenger_id":18015,"vehicle_id":13,"route":[[127.16485622,37.43708007],[127.16454315,37.43595886],[127.17266846,37.43969727]],"timestamp":[558.757453519547,559.0128541962116,560.6710971113529]},{"passenger_id":3416,"vehicle_id":67,"route":[[127.10596335,37.36424581],[127.10655975,37.36557007],[127.1282196,37.3656311]],"timestamp":[558.3860424798395,558.6988423779176,562.5272625756645]},{"passenger_id":15289,"vehicle_id":27,"route":[[127.11021105,37.37208768],[127.11124125,37.37278976],[127.11301516,37.39778597]],"timestamp":[558.5293702553064,558.7692213171173,564.3369554702225]},{"passenger_id":10408,"vehicle_id":32,"route":[[127.10324097,37.40611649],[127.11423492,37.40726852],[127.10972595,37.39482498]],"timestamp":[558.7288084478687,560.6877590846254,563.5674457304666]},{"passenger_id":893,"vehicle_id":9,"route":[[127.12945013,37.43042854],[127.1294632,37.43041611],[127.16603851,37.45035934]],"timestamp":[558.8506318941211,558.8542331270313,566.6887694514053]},{"passenger_id":12935,"vehicle_id":46,"route":[[127.10371255,37.40052467],[127.11108398,37.39645386],[127.10020447,37.40181732]],"timestamp":[558.9970911752016,560.5831733939962,562.8452962727771]},{"passenger_id":10393,"vehicle_id":55,"route":[[127.12887372,37.41045142],[127.12900543,37.41230774],[127.16848755,37.44948578]],"timestamp":[559.7005658855995,560.1140476880896,570.9295348995903]},{"passenger_id":8488,"vehicle_id":84,"route":[[127.12680153,37.44943736],[127.12679863,37.44954156],[127.13092559,37.46030341]],"timestamp":[559.0203272468794,559.0435059252169,561.545271505137]},{"passenger_id":21146,"vehicle_id":63,"route":[[127.10125182,37.40090979],[127.10945892,37.39495087],[127.11158752,37.3843689]],"timestamp":[559.2509715125938,561.2153096532006,563.59849818161]},{"passenger_id":3422,"vehicle_id":8,"route":[[127.10961151,37.40195465],[127.11105448,37.39623045],[127.10371254,37.40068235]],"timestamp":[559.6897806234423,560.988060109894,562.619852990157]},{"passenger_id":10414,"vehicle_id":54,"route":[[127.11616403,37.48603333],[127.13285065,37.4731369],[127.11669922,37.48544312]],"timestamp":[559.0076055096515,563.1183216768953,567.0699043825764]},{"passenger_id":21209,"vehicle_id":86,"route":[[127.1470809,37.29198066],[127.1116333,37.33872986],[127.12343597,37.38087845]],"timestamp":[559.0539099814594,571.1945812510194,580.7973722853075]},{"passenger_id":3442,"vehicle_id":44,"route":[[127.078125,37.39174652],[127.08026272,37.39100426],[127.12353831,37.35150407]],"timestamp":[559.6596114199086,560.0718204341792,571.7193405285154]},{"passenger_id":18084,"vehicle_id":56,"route":[[127.12592316,37.41087341],[127.12611929,37.41073404],[127.09336812,37.42879067]],"timestamp":[560,560.046486021781,567.0882827971964]},{"passenger_id":21114,"vehicle_id":16,"route":[[127.138727,37.444542],[127.138756230008,37.4428926133888],[127.143622866544,37.4415703992385]],"timestamp":[560.1155457046995,560.4823888578355,561.390609528538]},{"passenger_id":15291,"vehicle_id":96,"route":[[127.11721802,37.36188889],[127.11496735,37.36245346],[127.12012482,37.38476562]],"timestamp":[560.982937482049,561.4001058473904,566.4451269095146]},{"passenger_id":6000,"vehicle_id":19,"route":[[127.17379972,37.44014732],[127.16971588,37.44160843],[127.14379883,37.43939209]],"timestamp":[560.8380280329513,561.6289545030535,566.2317046429595]},{"passenger_id":12941,"vehicle_id":24,"route":[[127.16983032,37.43605423],[127.16425467,37.43512276],[127.15470167,37.43063213]],"timestamp":[560.5529218673541,561.5590580829913,563.5194821824625]},{"passenger_id":10425,"vehicle_id":17,"route":[[127.15044026,37.47330794],[127.15254974,37.4589386],[127.14982605,37.45170975]],"timestamp":[560.5274105128425,563.7446261145765,565.422617980916]},{"passenger_id":12940,"vehicle_id":40,"route":[[127.16237716,37.45900323],[127.16426184,37.45829301],[127.1618671,37.45530601]],"timestamp":[560.6461323114918,561.0144251235222,561.8018193089015]},{"passenger_id":15313,"vehicle_id":78,"route":[[127.13905334,37.43501282],[127.13896942,37.43505096],[127.14688873,37.4409256]],"timestamp":[560.3083504622517,560.3254253534784,562.2391498715689]},{"passenger_id":18054,"vehicle_id":13,"route":[[127.17266846,37.43969727],[127.16964722,37.44161606],[127.16415405,37.44604874]],"timestamp":[560.6710971113529,561.3542382747306,562.7371669824248]},{"passenger_id":17934,"vehicle_id":40,"route":[[127.1618671,37.45530601],[127.16197204,37.4555109],[127.15608382,37.44678441]],"timestamp":[561.8018193089015,561.8510069477829,564.0525824566987]},{"passenger_id":18038,"vehicle_id":16,"route":[[127.143622866544,37.4415703992385],[127.14356502,37.44166158],[127.12128008,37.38250122]],"timestamp":[561.390609528538,561.4133143981044,575.1462440864946]},{"passenger_id":18059,"vehicle_id":34,"route":[[127.0766795,37.39218462],[127.07180055,37.3925748],[127.11844655,37.39381941]],"timestamp":[561.8432048519585,562.7096115094936,570.9559431881813]},{"passenger_id":3412,"vehicle_id":59,"route":[[127.11283674,37.39776336],[127.11154738,37.39623295],[127.10828074,37.39981839]],"timestamp":[561.1001917631418,561.5097395407341,562.4940528427278]},{"passenger_id":18049,"vehicle_id":84,"route":[[127.13092559,37.46030341],[127.12659829,37.45983729],[127.12357479,37.40600136]],"timestamp":[561.545271505137,562.3161625920856,574.3006266885739]},{"passenger_id":8507,"vehicle_id":68,"route":[[127.13105448,37.44876994],[127.13303521,37.44878823],[127.14030397,37.43810331]],"timestamp":[561.3460461175002,561.6957769441915,564.3964418850156]},{"passenger_id":10430,"vehicle_id":57,"route":[[127.11058044,37.39382172],[127.11058044,37.39382172],[127.09868622,37.41267014]],"timestamp":[561.5797866180484,561.5797866180484,566.2686682800453]},{"passenger_id":15304,"vehicle_id":2,"route":[[127.123712,37.3509932],[127.1230074,37.35150788],[127.11838725,37.36058754]],"timestamp":[561.5803051569358,561.7494701750245,563.9276108728699]},{"passenger_id":10465,"vehicle_id":29,"route":[[126.97642002,37.29641525],[127.10894048,37.33912999],[127.12604903,37.41135044]],"timestamp":[561.4528505414596,586.7427273793855,603.0859431935961]},{"passenger_id":21195,"vehicle_id":47,"route":[[127.16509556,37.46057505],[127.16700745,37.46115112],[127.13490295,37.43342972]],"timestamp":[561.1952487010134,561.5562445877716,569.9309969290829]},{"passenger_id":901,"vehicle_id":51,"route":[[127.10120378,37.40212467],[127.10855103,37.4024086],[127.11502838,37.38773727]],"timestamp":[562,563.2995325073127,566.7571737479352]},{"passenger_id":8491,"vehicle_id":64,"route":[[127.11940577,37.37368588],[127.116484144915,37.3740152570195],[127.102042567693,37.3865874024082]],"timestamp":[562.6272772577511,563.1487899594686,566.9343106683406]},{"passenger_id":3414,"vehicle_id":10,"route":[[127.12166595,37.38787079],[127.12208254,37.38760433],[127.1624508,37.44029721]],"timestamp":[562.1374779583132,562.231977027884,575.9492779975265]},{"passenger_id":15261,"vehicle_id":13,"route":[[127.16415405,37.44604874],[127.16411443,37.44598145],[127.16414446,37.44599125]],"timestamp":[562.7371669824248,562.7536859002079,562.759418483623]},{"passenger_id":10413,"vehicle_id":8,"route":[[127.10371254,37.40068235],[127.11089141,37.3959795],[127.09829571,37.41272178]],"timestamp":[562.619852990157,564.2637705742743,568.6013221289354]},{"passenger_id":885,"vehicle_id":46,"route":[[127.10020447,37.40181732],[127.10968018,37.39476776],[127.10106659,37.40206528]],"timestamp":[562.8452962727771,565.138870881336,567.363649527702]},{"passenger_id":21225,"vehicle_id":22,"route":[[127.10600239,37.35888815],[127.10250092,37.35754776],[127.06030273,37.26259613]],"timestamp":[562.0025628193519,562.6895522366541,585.0861972286052]},{"passenger_id":12960,"vehicle_id":67,"route":[[127.1282196,37.3656311],[127.12966919,37.36481476],[127.1079483,37.36769485]],"timestamp":[562.5272625756645,562.8412789167286,566.7334927242815]},{"passenger_id":15298,"vehicle_id":78,"route":[[127.14688873,37.4409256],[127.14700188,37.44082457],[127.13854614,37.4381557]],"timestamp":[562.2391498715689,562.2692162067658,563.8759467207145]},{"passenger_id":18053,"vehicle_id":28,"route":[[127.25137546,37.38962764],[127.17872493,37.43162769],[127.17436703,37.44005481]],"timestamp":[562.6727305023036,578.545258235758,580.5712064495267]},{"passenger_id":8524,"vehicle_id":59,"route":[[127.10828074,37.39981839],[127.11103058,37.39603043],[127.1111908,37.40410995]],"timestamp":[562.4940528427278,563.4665096050202,565.2635358184048]},{"passenger_id":21185,"vehicle_id":38,"route":[[127.07865906,37.39163589],[127.08293959,37.39107469],[127.10256264,37.40106684]],"timestamp":[562.3197470853719,563.0863026705858,567.2043022932777]},{"passenger_id":909,"vehicle_id":83,"route":[[127.10240173,37.40327454],[127.0981416,37.4092774],[127.12266697,37.38382632]],"timestamp":[562.2325375155347,563.7650272834189,570.893278991727]},{"passenger_id":21184,"vehicle_id":18,"route":[[127.1257019,37.38604736],[127.12498474,37.38802719],[127.11517334,37.38817596]],"timestamp":[563,563.4581675041015,565.1921359407756]},{"passenger_id":3408,"vehicle_id":63,"route":[[127.11158752,37.3843689],[127.1118711,37.38934578],[127.12754012,37.41232931]],"timestamp":[563.59849818161,564.7064395083108,570.5192201341225]},{"passenger_id":8502,"vehicle_id":62,"route":[[127.13514709,37.4418602],[127.13523102,37.44185638],[127.15905762,37.43318176]],"timestamp":[563.5848945096736,563.5997384451845,568.228263563765]},{"passenger_id":18036,"vehicle_id":13,"route":[[127.16414446,37.44599125],[127.16446207,37.44609491],[127.13390262,37.43633968]],"timestamp":[562.759418483623,562.8200496088855,568.6358001300919]},{"passenger_id":3431,"vehicle_id":2,"route":[[127.11838725,37.36058754],[127.12023163,37.35983658],[127.1204834,37.4054451]],"timestamp":[563.9276108728699,564.2939159439859,574.4368855909323]},{"passenger_id":21183,"vehicle_id":24,"route":[[127.15470167,37.43063213],[127.15707932,37.43183676],[127.14661797,37.4501174]],"timestamp":[563.5194821824625,564.0175498285614,568.4829539215393]},{"passenger_id":15307,"vehicle_id":32,"route":[[127.10972595,37.39482498],[127.10968412,37.39459762],[127.10584709,37.40322461]],"timestamp":[563.5674457304666,563.6185455680128,565.6533423051892]},{"passenger_id":15328,"vehicle_id":78,"route":[[127.13854614,37.4381557],[127.14039236,37.43803444],[127.15991532,37.43425296]],"timestamp":[563.8759467207145,564.2030655158817,567.7516068396714]},{"passenger_id":12936,"vehicle_id":92,"route":[[127.14626312,37.35301971],[127.14215329,37.36633468],[127.0981696,37.39488642]],"timestamp":[564.3907582813277,567.4396860727161,577.476164976181]},{"passenger_id":12938,"vehicle_id":40,"route":[[127.15608382,37.44678441],[127.15732517,37.44587795],[127.1554887,37.44704206]],"timestamp":[564.0525824566987,564.350365052391,564.7652849199828]},{"passenger_id":903,"vehicle_id":15,"route":[[127.12264308,37.38524208],[127.12218844,37.38491557],[127.0993476,37.41631534]],"timestamp":[564.3980697650477,564.5063593328015,572.5714329996867]},{"passenger_id":5992,"vehicle_id":31,"route":[[127.16604548,37.45034338],[127.16605443,37.45032051],[127.14829701,37.44130734]],"timestamp":[564.2665967728697,564.2719226325379,567.9931792586318]},{"passenger_id":23694,"vehicle_id":27,"route":[[127.11301516,37.39778597],[127.11144885,37.39623245],[127.10011631,37.40178571]],"timestamp":[564.3369554702225,564.7796078997753,567.1320057365494]},{"passenger_id":10464,"vehicle_id":14,"route":[[127.10479343,37.48394192],[127.10475354,37.44773244],[127.1287701,37.435044]],"timestamp":[564.3510965697247,572.4037205929721,577.4974030005701]},{"passenger_id":10505,"vehicle_id":66,"route":[[127.07725525,37.39177322],[127.0747441,37.38713443],[127.12901165,37.31921514]],"timestamp":[564.4068474147424,565.5298412161994,583.4234566521375]},{"passenger_id":8573,"vehicle_id":72,"route":[[127.11042786,37.32054138],[127.113992493283,37.3388515832445],[127.057140065666,37.2585937412316]],"timestamp":[564.4038601709696,568.5243646239447,589.0115933782818]},{"passenger_id":12973,"vehicle_id":68,"route":[[127.14030397,37.43810331],[127.14148804,37.43796044],[127.12724936,37.45630582]],"timestamp":[564.3964418850156,564.6079253919651,569.4001047714418]},{"passenger_id":12902,"vehicle_id":33,"route":[[127.12953303,37.41307012],[127.1295237,37.4123335],[127.15631012,37.40423721]],"timestamp":[565.1020700472712,565.2658951507419,570.3287109317708]},{"passenger_id":15263,"vehicle_id":59,"route":[[127.1111908,37.40410995],[127.11435699,37.40659332],[127.11299133,37.39458847]],"timestamp":[565.2635358184048,566.0495760243388,568.7302125567439]},{"passenger_id":12949,"vehicle_id":17,"route":[[127.14982605,37.45170975],[127.14969483,37.45390534],[127.13445722,37.38486271]],"timestamp":[565.422617980916,565.9114441705949,581.4999091893781]},{"passenger_id":15379,"vehicle_id":80,"route":[[127.12343597,37.3515625],[127.12299274,37.35150788],[127.08480789,37.30751168]],"timestamp":[565.4306941290467,565.5099860103414,577.3981416527586]},{"passenger_id":6013,"vehicle_id":48,"route":[[127.12891716,37.43251494],[127.12893657,37.43235275],[127.09582667,37.41216925]],"timestamp":[565.4073993688514,565.4436312790517,572.8154768252755]},{"passenger_id":3441,"vehicle_id":32,"route":[[127.10584709,37.40322461],[127.11394501,37.40052414],[127.07592773,37.39253616]],"timestamp":[565.6533423051892,567.2049051886966,574.1526640856348]},{"passenger_id":10453,"vehicle_id":40,"route":[[127.1554887,37.44704206],[127.1583252,37.44766998],[127.17778778,37.44377518]],"timestamp":[564.7652849199828,565.2851961964802,568.8290278250087]},{"passenger_id":8532,"vehicle_id":18,"route":[[127.11517334,37.38817596],[127.11392198,37.3899257],[127.11920108,37.38451244]],"timestamp":[565.1921359407756,565.6396930209563,567.1626542738172]},{"passenger_id":23681,"vehicle_id":41,"route":[[127.11554184,37.3983187],[127.117228,37.397024],[127.143998,37.409139]],"timestamp":[566.2648779570798,566.6791829754708,572.1220544368358]},{"passenger_id":15268,"vehicle_id":51,"route":[[127.11502838,37.38773727],[127.11688995,37.39022827],[127.12380219,37.38471603]],"timestamp":[566.7571737479352,567.401442421115,569.1319152747209]},{"passenger_id":18039,"vehicle_id":19,"route":[[127.14379883,37.43939209],[127.14533153,37.43985411],[127.15263393,37.44991842]],"timestamp":[566.2317046429595,566.5211911876996,569.1042008509231]},{"passenger_id":5999,"vehicle_id":96,"route":[[127.12012482,37.38476562],[127.12104969,37.38625252],[127.11218331,37.39377021]],"timestamp":[566.4451269095146,566.8139796997334,569.1051449822843]},{"passenger_id":18092,"vehicle_id":9,"route":[[127.16603851,37.45035934],[127.1661575,37.45002272],[127.13039409,37.42947018]],"timestamp":[566.6887694514053,566.7665221350702,574.5620209636079]},{"passenger_id":3465,"vehicle_id":64,"route":[[127.102042567693,37.3865874024082],[127.09751129,37.38953781],[127.16044617,37.45249939]],"timestamp":[566.9343106683406,567.9694863080588,585.8471911962442]},{"passenger_id":10514,"vehicle_id":87,"route":[[127.17223358,37.44022369],[127.1750062,37.4389728],[127.11004918,37.39375672]],"timestamp":[566.3741435131383,566.9372374315836,582.1935378963361]},{"passenger_id":18090,"vehicle_id":67,"route":[[127.1079483,37.36769485],[127.10746313,37.36686349],[127.11167284,37.37657469]],"timestamp":[566.7334927242815,566.9372972779844,569.2215332580913]},{"passenger_id":15399,"vehicle_id":42,"route":[[127.10180655,37.32056423],[127.10893741,37.33926624],[127.12738485,37.45916328]],"timestamp":[567,571.3460907303775,598.2084202159109]},{"passenger_id":18131,"vehicle_id":57,"route":[[127.09868622,37.41267014],[127.098195369576,37.4128344640981],[127.123906321386,37.388698500502]],"timestamp":[567,567.0940903292396,574.125701544329]},{"passenger_id":10367,"vehicle_id":38,"route":[[127.10256264,37.40106684],[127.11099253,37.39597446],[127.12138481,37.38521036]],"timestamp":[567.2043022932777,569.0753082955005,572.092285877373]},{"passenger_id":18006,"vehicle_id":78,"route":[[127.15991532,37.43425296],[127.16049366,37.43331173],[127.15738285,37.44447168]],"timestamp":[567.7516068396714,567.9845128666137,570.5264331100758]},{"passenger_id":5980,"vehicle_id":56,"route":[[127.09336812,37.42879067],[127.09968567,37.43026352],[127.11351013,37.39616394]],"timestamp":[567.0882827971964,568.251050613041,576.2179196199116]},{"passenger_id":886,"vehicle_id":77,"route":[[127.11167145,37.3917923],[127.11144647,37.39177345],[127.09923252,37.41553959]],"timestamp":[567.1350829019392,567.1750548482139,572.8838819661463]},{"passenger_id":8521,"vehicle_id":89,"route":[[127.13674164,37.43439865],[127.13820119,37.43480567],[127.1501914,37.40495681]],"timestamp":[567.1896972809126,567.4628691268406,574.4305802813565]},{"passenger_id":12970,"vehicle_id":88,"route":[[127.136386800153,37.4342843327191],[127.13646698,37.43423843],[127.17001343,37.44861221]],"timestamp":[567.6578898990053,567.6753450731758,574.4061991866936]},{"passenger_id":15369,"vehicle_id":90,"route":[[127.10712717,37.36278658],[127.1058197,37.36239243],[127.10193634,37.40435028]],"timestamp":[567.6796190188229,567.9267894442236,577.2829888281996]},{"passenger_id":18248,"vehicle_id":18,"route":[[127.11920108,37.38451244],[127.12228916,37.38587467],[127.05592262,37.54139493]],"timestamp":[567.1626542738172,567.7867864273494,604.3030998347982]},{"passenger_id":18078,"vehicle_id":31,"route":[[127.14829701,37.44130734],[127.14685669,37.44076774],[127.12653963,37.45984703]],"timestamp":[567.9931792586318,568.2743906282011,573.8304642309841]},{"passenger_id":8549,"vehicle_id":27,"route":[[127.10011631,37.40178571],[127.09738159,37.40055847],[127.10706329,37.36105347]],"timestamp":[567.1320057365494,567.6868999894809,576.6374524835755]},{"passenger_id":15317,"vehicle_id":54,"route":[[127.11669922,37.48544312],[127.12682335,37.44865262],[127.12668365,37.45955098]],"timestamp":[567.0699043825764,575.4446203576987,577.8684305185149]},{"passenger_id":15344,"vehicle_id":21,"route":[[127.13150787,37.32014084],[127.10892779,37.3396941],[127.12366369,37.35148807]],"timestamp":[567.5855647277798,573.4891734155908,577.1860447417616]},{"passenger_id":21204,"vehicle_id":46,"route":[[127.10106659,37.40206528],[127.11308658,37.40276988],[127.11074561,37.39376378]],"timestamp":[568,570.1292736788995,572.1743957776337]},{"passenger_id":21192,"vehicle_id":61,"route":[[127.10808808,37.36653947],[127.10808808,37.36649917],[127.13658903,37.27545931]],"timestamp":[568.7566645178582,568.765626828947,589.6299878940633]},{"passenger_id":8497,"vehicle_id":13,"route":[[127.13390262,37.43633968],[127.13383484,37.43643951],[127.12863922,37.43454742]],"timestamp":[568.6358001300919,568.6610220635453,569.6703860480384]},{"passenger_id":15279,"vehicle_id":62,"route":[[127.15905762,37.43318176],[127.15751648,37.43237686],[127.12939453,37.43120193]],"timestamp":[568.228263563765,568.5540076293498,573.5270663080415]},{"passenger_id":8529,"vehicle_id":0,"route":[[127.13615417,37.38572311],[127.13486909,37.38510297],[127.10333993,37.40238465]],"timestamp":[568.0600144042893,568.3256924070976,575.093526484131]},{"passenger_id":15281,"vehicle_id":43,"route":[[127.11582184,37.36832047],[127.11606526,37.36875565],[127.11482644,37.36210052]],"timestamp":[568.1660239980937,568.2719356244043,569.768078529125]},{"passenger_id":23686,"vehicle_id":24,"route":[[127.14661797,37.4501174],[127.145418,37.452231],[127.153782,37.449967]],"timestamp":[568.4829539215393,568.9985337216697,570.5586685190694]},{"passenger_id":8533,"vehicle_id":59,"route":[[127.11299133,37.39458847],[127.11153443,37.39376918],[127.08765216,37.40704124]],"timestamp":[568.7302125567439,569.0455813507218,574.1947424739765]},{"passenger_id":18095,"vehicle_id":8,"route":[[127.09829571,37.41272178],[127.10123771,37.41525045],[127.12702754,37.41233182]],"timestamp":[568.6013221289354,569.367018058452,573.9684709331718]},{"passenger_id":21196,"vehicle_id":40,"route":[[127.17778778,37.44377518],[127.17949518,37.44496905],[127.16748427,37.44618793]],"timestamp":[568.8290278250087,569.2307431142605,571.3686701451844]},{"passenger_id":15352,"vehicle_id":20,"route":[[127.10584641,37.40159434],[127.11109161,37.3960228],[127.0956955,37.40910339]],"timestamp":[568.5235050883631,570.0707594104313,574.0532543461713]},{"passenger_id":15275,"vehicle_id":96,"route":[[127.11218331,37.39377021],[127.11063776,37.3937629],[127.14087897,37.43597409]],"timestamp":[569.1051449822843,569.3782244654146,580.1789349032174]},{"passenger_id":18026,"vehicle_id":6,"route":[[127.11397552,37.37419128],[127.11258698,37.37319565],[127.10701752,37.36680984]],"timestamp":[569.9272284924396,570.2577533100841,571.9856822447473]},{"passenger_id":3444,"vehicle_id":47,"route":[[127.13490295,37.43342972],[127.13270569,37.43362808],[127.11146545,37.39377213]],"timestamp":[569.9309969290829,570.3215121120727,579.9464194367251]},{"passenger_id":8526,"vehicle_id":67,"route":[[127.11167284,37.37657469],[127.112078616629,37.3766513520259],[127.120020234011,37.35912090367]],"timestamp":[569.2215332580913,569.295242860941,573.4388224731907]},{"passenger_id":21228,"vehicle_id":85,"route":[[127.1065685,37.37673176],[127.10532978,37.37487416],[127.12291353,37.33210191]],"timestamp":[569.2825880569005,569.750118587796,579.7572531405873]},{"passenger_id":21193,"vehicle_id":19,"route":[[127.15263393,37.44991842],[127.155761680371,37.4507092321927],[127.140272887293,37.4435064985176]],"timestamp":[569.1042008509231,569.6837378020946,572.8530100325916]},{"passenger_id":10421,"vehicle_id":51,"route":[[127.12380219,37.38471603],[127.12376404,37.38464355],[127.11928558,37.38533783]],"timestamp":[569.1319152747209,569.1493870164555,569.9556754951424]},{"passenger_id":21197,"vehicle_id":43,"route":[[127.11482644,37.36210052],[127.11446783,37.36344611],[127.10808807,37.36705903]],"timestamp":[569.768078529125,570.0739638316875,571.458568863225]},{"passenger_id":18188,"vehicle_id":68,"route":[[127.12724936,37.45630582],[127.12837982,37.45328522],[127.11052704,37.39608765]],"timestamp":[569.4001047714418,570.1008744149308,583.2059841184022]},{"passenger_id":15354,"vehicle_id":13,"route":[[127.12863922,37.43454742],[127.12854012,37.43617914],[127.13943564,37.44404083]],"timestamp":[570,570.36329968605,572.9629284627614]},{"passenger_id":8581,"vehicle_id":1,"route":[[127.10482025,37.48426437],[127.12740326,37.45061111],[127.11225128,37.37191772]],"timestamp":[570,578.4794887053089,596.1835848121825]},{"passenger_id":15378,"vehicle_id":55,"route":[[127.16848755,37.44948578],[127.16717529,37.4510498],[127.11883545,37.48680496]],"timestamp":[570.9295348995903,571.3474540013252,583.0105704213596]},{"passenger_id":8516,"vehicle_id":78,"route":[[127.15738285,37.44447168],[127.15762087,37.44503696],[127.16875708,37.44806076]],"timestamp":[570.5264331100758,570.6589842712867,572.737007967538]},{"passenger_id":21201,"vehicle_id":97,"route":[[127.12106323,37.38409042],[127.12211954,37.38254452],[127.09555229,37.41204753]],"timestamp":[570.137745361052,570.5289423149208,578.5962032022567]},{"passenger_id":18062,"vehicle_id":63,"route":[[127.12754012,37.41232931],[127.12814179,37.41232637],[127.15229053,37.40396472]],"timestamp":[570.5192201341225,570.6255015456378,575.2790714574771]},{"passenger_id":10426,"vehicle_id":83,"route":[[127.12266697,37.38382632],[127.12360445,37.38349726],[127.10592702,37.37219655]],"timestamp":[570.893278991727,571.0743829473809,575.0837848640613]},{"passenger_id":10456,"vehicle_id":34,"route":[[127.11844655,37.39381941],[127.11666107,37.39313889],[127.12525177,37.38140869]],"timestamp":[570.9559431881813,571.3058344905492,574.3240201578529]},{"passenger_id":15345,"vehicle_id":51,"route":[[127.11928558,37.38533783],[127.12209999,37.38762033],[127.11843909,37.39439515]],"timestamp":[569.9556754951424,570.6662954468131,572.3059326351251]},{"passenger_id":12992,"vehicle_id":24,"route":[[127.153782,37.449967],[127.15429363,37.4476111],[127.13992161,37.4513977]],"timestamp":[570.5586685190694,571.0903267228904,573.7638356480069]},{"passenger_id":10467,"vehicle_id":33,"route":[[127.15631012,37.40423721],[127.15575327,37.40538312],[127.1299547,37.4098217]],"timestamp":[570.3287109317708,570.6018773439403,575.2649158423375]},{"passenger_id":8506,"vehicle_id":43,"route":[[127.10808807,37.36705903],[127.107900864569,37.3661903049266],[127.124225763383,37.3403224075352]],"timestamp":[571.458568863225,571.6545775083264,578.0906261135377]},{"passenger_id":15364,"vehicle_id":98,"route":[[127.09293365,37.33433151],[127.1077652,37.34686661],[127.05758667,37.28595734]],"timestamp":[571.8713467213229,575.6986089049888,591.8926612115848]},{"passenger_id":12996,"vehicle_id":50,"route":[[127.11028862,37.34001752],[127.10891613,37.34056275],[127.15160709,37.26737047]],"timestamp":[571.4622794536184,571.7335568545985,589.6773136581609]},{"passenger_id":18151,"vehicle_id":99,"route":[[126.97251129,37.27884674],[127.06804927,37.36718504],[127.07132385,37.21216748]],"timestamp":[571.000437319064,596.9122448901715,631.3914453600083]},{"passenger_id":13038,"vehicle_id":44,"route":[[127.12353831,37.35150407],[127.12298241,37.35150788],[127.13809235,37.43902103]],"timestamp":[571.7193405285154,571.8176184132714,591.4619008258144]},{"passenger_id":12987,"vehicle_id":6,"route":[[127.10701752,37.36680984],[127.10784912,37.36629868],[127.12036133,37.35386658]],"timestamp":[571.9856822447473,572.1714959762278,575.7120626392289]},{"passenger_id":10459,"vehicle_id":40,"route":[[127.16748427,37.44618793],[127.16751099,37.44604874],[127.16745758,37.43893433]],"timestamp":[571.3686701451844,571.3999820337065,572.9821827351924]},{"passenger_id":18141,"vehicle_id":3,"route":[[126.98972693,37.39427897],[127.07467956,37.38695523],[127.1051669,37.40464199]],"timestamp":[571.7538631195387,586.8524063521844,593.5221583743896]},{"passenger_id":12957,"vehicle_id":41,"route":[[127.143998,37.409139],[127.14573457,37.40749044],[127.11116328,37.39178603]],"timestamp":[572.1220544368358,572.6000893872327,579.6358508417528]},{"passenger_id":8501,"vehicle_id":15,"route":[[127.0993476,37.41631534],[127.10132174,37.41870131],[127.11283673,37.39811506]],"timestamp":[572.5714329996867,573.2063637606973,578.2160864922212]},{"passenger_id":3411,"vehicle_id":38,"route":[[127.12138481,37.38521036],[127.12373352,37.38436127],[127.13626099,37.38014984]],"timestamp":[572.092285877373,572.5482535185374,574.9519725523071]},{"passenger_id":5976,"vehicle_id":25,"route":[[127.13140311,37.42921507],[127.13143593,37.42906398],[127.15348806,37.44310722]],"timestamp":[572.2495647064939,572.2836618248699,577.2753903250724]},{"passenger_id":5974,"vehicle_id":78,"route":[[127.16875708,37.44806076],[127.16617215,37.44646569],[127.17386532,37.44017223]],"timestamp":[572.737007967538,573.3150426085058,575.2654370700021]},{"passenger_id":21253,"vehicle_id":11,"route":[[127.09792935,37.26880564],[127.10707855,37.34817123],[127.10845947,37.40078354]],"timestamp":[572.4264609727202,590.1506021711557,601.8535910127949]},{"passenger_id":5994,"vehicle_id":51,"route":[[127.11843909,37.39439515],[127.12241364,37.39467621],[127.12168121,37.38808441]],"timestamp":[572.3059326351251,573.0109428407925,574.4825934440732]},{"passenger_id":15395,"vehicle_id":19,"route":[[127.140272887293,37.4435064985176],[127.14058861,37.4435373],[127.1093697,37.3380875]],"timestamp":[572.8530100325916,572.9091755481279,597.0001544805248]},{"passenger_id":13053,"vehicle_id":40,"route":[[127.16745758,37.43893433],[127.16858471,37.44005701],[127.10325506,37.40238465]],"timestamp":[572.9821827351924,573.3014745937685,587.560756135985]},{"passenger_id":21232,"vehicle_id":13,"route":[[127.13943564,37.44404083],[127.14003371,37.4433689],[127.16662693,37.44656326]],"timestamp":[572.9629284627614,573.145905633876,577.894738305844]},{"passenger_id":13090,"vehicle_id":77,"route":[[127.09923252,37.41553959],[127.09625191,37.40934201],[126.95088407,37.34419602]],"timestamp":[572.8838819661463,574.3592974968681,603.8529472767328]},{"passenger_id":15466,"vehicle_id":48,"route":[[127.09582667,37.41216925],[127.09485201,37.41085929],[127.04295726,37.50214456]],"timestamp":[572.8154768252755,573.1538696366141,595.4262048443621]},{"passenger_id":3509,"vehicle_id":46,"route":[[127.11074561,37.39376378],[127.11078409,37.3937641],[127.01645721,37.48469664]],"timestamp":[572.1743957776337,572.1811949677589,598.3798572406963]},{"passenger_id":15285,"vehicle_id":62,"route":[[127.12939453,37.43120193],[127.12937106,37.43111917],[127.12952264,37.44990626]],"timestamp":[573.5270663080415,573.545932205908,577.72407612405]},{"passenger_id":15314,"vehicle_id":31,"route":[[127.12653963,37.45984703],[127.13391113,37.44963074],[127.15140533,37.43092346]],"timestamp":[573.8304642309841,576.448773289557,581.6305012165989]},{"passenger_id":13001,"vehicle_id":67,"route":[[127.120020234011,37.35912090367],[127.12023163,37.35997391],[127.12555695,37.38640594]],"timestamp":[573.4388224731907,573.6321677515151,579.5852506378629]},{"passenger_id":15393,"vehicle_id":58,"route":[[127.20284547,37.40138709],[127.1632761,37.4113513],[127.22810745,37.39498579]],"timestamp":[573.9278240971446,581.260771314488,593.2783897800272]},{"passenger_id":23705,"vehicle_id":69,"route":[[127.10377502,37.40070343],[127.10280766,37.40318821],[127.11166733,37.38524589]],"timestamp":[573.7989469630844,574.3773602730425,578.6636122907462]},{"passenger_id":10528,"vehicle_id":24,"route":[[127.13992161,37.4513977],[127.13985663,37.4513782],[127.10598844,37.36099655]],"timestamp":[573.7638356480069,573.7761000574978,594.7476194061594]},{"passenger_id":8566,"vehicle_id":74,"route":[[127.10269146,37.5118671],[127.13147838,37.45420788],[127.09810473,37.41274464]],"timestamp":[573.7979598635453,587.5904448517664,598.5339364886805]},{"passenger_id":18148,"vehicle_id":8,"route":[[127.12702754,37.41233182],[127.1262331,37.41233385],[127.12372517,37.38600617]],"timestamp":[573.9684709331718,574.1088020750337,579.9805521764969]},{"passenger_id":23688,"vehicle_id":2,"route":[[127.1204834,37.4054451],[127.12070412,37.40545906],[127.12377588,37.35135939]],"timestamp":[574.4368855909323,574.4760007002643,586.5194585762234]},{"passenger_id":18030,"vehicle_id":84,"route":[[127.12357479,37.40600136],[127.12261999,37.40765102],[127.11544649,37.40594105]],"timestamp":[574.3006266885739,574.7044101342349,576.0274646964723]},{"passenger_id":12932,"vehicle_id":88,"route":[[127.17001343,37.44861221],[127.17240678,37.4477865],[127.16723531,37.44954339]],"timestamp":[574.4061991866936,574.8669346110075,575.8600689012197]},{"passenger_id":21177,"vehicle_id":89,"route":[[127.1501914,37.40495681],[127.14477226,37.40642213],[127.12864866,37.41311801]],"timestamp":[574.4305802813565,575.4418491481616,578.6558094895637]},{"passenger_id":6012,"vehicle_id":34,"route":[[127.12525177,37.38140869],[127.12684631,37.38320923],[127.12367249,37.35152817]],"timestamp":[574.3240201578529,574.8136464741413,581.8814892046775]},{"passenger_id":18114,"vehicle_id":38,"route":[[127.13626099,37.38014984],[127.1343879,37.38101358],[127.15811243,37.43584149]],"timestamp":[574.9519725523071,575.3346749375826,588.2279813961231]},{"passenger_id":15359,"vehicle_id":57,"route":[[127.123906321386,37.388698500502],[127.12392426,37.3887291],[127.17674255,37.43131256]],"timestamp":[574.125701544329,574.1332085536087,587.4273789435854]},{"passenger_id":13040,"vehicle_id":20,"route":[[127.0956955,37.40910339],[127.09559631,37.40019989],[127.14705658,37.35709]],"timestamp":[574.0532543461713,576.0333799389001,589.2476304569824]},{"passenger_id":13009,"vehicle_id":9,"route":[[127.13039409,37.42947018],[127.13040688,37.42946592],[127.1365108,37.44231155]],"timestamp":[574.5620209636079,574.5644703174232,577.6177858643985]},{"passenger_id":3464,"vehicle_id":59,"route":[[127.08765216,37.40704124],[127.0933075,37.4017334],[127.11241913,37.37862015]],"timestamp":[574.1947424739765,575.7411919845139,581.8913584320824]},{"passenger_id":10483,"vehicle_id":32,"route":[[127.07592773,37.39253616],[127.07702656,37.39158527],[127.10562436,37.40422837]],"timestamp":[574.1526640856348,574.4397412305347,580.221909562434]},{"passenger_id":3467,"vehicle_id":51,"route":[[127.12168121,37.38808441],[127.12097168,37.38688278],[127.1239624,37.41346359]],"timestamp":[575,575.2951788245696,581.2300478027961]},{"passenger_id":18076,"vehicle_id":10,"route":[[127.1624508,37.44029721],[127.16141655,37.43934933],[127.12779181,37.40984401]],"timestamp":[575.9492779975265,576.2281821634981,585.0781403697873]},{"passenger_id":8496,"vehicle_id":83,"route":[[127.10592702,37.37219655],[127.10688848,37.3724434],[127.10677934,37.36665426]],"timestamp":[575.0837848640613,575.262356166089,576.5499466592995]},{"passenger_id":10466,"vehicle_id":6,"route":[[127.12036133,37.35386658],[127.118195245249,37.3547875968523],[127.176669884197,37.4342537772514]],"timestamp":[575.7120626392289,576.1463170743265,596.61715461312]},{"passenger_id":12966,"vehicle_id":63,"route":[[127.15229053,37.40396472],[127.15057153,37.41321751],[127.12223545,37.40491772]],"timestamp":[575.2790714574771,577.3590831142318,582.6940799740273]},{"passenger_id":18115,"vehicle_id":33,"route":[[127.1299547,37.4098217],[127.12862724,37.41103794],[127.12030448,37.35395819]],"timestamp":[575.2649158423375,575.6228884613479,588.401760733825]},{"passenger_id":15361,"vehicle_id":37,"route":[[127.11478277,37.35985776],[127.11597536,37.35986801],[127.13678362,37.36788934]],"timestamp":[575.6273017566313,575.838121453348,579.9258548639611]},{"passenger_id":13055,"vehicle_id":26,"route":[[127.10006651,37.40488217],[127.10977173,37.40174484],[126.97390747,37.38368988]],"timestamp":[575.6434434650758,577.4945127194152,601.8334334729301]},{"passenger_id":10472,"vehicle_id":88,"route":[[127.16723531,37.44954339],[127.16596222,37.450634],[127.15846252,37.43492889]],"timestamp":[575.8600689012197,576.1907435610299,579.9260072312715]},{"passenger_id":18109,"vehicle_id":78,"route":[[127.17386532,37.44017223],[127.17074381,37.44015625],[127.16759355,37.44591812]],"timestamp":[575.2654370700021,575.8166292194841,577.2135317550241]},{"passenger_id":18128,"vehicle_id":16,"route":[[127.12128008,37.38250122],[127.12198639,37.38261032],[127.105896,37.37151718]],"timestamp":[575.1462440864946,575.2733931269363,579.0379518985011]},{"passenger_id":10494,"vehicle_id":0,"route":[[127.10333993,37.40238465],[127.11086535,37.39622949],[127.10008156,37.40181985]],"timestamp":[576,577.9082393328677,580.1831919305694]},{"passenger_id":18223,"vehicle_id":83,"route":[[127.10677934,37.36665426],[127.10595337,37.36614314],[127.09093298,37.21144104]],"timestamp":[576.5499466592995,576.7349690171044,611.2416371376163]},{"passenger_id":10518,"vehicle_id":27,"route":[[127.10706329,37.36105347],[127.10812436,37.3611545],[127.10121355,37.40278673]],"timestamp":[576.6374524835755,576.8263496808871,586.1651288084929]},{"passenger_id":13018,"vehicle_id":56,"route":[[127.11351013,37.39616394],[127.1112442,37.39648819],[127.10479736,37.38045883]],"timestamp":[576.2179196199116,576.6247029606058,580.3670546907592]},{"passenger_id":920,"vehicle_id":84,"route":[[127.11544649,37.40594105],[127.11570629,37.40581144],[127.13160954,37.41115239]],"timestamp":[576.0274646964723,576.0816605412846,579.1317425870454]},{"passenger_id":10437,"vehicle_id":13,"route":[[127.16662693,37.44656326],[127.16607913,37.44644555],[127.21019282,37.42379549]],"timestamp":[577.894738305844,577.994937822327,587.2715408992176]},{"passenger_id":891,"vehicle_id":92,"route":[[127.0981696,37.39488642],[127.09342957,37.39001465],[127.11319733,37.37767029]],"timestamp":[577.476164976181,578.8455585549923,583.2883424144978]},{"passenger_id":18123,"vehicle_id":78,"route":[[127.16759355,37.44591812],[127.16699982,37.44467545],[127.09510803,37.4112854]],"timestamp":[577.2135317550241,577.5091037026885,592.2175100778924]},{"passenger_id":21258,"vehicle_id":14,"route":[[127.1287701,37.435044],[127.12765771,37.43455991],[127.10048282,37.40185573]],"timestamp":[577.4974030005701,577.721403947814,586.4355233115296]},{"passenger_id":18206,"vehicle_id":45,"route":[[127.17319758,37.43838775],[127.17042227,37.44039261],[127.11009126,37.39622436]],"timestamp":[577.5066356073223,578.1691655971827,592.6617322536713]},{"passenger_id":21239,"vehicle_id":25,"route":[[127.15348806,37.44310722],[127.15348982,37.44310803],[127.14569392,37.44889254]],"timestamp":[577.2753903250724,577.2757495193932,579.1597591109335]},{"passenger_id":21280,"vehicle_id":80,"route":[[127.08480789,37.30751168],[127.10732269,37.34676361],[127.11010742,37.40312195]],"timestamp":[577.3981416527586,586.9925253331596,599.5357068114464]},{"passenger_id":15355,"vehicle_id":62,"route":[[127.12952264,37.44990626],[127.13008336,37.44814682],[127.12774913,37.43911346]],"timestamp":[577.72407612405,578.1276870531889,580.1784566116929]},{"passenger_id":15409,"vehicle_id":21,"route":[[127.12366369,37.35148807],[127.1229805,37.35150788],[127.09667604,37.32191401]],"timestamp":[577.1860447417616,577.3069021466596,585.3659015235853]},{"passenger_id":18156,"vehicle_id":9,"route":[[127.1365108,37.44231155],[127.13716135,37.44250319],[127.14731777,37.43564416]],"timestamp":[578,578.1225189344742,580.4768872249803]},{"passenger_id":15417,"vehicle_id":90,"route":[[127.10193634,37.40435028],[127.11086592,37.3962295],[127.0948795,37.41125839]],"timestamp":[578,580.3979826643164,584.7736831609315]},{"passenger_id":13016,"vehicle_id":54,"route":[[127.12668365,37.45955098],[127.13025651,37.44810995],[127.13549808,37.44351469]],"timestamp":[578,580.6213879853503,582.0000963673497]},{"passenger_id":18073,"vehicle_id":89,"route":[[127.12864866,37.41311801],[127.1280899,37.41268158],[127.11181641,37.40130997]],"timestamp":[578.6558094895637,578.7942351737486,582.6230423206923]},{"passenger_id":3523,"vehicle_id":69,"route":[[127.11166733,37.38524589],[127.10859929,37.38926337],[127.123425,37.35150789]],"timestamp":[578.6636122907462,579.7086689700224,588.5044660685412]},{"passenger_id":21231,"vehicle_id":15,"route":[[127.11283673,37.39811506],[127.1109804,37.39623008],[127.12012262,37.3776033]],"timestamp":[578.2160864922212,578.7483393850288,583.194592529281]},{"passenger_id":3450,"vehicle_id":43,"route":[[127.124225763383,37.3403224075352],[127.11416607,37.34789983],[127.12335056,37.35150789]],"timestamp":[578.0906261135377,580.5407297151567,582.3518821878373]},{"passenger_id":21284,"vehicle_id":97,"route":[[127.09555229,37.41204753],[127.08607523,37.40543675],[127.10678751,37.39634373]],"timestamp":[578.5962032022567,580.8242203277738,585.0050031020191]},{"passenger_id":5998,"vehicle_id":84,"route":[[127.13160954,37.41115239],[127.13386026,37.41167765],[127.10691529,37.36539757]],"timestamp":[579.1317425870454,579.546121518198,590.8862168944404]},{"passenger_id":8527,"vehicle_id":41,"route":[[127.11116328,37.39178603],[127.11088343,37.39182429],[127.10371255,37.40048442]],"timestamp":[579.6358508417528,579.68602401082,581.9913072435769]},{"passenger_id":13017,"vehicle_id":85,"route":[[127.12291353,37.33210191],[127.11530279,37.34892472],[127.10897262,37.28923179]],"timestamp":[579.7572531405873,583.7331214651895,597.0553486482349]},{"passenger_id":913,"vehicle_id":95,"route":[[127.11085523,37.37680568],[127.1120224,37.37691879],[127.10850525,37.40244675]],"timestamp":[579.461951660183,579.6697470916246,585.3808196211218]},{"passenger_id":18122,"vehicle_id":88,"route":[[127.15846252,37.43492889],[127.1581192,37.43629837],[127.12527466,37.40995789]],"timestamp":[579.9260072312715,580.2365411185359,588.4805860148274]},{"passenger_id":18126,"vehicle_id":76,"route":[[127.01646227,37.48468864],[127.07226249,37.43059612],[127.09117856,37.40860993]],"timestamp":[579.1510175169944,594.6992230357696,600.62119052408]},{"passenger_id":13039,"vehicle_id":12,"route":[[127.04203796,37.2376976],[127.10796356,37.34871674],[127.09590912,37.41072464]],"timestamp":[579.647356811585,606.9532756508448,620.9067695328065]},{"passenger_id":13034,"vehicle_id":67,"route":[[127.12555695,37.38640594],[127.12578748,37.38701326],[127.16763178,37.37790736]],"timestamp":[579.5852506378629,579.7263216249576,587.3929575707889]},{"passenger_id":6027,"vehicle_id":47,"route":[[127.11146545,37.39377213],[127.11171722,37.39368439],[127.16090393,37.35877228]],"timestamp":[579.9464194367251,579.9949946504415,591.6501144272979]},{"passenger_id":10530,"vehicle_id":8,"route":[[127.12372517,37.38600617],[127.12405154,37.38652009],[127.12652024,37.45984938]],"timestamp":[579.9805521764969,580.1085685827746,596.4220862579767]},{"passenger_id":23711,"vehicle_id":37,"route":[[127.13678362,37.36788934],[127.1339677,37.3695467],[127.10808807,37.36701801]],"timestamp":[579.9258548639611,580.5451706463715,585.1536922163804]},{"passenger_id":10503,"vehicle_id":25,"route":[[127.14569392,37.44889254],[127.14550781,37.44791794],[127.1326828,37.43896866]],"timestamp":[579.1597591109335,579.3789768668299,582.3937519087217]},{"passenger_id":13061,"vehicle_id":16,"route":[[127.105896,37.37151718],[127.10783386,37.37247467],[127.10870361,37.38977814]],"timestamp":[579.0379518985011,579.4412391114253,583.2924234449482]},{"passenger_id":23720,"vehicle_id":52,"route":[[127.03471538,37.16672927],[127.1105322,37.33807596],[127.12890445,37.31923687]],"timestamp":[580,620.4001097169162,625.7018397841905]},{"passenger_id":8508,"vehicle_id":62,"route":[[127.12774913,37.43911346],[127.12797512,37.43910115],[127.13103715,37.44876474]],"timestamp":[580.1784566116929,580.2184551595914,582.4345027357585]},{"passenger_id":12961,"vehicle_id":94,"route":[[127.167136610028,37.4612730564403],[127.16714601,37.46128776],[127.15937563,37.43788055]],"timestamp":[580.8641867749975,580.8678536230946,586.2511204576521]},{"passenger_id":906,"vehicle_id":71,"route":[[126.97336578,37.25852966],[127.106987,37.35013962],[127.11155701,37.39182663]],"timestamp":[580.2858156111553,611.4910764183012,620.7969622558153]},{"passenger_id":12994,"vehicle_id":56,"route":[[127.10479736,37.38045883],[127.10195923,37.37651443],[127.10721588,37.37573242]],"timestamp":[580.3670546907592,581.3775141425901,582.322639343375]},{"passenger_id":15348,"vehicle_id":9,"route":[[127.14731777,37.43564416],[127.14710999,37.43608856],[127.15593719,37.44319534]],"timestamp":[580.4768872249803,580.582308278421,582.8020758235145]},{"passenger_id":914,"vehicle_id":28,"route":[[127.17436703,37.44005481],[127.17853546,37.44267273],[127.1292572,37.43226624]],"timestamp":[580.5712064495267,581.5096593842633,590.513781594816]},{"passenger_id":3466,"vehicle_id":49,"route":[[127.10596332,37.36531869],[127.10596335,37.36426578],[127.10256263,37.40147363]],"timestamp":[580.2111658714844,580.4453223719725,588.7417634995285]},{"passenger_id":21226,"vehicle_id":86,"route":[[127.12343597,37.38087845],[127.12361013,37.38350142],[127.11237115,37.37767399]],"timestamp":[580.7973722853075,581.3815055098299,583.7530275835513]},{"passenger_id":915,"vehicle_id":96,"route":[[127.14087897,37.43597409],[127.14060974,37.4359436],[127.12726593,37.4593811]],"timestamp":[580.1789349032174,580.2269579790592,585.9469374462318]},{"passenger_id":18149,"vehicle_id":32,"route":[[127.10562436,37.40422837],[127.11183929,37.40129852],[127.11102295,37.39621353]],"timestamp":[580.221909562434,581.4986379861534,582.638648062493]},{"passenger_id":15400,"vehicle_id":0,"route":[[127.10008156,37.40181985],[127.10968714,37.39442396],[127.09503301,37.41156991]],"timestamp":[580.1831919305694,582.5465109896794,587.1553830172752]},{"passenger_id":883,"vehicle_id":51,"route":[[127.1239624,37.41346359],[127.12376019,37.41520845],[127.12275637,37.40543463]],"timestamp":[581.2300478027961,581.6197273287906,583.8005465418101]},{"passenger_id":3430,"vehicle_id":17,"route":[[127.13445722,37.38486271],[127.13128662,37.38405991],[127.10431671,37.39987946]],"timestamp":[581.4999091893781,582.0879327697648,588.0111879377268]},{"passenger_id":892,"vehicle_id":41,"route":[[127.10371255,37.40048442],[127.10979462,37.39424515],[127.10173035,37.39536285]],"timestamp":[581.9913072435769,583.7462903282161,585.1926208607306]},{"passenger_id":23713,"vehicle_id":59,"route":[[127.11241913,37.37862015],[127.113555,37.378739],[127.126087,37.41029]],"timestamp":[581.8913584320824,582.0938220412245,589.4515128016754]},{"passenger_id":3472,"vehicle_id":34,"route":[[127.12367249,37.35152817],[127.12354534,37.3514329],[127.10685908,37.3656142]],"timestamp":[581.8814892046775,581.9123786390701,586.2305242220491]},{"passenger_id":21261,"vehicle_id":31,"route":[[127.15140533,37.43092346],[127.15253019,37.43031173],[127.13376404,37.42899245]],"timestamp":[581.6305012165989,581.8712675120963,585.1983279116625]},{"passenger_id":6046,"vehicle_id":93,"route":[[127.11501148,37.35992558],[127.11799622,37.35939407],[127.10853577,37.39972687]],"timestamp":[581.0767748750021,581.6174507518591,590.7415310495526]},{"passenger_id":21221,"vehicle_id":87,"route":[[127.11004918,37.39375672],[127.11016453,37.39375812],[127.07132221,37.21216712]],"timestamp":[582.1935378963361,582.2139208275838,623.1782902420047]},{"passenger_id":5993,"vehicle_id":56,"route":[[127.10721588,37.37573242],[127.11225076,37.37652393],[127.13036617,37.41035083]],"timestamp":[582.322639343375,583.2296774995854,591.405039815528]},{"passenger_id":15412,"vehicle_id":89,"route":[[127.11181641,37.40130997],[127.11669065,37.4037242],[127.09882567,37.19993199]],"timestamp":[582.6230423206923,583.6378123765973,629.0691857292106]},{"passenger_id":13023,"vehicle_id":62,"route":[[127.13103715,37.44876474],[127.13352203,37.44779587],[127.15925598,37.444767]],"timestamp":[582.4345027357585,582.9232780748396,587.516537899455]},{"passenger_id":911,"vehicle_id":25,"route":[[127.1326828,37.43896866],[127.13271591,37.43889799],[127.15021596,37.44196972]],"timestamp":[582.3937519087217,582.4105204299937,585.5751893409389]},{"passenger_id":18155,"vehicle_id":9,"route":[[127.15593719,37.44319534],[127.15587463,37.44296985],[127.17294491,37.44921673]],"timestamp":[582.8020758235145,582.8534246959388,586.1721393632172]},{"passenger_id":6042,"vehicle_id":43,"route":[[127.12335056,37.35150789],[127.12340924,37.35148567],[127.09502802,37.31953283]],"timestamp":[582.3518821878373,582.363372698314,591.0627716841631]},{"passenger_id":8580,"vehicle_id":63,"route":[[127.12223545,37.40491772],[127.12208288,37.40431809],[127.09416945,37.42871536]],"timestamp":[582.6940799740273,582.8301281726729,590.1613518868443]},{"passenger_id":15402,"vehicle_id":54,"route":[[127.13549808,37.44351469],[127.13586207,37.44275275],[127.13940612,37.46793354]],"timestamp":[582.0000963673497,582.1813228408062,587.8161182829765]},{"passenger_id":3491,"vehicle_id":32,"route":[[127.11102295,37.39621353],[127.11088946,37.39597961],[127.09485795,37.41115394]],"timestamp":[583,583.057118087322,587.4626943934579]},{"passenger_id":18085,"vehicle_id":92,"route":[[127.11319733,37.37767029],[127.1141245,37.37672439],[127.12824913,37.41232585]],"timestamp":[583.2883424144978,583.554985320221,591.8563817352492]},{"passenger_id":3477,"vehicle_id":15,"route":[[127.12012262,37.3776033],[127.12236501,37.37492512],[126.97328028,37.27507314]],"timestamp":[583.194592529281,583.9099830159167,618.3806557542786]},{"passenger_id":6060,"vehicle_id":70,"route":[[126.63446112,37.397577],[127.0607308,37.39363218],[127.07332392,37.25355771]],"timestamp":[583.962374436947,659.2807947369747,690.5114446985417]},{"passenger_id":6029,"vehicle_id":51,"route":[[127.12275637,37.40543463],[127.12364197,37.40507889],[127.14367676,37.40896606]],"timestamp":[583.8005465418101,583.9758598662428,587.6191150526842]},{"passenger_id":15427,"vehicle_id":86,"route":[[127.11237115,37.37767399],[127.11214368,37.37750916],[127.13169173,37.44108252]],"timestamp":[583.7530275835513,583.8074304015488,598.361092076201]},{"passenger_id":925,"vehicle_id":16,"route":[[127.10870361,37.38977814],[127.10878754,37.38969421],[127.1216507,37.38604736]],"timestamp":[583.2924234449482,583.3162628150945,585.7295235585734]},{"passenger_id":8565,"vehicle_id":66,"route":[[127.12901165,37.31921514],[127.10913849,37.33945847],[127.10671997,37.35983276]],"timestamp":[583.4234566521375,589.1346270704723,593.685791138466]},{"passenger_id":21307,"vehicle_id":55,"route":[[127.11883545,37.48680496],[127.133517373816,37.4731424283769],[127.154253356321,37.4434926096725]],"timestamp":[583.0105704213596,587.0037680567641,594.545532100139]},{"passenger_id":21300,"vehicle_id":68,"route":[[127.11052704,37.39608765],[127.11087799,37.39414215],[127.09573364,37.40896988]],"timestamp":[583.2059841184022,583.6430641889053,587.8894757190513]},{"passenger_id":10551,"vehicle_id":90,"route":[[127.0948795,37.41125839],[127.1063385,37.42231369],[127.10845184,37.39975739]],"timestamp":[584.7736831609315,587.9582152295932,592.98837894158]},{"passenger_id":21353,"vehicle_id":21,"route":[[127.09667604,37.32191401],[127.10984039,37.35004425],[127.19796753,37.56456375]],"timestamp":[585.3659015235853,592.0408060612025,642.2203700136037]},{"passenger_id":926,"vehicle_id":41,"route":[[127.10173035,37.39536285],[127.10987161,37.39375456],[127.08496605,37.17041282]],"timestamp":[585.1926208607306,586.674840347672,636.5389018256923]},{"passenger_id":13020,"vehicle_id":37,"route":[[127.10808807,37.36701801],[127.10808809,37.36635549],[127.09463087,37.3444452]],"timestamp":[585.1536922163804,585.3010299420241,590.7233579470623]},{"passenger_id":21279,"vehicle_id":16,"route":[[127.1216507,37.38604736],[127.12271664,37.38769406],[127.10596335,37.36431151]],"timestamp":[585.7295235585734,586.1413316554166,592.125181454048]},{"passenger_id":15385,"vehicle_id":97,"route":[[127.10678751,37.39634373],[127.11070251,37.39405441],[127.10006714,37.40495682]],"timestamp":[585.0050031020191,585.8638758873245,588.9313026491131]},{"passenger_id":3480,"vehicle_id":31,"route":[[127.13376404,37.42899245],[127.13388824,37.42903137],[127.09506989,37.41156006]],"timestamp":[585.1983279116625,585.2219078080011,593.1024998993605]},{"passenger_id":18240,"vehicle_id":96,"route":[[127.12726593,37.4593811],[127.12753582,37.46295947],[127.1110007,37.39983307]],"timestamp":[585.9469374462318,586.7441554762765,601.0832927846628]},{"passenger_id":919,"vehicle_id":25,"route":[[127.15021596,37.44196972],[127.15021501,37.44173444],[127.16004,37.4543983]],"timestamp":[585.5751893409389,585.6275134944997,588.9351842143107]},{"passenger_id":13074,"vehicle_id":10,"route":[[127.12779181,37.40984401],[127.12647007,37.40986049],[127.13192746,37.44095207]],"timestamp":[585.0781403697873,585.3116499065569,592.2929543053866]},{"passenger_id":917,"vehicle_id":64,"route":[[127.16044617,37.45249939],[127.16038513,37.45225525],[127.16615295,37.46156311]],"timestamp":[585.8471911962442,585.9025445782637,588.2093980449907]},{"passenger_id":18199,"vehicle_id":95,"route":[[127.10850525,37.40244675],[127.1168501,37.40274225],[127.13690071,37.44049537]],"timestamp":[585.3808196211218,586.8565151235911,595.968716990552]},{"passenger_id":10549,"vehicle_id":91,"route":[[127.10101697,37.40206399],[127.11113739,37.39604187],[127.09793091,37.40465164]],"timestamp":[586,588.23395120095,591.2522086457385]},{"passenger_id":10540,"vehicle_id":22,"route":[[127.06030273,37.26259613],[127.10590882,37.34397637],[127.12338791,37.35150789]],"timestamp":[586,605.8148643864905,609.3297763610029]},{"passenger_id":6007,"vehicle_id":9,"route":[[127.17294491,37.44921673],[127.17289734,37.44918823],[127.13439941,37.47229385]],"timestamp":[586.1721393632172,586.182661203524,594.7025215984416]},{"passenger_id":23728,"vehicle_id":34,"route":[[127.10685908,37.3656142],[127.10746317,37.36551977],[127.09987404,37.40467097]],"timestamp":[586.2305242220491,586.3393432491893,595.1488415512038]},{"passenger_id":18181,"vehicle_id":94,"route":[[127.15937563,37.43788055],[127.16034913,37.43838287],[127.1511003,37.44320245]],"timestamp":[586.2511204576521,586.4561304182821,588.4095431883368]},{"passenger_id":18308,"vehicle_id":14,"route":[[127.10048282,37.40185573],[127.11071014,37.39788055],[127.06908417,37.22557068]],"timestamp":[587,589.0115351794087,628.0324160059847]},{"passenger_id":18257,"vehicle_id":2,"route":[[127.12377588,37.35135939],[127.12329927,37.35150788],[127.11117641,37.38796988]],"timestamp":[587,587.0904972768341,595.4775742009623]},{"passenger_id":8603,"vehicle_id":27,"route":[[127.10121355,37.40278673],[127.11309052,37.40166092],[127.13783264,37.44745255]],"timestamp":[587,589.1131236727442,600.1946537403614]},{"passenger_id":18106,"vehicle_id":68,"route":[[127.09573364,37.40896988],[127.112764723909,37.4151150056289],[127.126245196036,37.4123039116538]],"timestamp":[587.8894757190513,591.1937253687879,593.655579728657]},{"passenger_id":13003,"vehicle_id":62,"route":[[127.15925598,37.444767],[127.16152191,37.44517517],[127.16330719,37.45454025]],"timestamp":[587.516537899455,587.9267871737352,590.0332016749505]},{"passenger_id":18185,"vehicle_id":13,"route":[[127.21019282,37.42379549],[127.18058939,37.4360598],[127.12887372,37.41024593]],"timestamp":[587.2715408992176,593.1681837461294,603.9562277949434]},{"passenger_id":10539,"vehicle_id":67,"route":[[127.16763178,37.37790736],[127.1511777,37.3822597],[127.13487785,37.44182617]],"timestamp":[587.3929575707889,590.4575363036025,604.0138038410313]},{"passenger_id":10520,"vehicle_id":57,"route":[[127.17674255,37.43131256],[127.17851375,37.43160032],[127.16526294,37.46071847]],"timestamp":[587.4273789435854,587.7466444619344,594.6319011436767]},{"passenger_id":18233,"vehicle_id":51,"route":[[127.14367676,37.40896606],[127.14230005,37.40832729],[127.10602198,37.40136263]],"timestamp":[587.6191150526842,587.9007596508195,594.4940904917244]},{"passenger_id":937,"vehicle_id":0,"route":[[127.09503301,37.41156991],[127.10125901,37.42565139],[127.11173319,37.40323924]],"timestamp":[587.1553830172752,590.4744284202525,595.7909609182693]},{"passenger_id":18275,"vehicle_id":54,"route":[[127.13940612,37.46793354],[127.14072579,37.4725615],[127.10593269,37.5130818]],"timestamp":[587.8161182829765,588.8713580675065,599.7752189337994]},{"passenger_id":18265,"vehicle_id":32,"route":[[127.09485795,37.41115394],[127.09909821,37.42548752],[127.12532806,37.38651276]],"timestamp":[588,591.2744436445329,601.1028639909512]},{"passenger_id":935,"vehicle_id":40,"route":[[127.10325506,37.40238465],[127.11156464,37.39584732],[127.09816742,37.41278076]],"timestamp":[588,590.0661230705163,594.5139238965049]},{"passenger_id":21234,"vehicle_id":38,"route":[[127.15811243,37.43584149],[127.15814972,37.43638229],[127.11401367,37.39662552]],"timestamp":[588.2279813961231,588.3484299577577,600.1359850626815]},{"passenger_id":21278,"vehicle_id":64,"route":[[127.16615295,37.46156311],[127.16706795,37.46123033],[127.10433522,37.39984331]],"timestamp":[588.2093980449907,588.3870657818479,605.9684540875103]},{"passenger_id":18105,"vehicle_id":33,"route":[[127.12030448,37.35395819],[127.12292227,37.35150788],[127.11670865,37.33149708]],"timestamp":[588.401760733825,589.116675935286,593.700476212956]},{"passenger_id":18134,"vehicle_id":88,"route":[[127.12527466,37.40995789],[127.12512132,37.40980358],[127.16806038,37.44088234]],"timestamp":[588.4805860148274,588.5243051044412,598.7848699765583]},{"passenger_id":3484,"vehicle_id":69,"route":[[127.123425,37.35150789],[127.12311103,37.35150788],[127.10283672,37.32853791]],"timestamp":[588.5044660685412,588.5599709433556,594.8005510794706]},{"passenger_id":13069,"vehicle_id":25,"route":[[127.16004,37.4543983],[127.16117096,37.45447159],[127.17269897,37.43983078]],"timestamp":[588.9351842143107,589.1355095716848,592.9753077329682]},{"passenger_id":8568,"vehicle_id":97,"route":[[127.10006714,37.40495682],[127.11672336,37.40364667],[127.12389228,37.38872844]],"timestamp":[588.9313026491131,591.8881741850139,595.439392623863]},{"passenger_id":21326,"vehicle_id":94,"route":[[127.1511003,37.44320245],[127.15099116,37.44315146],[127.16978674,37.43605221]],"timestamp":[588.4095431883368,588.4319026320812,592.1071455765817]},{"passenger_id":923,"vehicle_id":17,"route":[[127.10431671,37.39987946],[127.10945892,37.39441681],[127.11308289,37.40162277]],"timestamp":[588.0111879377268,589.528164250402,591.2538659907921]},{"passenger_id":18250,"vehicle_id":49,"route":[[127.10256263,37.40147363],[127.10861452,37.39981839],[127.15049947,37.42848579]],"timestamp":[589,590.130770845001,599.8971086243172]},{"passenger_id":13004,"vehicle_id":20,"route":[[127.14705658,37.35709],[127.14329776,37.36748963],[127.12269877,37.38384965]],"timestamp":[589.2476304569824,591.6539445733729,596.8007643572531]},{"passenger_id":10623,"vehicle_id":61,"route":[[127.13658903,37.27545931],[127.11475221,37.34892471],[126.83740351,37.29930776]],"timestamp":[589.6299878940633,606.4182937877998,656.6928266934154]},{"passenger_id":18219,"vehicle_id":59,"route":[[127.126087,37.41029],[127.12602398,37.41089593],[127.12342133,37.35150789]],"timestamp":[589.4515128016754,589.586724526903,602.8020277067035]},{"passenger_id":15470,"vehicle_id":50,"route":[[127.15160709,37.26737047],[127.12351611,37.35095329],[126.98646309,37.39706997]],"timestamp":[589.6773136581609,608.9179473951933,635.2212707375026]},{"passenger_id":21465,"vehicle_id":72,"route":[[127.057140065666,37.2585937412316],[127.11028865,37.33868564],[127.18903007,37.56587767]],"timestamp":[589.0115933782818,609.1525889986438,661.5553322423848]},{"passenger_id":15383,"vehicle_id":28,"route":[[127.1292572,37.43226624],[127.12921776,37.4322545],[127.16870279,37.44899854]],"timestamp":[590.513781594816,590.5212197242407,598.4253410312879]},{"passenger_id":15357,"vehicle_id":36,"route":[[127.1540451,37.27803421],[127.12290192,37.35142517],[127.11195374,37.34943771]],"timestamp":[590.6310784738419,607.8569238250777,609.8422401602053]},{"passenger_id":21289,"vehicle_id":62,"route":[[127.16330719,37.45454025],[127.162425528045,37.4556786462249],[127.129053512175,37.431514905242]],"timestamp":[590.0332016749505,590.3303890532443,598.305206856493]},{"passenger_id":15425,"vehicle_id":53,"route":[[127.1360162,37.33134987],[127.12302399,37.3514328],[127.13893127,37.37084198]],"timestamp":[590.3500119222531,595.3723698283459,600.5238281837762]},{"passenger_id":3489,"vehicle_id":63,"route":[[127.09416945,37.42871536],[127.09448242,37.43028259],[127.11032867,37.40084457]],"timestamp":[590.1613518868443,590.5142431062657,597.634197031704]},{"passenger_id":6059,"vehicle_id":37,"route":[[127.09463087,37.3444452],[127.10694885,37.35009766],[127.10257721,37.4007225]],"timestamp":[590.7233579470623,593.2378651049569,604.5227934666173]},{"passenger_id":3482,"vehicle_id":84,"route":[[127.10691529,37.36539757],[127.10625458,37.36510849],[127.11779785,37.36723328]],"timestamp":[590.8862168944404,591.0195245893555,593.1137965781974]},{"passenger_id":15451,"vehicle_id":93,"route":[[127.10853577,37.39972687],[127.11109924,37.39588928],[127.08715057,37.40491486]],"timestamp":[590.7415310495526,591.7076991788832,596.3906530800678]},{"passenger_id":6064,"vehicle_id":39,"route":[[126.9907074,37.56263351],[127.14051561,37.46721219],[127.18304104,37.42075443]],"timestamp":[591,624.891726926571,637.6636876809052]},{"passenger_id":18142,"vehicle_id":92,"route":[[127.12824913,37.41232585],[127.12825924,37.4123258],[127.13122392,37.40313258]],"timestamp":[591.8563817352492,591.8581676072314,593.968658407744]},{"passenger_id":15416,"vehicle_id":47,"route":[[127.16090393,37.35877228],[127.14541913,37.36876133],[127.12137315,37.38352249]],"timestamp":[591.6501144272979,595.1751912307576,600.545014362896]},{"passenger_id":3481,"vehicle_id":44,"route":[[127.13809235,37.43902103],[127.13786898,37.43903506],[127.12689734,37.41233245]],"timestamp":[591.4619008258144,591.5014662057764,597.747994977108]},{"passenger_id":21361,"vehicle_id":98,"route":[[127.05758667,37.28595734],[127.10793404,37.35002328],[127.09798298,37.41275858]],"timestamp":[591.8926612115848,608.6940329697313,622.7561113496812]},{"passenger_id":18200,"vehicle_id":56,"route":[[127.13036617,37.41035083],[127.1319809,37.41016388],[127.12792969,37.41003036]],"timestamp":[591.405039815528,591.6932888248454,592.4095344091767]},{"passenger_id":10570,"vehicle_id":91,"route":[[127.09793091,37.40465164],[127.097553706879,37.4128122420154],[127.101045351818,37.4020234191022]],"timestamp":[591.2522086457385,593.0682665443326,595.5456058578363]},{"passenger_id":15443,"vehicle_id":17,"route":[[127.11308289,37.40162277],[127.11564636,37.40348816],[127.12541962,37.38581467]],"timestamp":[591.2538659907921,591.8680227954823,596.1610160872051]},{"passenger_id":10642,"vehicle_id":43,"route":[[127.09502802,37.31953283],[127.10879517,37.34076691],[127.08316803,37.23993301]],"timestamp":[592,597.312852182183,620.191092995919]},{"passenger_id":6015,"vehicle_id":94,"route":[[127.16978674,37.43605221],[127.16733551,37.43704224],[127.12943268,37.43096542]],"timestamp":[592.1071455765817,592.592771390682,599.421084355163]},{"passenger_id":13006,"vehicle_id":78,"route":[[127.09510803,37.4112854],[127.10068512,37.42730713],[127.13279724,37.3769722]],"timestamp":[592.2175100778924,595.9142371871201,608.463697239124]},{"passenger_id":6026,"vehicle_id":16,"route":[[127.10596335,37.36431151],[127.10627809,37.36343112],[127.11302224,37.3958683]],"timestamp":[592.125181454048,592.3287214939777,599.6402108232007]},{"passenger_id":924,"vehicle_id":4,"route":[[127.09071535,37.38941078],[127.08960953,37.38795516],[127.109978,37.400937]],"timestamp":[592.9955937951759,593.3737081511574,597.9873842164437]},{"passenger_id":13110,"vehicle_id":25,"route":[[127.17269897,37.43983078],[127.17149891,37.44121845],[127.11113276,37.4009433]],"timestamp":[592.9753077329682,593.3496574367982,607.2744370592343]},{"passenger_id":15419,"vehicle_id":90,"route":[[127.10845184,37.39975739],[127.11489324,37.39620281],[127.10808808,37.36666141]],"timestamp":[592.98837894158,594.3740229311837,601.0528864257924]},{"passenger_id":8578,"vehicle_id":23,"route":[[126.79891078,37.33557231],[127.07239885,37.38967633],[127.11110032,37.39623069]],"timestamp":[592.7127247980036,642.5287744118873,649.5204271705197]},{"passenger_id":18237,"vehicle_id":56,"route":[[127.12792969,37.41003036],[127.12862888,37.41088091],[127.12791559,37.36755509]],"timestamp":[592.4095344091767,592.6354402847566,602.271487311465]},{"passenger_id":18238,"vehicle_id":10,"route":[[127.13192746,37.44095207],[127.13197391,37.44096605],[127.1472308,37.4507538]],"timestamp":[592.2929543053866,592.3017256130414,595.7650275930712]},{"passenger_id":18235,"vehicle_id":45,"route":[[127.11009126,37.39622436],[127.11141968,37.39582443],[127.09996796,37.40533829]],"timestamp":[592.6617322536713,592.9127230812493,595.8401303993617]},{"passenger_id":21267,"vehicle_id":84,"route":[[127.11779785,37.36723328],[127.11620908,37.36758913],[127.12175451,37.38779563]],"timestamp":[593.1137965781974,593.4055443688732,598.0048842214364]},{"passenger_id":15398,"vehicle_id":68,"route":[[127.126245196036,37.4123039116538],[127.12606004,37.41240624],[127.09311223,37.41166697]],"timestamp":[593.655579728657,593.6954239098493,599.5176918747849]},{"passenger_id":10525,"vehicle_id":66,"route":[[127.10671997,37.35983276],[127.10686057,37.35991082],[127.0896239,37.3916429]],"timestamp":[593.685791138466,593.7161067396258,601.4023905578771]},{"passenger_id":10513,"vehicle_id":58,"route":[[127.22810745,37.39498579],[127.176342108449,37.4344954424403],[127.159367213568,37.4447314909709]],"timestamp":[593.2783897800272,605.9594095776243,609.7232055751563]},{"passenger_id":8594,"vehicle_id":31,"route":[[127.09506989,37.41156006],[127.10026212,37.42759663],[127.13331034,37.37288426]],"timestamp":[593.1024998993605,596.7848926078009,610.2806970390151]},{"passenger_id":21365,"vehicle_id":33,"route":[[127.11670865,37.33149708],[127.11556311,37.33967059],[127.11915111,37.3591086]],"timestamp":[593.700476212956,595.52943300532,599.8985405008277]},{"passenger_id":10566,"vehicle_id":3,"route":[[127.1051669,37.40464199],[127.10061685,37.40111316],[127.11188384,37.39623466]],"timestamp":[594,595.1233915222434,597.390426096228]},{"passenger_id":21357,"vehicle_id":92,"route":[[127.13122392,37.40313258],[127.12958466,37.40541323],[127.11346121,37.39622792]],"timestamp":[594,594.5840446847843,598.0892730599974]},{"passenger_id":13005,"vehicle_id":57,"route":[[127.16526294,37.46071847],[127.16588119,37.46020404],[127.13049825,37.44053314]],"timestamp":[594.6319011436767,594.7900129930108,602.4163390652759]},{"passenger_id":15374,"vehicle_id":40,"route":[[127.09816742,37.41278076],[127.1043103,37.42873646],[127.10262049,37.40318509]],"timestamp":[594.5139238965049,598.2244738123636,603.9146727529235]},{"passenger_id":10496,"vehicle_id":35,"route":[[127.11148071,37.39193344],[127.11155362004,37.391859592332],[127.099709249092,37.4122483565639]],"timestamp":[594.7970575058719,594.817930215752,599.8117217676621]},{"passenger_id":6030,"vehicle_id":55,"route":[[127.154253356321,37.4434926096725],[127.15353231,37.44344228],[127.14036618,37.46687889]],"timestamp":[594.545532100139,594.6733363129033,600.3801907232948]},{"passenger_id":921,"vehicle_id":24,"route":[[127.10598844,37.36099655],[127.10588837,37.36196518],[127.10861969,37.33982468]],"timestamp":[594.7476194061594,594.9637579018002,599.9111996611081]},{"passenger_id":6045,"vehicle_id":9,"route":[[127.13439941,37.47229385],[127.1270752,37.46752548],[127.14029694,37.46645737]],"timestamp":[594.7025215984416,596.3745714845554,598.7204205488936]},{"passenger_id":13073,"vehicle_id":69,"route":[[127.10283672,37.32853791],[127.10987549,37.35000915],[127.12031106,37.35394635]],"timestamp":[594.8005510794706,599.735060376818,601.7771335005448]},{"passenger_id":10569,"vehicle_id":51,"route":[[127.10602198,37.40136263],[127.1111145,37.39592361],[127.10118866,37.40209579]],"timestamp":[595,596.5075044710799,598.734451428262]},{"passenger_id":10497,"vehicle_id":97,"route":[[127.12389228,37.38872844],[127.12388473,37.3887351],[127.08141772,37.39181317]],"timestamp":[595.439392623863,595.4413859663722,602.9761547537058]},{"passenger_id":10481,"vehicle_id":95,"route":[[127.13690071,37.44049537],[127.137239572701,37.4397037440109],[127.137817346838,37.4322315674928]],"timestamp":[595.968716990552,596.1546569093878,597.8195222720375]},{"passenger_id":6058,"vehicle_id":10,"route":[[127.1472308,37.4507538],[127.14663437,37.45013928],[127.09289931,37.42834073]],"timestamp":[595.7650275930712,595.9375526758366,606.5926176096634]},{"passenger_id":13091,"vehicle_id":2,"route":[[127.11117641,37.38796988],[127.11288147,37.39005054],[127.1126951,37.37046302]],"timestamp":[595.4775742009623,596.0297293341874,600.3859195347653]},{"passenger_id":18224,"vehicle_id":0,"route":[[127.11173319,37.40323924],[127.11891287,37.40148936],[127.12178023,37.38777427]],"timestamp":[595.7909609182693,597.1177091860422,600.2095931733206]},{"passenger_id":18209,"vehicle_id":48,"route":[[127.04295726,37.50214456],[127.12638092,37.45362854],[127.12586975,37.43943024]],"timestamp":[595.4262048443621,613.6794912558415,616.8383386811041]},{"passenger_id":21331,"vehicle_id":91,"route":[[127.101045351818,37.4020234191022],[127.10977173,37.39407349],[127.10325623,37.4021225]],"timestamp":[595.5456058578363,597.891386891941,600.0195890638519]},{"passenger_id":21339,"vehicle_id":34,"route":[[127.09987404,37.40467097],[127.11075181,37.39376383],[127.12406782,37.38857284]],"timestamp":[595.1488415512038,598.2435151014004,600.8642830137092]},{"passenger_id":948,"vehicle_id":45,"route":[[127.09996796,37.40533829],[127.11109924,37.39396286],[127.09573364,37.40898132]],"timestamp":[595.8401303993617,599.0443750829883,603.3483557650341]},{"passenger_id":15420,"vehicle_id":8,"route":[[127.12652024,37.45984938],[127.12653089,37.44997742],[127.12692805,37.4123323]],"timestamp":[596.4220862579767,598.6175107991305,606.989697300121]},{"passenger_id":15388,"vehicle_id":6,"route":[[127.176669884197,37.4342537772514],[127.17568207,37.43451309],[127.16881561,37.44882202]],"timestamp":[596.61715461312,596.8008768244632,600.2061833001625]},{"passenger_id":13041,"vehicle_id":20,"route":[[127.12269877,37.38384965],[127.12289429,37.38393784],[127.14189148,37.40980148]],"timestamp":[596.8007643572531,596.8404927804894,603.499962983688]},{"passenger_id":18207,"vehicle_id":17,"route":[[127.12541962,37.38581467],[127.126342417409,37.3864735141023],[127.11039529341,37.3495292957214]],"timestamp":[596.1610160872051,596.3802349667088,605.0662782913245]},{"passenger_id":21317,"vehicle_id":1,"route":[[127.11225128,37.37191772],[127.11335503,37.37243654],[127.11176172,37.40214411]],"timestamp":[596.1835848121825,596.4102245003317,603.0228826543469]},{"passenger_id":950,"vehicle_id":7,"route":[[126.68227386,37.16508865],[127.07253265,37.38964081],[127.13530731,37.38031387]],"timestamp":[596.8924293308115,682.11578289141,693.4006526898825]},{"passenger_id":10605,"vehicle_id":93,"route":[[127.08715057,37.40491486],[127.08292486,37.39251059],[127.12033675,37.38631279]],"timestamp":[597,599.8578222844525,606.6104716163235]},{"passenger_id":21291,"vehicle_id":95,"route":[[127.137817346838,37.4322315674928],[127.13615795,37.43168832],[127.11148494,37.39623263]],"timestamp":[597.8195222720375,598.1364895367751,607.1457390573692]},{"passenger_id":10564,"vehicle_id":65,"route":[[126.96111193,37.39290045],[127.074903846654,37.3873318424623],[127.115223041755,37.3885846123479]],"timestamp":[597.1194702976566,617.26381208779,624.3935840647251]},{"passenger_id":10665,"vehicle_id":85,"route":[[127.10897262,37.28923179],[127.11351887,37.34507502],[126.89013349,37.40545299]],"timestamp":[597.0553486482349,609.5003191564773,651.1997703532799]},{"passenger_id":3513,"vehicle_id":44,"route":[[127.12689734,37.41233245],[127.1263781,37.41233385],[127.12021224,37.37326399]],"timestamp":[597.747994977108,597.83971440784,606.5964865509256]},{"passenger_id":3504,"vehicle_id":19,"route":[[127.1093697,37.3380875],[127.10913849,37.34881592],[127.11464691,37.38793945]],"timestamp":[597.0001544805248,599.3863964010217,608.141373599601]},{"passenger_id":8601,"vehicle_id":3,"route":[[127.11188384,37.39623466],[127.11304893,37.39377754],[127.09820456,37.41273321]],"timestamp":[597.390426096228,597.9743518340174,602.9390298086834]},{"passenger_id":18259,"vehicle_id":4,"route":[[127.109978,37.400937],[127.10861118,37.39621069],[127.12043188,37.38437676]],"timestamp":[597.9873842164437,599.06585027714,602.4256812901364]},{"passenger_id":18277,"vehicle_id":63,"route":[[127.11032867,37.40084457],[127.11109924,37.3959198],[127.09425354,37.38668823]],"timestamp":[598,599.1036477302666,602.7194766740279]},{"passenger_id":10545,"vehicle_id":9,"route":[[127.14029694,37.46645737],[127.14607282,37.4642639],[127.0948693,37.41120894]],"timestamp":[598.7204205488936,599.8506421903011,614.7154798072394]},{"passenger_id":23726,"vehicle_id":46,"route":[[127.01645721,37.48469664],[127.096451,37.429506],[127.126922,37.46262]],"timestamp":[598.3798572406963,617.0900062476317,626.2100954103686]},{"passenger_id":21354,"vehicle_id":62,"route":[[127.129053512175,37.431514905242],[127.12931553,37.43156786],[127.13839718,37.44731687]],"timestamp":[598.305206856493,598.3529531247625,602.2050310848956]},{"passenger_id":21352,"vehicle_id":74,"route":[[127.09810473,37.41274464],[127.10085235,37.42934107],[127.11072476,37.39388685]],"timestamp":[598.5339364886805,602.256580606844,610.331788456812]},{"passenger_id":18204,"vehicle_id":86,"route":[[127.13169173,37.44108252],[127.13149023,37.44151875],[127.13662846,37.44782281]],"timestamp":[598.361092076201,598.4644237510224,600.1343196738736]},{"passenger_id":18264,"vehicle_id":88,"route":[[127.16806038,37.44088234],[127.16967792,37.44155734],[127.14374542,37.44128772]],"timestamp":[598.7848699765583,599.10752895764,603.6868762419385]},{"passenger_id":3496,"vehicle_id":92,"route":[[127.11346121,37.39622792],[127.11188507,37.39196014],[127.09490967,37.41124344]],"timestamp":[598.0892730599974,599.0783947613693,604.3113974220769]},{"passenger_id":15463,"vehicle_id":28,"route":[[127.16870279,37.44899854],[127.16936218,37.44714287],[127.14213101,37.41344826]],"timestamp":[598.4253410312879,598.8541301179736,607.7578600549415]},{"passenger_id":18258,"vehicle_id":84,"route":[[127.12175451,37.38779563],[127.12225479,37.38776223],[127.1295236,37.41214853]],"timestamp":[598.0048842214364,598.0935944933063,603.6668276524847]},{"passenger_id":13086,"vehicle_id":42,"route":[[127.12738485,37.45916328],[127.12679839,37.44955],[127.12712557,37.45946084]],"timestamp":[598.2084202159109,600.3488216745429,602.5536486486913]},{"passenger_id":21389,"vehicle_id":51,"route":[[127.10118866,37.40209579],[127.09305573,37.39870453],[127.12498474,37.41228867]],"timestamp":[598.734451428262,600.3571914418068,606.7557274865446]}]'),mA=JSON.parse('[{"passenger_id":23594,"location":[127.12106,37.372699],"timestamp":[420,421.68292698503427]},{"passenger_id":14954,"location":[127.16778685,37.46143317],"timestamp":[420,420.41013744262955]},{"passenger_id":17607,"location":[127.13710277,37.44693516],"timestamp":[420,420.0052186695423]},{"passenger_id":14959,"location":[127.1422348,37.41281509],"timestamp":[420,420.9422832197536]},{"passenger_id":20721,"location":[127.119448015473,37.3736347037785],"timestamp":[420,421.63349605661676]},{"passenger_id":14960,"location":[127.11643219,37.35129166],"timestamp":[420,422.90060444614096]},{"passenger_id":14961,"location":[127.13217826,37.41132712],"timestamp":[420,420.63080033221655]},{"passenger_id":12623,"location":[127.10900983,37.35069467],"timestamp":[420,421.6257952982935]},{"passenger_id":12640,"location":[127.17330536,37.45001209],"timestamp":[420,421.53790893779154]},{"passenger_id":3243,"location":[127.11683062,37.3902932],"timestamp":[420,420.61697956828135]},{"passenger_id":10078,"location":[127.10808809,37.36630563],"timestamp":[421,421.1303860025564]},{"passenger_id":8308,"location":[127.16240248,37.44542298],"timestamp":[421,421.8998772931596]},{"passenger_id":20728,"location":[127.13671776,37.44479346],"timestamp":[421,421.2909391394296]},{"passenger_id":5815,"location":[127.14125924,37.44664372],"timestamp":[421,421.434067614624]},{"passenger_id":3242,"location":[127.12550421,37.38906743],"timestamp":[421,421.6675826649658]},{"passenger_id":5814,"location":[127.12668122,37.38442613],"timestamp":[421,421.74652853933236]},{"passenger_id":5813,"location":[127.1686554,37.43284988],"timestamp":[421,421.7591621156798]},{"passenger_id":5812,"location":[127.16299343,37.43299856],"timestamp":[421,422.0070947368048]},{"passenger_id":20748,"location":[127.15910339,37.43413544],"timestamp":[421,422.07322625884945]},{"passenger_id":8301,"location":[127.11557117,37.40402148],"timestamp":[422,423.8725765373196]},{"passenger_id":14966,"location":[127.16911651,37.45157531],"timestamp":[422,422.9260211694026]},{"passenger_id":10085,"location":[127.16891423,37.43272851],"timestamp":[422,424.08319539970347]},{"passenger_id":10087,"location":[127.14325823,37.36790868],"timestamp":[422,422.3133823636682]},{"passenger_id":10103,"location":[127.10993958,37.39393616],"timestamp":[422,422.50497027870597]},{"passenger_id":768,"location":[127.14405956,37.44494685],"timestamp":[422,422.3978119108407]},{"passenger_id":12616,"location":[127.12828522,37.40186392],"timestamp":[422,422.88010267254725]},{"passenger_id":3253,"location":[127.1320016,37.42906963],"timestamp":[423,423.28554420660436]},{"passenger_id":17615,"location":[127.112795279017,37.3909595978314],"timestamp":[423,423.0506081167957]},{"passenger_id":17620,"location":[127.14019012,37.44792938],"timestamp":[423,423.2951034065938]},{"passenger_id":10079,"location":[127.1735976,37.43447031],"timestamp":[423,425.5237046254066]},{"passenger_id":17612,"location":[127.14019179,37.44111994],"timestamp":[423,423.76013113653147]},{"passenger_id":12620,"location":[127.12457443,37.4395055],"timestamp":[423,423.3647139600724]},{"passenger_id":764,"location":[127.10968993,37.394272],"timestamp":[423,423.74471481294336]},{"passenger_id":20726,"location":[127.12307739,37.3598938],"timestamp":[423,426.49574122340425]},{"passenger_id":20722,"location":[127.08985138,37.38970566],"timestamp":[423,423.1493921300724]},{"passenger_id":3244,"location":[127.11394501,37.37867737],"timestamp":[423,424.42097267171897]},{"passenger_id":14972,"location":[127.16542809,37.43929386],"timestamp":[423,423.8752242308391]},{"passenger_id":20733,"location":[127.15951538,37.44560623],"timestamp":[424,425.606521111125]},{"passenger_id":17611,"location":[127.13081971,37.38494991],"timestamp":[424,424.5333936856223]},{"passenger_id":8302,"location":[127.11794124,37.40393636],"timestamp":[424,426.0088935292879]},{"passenger_id":20745,"location":[127.13280908,37.47316821],"timestamp":[424,425.62152753355247]},{"passenger_id":5824,"location":[127.1118927,37.37540054],"timestamp":[424,426.052414030097]},{"passenger_id":772,"location":[127.1332634,37.4377006],"timestamp":[424,424.91305973921123]},{"passenger_id":3273,"location":[127.16413879,37.446064],"timestamp":[424,424.9132023774285]},{"passenger_id":10082,"location":[127.141225659199,37.4465370355328],"timestamp":[424,424.8537503100128]},{"passenger_id":5835,"location":[127.11373138,37.39999771],"timestamp":[424,425.82989593371065]},{"passenger_id":3258,"location":[127.11484528,37.36503601],"timestamp":[424,427.9132632100423]},{"passenger_id":8305,"location":[127.15876216,37.4141573],"timestamp":[425,425.58321301121794]},{"passenger_id":770,"location":[127.16346309,37.41164985],"timestamp":[425,427.2565778084252]},{"passenger_id":14957,"location":[127.14400085,37.44490506],"timestamp":[425,426.0406783349047]},{"passenger_id":20900,"location":[127.12856777,37.3973078],"timestamp":[425,425.9373621666086]},{"passenger_id":12618,"location":[127.13811493,37.3703804],"timestamp":[425,425.8569875428261]},{"passenger_id":784,"location":[127.16012573,37.45177841],"timestamp":[425,425.92925428490423]},{"passenger_id":14958,"location":[127.15968323,37.43771744],"timestamp":[425,425.75185068972377]},{"passenger_id":14974,"location":[127.15966152,37.44204225],"timestamp":[426,428.7883179700916]},{"passenger_id":8313,"location":[127.14335632,37.4420166],"timestamp":[426,426.99034139954534]},{"passenger_id":8309,"location":[127.125853531548,37.3868762894183],"timestamp":[426,427.2559360438666]},{"passenger_id":14965,"location":[127.07207886,37.39313555],"timestamp":[426,429.98370262431433]},{"passenger_id":12627,"location":[127.10970106,37.39327079],"timestamp":[426,426.8241388096301]},{"passenger_id":14980,"location":[127.11093903,37.39599228],"timestamp":[426,426.07020766230244]},{"passenger_id":3262,"location":[127.11164856,37.34503555],"timestamp":[426,429.55978952243345]},{"passenger_id":10091,"location":[127.15009308,37.42837906],"timestamp":[426,426.32923186509845]},{"passenger_id":20727,"location":[127.09847476,37.41268552],"timestamp":[426,426.25699391498114]},{"passenger_id":3254,"location":[127.14304352,37.40972519],"timestamp":[427,428.4128404019148]},{"passenger_id":12628,"location":[127.1432255,37.37178511],"timestamp":[427,429.7562868856846]},{"passenger_id":17642,"location":[127.11744594,37.33505464],"timestamp":[427,436.32015438691224]},{"passenger_id":20753,"location":[127.16979645,37.45610614],"timestamp":[427,427.2985738051654]},{"passenger_id":17638,"location":[127.113720273013,37.3642208725013],"timestamp":[427,430.06133264901683]},{"passenger_id":17628,"location":[127.14222424,37.43836985],"timestamp":[427,427.3817970619079]},{"passenger_id":17624,"location":[127.10598266,37.36255728],"timestamp":[427,432.4961757042362]},{"passenger_id":20823,"location":[127.1107065,37.3971795],"timestamp":[427,427.73911506315613]},{"passenger_id":20731,"location":[127.11745453,37.33566284],"timestamp":[427,433.71208082396004]},{"passenger_id":14968,"location":[127.10664368,37.35992813],"timestamp":[427,431.39764716900686]},{"passenger_id":8312,"location":[127.14152527,37.36875916],"timestamp":[427,427.73469419388863]},{"passenger_id":14953,"location":[127.13929354,37.43866253],"timestamp":[427,428.8490946530588]},{"passenger_id":3247,"location":[127.11440265,37.37182444],"timestamp":[427,430.050575592327]},{"passenger_id":3245,"location":[127.1149292,37.36895752],"timestamp":[427,430.97914820222417]},{"passenger_id":769,"location":[127.11309814,37.38931656],"timestamp":[427,428.59920715060315]},{"passenger_id":20742,"location":[127.13336954,37.44137874],"timestamp":[428,429.06761881131814]},{"passenger_id":5827,"location":[127.13437946,37.44590022],"timestamp":[428,428.8056130158532]},{"passenger_id":3248,"location":[127.13832092,37.37543869],"timestamp":[428,431.16246021427014]},{"passenger_id":12613,"location":[127.13797083,37.44719298],"timestamp":[428,428.79398153942316]},{"passenger_id":23598,"location":[127.146303,37.428546],"timestamp":[428,428.44880064658435]},{"passenger_id":3312,"location":[127.13249826,37.40888438],"timestamp":[428,429.1416074028302]},{"passenger_id":12624,"location":[127.151772815897,37.4139650125179],"timestamp":[428,430.8527683787517]},{"passenger_id":20743,"location":[127.146950623159,37.3697430608163],"timestamp":[428,433.1628684082613]},{"passenger_id":783,"location":[127.05856323,37.39274597],"timestamp":[428,431.9939799067834]},{"passenger_id":8314,"location":[127.14238019,37.43845977],"timestamp":[428,430.069533488784]},{"passenger_id":10084,"location":[127.13793182,37.44721222],"timestamp":[428,429.97799752852274]},{"passenger_id":20757,"location":[127.14723969,37.429039],"timestamp":[429,430.77129739772033]},{"passenger_id":12614,"location":[127.12910155,37.41234146],"timestamp":[429,430.47426815546123]},{"passenger_id":14991,"location":[127.16288822,37.44507844],"timestamp":[429,431.40782244252216]},{"passenger_id":14979,"location":[127.12322506,37.38225413],"timestamp":[429,431.5653695268348]},{"passenger_id":12632,"location":[127.13044771,37.44051937],"timestamp":[429,429.3658871532822]},{"passenger_id":23595,"location":[127.126688,37.383875],"timestamp":[429,431.13603516955783]},{"passenger_id":23605,"location":[127.16994473,37.46151175],"timestamp":[429,429.87585247126907]},{"passenger_id":5823,"location":[127.15007019,37.42834091],"timestamp":[429,430.41660646390784]},{"passenger_id":17627,"location":[127.12851847,37.43628522],"timestamp":[429,429.53735894369703]},{"passenger_id":8311,"location":[127.12791724,37.40633461],"timestamp":[429,431.1260464182418]},{"passenger_id":15075,"location":[127.11206111,37.39179174],"timestamp":[429,429.89490674012217]},{"passenger_id":12644,"location":[127.15884803,37.43701248],"timestamp":[429,430.99554231575223]},{"passenger_id":766,"location":[127.132164,37.441185],"timestamp":[429,429.88589545459376]},{"passenger_id":17625,"location":[127.16853765,37.44484011],"timestamp":[430,432.1959132566831]},{"passenger_id":14978,"location":[127.13449097,37.43379974],"timestamp":[430,431.2968886404702]},{"passenger_id":775,"location":[127.13002014,37.43293381],"timestamp":[430,430.20640324936664]},{"passenger_id":776,"location":[127.13996124,37.44338989],"timestamp":[430,432.18795964759613]},{"passenger_id":23597,"location":[127.125133,37.440159],"timestamp":[430,430.8242819795653]},{"passenger_id":12637,"location":[127.16459849,37.45825922],"timestamp":[430,430.16651627762764]},{"passenger_id":23596,"location":[127.159573,37.450426],"timestamp":[430,431.6161298487591]},{"passenger_id":10080,"location":[127.1168314,37.39032965],"timestamp":[430,433.4528918894434]},{"passenger_id":8310,"location":[127.12413025,37.38896561],"timestamp":[430,434.78766762351097]},{"passenger_id":12612,"location":[127.15818787,37.43616867],"timestamp":[430,434.06879196303305]},{"passenger_id":8319,"location":[127.0887888,37.40742544],"timestamp":[430,431.7126073707172]},{"passenger_id":17626,"location":[127.11392544,37.40070713],"timestamp":[431,433.3153217695037]},{"passenger_id":10093,"location":[127.1505127,37.41568756],"timestamp":[431,436.86666080383566]},{"passenger_id":5880,"location":[127.13145447,37.4071846],"timestamp":[431,432.32426627077353]},{"passenger_id":5822,"location":[127.16532616,37.44221829],"timestamp":[431,434.520792510531]},{"passenger_id":14962,"location":[127.14352481,37.43909919],"timestamp":[431,434.5808309217201]},{"passenger_id":20741,"location":[127.13634569,37.43130214],"timestamp":[431,432.0765625201759]},{"passenger_id":5820,"location":[127.12900543,37.43166733],"timestamp":[431,431.8495878190823]},{"passenger_id":17650,"location":[127.16600544,37.43801427],"timestamp":[431,435.87141852777813]},{"passenger_id":10088,"location":[127.13378524,37.37361929],"timestamp":[431,434.6226108688178]},{"passenger_id":5819,"location":[127.09382386,37.38258968],"timestamp":[432,435.2998803429315]},{"passenger_id":14983,"location":[127.12541962,37.38759613],"timestamp":[432,436.9902983593314]},{"passenger_id":8307,"location":[127.1289292,37.4324143],"timestamp":[432,432.25683960291485]},{"passenger_id":774,"location":[127.11080933,37.39189529],"timestamp":[432,437.21871968560424]},{"passenger_id":20776,"location":[127.11323157,37.34596216],"timestamp":[432,436.95947195218713]},{"passenger_id":10086,"location":[127.14352537,37.43909952],"timestamp":[432,433.58987511682454]},{"passenger_id":12657,"location":[127.13310242,37.44586945],"timestamp":[432,435.66490613529237]},{"passenger_id":20827,"location":[127.11063385,37.39762115],"timestamp":[432,434.14824848520595]},{"passenger_id":20734,"location":[127.10739136,37.3560791],"timestamp":[432,434.39730113156196]},{"passenger_id":3250,"location":[127.14833069,37.42788696],"timestamp":[432,436.9162973280492]},{"passenger_id":20737,"location":[127.17472909,37.43126787],"timestamp":[432,441.86399963480073]},{"passenger_id":20739,"location":[127.14011251,37.43558979],"timestamp":[432,434.19712055787323]},{"passenger_id":8317,"location":[127.10991406,37.34694998],"timestamp":[432,436.4606847112445]},{"passenger_id":20744,"location":[127.163372744414,37.4573008585225],"timestamp":[432,436.82422863619934]},{"passenger_id":5828,"location":[127.11553955,37.39622116],"timestamp":[432,438.2134898939943]},{"passenger_id":17623,"location":[127.14299011,37.43312454],"timestamp":[433,439.04200941402763]},{"passenger_id":773,"location":[127.13555908,37.45013809],"timestamp":[433,435.6146769880094]},{"passenger_id":17660,"location":[127.16366106,37.4440001],"timestamp":[433,442.41853978851464]},{"passenger_id":17643,"location":[127.15956879,37.44491577],"timestamp":[433,433.1182541058607]},{"passenger_id":10102,"location":[127.11831988,37.33973423],"timestamp":[433,443.7632484560419]},{"passenger_id":788,"location":[127.14546204,37.47278976],"timestamp":[433,436.31901409584793]},{"passenger_id":12631,"location":[127.15059662,37.43947601],"timestamp":[433,437.0491823225436]},{"passenger_id":10090,"location":[127.1289444,37.43222427],"timestamp":[433,438.3625887983864]},{"passenger_id":20738,"location":[127.11019135,37.35005188],"timestamp":[433,444.1087117445999]},{"passenger_id":20735,"location":[127.1417139,37.46439754],"timestamp":[433,440.5254376039205]},{"passenger_id":12638,"location":[127.11819701,37.40158741],"timestamp":[434,437.087713946271]},{"passenger_id":17652,"location":[127.13245168,37.44354325],"timestamp":[434,436.87630334412637]},{"passenger_id":14973,"location":[127.13265953,37.44561729],"timestamp":[434,446.03706053201125]},{"passenger_id":778,"location":[127.10654579,37.37244158],"timestamp":[434,440.9714143356458]},{"passenger_id":14970,"location":[127.16539217623,37.4373037586143],"timestamp":[434,444.8415108349406]},{"passenger_id":10095,"location":[127.12667251,37.44063287],"timestamp":[434,440.2217039445779]},{"passenger_id":10100,"location":[127.11379613,37.40651551],"timestamp":[434,436.09402057113107]},{"passenger_id":15020,"location":[127.11330414,37.36051941],"timestamp":[434,437.1162150628271]},{"passenger_id":20758,"location":[127.10808809,37.36627078],"timestamp":[434,435.4936913043479]},{"passenger_id":5825,"location":[127.16164398,37.4353981],"timestamp":[434,435.8442077889222]},{"passenger_id":12630,"location":[127.11068206,37.39376212],"timestamp":[435,435.4394580617871]},{"passenger_id":5840,"location":[127.1138382,37.40037155],"timestamp":[435,437.1806777915093]},{"passenger_id":12642,"location":[127.1272535,37.45649598],"timestamp":[434,442.1390781796499]},{"passenger_id":15001,"location":[127.14385709,37.43765201],"timestamp":[435,436.7190571312659]},{"passenger_id":17630,"location":[127.13535789,37.44641458],"timestamp":[435,436.9966874863107]},{"passenger_id":23601,"location":[127.138302,37.438038],"timestamp":[435,437.16938754109145]},{"passenger_id":23602,"location":[127.159979,37.451672],"timestamp":[435,437.5459338942694]},{"passenger_id":12634,"location":[127.11089325,37.39605331],"timestamp":[435,435.9273816482035]},{"passenger_id":15027,"location":[127.1434278,37.43803266],"timestamp":[435,435.93724068410165]},{"passenger_id":20766,"location":[127.13728333,37.44698715],"timestamp":[436,438.9999797164279]},{"passenger_id":3251,"location":[127.12346235,37.38876605],"timestamp":[436,442.3570321094981]},{"passenger_id":17631,"location":[127.10733032,37.34050751],"timestamp":[436,439.76254169625236]},{"passenger_id":20751,"location":[127.16594239,37.45062542],"timestamp":[435,441.53716373341433]},{"passenger_id":3255,"location":[127.11276245,37.39027786],"timestamp":[435,440.0614478410775]},{"passenger_id":17636,"location":[127.1284678,37.37794358],"timestamp":[435,439.1229913270251]},{"passenger_id":14989,"location":[127.16570282,37.45504761],"timestamp":[436,441.4023901415429]},{"passenger_id":17645,"location":[127.10102844,37.43096161],"timestamp":[436,442.8216666038606]},{"passenger_id":23604,"location":[127.113418,37.390283],"timestamp":[437,439.84303869206985]},{"passenger_id":23600,"location":[127.117835,37.39106],"timestamp":[437,441.42060599868574]},{"passenger_id":3260,"location":[127.12609863,37.38847351],"timestamp":[437,441.74610811511934]},{"passenger_id":3263,"location":[127.10706329,37.36849976],"timestamp":[437,437.42632899804653]},{"passenger_id":20749,"location":[127.12935638,37.43124771],"timestamp":[437,441.06456990195915]},{"passenger_id":17629,"location":[127.15039717,37.44203092],"timestamp":[437,437.7531943259745]},{"passenger_id":17622,"location":[127.16331735,37.4571524],"timestamp":[435,438.41533131124817]},{"passenger_id":14976,"location":[127.11145522,37.39177306],"timestamp":[438,440.9083600217789]},{"passenger_id":20761,"location":[127.10871124,37.34992218],"timestamp":[438,438.17190394948335]},{"passenger_id":3266,"location":[127.1220932,37.36859894],"timestamp":[438,441.85593951351996]},{"passenger_id":17661,"location":[127.16764832,37.45623016],"timestamp":[434,443.2231466961246]},{"passenger_id":797,"location":[127.13617194,37.37845351],"timestamp":[435,441.1794930496685]},{"passenger_id":17634,"location":[127.163686631359,37.4572008591335],"timestamp":[438,439.89533933500786]},{"passenger_id":782,"location":[127.12862374,37.41137295],"timestamp":[438,438.8176669035093]},{"passenger_id":20769,"location":[127.12913513,37.44464111],"timestamp":[438,443.07414373421017]},{"passenger_id":14977,"location":[127.15819274,37.43784989],"timestamp":[438,441.0635102053891]},{"passenger_id":20760,"location":[127.12973785,37.43293381],"timestamp":[439,440.43635564074424]},{"passenger_id":781,"location":[127.11226654,37.39724731],"timestamp":[439,441.4880363057607]},{"passenger_id":14990,"location":[127.07764319,37.39153936],"timestamp":[437,444.73213686356513]},{"passenger_id":15026,"location":[127.12116664,37.40544586],"timestamp":[438,442.4017778645654]},{"passenger_id":8321,"location":[127.12891151,37.41234861],"timestamp":[438,440.2540803922655]},{"passenger_id":17678,"location":[127.12892495,37.43244983],"timestamp":[439,439.7269968489013]},{"passenger_id":17654,"location":[127.14124061,37.46283423],"timestamp":[439,443.16867019341237]},{"passenger_id":10108,"location":[127.12818841,37.43663612],"timestamp":[440,440.67264299427603]},{"passenger_id":17633,"location":[127.11781062,37.37397914],"timestamp":[440,441.2983093027871]},{"passenger_id":17653,"location":[127.12333565,37.40037646],"timestamp":[440,441.1473874653765]},{"passenger_id":17684,"location":[127.11031755,37.3973965],"timestamp":[440,442.4141036198606]},{"passenger_id":12648,"location":[127.13843402,37.44413124],"timestamp":[440,440.0081096387971]},{"passenger_id":12654,"location":[127.11224365,37.35535431],"timestamp":[440,442.1269213234312]},{"passenger_id":10098,"location":[127.11683136,37.39032763],"timestamp":[440,441.7659447003137]},{"passenger_id":20754,"location":[127.13680979,37.44069816],"timestamp":[440,441.8895041767729]},{"passenger_id":17641,"location":[127.10596311,37.37293067],"timestamp":[435,442.0129630282136]},{"passenger_id":17639,"location":[127.16282552528,37.4119205805524],"timestamp":[438,442.69491277124797]},{"passenger_id":14975,"location":[127.14717314,37.4358307],"timestamp":[438,440.83084915337275]},{"passenger_id":840,"location":[127.12864866,37.413126],"timestamp":[439,445.5014916987222]},{"passenger_id":20752,"location":[127.16801453,37.44072723],"timestamp":[440,456.0030881268088]},{"passenger_id":3281,"location":[127.12426758,37.44061661],"timestamp":[440,442.65136995805796]},{"passenger_id":12636,"location":[127.11694594,37.39057372],"timestamp":[441,444.0613605584471]},{"passenger_id":15012,"location":[127.13082123,37.44296265],"timestamp":[441,443.1897669682357]},{"passenger_id":17657,"location":[127.10645087356,37.3684402911705],"timestamp":[435,447.1762939221624]},{"passenger_id":20771,"location":[127.14725008,37.44371164],"timestamp":[438,443.02572123217163]},{"passenger_id":20750,"location":[127.1362381,37.44670868],"timestamp":[439,442.26419128088855]},{"passenger_id":3275,"location":[127.13086408,37.38459972],"timestamp":[441,446.84034366811807]},{"passenger_id":5837,"location":[127.12740326,37.41595459],"timestamp":[441,445.0162184658253]},{"passenger_id":8325,"location":[127.122734106399,37.387204065204],"timestamp":[442,442.2185301160918]},{"passenger_id":5833,"location":[127.10432434,37.38063431],"timestamp":[442,445.88570069996985]},{"passenger_id":5830,"location":[127.11785366,37.36855713],"timestamp":[436,447.32735761067715]},{"passenger_id":3272,"location":[127.1059837,37.36238898],"timestamp":[438,442.8007083847668]},{"passenger_id":20770,"location":[127.10808809,37.36624883],"timestamp":[440,442.6214985820933]},{"passenger_id":20755,"location":[127.1326485,37.43889549],"timestamp":[442,451.2221346555701]},{"passenger_id":10117,"location":[127.11348659,37.34592551],"timestamp":[443,453.1055848209974]},{"passenger_id":23607,"location":[127.13177122,37.40912308],"timestamp":[443,446.97809415412456]},{"passenger_id":10113,"location":[127.12831971,37.41232266],"timestamp":[443,445.75114689840285]},{"passenger_id":5834,"location":[127.16113014,37.41224287],"timestamp":[443,460.2897003023611]},{"passenger_id":20783,"location":[127.13813723,37.43460823],"timestamp":[443,443.74585814174924]},{"passenger_id":8318,"location":[127.11110672,37.37641835],"timestamp":[443,448.5966059747119]},{"passenger_id":15155,"location":[127.14326779,37.42732334],"timestamp":[443,447.64016323798944]},{"passenger_id":3265,"location":[127.14549145,37.43993325],"timestamp":[439,445.0145952856375]},{"passenger_id":780,"location":[127.15856171,37.45863724],"timestamp":[441,444.2128829314733]},{"passenger_id":10123,"location":[127.12936401,37.44610596],"timestamp":[441,444.49285595572206]},{"passenger_id":20775,"location":[127.12308543,37.36118486],"timestamp":[441,445.76774308163215]},{"passenger_id":8320,"location":[127.10811024,37.36249518],"timestamp":[443,444.72614828257076]},{"passenger_id":14985,"location":[127.14564914,37.44024474],"timestamp":[443,444.88827268001955]},{"passenger_id":12643,"location":[127.169567150392,37.4373009808456],"timestamp":[443,444.3009652068624]},{"passenger_id":17648,"location":[127.15581946,37.44420767],"timestamp":[443,443.99758903323556]},{"passenger_id":3276,"location":[127.1080423,37.37176187],"timestamp":[444,445.16679800751723]},{"passenger_id":786,"location":[127.10944366,37.40407181],"timestamp":[444,445.23655831858446]},{"passenger_id":12646,"location":[127.07786029,37.39152319],"timestamp":[444,447.6220262398217]},{"passenger_id":8328,"location":[127.13180673,37.42029131],"timestamp":[444,445.8654730092591]},{"passenger_id":17632,"location":[127.133725,37.44955307],"timestamp":[435,453.7103473266312]},{"passenger_id":20873,"location":[127.17035351,37.45179882],"timestamp":[442,457.4914732341359]},{"passenger_id":12665,"location":[127.12160714,37.40057155],"timestamp":[444,446.6401063630042]},{"passenger_id":20774,"location":[127.1292164,37.43226407],"timestamp":[444,444.28642273556994]},{"passenger_id":20765,"location":[127.16481358,37.43514018],"timestamp":[445,445.27223965591605]},{"passenger_id":20767,"location":[127.14094533,37.44805932],"timestamp":[445,445.9034601735904]},{"passenger_id":17656,"location":[127.1230066,37.35150788],"timestamp":[445,449.92968862741753]},{"passenger_id":12653,"location":[127.10971069,37.39333344],"timestamp":[445,447.6772680670264]},{"passenger_id":15032,"location":[127.17134669,37.44822289],"timestamp":[445,446.65810304507943]},{"passenger_id":20756,"location":[127.11490631,37.36896515],"timestamp":[445,447.16938771708107]},{"passenger_id":10128,"location":[127.1640625,37.43300629],"timestamp":[443,457.45411879081416]},{"passenger_id":10099,"location":[127.16932563,37.45787507],"timestamp":[445,446.3112811376638]},{"passenger_id":14988,"location":[127.13378906,37.40826416],"timestamp":[446,447.5594772450639]},{"passenger_id":3279,"location":[127.11075365,37.39165739],"timestamp":[446,447.0186858687568]},{"passenger_id":20803,"location":[127.11112213,37.35339737],"timestamp":[446,448.2900483158821]},{"passenger_id":8322,"location":[127.10901079,37.35066496],"timestamp":[442,449.023323229824]},{"passenger_id":15010,"location":[127.16408551,37.44150506],"timestamp":[443,448.1064364937115]},{"passenger_id":15048,"location":[127.09236145,37.38770676],"timestamp":[445,449.78262254204293]},{"passenger_id":12647,"location":[127.12407159,37.38856943],"timestamp":[446,448.8795639095093]},{"passenger_id":20768,"location":[127.16599344,37.43745176],"timestamp":[446,448.32552207622433]},{"passenger_id":20820,"location":[127.14055634,37.4515686],"timestamp":[446,449.3378180417272]},{"passenger_id":3268,"location":[127.11226654,37.39705276],"timestamp":[447,448.3087078746791]},{"passenger_id":17669,"location":[127.13007888,37.41542461],"timestamp":[447,447.97952828121305]},{"passenger_id":23606,"location":[127.163282,37.433502],"timestamp":[447,448.401071030622]},{"passenger_id":20780,"location":[127.16191735,37.45688759],"timestamp":[443,447.73723329332813]},{"passenger_id":12649,"location":[127.15818787,37.43603897],"timestamp":[443,448.1741299009532]},{"passenger_id":14995,"location":[127.16248322,37.44045258],"timestamp":[443,449.972280783002]},{"passenger_id":10096,"location":[127.10732736,37.35551544],"timestamp":[443,449.35897712739103]},{"passenger_id":5868,"location":[127.16172791,37.43335724],"timestamp":[444,449.9717355715514]},{"passenger_id":12667,"location":[127.13377814,37.43374007],"timestamp":[445,448.9894576631369]},{"passenger_id":10142,"location":[127.12743378,37.40312576],"timestamp":[448,451.48749146346165]},{"passenger_id":10110,"location":[127.11745118,37.362559],"timestamp":[439,451.1209740264469]},{"passenger_id":8347,"location":[127.12944965,37.36476513],"timestamp":[443,452.1445939769463]},{"passenger_id":17698,"location":[127.14901733,37.45196152],"timestamp":[444,449.01372757227307]},{"passenger_id":790,"location":[127.11825321,37.36244813],"timestamp":[444,449.4298692561651]},{"passenger_id":17658,"location":[127.15248393,37.42848505],"timestamp":[448,449.46773148972386]},{"passenger_id":15007,"location":[127.1304893,37.41380041],"timestamp":[449,450.30940611834103]},{"passenger_id":5857,"location":[127.11437225,37.39826202],"timestamp":[448,451.4090841016715]},{"passenger_id":23611,"location":[127.110675847714,37.393929024122],"timestamp":[449,449.25039202166363]},{"passenger_id":12650,"location":[127.11658392,37.34564181],"timestamp":[450,458.6052826713627]},{"passenger_id":10138,"location":[127.16049194,37.44486618],"timestamp":[450,450.60059438833815]},{"passenger_id":23603,"location":[127.163466,37.450937],"timestamp":[440,451.01968827978794]},{"passenger_id":12749,"location":[127.16263324,37.44549915],"timestamp":[447,451.61390989329806]},{"passenger_id":17688,"location":[127.16795349,37.44268799],"timestamp":[449,452.00650330008153]},{"passenger_id":12660,"location":[127.16259766,37.43319321],"timestamp":[450,453.51560712779826]},{"passenger_id":20777,"location":[127.17233276,37.44781113],"timestamp":[451,451.3211352914641]},{"passenger_id":5845,"location":[127.12286377,37.40761948],"timestamp":[451,451.93782264149485]},{"passenger_id":5843,"location":[127.10723967,37.37609618],"timestamp":[451,451.22278902857]},{"passenger_id":5838,"location":[127.16596938,37.43651508],"timestamp":[451,451.2099919659058]},{"passenger_id":12680,"location":[127.12998179,37.38238572],"timestamp":[451,452.2248439217222]},{"passenger_id":829,"location":[127.10919207,37.40397623],"timestamp":[451,453.72399563406833]},{"passenger_id":3274,"location":[127.10598301,37.36249953],"timestamp":[447,452.9879737806703]},{"passenger_id":10133,"location":[127.16553971,37.44732683],"timestamp":[447,451.9865308324206]},{"passenger_id":20791,"location":[127.17514638,37.44962721],"timestamp":[448,452.9048281014451]},{"passenger_id":8332,"location":[127.11094666,37.39632797],"timestamp":[448,452.9220395783621]},{"passenger_id":12663,"location":[127.16940616,37.44469134],"timestamp":[449,453.50705597256945]},{"passenger_id":23610,"location":[127.1190033,37.37440872],"timestamp":[450,451.9946512313203]},{"passenger_id":8330,"location":[127.12822308,37.38080818],"timestamp":[450,452.3920963370215]},{"passenger_id":17651,"location":[127.12089539,37.3393898],"timestamp":[450,469.2200605118701]},{"passenger_id":8341,"location":[127.1319338,37.41369433],"timestamp":[452,452.8248186346067]},{"passenger_id":785,"location":[127.15820312,37.4483757],"timestamp":[443,453.52426734836166]},{"passenger_id":8382,"location":[127.12297055,37.35150788],"timestamp":[450,457.51135251410835]},{"passenger_id":12668,"location":[127.10968537,37.39453428],"timestamp":[450,453.4446211305839]},{"passenger_id":20801,"location":[127.167139387475,37.4108705869664],"timestamp":[450,459.62603220730125]},{"passenger_id":20788,"location":[127.11869049,37.37023544],"timestamp":[450,453.06836757950236]},{"passenger_id":20821,"location":[127.11632313,37.34990795],"timestamp":[451,453.4406647447699]},{"passenger_id":23660,"location":[127.1173258,37.4026682],"timestamp":[451,455.03967806465107]},{"passenger_id":20778,"location":[127.16025543,37.43350983],"timestamp":[452,452.7339161865596]},{"passenger_id":8334,"location":[127.15033387,37.44177217],"timestamp":[452,454.15187159081427]},{"passenger_id":10122,"location":[127.12418365,37.38863754],"timestamp":[452,452.2428276647201]},{"passenger_id":17716,"location":[127.09582492,37.39404326],"timestamp":[452,454.6289172501701]},{"passenger_id":12658,"location":[127.11670915,37.40368518],"timestamp":[453,455.6995280916772]},{"passenger_id":3311,"location":[127.14628601,37.40826416],"timestamp":[453,454.6786784185166]},{"passenger_id":17665,"location":[127.16651035,37.44267289],"timestamp":[453,454.7304954139268]},{"passenger_id":17670,"location":[127.11172458,37.37603777],"timestamp":[453,453.23411330406503]},{"passenger_id":17647,"location":[127.16745556,37.45119987],"timestamp":[442,453.51319687216517]},{"passenger_id":17659,"location":[127.12921942,37.43224283],"timestamp":[448,453.66833416007233]},{"passenger_id":10121,"location":[127.147931173256,37.4471398096029],"timestamp":[449,455.1784864658803]},{"passenger_id":12677,"location":[127.1327165,37.41208609],"timestamp":[450,454.5922872474676]},{"passenger_id":15013,"location":[127.1285881,37.41685834],"timestamp":[451,456.04942023609146]},{"passenger_id":17695,"location":[127.13539994,37.43406066],"timestamp":[453,454.1319970625206]},{"passenger_id":8342,"location":[127.11090851,37.39640808],"timestamp":[454,455.7525010485773]},{"passenger_id":20812,"location":[127.09639855,37.42953954],"timestamp":[454,458.1504190475405]},{"passenger_id":23626,"location":[127.15820528,37.45977954],"timestamp":[454,454.42166414396644]},{"passenger_id":10114,"location":[127.10976268,37.37498382],"timestamp":[446,455.1941269021746]},{"passenger_id":3282,"location":[127.11141205,37.37612915],"timestamp":[452,455.700785392593]},{"passenger_id":3346,"location":[127.11477661,37.39642334],"timestamp":[452,456.8584746649961]},{"passenger_id":5852,"location":[127.11684331,37.40028744],"timestamp":[454,459.30243237001423]},{"passenger_id":17680,"location":[127.15596188,37.44446668],"timestamp":[455,455.2840726086898]},{"passenger_id":10129,"location":[127.12892993,37.4324082],"timestamp":[450,462.1583260066525]},{"passenger_id":10111,"location":[127.12876892,37.44449234],"timestamp":[452,477.675308666977]},{"passenger_id":17734,"location":[127.10552979,37.34396744],"timestamp":[454,462.95753555181284]},{"passenger_id":20830,"location":[127.1111668,37.39623102],"timestamp":[456,458.2640517129114]},{"passenger_id":3302,"location":[127.09645844,37.39807892],"timestamp":[456,457.4618366219816]},{"passenger_id":20802,"location":[127.11103722,37.39597125],"timestamp":[456,457.65451746564503]},{"passenger_id":17682,"location":[127.1239624,37.38864899],"timestamp":[456,456.41449718791705]},{"passenger_id":20800,"location":[127.16271021,37.41162949],"timestamp":[451,464.11500394980305]},{"passenger_id":8350,"location":[127.12941369,37.36495906],"timestamp":[453,460.47385532872454]},{"passenger_id":8344,"location":[127.12888247,37.43278515],"timestamp":[455,456.7618184416047]},{"passenger_id":8349,"location":[127.15111542,37.44227219],"timestamp":[455,457.570125690963]},{"passenger_id":17687,"location":[127.12803181,37.41232691],"timestamp":[457,457.71378518375576]},{"passenger_id":10130,"location":[127.13088226,37.40612793],"timestamp":[450,459.4351678965223]},{"passenger_id":10132,"location":[127.14434814,37.37437439],"timestamp":[453,461.3050579249444]},{"passenger_id":20806,"location":[127.16419989,37.45822188],"timestamp":[453,458.9738600400808]},{"passenger_id":12699,"location":[127.14365517,37.44493445],"timestamp":[454,457.5071900692779]},{"passenger_id":17677,"location":[127.10901642,37.35058594],"timestamp":[456,460.63421113902]},{"passenger_id":15028,"location":[127.16596998,37.43658735],"timestamp":[456,459.089690493626]},{"passenger_id":17671,"location":[127.16976122,37.44192276],"timestamp":[456,458.68453918953827]},{"passenger_id":17712,"location":[127.11388119,37.35201326],"timestamp":[456,459.0225693307574]},{"passenger_id":17666,"location":[127.12945303,37.43040026],"timestamp":[456,458.441697780554]},{"passenger_id":8331,"location":[127.12409068,37.35836528],"timestamp":[457,458.84214382134866]},{"passenger_id":12661,"location":[127.10484314,37.38055038],"timestamp":[457,458.03257786480344]},{"passenger_id":15004,"location":[127.11283676,37.39714077],"timestamp":[458,458.30059285953166]},{"passenger_id":15002,"location":[127.11107312,37.39623055],"timestamp":[458,460.74095679603437]},{"passenger_id":17961,"location":[127.11083973563,37.3977262231159],"timestamp":[458,462.0236028988929]},{"passenger_id":5839,"location":[127.15951307,37.45071999],"timestamp":[447,458.59253920834885]},{"passenger_id":10134,"location":[127.12767033,37.4407242],"timestamp":[453,463.05264036649294]},{"passenger_id":17714,"location":[127.14588206,37.42865623],"timestamp":[456,458.75611805242613]},{"passenger_id":3295,"location":[127.17331879,37.44986146],"timestamp":[458,458.79920387301934]},{"passenger_id":796,"location":[127.15904999,37.43427277],"timestamp":[458,459.0598993997766]},{"passenger_id":12706,"location":[127.12330337,37.35150788],"timestamp":[459,459.0321042088505]},{"passenger_id":5897,"location":[127.10591125,37.36270905],"timestamp":[436,461.2778510000937]},{"passenger_id":17676,"location":[127.14726101,37.44092116],"timestamp":[452,459.99793507751565]},{"passenger_id":5903,"location":[127.11009216,37.39385605],"timestamp":[456,462.5165564056046]},{"passenger_id":804,"location":[127.12471008,37.38529587],"timestamp":[458,459.1027010812932]},{"passenger_id":12675,"location":[127.1107824,37.39376311],"timestamp":[458,462.6731190740625]},{"passenger_id":20784,"location":[127.17873607,37.43879723],"timestamp":[459,470.36695373021183]},{"passenger_id":3297,"location":[127.12269169,37.40327656],"timestamp":[460,461.1130346607694]},{"passenger_id":10115,"location":[127.14549255,37.40724182],"timestamp":[444,462.414024316493]},{"passenger_id":10105,"location":[127.12934875,37.43217468],"timestamp":[447,460.8249958730418]},{"passenger_id":15046,"location":[127.07518482,37.39317376],"timestamp":[452,460.95898851519775]},{"passenger_id":20786,"location":[127.16103388,37.41213938],"timestamp":[453,475.6195091935107]},{"passenger_id":10126,"location":[127.12183628,37.38323177],"timestamp":[453,460.3870380713268]},{"passenger_id":3277,"location":[127.10977936,37.39302444],"timestamp":[455,463.2899708208694]},{"passenger_id":15029,"location":[127.16379496392,37.4414926218838],"timestamp":[455,460.97659482319557]},{"passenger_id":17675,"location":[127.10901121,37.35065175],"timestamp":[456,463.64964478520545]},{"passenger_id":17681,"location":[127.12457392,37.41812765],"timestamp":[458,461.44458965779944]},{"passenger_id":15047,"location":[127.15004842,37.41378944],"timestamp":[459,460.404566988167]},{"passenger_id":15008,"location":[127.11147308,37.39185333],"timestamp":[459,460.6462286410741]},{"passenger_id":12679,"location":[127.15484466,37.44375792],"timestamp":[459,461.5069362246277]},{"passenger_id":17697,"location":[127.12915039,37.41238785],"timestamp":[460,461.44894311074887]},{"passenger_id":12670,"location":[127.17910451,37.4315516],"timestamp":[461,466.4745322910766]},{"passenger_id":23614,"location":[127.12348938,37.35155487],"timestamp":[461,461.1106905442467]},{"passenger_id":5860,"location":[127.09775543,37.41286087],"timestamp":[461,461.0218837495112]},{"passenger_id":20825,"location":[127.14707184,37.36959457],"timestamp":[461,469.1593626710043]},{"passenger_id":5841,"location":[127.12421417,37.3841362],"timestamp":[453,462.03995479424145]},{"passenger_id":5848,"location":[127.10639954,37.36283112],"timestamp":[459,461.9827508286734]},{"passenger_id":15043,"location":[127.1439209,37.43773651],"timestamp":[461,461.7577052330883]},{"passenger_id":20844,"location":[127.128089629534,37.4614813886136],"timestamp":[461,468.1474833605647]},{"passenger_id":17703,"location":[127.11746216,37.40162277],"timestamp":[462,463.92664212213725]},{"passenger_id":17649,"location":[127.10808809,37.36628446],"timestamp":[446,462.21319316799213]},{"passenger_id":5836,"location":[127.08964539,37.38776016],"timestamp":[448,463.2778935682745]},{"passenger_id":8338,"location":[127.1280899,37.41230011],"timestamp":[456,463.6564589367675]},{"passenger_id":23615,"location":[127.086071,37.389751],"timestamp":[462,466.8520988924016]},{"passenger_id":8356,"location":[127.11403665,37.39688329],"timestamp":[463,464.37333878553517]},{"passenger_id":20842,"location":[127.106914759624,37.372359711637],"timestamp":[463,463.9283596482174]},{"passenger_id":10127,"location":[127.10931396,37.39567566],"timestamp":[463,465.7785067512701]},{"passenger_id":3290,"location":[127.11061096,37.33797073],"timestamp":[463,485.3613882004759]},{"passenger_id":17664,"location":[127.14643192,37.44986891],"timestamp":[440,463.2119714728349]},{"passenger_id":14999,"location":[127.13159909,37.44530202],"timestamp":[443,464.1162576881544]},{"passenger_id":12674,"location":[127.1282959,37.41228867],"timestamp":[456,464.1421439701235]},{"passenger_id":15021,"location":[127.09894865,37.43088109],"timestamp":[461,486.70732042348374]},{"passenger_id":15022,"location":[127.11114502,37.39156723],"timestamp":[461,465.9252941798334]},{"passenger_id":5890,"location":[127.12561758,37.40975677],"timestamp":[464,464.014358859595]},{"passenger_id":12678,"location":[127.11108398,37.39605331],"timestamp":[464,466.10679916393104]},{"passenger_id":787,"location":[127.11283112,37.39038849],"timestamp":[448,464.77089000072544]},{"passenger_id":14998,"location":[127.13760767,37.44263348],"timestamp":[449,464.8574715805892]},{"passenger_id":3298,"location":[127.11426984,37.33685794],"timestamp":[463,470.9074937729675]},{"passenger_id":8348,"location":[127.16593056,37.43410827],"timestamp":[464,465.0353745116942]},{"passenger_id":8368,"location":[127.12023951,37.34008845],"timestamp":[465,485.16859184335624]},{"passenger_id":10118,"location":[127.16834916,37.44042669],"timestamp":[455,466.8575768495248]},{"passenger_id":5859,"location":[127.12886256,37.41210337],"timestamp":[460,466.1986013963742]},{"passenger_id":12697,"location":[127.17618493,37.43998509],"timestamp":[461,466.0188144797007]},{"passenger_id":17674,"location":[127.12293213,37.35997307],"timestamp":[461,465.22962955027236]},{"passenger_id":20835,"location":[127.13492584,37.38513947],"timestamp":[461,465.7462074568615]},{"passenger_id":5851,"location":[127.12104653,37.40544929],"timestamp":[462,466.46345120142934]},{"passenger_id":12703,"location":[127.12250828,37.3837117],"timestamp":[462,465.85176122152035]},{"passenger_id":12688,"location":[127.12296382,37.36001964],"timestamp":[465,467.7952543230185]},{"passenger_id":3288,"location":[127.10967691,37.39496519],"timestamp":[465,466.16518995870985]},{"passenger_id":5864,"location":[127.12298584,37.38848877],"timestamp":[466,466.4294243599437]},{"passenger_id":20793,"location":[127.14037904,37.43573994],"timestamp":[446,466.7947443977392]},{"passenger_id":10173,"location":[127.17155108,37.46157611],"timestamp":[457,480.74574641345527]},{"passenger_id":795,"location":[127.11271667,37.39109802],"timestamp":[457,466.56393906403224]},{"passenger_id":12673,"location":[127.123909099145,37.3885179460509],"timestamp":[458,466.8409801822988]},{"passenger_id":808,"location":[127.12773132,37.44802094],"timestamp":[460,467.51506653229666]},{"passenger_id":15094,"location":[127.14895879,37.46694175],"timestamp":[462,479.4566982463401]},{"passenger_id":20826,"location":[127.165986616993,37.4368037616715],"timestamp":[464,467.6560965261813]},{"passenger_id":3309,"location":[127.10088601,37.43094793],"timestamp":[467,471.10930664414275]},{"passenger_id":12708,"location":[127.128961845896,37.4122844673175],"timestamp":[467,467.6756087529732]},{"passenger_id":3284,"location":[127.10793304,37.36660385],"timestamp":[445,467.8617220770644]},{"passenger_id":17691,"location":[127.09762914,37.37020556],"timestamp":[462,473.5451366738106]},{"passenger_id":8362,"location":[127.148570057875,37.4063928366232],"timestamp":[462,469.52717885091914]},{"passenger_id":802,"location":[127.10507202,37.3723793],"timestamp":[464,469.9947114022654]},{"passenger_id":20818,"location":[127.10842823,37.3962091],"timestamp":[465,469.0140700672881]},{"passenger_id":12722,"location":[127.1294466,37.43046454],"timestamp":[465,467.7817195082749]},{"passenger_id":17685,"location":[127.15585327,37.44300079],"timestamp":[465,468.217906981149]},{"passenger_id":12689,"location":[127.13249893,37.39228709],"timestamp":[465,467.79535643634324]},{"passenger_id":12682,"location":[127.17841048,37.44273158],"timestamp":[467,468.9839152701547]},{"passenger_id":20919,"location":[127.11129616,37.35001389],"timestamp":[468,474.2859274417555]},{"passenger_id":12701,"location":[127.12297176,37.3600313],"timestamp":[454,470.9651542081745]},{"passenger_id":3287,"location":[127.12099457,37.40616226],"timestamp":[457,471.2806302181922]},{"passenger_id":20805,"location":[127.16231738,37.44539489],"timestamp":[459,468.4605972259488]},{"passenger_id":20832,"location":[127.14308929,37.44260788],"timestamp":[464,468.95608853227924]},{"passenger_id":8345,"location":[127.10808809,37.36624064],"timestamp":[466,468.4023283624291]},{"passenger_id":10210,"location":[127.10707855,37.37095642],"timestamp":[467,468.375910737984]},{"passenger_id":23617,"location":[127.11281194,37.39094666],"timestamp":[468,472.1262103274079]},{"passenger_id":17708,"location":[127.1099472,37.39439011],"timestamp":[469,471.03230528046646]},{"passenger_id":14992,"location":[127.11843109,37.39518356],"timestamp":[448,472.2248322300475]},{"passenger_id":8323,"location":[127.13337945,37.44805019],"timestamp":[448,471.4028391344756]},{"passenger_id":15071,"location":[127.11100769,37.38803101],"timestamp":[458,470.7663315176229]},{"passenger_id":8355,"location":[127.11088653,37.37457631],"timestamp":[462,470.35208687961415]},{"passenger_id":812,"location":[127.11276245,37.37893677],"timestamp":[467,471.08815880217264]},{"passenger_id":3293,"location":[127.11843872,37.39403152],"timestamp":[467,470.8418243406212]},{"passenger_id":17689,"location":[127.13583268,37.45017449],"timestamp":[468,479.2968514144437]},{"passenger_id":17701,"location":[127.18045887,37.44207224],"timestamp":[469,470.74990282500926]},{"passenger_id":20861,"location":[127.17941785,37.44422729],"timestamp":[469,469.8536360215905]},{"passenger_id":20868,"location":[127.12556551,37.40974338],"timestamp":[470,471.0536199177632]},{"passenger_id":5867,"location":[127.10183716,37.38718033],"timestamp":[470,473.9326280911327]},{"passenger_id":12714,"location":[127.14571381,37.36924362],"timestamp":[470,477.7295711557404]},{"passenger_id":12729,"location":[127.11543624,37.40658346],"timestamp":[470,472.32704643134736]},{"passenger_id":5842,"location":[127.16075897,37.45038223],"timestamp":[452,470.2037989895374]},{"passenger_id":10271,"location":[127.1270744,37.39247032],"timestamp":[460,472.1225125098759]},{"passenger_id":15011,"location":[127.12922747,37.43218631],"timestamp":[461,471.0423361299718]},{"passenger_id":15049,"location":[127.12757646,37.41611119],"timestamp":[467,471.0345036185108]},{"passenger_id":833,"location":[127.11284637,37.36491394],"timestamp":[468,471.40085102767034]},{"passenger_id":814,"location":[127.13339996,37.44136047],"timestamp":[468,471.56922393114206]},{"passenger_id":8364,"location":[127.16714478,37.43962097],"timestamp":[468,472.43445993883114]},{"passenger_id":20856,"location":[127.13537312,37.40902831],"timestamp":[468,471.126583589716]},{"passenger_id":20855,"location":[127.13635884,37.4295541],"timestamp":[468,470.42218031736854]},{"passenger_id":15067,"location":[127.11428141,37.33809269],"timestamp":[470,470.43359452262234]},{"passenger_id":15099,"location":[127.11281244,37.39477049],"timestamp":[471,473.6834904055318]},{"passenger_id":12655,"location":[127.11451721,37.38537598],"timestamp":[449,474.9112165679139]},{"passenger_id":20781,"location":[127.17367323,37.45063429],"timestamp":[450,473.78123647983824]},{"passenger_id":12656,"location":[127.16338142,37.44574463],"timestamp":[453,472.54624244782264]},{"passenger_id":17705,"location":[127.16844877,37.44493343],"timestamp":[455,473.11142406069246]},{"passenger_id":803,"location":[127.13282776,37.39489746],"timestamp":[463,473.47733301148315]},{"passenger_id":10146,"location":[127.10981281,37.37042728],"timestamp":[464,471.7379327376757]},{"passenger_id":5878,"location":[127.11611938,37.37896347],"timestamp":[466,472.1791375136565]},{"passenger_id":17737,"location":[127.132395157991,37.4125900209909],"timestamp":[468,472.3191778366272]},{"passenger_id":20932,"location":[127.17306229,37.44924199],"timestamp":[469,472.91538167465654]},{"passenger_id":3308,"location":[127.12677002,37.41227341],"timestamp":[469,473.58661242530667]},{"passenger_id":12712,"location":[127.12606004,37.41258873],"timestamp":[470,474.29617284584475]},{"passenger_id":15056,"location":[127.11165619,37.34749222],"timestamp":[470,486.34024785485616]},{"passenger_id":12728,"location":[127.12711334,37.41565323],"timestamp":[470,472.04947682186486]},{"passenger_id":8367,"location":[127.1439209,37.44478607],"timestamp":[471,471.08678170709146]},{"passenger_id":10165,"location":[127.12792969,37.46149826],"timestamp":[471,471.91911445128454]},{"passenger_id":12756,"location":[127.0941925,37.40047455],"timestamp":[472,472.91255795750624]},{"passenger_id":20808,"location":[127.12779662,37.43881716],"timestamp":[452,472.63542856707744]},{"passenger_id":15003,"location":[127.13954163,37.43548965],"timestamp":[459,472.5843753045602]},{"passenger_id":17706,"location":[127.1431908,37.40973597],"timestamp":[462,474.3019537988068]},{"passenger_id":5856,"location":[127.12395286,37.38867508],"timestamp":[462,473.7580509068263]},{"passenger_id":23618,"location":[127.10901344,37.35059941],"timestamp":[464,479.0876381296139]},{"passenger_id":5869,"location":[127.1289444,37.4121933],"timestamp":[469,472.7230681818216]},{"passenger_id":10107,"location":[127.06797414,37.39125721],"timestamp":[444,478.93096935849957]},{"passenger_id":12676,"location":[127.13654327,37.44157028],"timestamp":[449,474.03768375517643]},{"passenger_id":8351,"location":[127.1298472,37.44034038],"timestamp":[453,473.68570231273094]},{"passenger_id":8333,"location":[127.13816416,37.40662301],"timestamp":[457,473.3647823614603]},{"passenger_id":3286,"location":[127.12402765,37.38860913],"timestamp":[461,473.61397413920423]},{"passenger_id":15051,"location":[127.12778473,37.43859863],"timestamp":[464,473.43816604462336]},{"passenger_id":23619,"location":[127.098741,37.356358],"timestamp":[471,503.2869307129482]},{"passenger_id":12719,"location":[127.13444519,37.47439575],"timestamp":[471,475.1558686557026]},{"passenger_id":20917,"location":[127.10504433,37.36851361],"timestamp":[472,474.4175174683951]},{"passenger_id":17707,"location":[127.17355951,37.43755431],"timestamp":[473,475.1298258823035]},{"passenger_id":17724,"location":[127.16989422,37.45169323],"timestamp":[473,473.66084764710865]},{"passenger_id":5866,"location":[127.11423492,37.35235977],"timestamp":[474,476.74459561070023]},{"passenger_id":8359,"location":[127.11295155,37.37784509],"timestamp":[474,474.7416106370295]},{"passenger_id":20901,"location":[127.10452271,37.39988327],"timestamp":[474,475.04490677605816]},{"passenger_id":3316,"location":[127.10677338,37.37031937],"timestamp":[474,474.45974870746966]},{"passenger_id":10144,"location":[127.13867961,37.43884411],"timestamp":[457,474.869102333402]},{"passenger_id":20815,"location":[127.14711761,37.43599701],"timestamp":[461,474.35519534531454]},{"passenger_id":12751,"location":[127.1074295,37.35574341],"timestamp":[464,475.51938203009354]},{"passenger_id":15016,"location":[127.12492453,37.38686215],"timestamp":[464,475.89769693902]},{"passenger_id":8358,"location":[127.12533569,37.38654709],"timestamp":[467,474.56735277800834]},{"passenger_id":5882,"location":[127.07246145,37.38967308],"timestamp":[470,496.0145916329511]},{"passenger_id":5883,"location":[127.15376504,37.44355748],"timestamp":[470,474.4091801547407]},{"passenger_id":10235,"location":[127.14543915,37.3701973],"timestamp":[475,483.44881784064177]},{"passenger_id":20837,"location":[127.1289444,37.41230392],"timestamp":[469,475.53697445363446]},{"passenger_id":15065,"location":[127.11107011,37.39623053],"timestamp":[473,476.78921913610446]},{"passenger_id":17720,"location":[127.10808809,37.36636304],"timestamp":[475,476.3560092891509]},{"passenger_id":12739,"location":[127.12241364,37.40538788],"timestamp":[475,476.86426632263806]},{"passenger_id":12909,"location":[127.11016846,37.39779282],"timestamp":[476,477.95318000881235]},{"passenger_id":15038,"location":[127.13724518,37.44248581],"timestamp":[464,476.6622276115402]},{"passenger_id":10160,"location":[127.15473997,37.44403793],"timestamp":[466,476.83216355676353]},{"passenger_id":12709,"location":[127.15634091,37.44472795],"timestamp":[473,477.11182284254363]},{"passenger_id":17745,"location":[127.14003505,37.37074616],"timestamp":[474,477.27310219156095]},{"passenger_id":23620,"location":[127.114549,37.377966],"timestamp":[475,477.90763710756335]},{"passenger_id":20841,"location":[127.16975786,37.43746848],"timestamp":[476,476.82450640320207]},{"passenger_id":3384,"location":[127.09394073,37.38282394],"timestamp":[476,478.3596420461406]},{"passenger_id":15064,"location":[127.161026,37.41229248],"timestamp":[463,478.935741100641]},{"passenger_id":20824,"location":[127.16157532,37.43334579],"timestamp":[465,477.6099022692427]},{"passenger_id":12711,"location":[127.16790771,37.46321487],"timestamp":[471,485.7734661191281]},{"passenger_id":3310,"location":[127.10826874,37.36623383],"timestamp":[473,477.89798698414194]},{"passenger_id":830,"location":[127.11312866,37.40153885],"timestamp":[475,478.4300054488846]},{"passenger_id":20852,"location":[127.11588287,37.39116287],"timestamp":[476,478.1733456747123]},{"passenger_id":15059,"location":[127.11250099,37.36344255],"timestamp":[478,478.938178377369]},{"passenger_id":10139,"location":[127.16163942165,37.4333176718933],"timestamp":[461,478.67646800600676]},{"passenger_id":5873,"location":[127.12271826,37.36234822],"timestamp":[462,479.67602366960966]},{"passenger_id":20809,"location":[127.13013589,37.4404248],"timestamp":[465,478.599182179426]},{"passenger_id":20884,"location":[127.11478954,37.36514319],"timestamp":[472,479.5965027744059]},{"passenger_id":3314,"location":[127.12829257,37.41232564],"timestamp":[475,478.79596737749256]},{"passenger_id":5877,"location":[127.13260536,37.40880518],"timestamp":[475,479.2031755977319]},{"passenger_id":3296,"location":[127.10968301,37.39465426],"timestamp":[477,481.17514465708877]},{"passenger_id":12754,"location":[127.1130756,37.39784133],"timestamp":[478,479.9594105527024]},{"passenger_id":10212,"location":[127.11277008,37.39811325],"timestamp":[478,480.40436264793976]},{"passenger_id":8360,"location":[127.13806915,37.40872574],"timestamp":[478,479.4123117310638]},{"passenger_id":17765,"location":[127.1316608,37.44532233],"timestamp":[479,479.13845323975346]},{"passenger_id":819,"location":[127.12380981,37.41542435],"timestamp":[479,479.24843592898924]},{"passenger_id":17740,"location":[127.14902292,37.43691454],"timestamp":[479,479.0897267727383]},{"passenger_id":5887,"location":[127.10803986,37.37147903],"timestamp":[479,479.2860072308786]},{"passenger_id":5847,"location":[127.12890379,37.43262288],"timestamp":[454,479.3754553541971]},{"passenger_id":17725,"location":[127.15188446,37.4156783],"timestamp":[473,479.81250653983295]},{"passenger_id":5894,"location":[127.14338345,37.46173943],"timestamp":[474,480.99592786732865]},{"passenger_id":20854,"location":[127.13565826,37.37277222],"timestamp":[475,479.73758807031226]},{"passenger_id":8410,"location":[127.16888325,37.46226391],"timestamp":[475,499.30453940262595]},{"passenger_id":8373,"location":[127.12724523,37.38847541],"timestamp":[476,480.7293164853549]},{"passenger_id":15069,"location":[127.12831086,37.41232525],"timestamp":[480,480.43890507062997]},{"passenger_id":12715,"location":[127.07716293,37.39157512],"timestamp":[470,481.5799800839462]},{"passenger_id":20860,"location":[127.15007976,37.44169151],"timestamp":[472,480.59928986108537]},{"passenger_id":23621,"location":[127.151204,37.413781],"timestamp":[473,480.7934684305922]},{"passenger_id":3301,"location":[127.12945557,37.44830322],"timestamp":[474,481.39427486555144]},{"passenger_id":20872,"location":[127.142817315988,37.4432981664504],"timestamp":[475,481.2471236033405]},{"passenger_id":15060,"location":[127.16410405,37.43287396],"timestamp":[477,480.4223421807145]},{"passenger_id":8369,"location":[127.16538846,37.43271114],"timestamp":[479,481.48141841522477]},{"passenger_id":12744,"location":[127.12660716,37.44830094],"timestamp":[479,480.15216481266265]},{"passenger_id":10184,"location":[127.12885978,37.41229779],"timestamp":[479,480.65820115452095]},{"passenger_id":15061,"location":[127.09510803,37.39931488],"timestamp":[481,482.33179090527716]},{"passenger_id":5938,"location":[127.10531616,37.45447159],"timestamp":[481,498.10457117295454]},{"passenger_id":20913,"location":[127.15997314,37.45452881],"timestamp":[465,481.64021020244513]},{"passenger_id":20828,"location":[127.14492573,37.43987599],"timestamp":[465,481.6795402959617]},{"passenger_id":20811,"location":[127.10598259,37.36256862],"timestamp":[465,481.347331659372]},{"passenger_id":10161,"location":[127.16493984,37.43277539],"timestamp":[467,481.83464748695263]},{"passenger_id":20904,"location":[127.15299245,37.41555643],"timestamp":[472,482.0303481827242]},{"passenger_id":12730,"location":[127.12908483,37.41234209],"timestamp":[473,481.6853129360158]},{"passenger_id":12707,"location":[127.14003983,37.45143209],"timestamp":[475,485.1496292959568]},{"passenger_id":8399,"location":[127.1275934,37.37030644],"timestamp":[478,481.7887211671676]},{"passenger_id":15141,"location":[127.11082876,37.39718028],"timestamp":[481,481.7959397384427]},{"passenger_id":20869,"location":[127.14511126,37.42845739],"timestamp":[481,481.6739591399173]},{"passenger_id":8371,"location":[127.12905884,37.41233063],"timestamp":[482,482.24999864540985]},{"passenger_id":798,"location":[127.12849177,37.43640038],"timestamp":[453,482.6982851619218]},{"passenger_id":15014,"location":[127.1376935,37.45073201],"timestamp":[460,485.4726141329268]},{"passenger_id":15070,"location":[127.11188207,37.39383908],"timestamp":[473,483.92833971398403]},{"passenger_id":5904,"location":[127.12042999,37.33942032],"timestamp":[475,483.4714765884301]},{"passenger_id":10223,"location":[127.11792654,37.34802093],"timestamp":[478,483.4656577824396]},{"passenger_id":12775,"location":[127.10917664,37.33698273],"timestamp":[479,491.0366859498028]},{"passenger_id":15058,"location":[127.14730072,37.42902374],"timestamp":[480,482.917231184902]},{"passenger_id":10191,"location":[127.12191706,37.4004609],"timestamp":[480,484.3319196837905]},{"passenger_id":8415,"location":[127.11301422,37.39719772],"timestamp":[481,482.7734382267329]},{"passenger_id":817,"location":[127.12729645,37.40976334],"timestamp":[481,483.89274402351305]},{"passenger_id":5875,"location":[127.17214203,37.44150162],"timestamp":[482,483.54384604221065]},{"passenger_id":3313,"location":[127.11491394,37.36244965],"timestamp":[482,483.55927418220585]},{"passenger_id":5871,"location":[127.14057185,37.39109637],"timestamp":[474,484.7597942374406]},{"passenger_id":15078,"location":[127.10279478,37.34122348],"timestamp":[479,503.10322481340506]},{"passenger_id":12840,"location":[127.12458801,37.35784149],"timestamp":[480,484.6980585061795]},{"passenger_id":15086,"location":[127.18080902,37.44142151],"timestamp":[481,483.6443086493682]},{"passenger_id":20941,"location":[127.114003604398,37.3457265411887],"timestamp":[482,484.70916362116503]},{"passenger_id":23612,"location":[127.137564,37.41823],"timestamp":[457,484.74535901726273]},{"passenger_id":17690,"location":[127.12908173,37.43238831],"timestamp":[461,484.63759326094083]},{"passenger_id":20909,"location":[127.14178503,37.36889246],"timestamp":[467,485.0940974184304]},{"passenger_id":20887,"location":[127.13672638,37.43083572],"timestamp":[473,484.3476730389227]},{"passenger_id":20877,"location":[127.179028202968,37.4402648515905],"timestamp":[476,484.57394433271446]},{"passenger_id":5899,"location":[127.16934204,37.43819427],"timestamp":[477,486.05093663966903]},{"passenger_id":10179,"location":[127.12892781,37.43242591],"timestamp":[477,484.49461670823035]},{"passenger_id":20859,"location":[127.10950823,37.39118836],"timestamp":[478,486.6680876684729]},{"passenger_id":12787,"location":[127.11392545,37.40036825],"timestamp":[485,486.5442105980935]},{"passenger_id":10193,"location":[127.11543624,37.40654737],"timestamp":[485,485.0741022114962]},{"passenger_id":17750,"location":[127.07238926,37.39268199],"timestamp":[467,486.88807616593994]},{"passenger_id":17760,"location":[127.14737071,37.43689154],"timestamp":[468,485.15447773939684]},{"passenger_id":3319,"location":[127.12812128,37.36610372],"timestamp":[477,485.7557063965191]},{"passenger_id":10186,"location":[127.12438935,37.38647949],"timestamp":[480,486.06203952857487]},{"passenger_id":813,"location":[127.12407684,37.38866043],"timestamp":[481,486.9272043580322]},{"passenger_id":10174,"location":[127.14673865,37.40541455],"timestamp":[483,486.4448624213829]},{"passenger_id":3358,"location":[127.10892272,37.34006906],"timestamp":[486,491.8621108877596]},{"passenger_id":3294,"location":[127.0736956,37.39314291],"timestamp":[462,486.87176685446]},{"passenger_id":10147,"location":[127.15476227,37.44265366],"timestamp":[467,486.2718987036752]},{"passenger_id":17735,"location":[127.14564365,37.44609944],"timestamp":[468,487.1868875340103]},{"passenger_id":8346,"location":[127.1678201,37.45128784],"timestamp":[469,486.49084707039003]},{"passenger_id":20839,"location":[127.15978321,37.41250235],"timestamp":[470,486.6681845704831]},{"passenger_id":15135,"location":[127.11248977,37.34585343],"timestamp":[476,487.5875321591101]},{"passenger_id":17747,"location":[127.10901137,37.35064704],"timestamp":[483,486.81037627890083]},{"passenger_id":8404,"location":[127.12902404,37.39855666],"timestamp":[483,487.81706845340017]},{"passenger_id":10172,"location":[127.11165895,37.39623352],"timestamp":[484,486.7322044410996]},{"passenger_id":12757,"location":[127.13211373,37.4401737],"timestamp":[485,486.70453732140163]},{"passenger_id":20807,"location":[127.16607396,37.44250887],"timestamp":[463,488.64762045932747]},{"passenger_id":10195,"location":[127.15033187,37.4435971],"timestamp":[467,487.8457992986256]},{"passenger_id":17727,"location":[127.14097711,37.43303274],"timestamp":[472,487.88658618366054]},{"passenger_id":10176,"location":[127.10053253,37.42707443],"timestamp":[481,487.8511909822503]},{"passenger_id":3315,"location":[127.11361694,37.37860107],"timestamp":[484,488.3804082774628]},{"passenger_id":21050,"location":[127.15707123,37.44360608],"timestamp":[486,487.8702721187834]},{"passenger_id":17806,"location":[127.13275311,37.44564509],"timestamp":[486,487.43424537420884]},{"passenger_id":3332,"location":[127.16310883,37.45029449],"timestamp":[487,487.35165553844047]},{"passenger_id":8377,"location":[127.16598511,37.43503952],"timestamp":[488,488.8668207940923]},{"passenger_id":17796,"location":[127.1346157,37.37947968],"timestamp":[488,490.4542206519498]},{"passenger_id":3305,"location":[127.07813094,37.39388283],"timestamp":[468,492.583553308464]},{"passenger_id":23624,"location":[127.104861995105,37.4221955179128],"timestamp":[472,491.0711613255117]},{"passenger_id":15050,"location":[127.13557771,37.45009865],"timestamp":[479,488.4452326744184]},{"passenger_id":15077,"location":[127.1598602,37.44159695],"timestamp":[480,488.5359034212257]},{"passenger_id":12819,"location":[127.14081573,37.44129181],"timestamp":[483,488.98427484739375]},{"passenger_id":17791,"location":[127.10988617,37.39541626],"timestamp":[484,491.05294870186356]},{"passenger_id":20911,"location":[127.133303485657,37.4073011644503],"timestamp":[484,489.6177722758052]},{"passenger_id":12755,"location":[127.12807842,37.43981445],"timestamp":[485,489.11186568151396]},{"passenger_id":3337,"location":[127.11432195,37.40119333],"timestamp":[486,489.06299465201135]},{"passenger_id":17779,"location":[127.14808952,37.40575433],"timestamp":[488,489.5758308183087]},{"passenger_id":15111,"location":[127.11694336,37.39990997],"timestamp":[488,489.17978590727716]},{"passenger_id":5901,"location":[127.12267303,37.41546249],"timestamp":[472,492.0404694232297]},{"passenger_id":3300,"location":[127.10597229,37.36238861],"timestamp":[476,489.9510606233528]},{"passenger_id":3303,"location":[127.16599274,37.43667221],"timestamp":[476,489.82032017481663]},{"passenger_id":5885,"location":[127.1153717,37.37265396],"timestamp":[477,490.6090297545138]},{"passenger_id":17758,"location":[127.14805292,37.4078348],"timestamp":[482,490.88087025299484]},{"passenger_id":8379,"location":[127.109823075221,37.39493179577],"timestamp":[487,491.1488794847802]},{"passenger_id":12768,"location":[127.12123108,37.3860321],"timestamp":[487,489.7226276711234]},{"passenger_id":20922,"location":[127.10970106,37.39331035],"timestamp":[488,492.08811783330765]},{"passenger_id":17789,"location":[127.13573456,37.44324112],"timestamp":[468,490.83608129275717]},{"passenger_id":23623,"location":[127.145666,37.407236],"timestamp":[476,491.8535912999121]},{"passenger_id":8391,"location":[127.16344164,37.44393066],"timestamp":[481,490.6685329855694]},{"passenger_id":20903,"location":[127.17863066,37.43161547],"timestamp":[483,491.113594786926]},{"passenger_id":12763,"location":[127.123922987948,37.3885318348547],"timestamp":[488,491.04551582878804]},{"passenger_id":10190,"location":[127.16478385,37.43684953],"timestamp":[488,490.5345297255074]},{"passenger_id":5902,"location":[127.12911224,37.43164444],"timestamp":[489,490.2238905012872]},{"passenger_id":23637,"location":[127.127656,37.398561],"timestamp":[489,491.3396474708504]},{"passenger_id":824,"location":[127.1417998,37.43263524],"timestamp":[490,490.88164830118626]},{"passenger_id":20939,"location":[127.1255919,37.40975017],"timestamp":[491,491.26643216485076]},{"passenger_id":20994,"location":[127.13101572,37.44875831],"timestamp":[491,491.7442897445506]},{"passenger_id":8352,"location":[127.10827637,37.36624527],"timestamp":[465,491.6630009179711]},{"passenger_id":17732,"location":[127.16063684,37.43329052],"timestamp":[476,491.3071208909081]},{"passenger_id":20874,"location":[127.14112804,37.43615253],"timestamp":[477,491.3531724475072]},{"passenger_id":10359,"location":[127.11830902,37.36001587],"timestamp":[484,492.22426975251886]},{"passenger_id":20899,"location":[127.17897034,37.44003677],"timestamp":[488,491.92374018277417]},{"passenger_id":10188,"location":[127.14716653,37.43583922],"timestamp":[489,491.13336263556516]},{"passenger_id":23634,"location":[127.149705,37.43629],"timestamp":[489,492.2506535525663]},{"passenger_id":12818,"location":[127.1002544,37.3780181],"timestamp":[491,491.8701084848678]},{"passenger_id":3379,"location":[127.11031342,37.39759445],"timestamp":[491,493.27864620401954]},{"passenger_id":17784,"location":[127.109848075062,37.3944845762833],"timestamp":[492,494.5715954937822]},{"passenger_id":20895,"location":[127.16600543,37.4383074],"timestamp":[478,493.4493948328018]},{"passenger_id":12733,"location":[127.15753174,37.43250275],"timestamp":[482,492.8958960337474]},{"passenger_id":12743,"location":[127.17925084,37.44458844],"timestamp":[488,493.7397233748555]},{"passenger_id":20933,"location":[127.10997772,37.37042236],"timestamp":[489,492.88777250194426]},{"passenger_id":12762,"location":[127.17874868,37.43163077],"timestamp":[492,493.414963415749]},{"passenger_id":12767,"location":[127.15473938,37.4440918],"timestamp":[492,492.5810364131753]},{"passenger_id":21008,"location":[127.17885571,37.43528201],"timestamp":[493,493.63494410430786]},{"passenger_id":3336,"location":[127.12822723,37.41226959],"timestamp":[493,493.7406102698095]},{"passenger_id":8397,"location":[127.10795593,37.36631393],"timestamp":[481,493.78468248436906]},{"passenger_id":12758,"location":[127.11283674,37.39762009],"timestamp":[493,494.70301131707976]},{"passenger_id":10208,"location":[127.12843006,37.4098392],"timestamp":[494,494.4551697681698]},{"passenger_id":10292,"location":[127.11069489,37.39781952],"timestamp":[494,495.10947013876205]},{"passenger_id":3299,"location":[127.12379681,37.38382359],"timestamp":[469,495.1720662253963]},{"passenger_id":20833,"location":[127.13908386,37.43520737],"timestamp":[472,495.1473004522297]},{"passenger_id":15073,"location":[127.12627544,37.41880105],"timestamp":[477,494.647120697572]},{"passenger_id":17850,"location":[127.14616394,37.37188721],"timestamp":[483,496.9938199776313]},{"passenger_id":20995,"location":[127.12940979,37.43046188],"timestamp":[483,494.63235695686393]},{"passenger_id":5893,"location":[127.12893151,37.43239498],"timestamp":[486,494.51073295131965]},{"passenger_id":17751,"location":[127.14282744,37.43709006],"timestamp":[488,495.2333207239568]},{"passenger_id":15145,"location":[127.12857871,37.46266451],"timestamp":[491,510.92279731165644]},{"passenger_id":17787,"location":[127.11121472,37.39608556],"timestamp":[493,495.80728665900267]},{"passenger_id":12852,"location":[127.10969597,37.33588054],"timestamp":[494,514.9480797694221]},{"passenger_id":8357,"location":[127.14704132,37.42898941],"timestamp":[466,495.11011162014535]},{"passenger_id":12693,"location":[127.1711863,37.44885137],"timestamp":[467,495.8120989351447]},{"passenger_id":17755,"location":[127.15067834,37.43246258],"timestamp":[485,495.6283640645999]},{"passenger_id":17792,"location":[127.14484855,37.43916132],"timestamp":[488,495.91986104357807]},{"passenger_id":10206,"location":[127.12830428,37.41232558],"timestamp":[492,496.16732922574704]},{"passenger_id":17816,"location":[127.12737274,37.40472031],"timestamp":[493,496.723164368031]},{"passenger_id":15092,"location":[127.12831506,37.41232402],"timestamp":[493,496.5317526207763]},{"passenger_id":5908,"location":[127.11274719,37.37659454],"timestamp":[494,496.8015469420922]},{"passenger_id":12792,"location":[127.12921327,37.43228604],"timestamp":[495,495.99891758696634]},{"passenger_id":3324,"location":[127.09422302,37.40049362],"timestamp":[496,497.6112574026621]},{"passenger_id":3454,"location":[127.16307126,37.44087525],"timestamp":[496,496.4491801433174]},{"passenger_id":15063,"location":[127.12933944,37.43137996],"timestamp":[476,496.9773285224615]},{"passenger_id":12766,"location":[127.161025536699,37.4538869905204],"timestamp":[480,496.9285044482216]},{"passenger_id":10194,"location":[127.124189652924,37.3842401944392],"timestamp":[481,496.58112473175856]},{"passenger_id":8395,"location":[127.15152406,37.44883628],"timestamp":[481,496.6491040985788]},{"passenger_id":20907,"location":[127.14268636,37.4081878],"timestamp":[490,496.9965381816929]},{"passenger_id":15100,"location":[127.12708562,37.39467571],"timestamp":[494,496.75256222016213]},{"passenger_id":12760,"location":[127.16068131,37.43328394],"timestamp":[496,496.98752226657405]},{"passenger_id":20915,"location":[127.159892210363,37.4512258956892],"timestamp":[496,496.17142486986626]},{"passenger_id":15053,"location":[127.14472234,37.43933938],"timestamp":[471,497.49416938162807]},{"passenger_id":8400,"location":[127.11308706,37.3949142],"timestamp":[489,498.0737969136172]},{"passenger_id":20935,"location":[127.1240101,37.38862465],"timestamp":[492,497.46940986553614]},{"passenger_id":15134,"location":[127.14655288,37.45003062],"timestamp":[493,497.68423398859915]},{"passenger_id":15096,"location":[127.11103821,37.3960762],"timestamp":[496,499.82085132521746]},{"passenger_id":15119,"location":[127.11104787,37.39623042],"timestamp":[496,499.537534464901]},{"passenger_id":15205,"location":[127.14549179,37.37393133],"timestamp":[496,564.2659591356193]},{"passenger_id":20940,"location":[127.12922142,37.43222877],"timestamp":[497,497.0250573978653]},{"passenger_id":12820,"location":[127.120224,37.33497238],"timestamp":[497,518.9395550034542]},{"passenger_id":17833,"location":[127.13472135,37.47402091],"timestamp":[498,510.30337232649805]},{"passenger_id":8434,"location":[127.11309052,37.40167236],"timestamp":[498,500.1919689817483]},{"passenger_id":10166,"location":[127.16597493,37.46031019],"timestamp":[478,498.6878850905872]},{"passenger_id":3321,"location":[127.13494232,37.44184535],"timestamp":[485,498.66159714721744]},{"passenger_id":12783,"location":[127.10725431,37.35134928],"timestamp":[487,505.245876118324]},{"passenger_id":20912,"location":[127.16156006,37.41156769],"timestamp":[487,511.724366658085]},{"passenger_id":10250,"location":[127.10192108,37.37099075],"timestamp":[496,500.03919671185105]},{"passenger_id":20943,"location":[127.13845703,37.41212621],"timestamp":[498,499.2202403155594]},{"passenger_id":10211,"location":[127.11098784,37.39623011],"timestamp":[499,501.93217795398334]},{"passenger_id":8407,"location":[127.17433929,37.43781281],"timestamp":[499,499.78107887591034]},{"passenger_id":21083,"location":[127.11227569,37.39769545],"timestamp":[499,501.1914965100218]},{"passenger_id":12723,"location":[127.15095382,37.43254591],"timestamp":[471,499.56508229937725]},{"passenger_id":8394,"location":[127.09794439,37.371182],"timestamp":[472,501.82164792925744]},{"passenger_id":10155,"location":[127.12931561,37.43156732],"timestamp":[473,499.47647491800063]},{"passenger_id":3325,"location":[127.13688129,37.37431833],"timestamp":[489,499.9411463503663]},{"passenger_id":15280,"location":[127.10784375,37.36343115],"timestamp":[495,499.9643704412192]},{"passenger_id":17800,"location":[127.10808809,37.36635784],"timestamp":[497,499.8047776856225]},{"passenger_id":20958,"location":[127.12824249,37.46486664],"timestamp":[499,530.6683729429986]},{"passenger_id":20997,"location":[127.14893516,37.43704345],"timestamp":[499,500.0478738177445]},{"passenger_id":20931,"location":[127.11128235,37.39602661],"timestamp":[500,503.01816657935234]},{"passenger_id":8403,"location":[127.13868063,37.43479491],"timestamp":[500,500.76139796463593]},{"passenger_id":5917,"location":[127.11854553,37.40089417],"timestamp":[500,501.2680661200867]},{"passenger_id":10177,"location":[127.1236051,37.38349774],"timestamp":[474,501.3805387697281]},{"passenger_id":17790,"location":[127.16632745,37.46026805],"timestamp":[484,501.0428805471523]},{"passenger_id":20894,"location":[127.16877157,37.46252245],"timestamp":[488,500.06545245448154]},{"passenger_id":17798,"location":[127.12445831,37.38950729],"timestamp":[488,501.0561270057597]},{"passenger_id":8396,"location":[127.12794496,37.43928075],"timestamp":[492,500.17656912279165]},{"passenger_id":3360,"location":[127.12340546,37.35053253],"timestamp":[496,500.24809315117886]},{"passenger_id":836,"location":[127.14089203,37.41006088],"timestamp":[500,500.8448441405427]},{"passenger_id":17814,"location":[127.12628174,37.41220093],"timestamp":[501,501.56527928451095]},{"passenger_id":8422,"location":[127.14213562,37.37379456],"timestamp":[501,501.3580218982915]},{"passenger_id":17719,"location":[127.11439949,37.36853898],"timestamp":[473,501.73181461672243]},{"passenger_id":10171,"location":[127.12931181,37.431594],"timestamp":[481,501.2118468523924]},{"passenger_id":15128,"location":[127.13027558,37.37361686],"timestamp":[494,501.73126962054846]},{"passenger_id":10244,"location":[127.07391461,37.3916728],"timestamp":[499,501.7347115764214]},{"passenger_id":8439,"location":[127.12820671,37.44799979],"timestamp":[500,501.5057626499116]},{"passenger_id":17891,"location":[127.16993111,37.44113356],"timestamp":[500,502.96662579175074]},{"passenger_id":15117,"location":[127.17017206,37.44075999],"timestamp":[500,502.10452062573444]},{"passenger_id":3333,"location":[127.10967255,37.39467621],"timestamp":[501,502.87912338901987]},{"passenger_id":8492,"location":[127.11253766,37.37556655],"timestamp":[501,501.55127913498075]},{"passenger_id":17844,"location":[127.12702588,37.39072725],"timestamp":[501,502.17586445745525]},{"passenger_id":20956,"location":[127.10736847,37.37545013],"timestamp":[502,502.31492236197636]},{"passenger_id":17754,"location":[127.15885925,37.43339157],"timestamp":[476,502.51059713390396]},{"passenger_id":821,"location":[127.16064008,37.43865379],"timestamp":[478,502.1552470175307]},{"passenger_id":8402,"location":[127.16591143,37.46023847],"timestamp":[484,503.0818882453077]},{"passenger_id":12776,"location":[127.12943716,37.43056636],"timestamp":[487,502.91682677513336]},{"passenger_id":20896,"location":[127.12971593,37.43293033],"timestamp":[488,502.4634766658787]},{"passenger_id":3320,"location":[127.11608797,37.34312379],"timestamp":[490,504.3237285844724]},{"passenger_id":20960,"location":[127.09334328,37.42877345],"timestamp":[497,506.3070762827681]},{"passenger_id":17884,"location":[127.13874054,37.44298172],"timestamp":[500,502.57409387564593]},{"passenger_id":3343,"location":[127.11803772,37.33809634],"timestamp":[502,518.4775289961427]},{"passenger_id":12839,"location":[127.14154654,37.43638107],"timestamp":[503,503.4700250131848]},{"passenger_id":6017,"location":[127.10276794,37.39990997],"timestamp":[503,505.99036888764454]},{"passenger_id":20889,"location":[127.16620813,37.44987086],"timestamp":[493,504.16853299007073]},{"passenger_id":10226,"location":[127.14778643,37.36858521],"timestamp":[500,569.4793620775317]},{"passenger_id":3344,"location":[127.1063637,37.35052081],"timestamp":[500,503.21210103747023]},{"passenger_id":15114,"location":[127.14533308,37.44793558],"timestamp":[501,503.756069767193]},{"passenger_id":17830,"location":[127.1133194,37.37844849],"timestamp":[502,503.0747290525405]},{"passenger_id":23640,"location":[127.121695,37.339068],"timestamp":[503,531.5433696087559]},{"passenger_id":5906,"location":[127.11529541,37.40407181],"timestamp":[503,505.91170272516206]},{"passenger_id":12803,"location":[127.17604276,37.43139757],"timestamp":[504,504.8325863383204]},{"passenger_id":10163,"location":[127.151883926458,37.4324093441399],"timestamp":[477,505.0019762605075]},{"passenger_id":816,"location":[127.16661835,37.44664383],"timestamp":[479,504.89618249263924]},{"passenger_id":23631,"location":[127.170736587636,37.443506498441],"timestamp":[491,505.2614130971797]},{"passenger_id":10205,"location":[127.146795,37.44074354],"timestamp":[492,505.010948259465]},{"passenger_id":20979,"location":[127.1284386,37.46100584],"timestamp":[500,505.08673026650007]},{"passenger_id":17886,"location":[127.1164856,37.40425491],"timestamp":[503,505.42567360274677]},{"passenger_id":15177,"location":[127.12452857,37.34525156],"timestamp":[504,505.4915836252949]},{"passenger_id":12826,"location":[127.1006012,37.42725372],"timestamp":[504,507.42133887767767]},{"passenger_id":10241,"location":[127.16268459,37.41298926],"timestamp":[504,518.297123462963]},{"passenger_id":20890,"location":[127.15056801,37.43938932],"timestamp":[476,506.6639084288715]},{"passenger_id":17824,"location":[127.12887573,37.38512039],"timestamp":[493,506.262901534003]},{"passenger_id":20934,"location":[127.10594669,37.36811022],"timestamp":[497,506.44291855070173]},{"passenger_id":15127,"location":[127.12945171,37.43041308],"timestamp":[498,505.6576135433724]},{"passenger_id":843,"location":[127.13213348,37.38035965],"timestamp":[502,506.6313202372529]},{"passenger_id":21044,"location":[127.11036669,37.35001079],"timestamp":[502,506.1338344284978]},{"passenger_id":21023,"location":[127.16774977,37.45986558],"timestamp":[503,506.319360578778]},{"passenger_id":5912,"location":[127.10621643,37.40076447],"timestamp":[505,506.16424096966176]},{"passenger_id":5914,"location":[127.12301636,37.38850021],"timestamp":[506,506.2237975063304]},{"passenger_id":21047,"location":[127.15997873,37.45179267],"timestamp":[506,506.0186262879001]},{"passenger_id":17793,"location":[127.14410325,37.46725384],"timestamp":[485,508.302561198672]},{"passenger_id":8418,"location":[127.10881347,37.35034717],"timestamp":[493,506.430947279637]},{"passenger_id":23638,"location":[127.117723,37.390637],"timestamp":[495,507.73623089563335]},{"passenger_id":872,"location":[127.12496948,37.34297562],"timestamp":[503,507.3644793362448]},{"passenger_id":5935,"location":[127.10893734,37.3392695],"timestamp":[505,532.4515427094318]},{"passenger_id":12800,"location":[127.14468758,37.43939267],"timestamp":[507,507.51195391812644]},{"passenger_id":10183,"location":[127.11372375,37.35199356],"timestamp":[480,507.24091893154235]},{"passenger_id":15109,"location":[127.06867358,37.39280223],"timestamp":[492,508.5341882027646]},{"passenger_id":12770,"location":[127.1239336,37.35731211],"timestamp":[496,509.0664086731391]},{"passenger_id":20981,"location":[127.14990234,37.45158005],"timestamp":[501,507.6244987079458]},{"passenger_id":20986,"location":[127.15634914,37.44484966],"timestamp":[504,507.85217722345743]},{"passenger_id":17928,"location":[127.11946525,37.33967788],"timestamp":[507,524.6010131182425]},{"passenger_id":8429,"location":[127.14588115,37.44012038],"timestamp":[507,508.23377348047836]},{"passenger_id":15057,"location":[127.12032674,37.35922356],"timestamp":[481,508.98950438360623]},{"passenger_id":10362,"location":[127.12729939,37.40272671],"timestamp":[497,508.8647736588978]},{"passenger_id":3341,"location":[127.15499115,37.40548706],"timestamp":[498,508.7979408460917]},{"passenger_id":828,"location":[127.11675262,37.39498901],"timestamp":[498,508.6957220480198]},{"passenger_id":5911,"location":[127.10605621,37.35747147],"timestamp":[505,509.9371995261121]},{"passenger_id":20965,"location":[127.10600281,37.35430527],"timestamp":[505,529.7431515919209]},{"passenger_id":17912,"location":[127.12531281,37.40829086],"timestamp":[508,508.9101573576422]},{"passenger_id":21018,"location":[127.11357117,37.37854004],"timestamp":[508,508.4760842871114]},{"passenger_id":17847,"location":[127.12726124,37.4563068],"timestamp":[509,532.7343148908114]},{"passenger_id":3348,"location":[127.1090129,37.35059958],"timestamp":[509,509.2593686350262]},{"passenger_id":17785,"location":[127.09412591,37.42927447],"timestamp":[489,516.8929137721506]},{"passenger_id":15115,"location":[127.14368439,37.4127121],"timestamp":[491,509.7712047864578]},{"passenger_id":15122,"location":[127.11482043,37.36242887],"timestamp":[491,509.9088303546788]},{"passenger_id":15175,"location":[127.16600545,37.43791037],"timestamp":[495,509.80878704028856]},{"passenger_id":15150,"location":[127.08312988,37.39279556],"timestamp":[502,512.9452297015042]},{"passenger_id":12831,"location":[127.13034458,37.40980607],"timestamp":[504,510.25641741052107]},{"passenger_id":8445,"location":[127.14296601,37.43879321],"timestamp":[508,510.03529687973366]},{"passenger_id":20957,"location":[127.10717923,37.37575464],"timestamp":[508,509.30041028060936]},{"passenger_id":10351,"location":[127.11032589,37.39717679],"timestamp":[509,510.1765210183756]},{"passenger_id":17937,"location":[127.14574432,37.4730072],"timestamp":[510,510.44942913923427]},{"passenger_id":3331,"location":[127.12485504,37.35850525],"timestamp":[489,511.7760751292347]},{"passenger_id":21037,"location":[127.10751343,37.36715698],"timestamp":[491,511.2374966007618]},{"passenger_id":8408,"location":[127.14183807,37.43787766],"timestamp":[492,511.646692368019]},{"passenger_id":20962,"location":[127.12426149,37.38415275],"timestamp":[507,510.8056091514165]},{"passenger_id":23643,"location":[127.145351,37.447643],"timestamp":[507,510.5289943949082]},{"passenger_id":17834,"location":[127.173728235756,37.4379454213412],"timestamp":[507,510.7515817680895]},{"passenger_id":17939,"location":[127.15538844,37.44816116],"timestamp":[509,510.6378252271235]},{"passenger_id":15186,"location":[127.12863922,37.41215897],"timestamp":[509,510.32350325466086]},{"passenger_id":17882,"location":[127.16036189,37.4527138],"timestamp":[511,511.3179706132565]},{"passenger_id":12804,"location":[127.17898982,37.44011332],"timestamp":[511,526.4589543263589]},{"passenger_id":17848,"location":[127.16597917,37.43718098],"timestamp":[511,511.63132229967454]},{"passenger_id":17926,"location":[127.10746313,37.36711893],"timestamp":[491,511.87191953371257]},{"passenger_id":837,"location":[127.11174011,37.36123276],"timestamp":[495,511.95783446619373]},{"passenger_id":10242,"location":[127.15059302,37.40867909],"timestamp":[504,512.9009207444395]},{"passenger_id":12815,"location":[127.13644031,37.43110751],"timestamp":[507,512.3066503148373]},{"passenger_id":15267,"location":[127.09532928,37.39904785],"timestamp":[512,512.3972693041262]},{"passenger_id":12780,"location":[127.10808809,37.36624839],"timestamp":[495,512.5628710976396]},{"passenger_id":826,"location":[127.15440369,37.44750977],"timestamp":[497,512.7111315960871]},{"passenger_id":17826,"location":[127.13658905,37.44227219],"timestamp":[498,512.9967059890527]},{"passenger_id":17862,"location":[127.11414337,37.34701538],"timestamp":[504,512.8556439950082]},{"passenger_id":10262,"location":[127.1468199,37.40672086],"timestamp":[507,512.8482877768944]},{"passenger_id":3363,"location":[127.12395586,37.38867243],"timestamp":[508,512.583141005159]},{"passenger_id":10231,"location":[127.158394997462,37.4589925148528],"timestamp":[508,513.3599836004877]},{"passenger_id":12817,"location":[127.14788818,37.42914581],"timestamp":[509,512.9752483515207]},{"passenger_id":3370,"location":[127.11546326,37.403862],"timestamp":[509,513.3332872618812]},{"passenger_id":3373,"location":[127.06072235,37.39308929],"timestamp":[510,512.7728776186595]},{"passenger_id":20988,"location":[127.15846458,37.45888075],"timestamp":[511,513.6827178457355]},{"passenger_id":15104,"location":[127.14178914,37.3704613],"timestamp":[489,514.3490055181927]},{"passenger_id":17805,"location":[127.16215662,37.44534182],"timestamp":[492,513.467389736699]},{"passenger_id":23636,"location":[127.15018547,37.41293143],"timestamp":[497,515.2420890768351]},{"passenger_id":12862,"location":[127.13388429,37.41580508],"timestamp":[499,513.4858250786397]},{"passenger_id":15116,"location":[127.17951965,37.44397354],"timestamp":[508,524.5030055987413]},{"passenger_id":15142,"location":[127.12504609,37.40961845],"timestamp":[512,513.4853732583518]},{"passenger_id":17857,"location":[127.12936604,37.43116056],"timestamp":[514,514.0391094594451]},{"passenger_id":21000,"location":[127.167481052246,37.4460731494139],"timestamp":[514,514.1945675359277]},{"passenger_id":3334,"location":[127.15885162,37.44749451],"timestamp":[488,514.2886179726727]},{"passenger_id":838,"location":[127.11473083,37.3731842],"timestamp":[506,514.5906904987806]},{"passenger_id":5907,"location":[127.16834259,37.46216965],"timestamp":[507,515.1406283576284]},{"passenger_id":15148,"location":[127.13924276,37.37526647],"timestamp":[508,514.3676151846265]},{"passenger_id":10238,"location":[127.16746512,37.44624085],"timestamp":[508,515.0414404151735]},{"passenger_id":8441,"location":[127.10461359,37.38082411],"timestamp":[509,515.8647662210321]},{"passenger_id":10276,"location":[127.14403534,37.44475937],"timestamp":[511,514.6760830164678]},{"passenger_id":12808,"location":[127.123817432996,37.3834874212677],"timestamp":[511,514.4847895507426]},{"passenger_id":12858,"location":[127.1015625,37.39997482],"timestamp":[512,515.8078646390609]},{"passenger_id":17856,"location":[127.16035576,37.45269881],"timestamp":[512,514.84165926915]},{"passenger_id":17810,"location":[127.17808737,37.44600121],"timestamp":[502,516.8982005095772]},{"passenger_id":839,"location":[127.16436459,37.45841186],"timestamp":[506,516.1016754939653]},{"passenger_id":17849,"location":[127.16451263,37.45044327],"timestamp":[511,516.2443112546641]},{"passenger_id":17870,"location":[127.16533813,37.43945579],"timestamp":[513,516.1108017547422]},{"passenger_id":5936,"location":[127.16059113,37.41241837],"timestamp":[515,529.5782700664297]},{"passenger_id":17880,"location":[127.120545230991,37.3816124327511],"timestamp":[515,516.4364467136713]},{"passenger_id":12773,"location":[127.07357788,37.38965225],"timestamp":[492,517.3766587583053]},{"passenger_id":17842,"location":[127.12733615,37.44142047],"timestamp":[493,516.4624474735991]},{"passenger_id":10255,"location":[127.07824117,37.39106246],"timestamp":[501,517.2958687726872]},{"passenger_id":12807,"location":[127.128959068136,37.4124289108784],"timestamp":[509,516.4635083272877]},{"passenger_id":8421,"location":[127.1463378,37.44974055],"timestamp":[509,516.9571697494532]},{"passenger_id":10303,"location":[127.13736155,37.44625499],"timestamp":[512,517.243097401936]},{"passenger_id":10260,"location":[127.09384364,37.40031274],"timestamp":[513,517.7953797572691]},{"passenger_id":17868,"location":[127.11601257,37.37889481],"timestamp":[514,517.1094750225765]},{"passenger_id":21058,"location":[127.168396,37.4318924],"timestamp":[515,518.0796905035792]},{"passenger_id":3417,"location":[127.11052105,37.39774056],"timestamp":[515,516.5319003297465]},{"passenger_id":12881,"location":[127.11709595,37.40669632],"timestamp":[517,518.9835203996657]},{"passenger_id":12890,"location":[127.12849426,37.41225433],"timestamp":[517,517.1073145079017]},{"passenger_id":12769,"location":[127.16912807,37.44214839],"timestamp":[496,518.9008072381782]},{"passenger_id":12765,"location":[127.16410144,37.44147864],"timestamp":[501,518.1826957505541]},{"passenger_id":8420,"location":[127.16013345,37.45218037],"timestamp":[507,517.8079611755584]},{"passenger_id":10368,"location":[127.159806099736,37.4440509395771],"timestamp":[510,517.6669181027692]},{"passenger_id":20966,"location":[127.11117554,37.39604187],"timestamp":[510,518.0359192977708]},{"passenger_id":5920,"location":[127.14160185,37.44825584],"timestamp":[512,517.856197525328]},{"passenger_id":15192,"location":[127.16945648,37.44444656],"timestamp":[513,518.6291602715437]},{"passenger_id":20989,"location":[127.12326448,37.35887078],"timestamp":[514,519.0901196178263]},{"passenger_id":17993,"location":[127.1415587,37.43438622],"timestamp":[514,517.8803368595816]},{"passenger_id":8493,"location":[127.10638364,37.3996266],"timestamp":[517,518.3830340948108]},{"passenger_id":17807,"location":[127.1651213,37.43275288],"timestamp":[498,519.0593938690928]},{"passenger_id":21067,"location":[127.16660282,37.44655782],"timestamp":[502,518.8076486831176]},{"passenger_id":15095,"location":[127.16513824,37.4328804],"timestamp":[493,520.4702250812252]},{"passenger_id":12799,"location":[127.1491394,37.45197296],"timestamp":[502,519.7511929046632]},{"passenger_id":12788,"location":[127.16489028,37.43656263],"timestamp":[503,519.2911168243506]},{"passenger_id":20996,"location":[127.11022949,37.39749908],"timestamp":[513,520.8806073556705]},{"passenger_id":17946,"location":[127.12922468,37.43220588],"timestamp":[514,519.1013046736251]},{"passenger_id":17974,"location":[127.14491724,37.36824762],"timestamp":[516,585.6566331220349]},{"passenger_id":5942,"location":[127.11424255,37.40094376],"timestamp":[518,521.208994122991]},{"passenger_id":21011,"location":[127.14682282,37.40611469],"timestamp":[518,522.5037738582763]},{"passenger_id":17888,"location":[127.1810693,37.44136374],"timestamp":[519,519.974415387281]},{"passenger_id":15164,"location":[127.1204776,37.38641256],"timestamp":[519,520.4288635947307]},{"passenger_id":8392,"location":[127.16598511,37.43417358],"timestamp":[492,520.8849914836862]},{"passenger_id":12827,"location":[127.13338406,37.37748467],"timestamp":[493,520.8621294300369]},{"passenger_id":5905,"location":[127.15371351,37.41452881],"timestamp":[494,522.3160100185117]},{"passenger_id":12866,"location":[127.16994804,37.45626411],"timestamp":[499,520.1425632236619]},{"passenger_id":15178,"location":[127.14527313,37.37591539],"timestamp":[512,524.9808808168526]},{"passenger_id":23650,"location":[127.10808809,37.36632358],"timestamp":[512,520.2336555136992]},{"passenger_id":17859,"location":[127.13703933,37.44018451],"timestamp":[513,520.3434457877843]},{"passenger_id":21091,"location":[127.1622126,37.44007895],"timestamp":[514,520.2005607993568]},{"passenger_id":12896,"location":[127.12681326,37.46117896],"timestamp":[518,520.5843088316745]},{"passenger_id":17930,"location":[127.11569977,37.40391541],"timestamp":[519,521.9707737492672]},{"passenger_id":15232,"location":[127.12649245,37.41233385],"timestamp":[520,521.2012327853563]},{"passenger_id":8450,"location":[127.12884851,37.40941231],"timestamp":[520,520.8973664200748]},{"passenger_id":21042,"location":[127.12460327,37.41656113],"timestamp":[520,521.0874570955551]},{"passenger_id":21097,"location":[127.10945713,37.33588365],"timestamp":[521,531.6899803915147]},{"passenger_id":10281,"location":[127.17091235,37.4338541],"timestamp":[521,521.5451107943439]},{"passenger_id":10282,"location":[127.17903689,37.44062392],"timestamp":[521,521.4235178687269]},{"passenger_id":12777,"location":[127.11502838,37.36551285],"timestamp":[494,521.3482795438334]},{"passenger_id":20993,"location":[127.0953208,37.42951588],"timestamp":[508,558.4615075634155]},{"passenger_id":10254,"location":[127.16011047,37.45165634],"timestamp":[509,521.6227372887494]},{"passenger_id":5946,"location":[127.10913849,37.34047318],"timestamp":[511,521.9362118078074]},{"passenger_id":12847,"location":[127.17079128,37.44624594],"timestamp":[513,521.9386990325152]},{"passenger_id":21015,"location":[127.09902954,37.41244125],"timestamp":[514,522.1547409870379]},{"passenger_id":17883,"location":[127.14186859,37.43686295],"timestamp":[518,522.4808857053835]},{"passenger_id":10296,"location":[127.12302799,37.38844319],"timestamp":[519,521.6359788812907]},{"passenger_id":10275,"location":[127.17539596,37.43133432],"timestamp":[520,533.7674472725142]},{"passenger_id":17931,"location":[127.10889435,37.34969711],"timestamp":[520,521.5313071642237]},{"passenger_id":10346,"location":[127.12363866,37.38352234],"timestamp":[521,521.6765901201132]},{"passenger_id":17836,"location":[127.16656494,37.4466095],"timestamp":[497,522.9128176425351]},{"passenger_id":12798,"location":[127.12941742,37.43044662],"timestamp":[500,522.4119675640103]},{"passenger_id":8416,"location":[127.13958558,37.43855616],"timestamp":[503,522.6176304967465]},{"passenger_id":15152,"location":[127.16695667,37.45658371],"timestamp":[512,522.5157331881258]},{"passenger_id":851,"location":[127.14721508,37.4357766],"timestamp":[515,522.3041096485516]},{"passenger_id":17907,"location":[127.17014398,37.44080323],"timestamp":[520,523.251129451319]},{"passenger_id":12795,"location":[127.16779327,37.44271851],"timestamp":[495,524.1332743393723]},{"passenger_id":21032,"location":[127.16176605,37.44524384],"timestamp":[504,523.5054039229391]},{"passenger_id":10360,"location":[127.109181411913,37.3393849133384],"timestamp":[510,551.8882121834572]},{"passenger_id":5930,"location":[127.12400818,37.34719467],"timestamp":[520,524.808917278914]},{"passenger_id":3361,"location":[127.10627747,37.35148621],"timestamp":[520,523.8179905846016]},{"passenger_id":15211,"location":[127.1171875,37.4066391],"timestamp":[521,524.7036442776151]},{"passenger_id":10310,"location":[127.14547729,37.36736298],"timestamp":[522,523.2965846264167]},{"passenger_id":10278,"location":[127.16572405,37.43265871],"timestamp":[524,525.820311885343]},{"passenger_id":15136,"location":[127.1283322,37.41231901],"timestamp":[502,524.2834255013572]},{"passenger_id":17803,"location":[127.135286807047,37.4441037171039],"timestamp":[503,524.5976094456103]},{"passenger_id":8440,"location":[127.12909621,37.41234166],"timestamp":[505,524.4263316215477]},{"passenger_id":5916,"location":[127.13813447,37.41067225],"timestamp":[507,524.1740527198713]},{"passenger_id":17909,"location":[127.09551239,37.42762756],"timestamp":[515,529.190763382167]},{"passenger_id":15156,"location":[127.14076869,37.43594996],"timestamp":[515,525.0201392990629]},{"passenger_id":15223,"location":[127.12606004,37.41253783],"timestamp":[516,525.4067956465549]},{"passenger_id":21162,"location":[127.11032425,37.39724098],"timestamp":[517,526.3711642532049]},{"passenger_id":21003,"location":[127.11673771,37.35033669],"timestamp":[519,525.7605230516745]},{"passenger_id":17897,"location":[127.16590118,37.44642258],"timestamp":[521,524.4477106082908]},{"passenger_id":21012,"location":[127.168644933925,37.445000933748],"timestamp":[522,524.5591482983068]},{"passenger_id":21046,"location":[127.11251831,37.39704895],"timestamp":[524,525.8046937408773]},{"passenger_id":12855,"location":[127.16694178,37.43724524],"timestamp":[525,526.1662764940473]},{"passenger_id":8432,"location":[127.10582225,37.36343218],"timestamp":[496,526.172555840731]},{"passenger_id":10230,"location":[127.13500214,37.44194412],"timestamp":[505,525.1217631308309]},{"passenger_id":21029,"location":[127.16186523,37.44507217],"timestamp":[506,526.1658375077134]},{"passenger_id":852,"location":[127.12997437,37.43154144],"timestamp":[508,526.1788788448663]},{"passenger_id":15163,"location":[127.16507468,37.43275941],"timestamp":[516,527.8894725959157]},{"passenger_id":868,"location":[127.10912323,37.3397522],"timestamp":[520,543.360666998206]},{"passenger_id":5933,"location":[127.14685643,37.45063438],"timestamp":[521,525.6640694947973]},{"passenger_id":21060,"location":[127.14256287,37.40830994],"timestamp":[521,526.8506862522025]},{"passenger_id":15190,"location":[127.16516065,37.43274673],"timestamp":[525,527.3737113325965]},{"passenger_id":21020,"location":[127.1655693,37.4390647],"timestamp":[525,527.8884547215058]},{"passenger_id":10294,"location":[127.1282196,37.43755722],"timestamp":[525,526.0303134061726]},{"passenger_id":5940,"location":[127.1295236,37.41215325],"timestamp":[525,526.0280732419966]},{"passenger_id":3335,"location":[127.12522102,37.35891104],"timestamp":[497,528.6329881427381]},{"passenger_id":17933,"location":[127.12939327,37.44465177],"timestamp":[513,526.7855733706849]},{"passenger_id":10268,"location":[127.11482101,37.36239735],"timestamp":[521,526.9513556562289]},{"passenger_id":13010,"location":[127.11093416,37.39717987],"timestamp":[523,527.9244720728811]},{"passenger_id":3374,"location":[127.16727636,37.44284063],"timestamp":[526,526.6836951437218]},{"passenger_id":21128,"location":[127.15376282,37.44364929],"timestamp":[499,528.2096361527114]},{"passenger_id":12781,"location":[127.15882376,37.43328308],"timestamp":[499,527.9041271627028]},{"passenger_id":23639,"location":[127.167550496293,37.4512536732811],"timestamp":[504,527.4472074776156]},{"passenger_id":12825,"location":[127.16520694,37.43967842],"timestamp":[508,528.7184805157135]},{"passenger_id":3382,"location":[127.10891668,37.34052152],"timestamp":[510,528.8821725151253]},{"passenger_id":21031,"location":[127.10981474,37.36958131],"timestamp":[518,528.309312133018]},{"passenger_id":12908,"location":[127.12057843,37.34014652],"timestamp":[518,530.8152802275022]},{"passenger_id":10286,"location":[127.1413777,37.43719678],"timestamp":[525,528.2804035487704]},{"passenger_id":12888,"location":[127.16548833,37.43269554],"timestamp":[528,528.0434698632617]},{"passenger_id":936,"location":[127.12940979,37.4311676],"timestamp":[528,528.0079666423751]},{"passenger_id":17877,"location":[127.1644484,37.43283364],"timestamp":[516,530.4689387474956]},{"passenger_id":17878,"location":[127.17193501,37.44900171],"timestamp":[516,528.8171814338051]},{"passenger_id":12899,"location":[127.14896393,37.45017624],"timestamp":[517,528.2699972564147]},{"passenger_id":15213,"location":[127.14435577,37.47244263],"timestamp":[517,558.6229816977408]},{"passenger_id":8447,"location":[127.12100983,37.38671875],"timestamp":[518,528.7234881805449]},{"passenger_id":15169,"location":[127.10808809,37.36620098],"timestamp":[519,528.4307044949467]},{"passenger_id":21329,"location":[127.17136747,37.44823226],"timestamp":[522,529.9832092649419]},{"passenger_id":5929,"location":[127.12360742,37.38349944],"timestamp":[523,528.9210884045198]},{"passenger_id":10305,"location":[127.13690233,37.37056605],"timestamp":[525,529.1470024972223]},{"passenger_id":21068,"location":[127.11910039,37.40007212],"timestamp":[527,529.3600745359805]},{"passenger_id":861,"location":[127.16110229,37.43967438],"timestamp":[529,529.3477436453187]},{"passenger_id":10304,"location":[127.160148,37.451851],"timestamp":[529,529.0226045122271]},{"passenger_id":8435,"location":[127.14687601,37.37266862],"timestamp":[503,531.769435248745]},{"passenger_id":8458,"location":[127.14635896,37.37187167],"timestamp":[521,596.695817490886]},{"passenger_id":21040,"location":[127.16000575,37.45185544],"timestamp":[526,529.0695734538649]},{"passenger_id":8461,"location":[127.13424665,37.44163842],"timestamp":[527,530.0036100390786]},{"passenger_id":15296,"location":[127.11833403,37.35922272],"timestamp":[529,529.9067175304599]},{"passenger_id":20987,"location":[127.12799812,37.43896312],"timestamp":[506,530.2060889387558]},{"passenger_id":10277,"location":[127.13638306,37.43108749],"timestamp":[513,530.4653527300495]},{"passenger_id":17978,"location":[127.096420380762,37.4298760265331],"timestamp":[514,543.2467965636398]},{"passenger_id":5949,"location":[127.12308502,37.3885498],"timestamp":[516,530.8801789506696]},{"passenger_id":5962,"location":[127.12676704,37.46197766],"timestamp":[518,531.4675895767149]},{"passenger_id":17908,"location":[127.16708086,37.44666565],"timestamp":[525,530.5181835280474]},{"passenger_id":21080,"location":[127.1159744,37.40422992],"timestamp":[526,530.90369792694]},{"passenger_id":21048,"location":[127.16977715,37.44175695],"timestamp":[530,531.505964224227]},{"passenger_id":10257,"location":[127.11427307,37.39057922],"timestamp":[504,531.3652513361661]},{"passenger_id":3352,"location":[127.16469574,37.43651199],"timestamp":[510,532.471845273407]},{"passenger_id":8459,"location":[127.1580658,37.4450531],"timestamp":[525,531.6780829124615]},{"passenger_id":15214,"location":[127.10792743,37.3506765],"timestamp":[530,531.2661572603375]},{"passenger_id":859,"location":[127.16638087,37.44935626],"timestamp":[530,532.2055078728405]},{"passenger_id":10321,"location":[127.17889419,37.43462128],"timestamp":[531,532.2640593076899]},{"passenger_id":865,"location":[127.16650391,37.46043015],"timestamp":[531,532.0117704000846]},{"passenger_id":8470,"location":[127.12943942,37.43054197],"timestamp":[532,532.0476322167214]},{"passenger_id":3372,"location":[127.11330477,37.34597594],"timestamp":[507,532.6874089746177]},{"passenger_id":21053,"location":[127.107328645853,37.3632708783436],"timestamp":[509,532.4614446246882]},{"passenger_id":23655,"location":[127.139208,37.408515],"timestamp":[511,535.1319380728597]},{"passenger_id":12802,"location":[127.12679702,37.44958996],"timestamp":[515,532.3995113172801]},{"passenger_id":12843,"location":[127.16088441,37.45390586],"timestamp":[521,532.5040320501121]},{"passenger_id":15247,"location":[127.15356608,37.44345899],"timestamp":[525,532.951894281427]},{"passenger_id":15207,"location":[127.11269228,37.39984317],"timestamp":[526,533.9630761966844]},{"passenger_id":12976,"location":[127.13844299,37.43467712],"timestamp":[528,532.6413539549019]},{"passenger_id":23664,"location":[127.12295872,37.35150788],"timestamp":[530,532.9895057810613]},{"passenger_id":17968,"location":[127.10872982,37.39621161],"timestamp":[531,533.8733908188626]},{"passenger_id":17929,"location":[127.17892456,37.4349556],"timestamp":[532,546.2626222722494]},{"passenger_id":21084,"location":[127.10594856,37.36801716],"timestamp":[532,532.1096704608073]},{"passenger_id":15242,"location":[127.11685651,37.40194032],"timestamp":[532,532.9712726112996]},{"passenger_id":10248,"location":[127.15512344,37.41499974],"timestamp":[508,536.2743226428462]},{"passenger_id":3419,"location":[127.1044583,37.36823193],"timestamp":[516,533.7455826664683]},{"passenger_id":21069,"location":[127.0677948,37.37049484],"timestamp":[518,554.7321564592011]},{"passenger_id":21024,"location":[127.12647247,37.41378021],"timestamp":[523,533.8698657928908]},{"passenger_id":17904,"location":[127.16846858,37.44695903],"timestamp":[523,533.7107977112112]},{"passenger_id":17971,"location":[127.16298286,37.41194678],"timestamp":[524,571.3559200846436]},{"passenger_id":10339,"location":[127.10891865,37.34037399],"timestamp":[531,544.5451323651951]},{"passenger_id":15203,"location":[127.141614545603,37.4371482040725],"timestamp":[532,533.5847462951858]},{"passenger_id":10371,"location":[127.1110056,37.3962302],"timestamp":[532,534.5744779594288]},{"passenger_id":12885,"location":[127.17901922,37.4404256],"timestamp":[533,534.5125801619557]},{"passenger_id":5966,"location":[127.11883545,37.33613586],"timestamp":[533,556.6152915956396]},{"passenger_id":5958,"location":[127.1067276,37.37338257],"timestamp":[533,534.1261549938405]},{"passenger_id":15325,"location":[127.16881561,37.44054794],"timestamp":[534,535.7905103890884]},{"passenger_id":12887,"location":[127.17919159,37.44187546],"timestamp":[534,534.6968745695489]},{"passenger_id":15125,"location":[127.12703103,37.36691075],"timestamp":[508,534.7475099570405]},{"passenger_id":17855,"location":[127.13319932,37.44939974],"timestamp":[516,534.7140595349518]},{"passenger_id":21022,"location":[127.13815571,37.40870757],"timestamp":[523,535.4081517481832]},{"passenger_id":10334,"location":[127.10891635,37.3405463],"timestamp":[527,539.3250822000228]},{"passenger_id":21076,"location":[127.13923207,37.43510273],"timestamp":[528,534.1790990881256]},{"passenger_id":10353,"location":[127.13852845364,37.4428120583268],"timestamp":[528,534.9877659794528]},{"passenger_id":3407,"location":[127.12493896,37.35694122],"timestamp":[529,535.5636822855049]},{"passenger_id":5939,"location":[127.16240692,37.44535446],"timestamp":[529,534.5201056964225]},{"passenger_id":21122,"location":[127.10591888,37.36234283],"timestamp":[532,535.1547956894927]},{"passenger_id":15226,"location":[127.12417528,37.34707592],"timestamp":[533,535.7320895538927]},{"passenger_id":10338,"location":[127.127406300376,37.4556703130501],"timestamp":[533,535.6284812272379]},{"passenger_id":15224,"location":[127.16971588,37.44201279],"timestamp":[534,535.2476685953844]},{"passenger_id":12877,"location":[127.16524692,37.43961125],"timestamp":[534,534.3831816960424]},{"passenger_id":8490,"location":[127.17435455,37.43813324],"timestamp":[535,535.1581386107563]},{"passenger_id":10343,"location":[127.1786449,37.43821616],"timestamp":[535,535.8709006331729]},{"passenger_id":21041,"location":[127.17119598,37.44880295],"timestamp":[519,537.1884368009672]},{"passenger_id":12867,"location":[127.13189617,37.44901552],"timestamp":[521,535.7334397317874]},{"passenger_id":3378,"location":[127.077049,37.3915836],"timestamp":[521,535.9321387661756]},{"passenger_id":15189,"location":[127.09846128,37.41268957],"timestamp":[524,537.20397307691]},{"passenger_id":23683,"location":[127.146222850706,37.473384093523],"timestamp":[534,558.7908056494815]},{"passenger_id":10411,"location":[127.11885168,37.33986875],"timestamp":[535,613.8791891343003]},{"passenger_id":12995,"location":[127.10892696,37.40241202],"timestamp":[535,535.9391689124583]},{"passenger_id":17997,"location":[127.16972351,37.43188095],"timestamp":[536,538.2398232106763]},{"passenger_id":17845,"location":[127.15198442,37.42992977],"timestamp":[511,536.7313564711485]},{"passenger_id":10261,"location":[127.13687109,37.46199185],"timestamp":[512,538.1622475503722]},{"passenger_id":10328,"location":[127.10482865,37.36640347],"timestamp":[529,538.289958315686]},{"passenger_id":21057,"location":[127.10991072,37.34549171],"timestamp":[531,552.9483446820195]},{"passenger_id":17962,"location":[127.16600037,37.43385315],"timestamp":[536,538.7724049119087]},{"passenger_id":21099,"location":[127.15745929,37.44446994],"timestamp":[537,537.0094895251025]},{"passenger_id":17981,"location":[127.17279816,37.43924713],"timestamp":[537,537.3038152980039]},{"passenger_id":15188,"location":[127.14183192,37.43814603],"timestamp":[511,537.1095476538861]},{"passenger_id":15208,"location":[127.12922491,37.43220431],"timestamp":[514,537.8542024326357]},{"passenger_id":15193,"location":[127.07460785,37.38702774],"timestamp":[519,559.7781420557068]},{"passenger_id":15157,"location":[127.10808809,37.36626126],"timestamp":[520,537.2117172251477]},{"passenger_id":21038,"location":[127.16427037,37.43285474],"timestamp":[522,538.0818111099519]},{"passenger_id":15194,"location":[127.12660661,37.41233386],"timestamp":[522,537.9588937770598]},{"passenger_id":3376,"location":[127.13019562,37.40987396],"timestamp":[522,537.8499218038712]},{"passenger_id":10324,"location":[127.16017914,37.45176697],"timestamp":[530,537.9952259827604]},{"passenger_id":15204,"location":[127.10900237,37.34928925],"timestamp":[532,538.7869219892588]},{"passenger_id":21077,"location":[127.09593964,37.41213226],"timestamp":[532,538.2270845805067]},{"passenger_id":18001,"location":[127.12945283,37.43040216],"timestamp":[535,537.6112066449125]},{"passenger_id":881,"location":[127.16596617,37.43841264],"timestamp":[537,539.6057327873306]},{"passenger_id":17989,"location":[127.13587571,37.44454913],"timestamp":[511,538.895260648631]},{"passenger_id":12813,"location":[127.16404331,37.43288078],"timestamp":[511,539.0338634322696]},{"passenger_id":12824,"location":[127.10791966,37.36665801],"timestamp":[513,538.1977162303293]},{"passenger_id":12822,"location":[127.10900889,37.35072386],"timestamp":[515,538.5659360441879]},{"passenger_id":8444,"location":[127.16424561,37.43451309],"timestamp":[519,539.3238530623349]},{"passenger_id":5927,"location":[127.13426208,37.43373871],"timestamp":[523,538.5115882617375]},{"passenger_id":8469,"location":[127.115100819839,37.345759874313],"timestamp":[528,539.0935689844528]},{"passenger_id":18009,"location":[127.11482439,37.36221667],"timestamp":[529,539.5082740062223]},{"passenger_id":8472,"location":[127.12823486,37.41224289],"timestamp":[532,538.8345921128163]},{"passenger_id":20955,"location":[127.14540922,37.42853364],"timestamp":[510,539.1960880193808]},{"passenger_id":23651,"location":[127.154035,37.454841],"timestamp":[515,540.2461822396888]},{"passenger_id":8466,"location":[127.08959429,37.40705606],"timestamp":[519,539.4602542339014]},{"passenger_id":21199,"location":[127.1135025,37.34774017],"timestamp":[524,541.7322566952814]},{"passenger_id":3377,"location":[127.11482092,37.36240236],"timestamp":[524,539.4103205228865]},{"passenger_id":15225,"location":[127.12912727,37.43301006],"timestamp":[532,539.8499139070536]},{"passenger_id":12895,"location":[127.11824545,37.33641212],"timestamp":[537,569.842950009444]},{"passenger_id":15236,"location":[127.12301636,37.35998154],"timestamp":[537,541.0937501775243]},{"passenger_id":12844,"location":[127.15850382,37.45874062],"timestamp":[517,541.0620719177949]},{"passenger_id":15174,"location":[127.1579895,37.46058273],"timestamp":[517,540.8268648508126]},{"passenger_id":17901,"location":[127.16370557,37.43291867],"timestamp":[517,541.924101142254]},{"passenger_id":17887,"location":[127.15945412,37.45692852],"timestamp":[518,540.3831263942055]},{"passenger_id":12846,"location":[127.16019164,37.45232261],"timestamp":[520,540.7924595404378]},{"passenger_id":8452,"location":[127.12400155,37.38707522],"timestamp":[521,540.7700836001893]},{"passenger_id":21102,"location":[127.14392853,37.41334915],"timestamp":[531,541.337667236829]},{"passenger_id":15216,"location":[127.15196366,37.45038414],"timestamp":[535,540.8417390847427]},{"passenger_id":17985,"location":[127.15890589,37.43706515],"timestamp":[536,540.5047626994574]},{"passenger_id":10361,"location":[127.11392545,37.40055751],"timestamp":[536,541.0757720723282]},{"passenger_id":23671,"location":[127.10876897,37.39621191],"timestamp":[538,541.6057102367114]},{"passenger_id":3393,"location":[127.13452083,37.4658662],"timestamp":[538,543.5655146843272]},{"passenger_id":15253,"location":[127.10676575,37.36854935],"timestamp":[538,541.030717758593]},{"passenger_id":15219,"location":[127.1315918,37.38090515],"timestamp":[522,541.8376684841376]},{"passenger_id":5928,"location":[127.1056366,37.37615967],"timestamp":[523,541.2849871720504]},{"passenger_id":21049,"location":[127.16912887,37.44709565],"timestamp":[528,541.8049709464707]},{"passenger_id":15215,"location":[127.13280935,37.42896527],"timestamp":[529,541.6894709105737]},{"passenger_id":10349,"location":[127.1241684,37.38415527],"timestamp":[532,541.2856230118196]},{"passenger_id":10363,"location":[127.15532497,37.44403109],"timestamp":[534,542.0530190374434]},{"passenger_id":3420,"location":[127.14126602,37.44455673],"timestamp":[537,541.9580308687306]},{"passenger_id":870,"location":[127.11099211,37.39376581],"timestamp":[538,541.9531149934752]},{"passenger_id":17996,"location":[127.15581997,37.45022975],"timestamp":[538,541.5935362868581]},{"passenger_id":8528,"location":[127.1161131,37.3383707],"timestamp":[538,542.1903669411197]},{"passenger_id":10427,"location":[127.11776116,37.35930408],"timestamp":[538,542.296907746407]},{"passenger_id":18045,"location":[127.12526019,37.40990913],"timestamp":[540,541.9548132310905]},{"passenger_id":21116,"location":[127.18117071,37.44136036],"timestamp":[540,543.7714546508156]},{"passenger_id":8514,"location":[127.09466576,37.43013158],"timestamp":[540,542.3267287957433]},{"passenger_id":15273,"location":[127.14026516,37.43813355],"timestamp":[541,542.1893258776932]},{"passenger_id":18014,"location":[127.12311026,37.41486215],"timestamp":[542,543.2723221003029]},{"passenger_id":17890,"location":[127.11213185,37.37662406],"timestamp":[513,542.9662857437816]},{"passenger_id":21063,"location":[127.12828827,37.43982315],"timestamp":[535,542.5991367500781]},{"passenger_id":3405,"location":[127.10195923,37.3765564],"timestamp":[539,543.5790169007415]},{"passenger_id":18020,"location":[127.11360632,37.35192214],"timestamp":[541,544.4680771823456]},{"passenger_id":5967,"location":[127.11339578,37.34599308],"timestamp":[543,572.5948430567128]},{"passenger_id":12868,"location":[127.13165447,37.44087171],"timestamp":[523,543.1207339680873]},{"passenger_id":23680,"location":[127.16605851,37.44644108],"timestamp":[524,543.9691123658732]},{"passenger_id":17917,"location":[127.14642809,37.44986368],"timestamp":[526,543.179961788132]},{"passenger_id":17953,"location":[127.1609664,37.4411466],"timestamp":[530,543.4724119646477]},{"passenger_id":12956,"location":[127.17190117,37.44143856],"timestamp":[539,545.0378157783733]},{"passenger_id":10379,"location":[127.10881348,37.34973689],"timestamp":[540,584.0370156795321]},{"passenger_id":8519,"location":[127.16125834,37.4121738],"timestamp":[542,551.3160093120827]},{"passenger_id":21125,"location":[127.16867494,37.44078976],"timestamp":[542,544.1693578615713]},{"passenger_id":15282,"location":[127.09836773,37.41270978],"timestamp":[542,545.0689411548815]},{"passenger_id":5968,"location":[127.16407013,37.43304825],"timestamp":[544,546.0620163700607]},{"passenger_id":12863,"location":[127.12933964,37.40983966],"timestamp":[515,544.7102379589886]},{"passenger_id":12864,"location":[127.10808809,37.36626181],"timestamp":[518,544.0852292521334]},{"passenger_id":15230,"location":[127.10805573,37.37114874],"timestamp":[529,544.988454281026]},{"passenger_id":8495,"location":[127.10976268,37.37513452],"timestamp":[532,544.5439303408327]},{"passenger_id":21110,"location":[127.12112427,37.38612747],"timestamp":[533,545.1736756742813]},{"passenger_id":5947,"location":[127.15812514,37.43618913],"timestamp":[534,544.6839503801692]},{"passenger_id":21081,"location":[127.13702393,37.44235229],"timestamp":[537,544.2411286291971]},{"passenger_id":21151,"location":[127.15510559,37.40605545],"timestamp":[539,545.5087071942468]},{"passenger_id":18012,"location":[127.12317496,37.38855613],"timestamp":[540,544.180296233704]},{"passenger_id":21164,"location":[127.10715723,37.35134928],"timestamp":[542,574.2720526192527]},{"passenger_id":8494,"location":[127.12359629,37.38349128],"timestamp":[543,544.5210959549207]},{"passenger_id":18007,"location":[127.16916191,37.44213629],"timestamp":[545,546.5541463481572]},{"passenger_id":17910,"location":[127.163111634844,37.445820373191],"timestamp":[516,545.6586499822548]},{"passenger_id":15198,"location":[127.14241791,37.36823273],"timestamp":[526,546.2215403158389]},{"passenger_id":15221,"location":[127.12781665,37.43870202],"timestamp":[528,545.2057621700261]},{"passenger_id":21070,"location":[127.12930298,37.43101883],"timestamp":[530,545.1901647333965]},{"passenger_id":15201,"location":[127.14562988,37.44034576],"timestamp":[530,545.3848189960974]},{"passenger_id":12946,"location":[127.13887935,37.44745237],"timestamp":[534,545.3580939826631]},{"passenger_id":21089,"location":[127.14426422,37.44016647],"timestamp":[535,545.6262173837971]},{"passenger_id":3403,"location":[127.10913086,37.34976959],"timestamp":[540,619.4695652916193]},{"passenger_id":5959,"location":[127.12380219,37.38370895],"timestamp":[541,545.938747740421]},{"passenger_id":15249,"location":[127.11094318,37.39622989],"timestamp":[542,547.0797056157178]},{"passenger_id":10420,"location":[127.14727783,37.44107437],"timestamp":[542,545.5973810352341]},{"passenger_id":21149,"location":[127.12935821,37.43122514],"timestamp":[543,545.5784092504834]},{"passenger_id":21121,"location":[127.17325931,37.44999788],"timestamp":[544,547.089163601449]},{"passenger_id":21141,"location":[127.11201325,37.34719736],"timestamp":[546,576.0416753934502]},{"passenger_id":21150,"location":[127.17016921,37.44076438],"timestamp":[546,546.4352930921623]},{"passenger_id":15293,"location":[127.12302421,37.38614143],"timestamp":[546,546.4012334301634]},{"passenger_id":888,"location":[127.10635376,37.40306854],"timestamp":[546,547.2468843831468]},{"passenger_id":17942,"location":[127.10948142,37.35000783],"timestamp":[526,563.3171960207918]},{"passenger_id":8480,"location":[127.12709808,37.45049667],"timestamp":[537,546.8349123983909]},{"passenger_id":5952,"location":[127.15763681,37.44503503],"timestamp":[539,546.7016733472627]},{"passenger_id":10387,"location":[127.13926697,37.37611771],"timestamp":[547,547.4357209825297]},{"passenger_id":15302,"location":[127.1791458,37.43929262],"timestamp":[547,548.7475328988887]},{"passenger_id":10433,"location":[127.1681551,37.44073239],"timestamp":[539,549.1391737251829]},{"passenger_id":12920,"location":[127.12795258,37.46644592],"timestamp":[544,551.586114753198]},{"passenger_id":18027,"location":[127.13396848,37.38118946],"timestamp":[547,548.7791701556665]},{"passenger_id":869,"location":[127.12827301,37.41226578],"timestamp":[522,549.6940491296073]},{"passenger_id":12891,"location":[127.12687062,37.44388715],"timestamp":[529,548.9300206057277]},{"passenger_id":18023,"location":[127.11689758,37.3800087],"timestamp":[534,549.7948638213635]},{"passenger_id":12965,"location":[127.15248871,37.42897415],"timestamp":[537,548.7524949533521]},{"passenger_id":18008,"location":[127.16023805,37.43828067],"timestamp":[538,548.7467768909244]},{"passenger_id":10375,"location":[127.13276672,37.45265579],"timestamp":[539,548.8864447438]},{"passenger_id":21179,"location":[127.1599635,37.45175559],"timestamp":[540,548.203858165452]},{"passenger_id":12897,"location":[127.15870144,37.43322981],"timestamp":[541,548.2581764287382]},{"passenger_id":10401,"location":[127.11268395,37.39832484],"timestamp":[542,548.7629609357068]},{"passenger_id":21127,"location":[127.167142165453,37.4458425952692],"timestamp":[542,548.6221425627754]},{"passenger_id":21167,"location":[127.14120909,37.40775939],"timestamp":[543,548.6526070793268]},{"passenger_id":21154,"location":[127.1241684,37.34699631],"timestamp":[548,549.1399579684198]},{"passenger_id":17965,"location":[127.0983261,37.43103992],"timestamp":[528,553.2741986999966]},{"passenger_id":8499,"location":[127.07699585,37.39176178],"timestamp":[533,550.0430679781381]},{"passenger_id":15312,"location":[127.11124469,37.40423741],"timestamp":[536,549.8146313186935]},{"passenger_id":3421,"location":[127.13446045,37.44180679],"timestamp":[538,549.9316156563505]},{"passenger_id":12901,"location":[127.12224958,37.38775746],"timestamp":[539,549.8377537758255]},{"passenger_id":10372,"location":[127.16572225,37.43881546],"timestamp":[540,552.1793691793479]},{"passenger_id":12903,"location":[127.15937162,37.45032879],"timestamp":[542,549.9973540633994]},{"passenger_id":23675,"location":[127.12415718,37.38488501],"timestamp":[547,550.0130844133159]},{"passenger_id":890,"location":[127.12618256,37.41320038],"timestamp":[548,549.4623649697216]},{"passenger_id":21148,"location":[127.16589802,37.44244472],"timestamp":[548,551.2586380861205]},{"passenger_id":12954,"location":[127.15545049,37.43441846],"timestamp":[549,549.0970458144598]},{"passenger_id":858,"location":[127.15799224,37.44694765],"timestamp":[522,550.9746331058876]},{"passenger_id":21157,"location":[127.09640503,37.43009186],"timestamp":[543,551.6567232919166]},{"passenger_id":15278,"location":[127.1022967,37.42693791],"timestamp":[546,550.5476250654208]},{"passenger_id":15347,"location":[127.10805585,37.37113949],"timestamp":[550,550.2199907653851]},{"passenger_id":23685,"location":[127.117023,37.349259],"timestamp":[550,551.3882523448926]},{"passenger_id":3402,"location":[127.11445618,37.38726807],"timestamp":[537,551.9787029655565]},{"passenger_id":10390,"location":[127.10905457,37.35042572],"timestamp":[537,551.9251894813469]},{"passenger_id":3515,"location":[127.09796143,37.41274643],"timestamp":[541,551.9117514102616]},{"passenger_id":21119,"location":[127.11677636,37.35849025],"timestamp":[544,551.6975104711157]},{"passenger_id":12981,"location":[127.16607828,37.45025956],"timestamp":[547,551.19331890514]},{"passenger_id":10306,"location":[127.14529419,37.43985367],"timestamp":[524,552.6347443040106]},{"passenger_id":17906,"location":[127.16594832,37.44641723],"timestamp":[527,553.1084433899294]},{"passenger_id":18101,"location":[127.14959717,37.44935226],"timestamp":[534,552.5235716326226]},{"passenger_id":3486,"location":[127.16091452,37.45397593],"timestamp":[539,552.7553019774332]},{"passenger_id":17998,"location":[127.1288147,37.3980217],"timestamp":[542,552.5637749663415]},{"passenger_id":18056,"location":[127.13631439,37.43434525],"timestamp":[545,553.0879419493746]},{"passenger_id":6008,"location":[127.12400818,37.38874435],"timestamp":[545,552.2713452639564]},{"passenger_id":21123,"location":[127.13054657,37.43320084],"timestamp":[546,553.2651134474165]},{"passenger_id":12934,"location":[127.12301768,37.35150788],"timestamp":[552,552.6927505730645]},{"passenger_id":21210,"location":[127.12933668,37.43140266],"timestamp":[553,553.0714872465586]},{"passenger_id":17995,"location":[127.12403934,37.38381618],"timestamp":[534,553.8293004635059]},{"passenger_id":10365,"location":[127.1071422,37.36853086],"timestamp":[543,553.380717634764]},{"passenger_id":10423,"location":[127.15062714,37.44208145],"timestamp":[548,554.0041335276107]},{"passenger_id":21203,"location":[127.112854,37.39468002],"timestamp":[553,553.4044265289606]},{"passenger_id":21214,"location":[127.10901219,37.35062141],"timestamp":[554,554.3289579513587]},{"passenger_id":907,"location":[127.06433868,37.39020157],"timestamp":[554,586.4585945476252]},{"passenger_id":23677,"location":[127.162245,37.458495],"timestamp":[539,554.1896368677918]},{"passenger_id":5979,"location":[127.07143688,37.38972268],"timestamp":[545,569.5647201890471]},{"passenger_id":8522,"location":[127.10901029,37.35068033],"timestamp":[545,554.1131706626139]},{"passenger_id":18002,"location":[127.16537476,37.43587875],"timestamp":[545,556.5098981396255]},{"passenger_id":21153,"location":[127.13301931,37.43359005],"timestamp":[553,554.8639656563797]},{"passenger_id":5995,"location":[127.15516235,37.44995186],"timestamp":[553,555.2667948607769]},{"passenger_id":12951,"location":[127.15564343,37.44658161],"timestamp":[554,554.2933517121693]},{"passenger_id":21096,"location":[127.15616694,37.44460406],"timestamp":[527,555.6278010807667]},{"passenger_id":18011,"location":[127.16117794,37.44542438],"timestamp":[529,555.991457588197]},{"passenger_id":17940,"location":[127.10901132,37.35064837],"timestamp":[532,555.3144853420339]},{"passenger_id":18005,"location":[127.10641864,37.4223298],"timestamp":[533,556.2695362205914]},{"passenger_id":877,"location":[127.13036346,37.40988922],"timestamp":[538,555.6212545480286]},{"passenger_id":12923,"location":[127.1376467,37.37388327],"timestamp":[540,555.9252085959262]},{"passenger_id":15259,"location":[127.14160156,37.43527985],"timestamp":[544,555.3924225298646]},{"passenger_id":12959,"location":[127.11153989,37.34431688],"timestamp":[549,582.313046388362]},{"passenger_id":12993,"location":[127.13070679,37.44766998],"timestamp":[552,555.8960647178382]},{"passenger_id":21159,"location":[127.10792743,37.35076443],"timestamp":[552,578.6853330431952]},{"passenger_id":10396,"location":[127.11482365,37.36225615],"timestamp":[554,556.1958874300059]},{"passenger_id":8471,"location":[127.16483307,37.45899963],"timestamp":[527,557.1043453226118]},{"passenger_id":10327,"location":[127.15864277,37.44847541],"timestamp":[530,557.5834611571482]},{"passenger_id":21086,"location":[127.16757965,37.45119858],"timestamp":[534,557.1616083391978]},{"passenger_id":15269,"location":[127.10881346,37.35069784],"timestamp":[538,625.1483841686859]},{"passenger_id":15300,"location":[127.10901064,37.35066965],"timestamp":[542,557.1845732919816]},{"passenger_id":3413,"location":[127.09535217,37.40248108],"timestamp":[548,557.1176447809482]},{"passenger_id":23690,"location":[127.1252,37.432217],"timestamp":[551,556.4798637776443]},{"passenger_id":18067,"location":[127.12601654,37.41025067],"timestamp":[554,556.6089355154293]},{"passenger_id":3435,"location":[127.10601044,37.40125275],"timestamp":[554,556.8103417130941]},{"passenger_id":6006,"location":[127.16677094,37.4610672],"timestamp":[557,557.2596392307872]},{"passenger_id":8468,"location":[127.16445261,37.44090256],"timestamp":[534,557.9043882827677]},{"passenger_id":5986,"location":[127.16625977,37.45094681],"timestamp":[537,558.094524698755]},{"passenger_id":5965,"location":[127.11577616,37.40412764],"timestamp":[540,558.6811939802596]},{"passenger_id":21147,"location":[127.09886169,37.43035126],"timestamp":[543,557.155593617473]},{"passenger_id":15290,"location":[127.11072677,37.39622879],"timestamp":[552,559.294910822025]},{"passenger_id":12933,"location":[127.15089417,37.44226074],"timestamp":[552,557.6683302986398]},{"passenger_id":3432,"location":[127.09992218,37.40216827],"timestamp":[557,557.8926511355202]},{"passenger_id":18015,"location":[127.16454315,37.43595886],"timestamp":[546,559.0128541962116]},{"passenger_id":3416,"location":[127.10655975,37.36557007],"timestamp":[546,558.6988423779176]},{"passenger_id":15289,"location":[127.11124125,37.37278976],"timestamp":[549,558.7692213171173]},{"passenger_id":10408,"location":[127.11423492,37.40726852],"timestamp":[551,560.6877590846254]},{"passenger_id":893,"location":[127.1294632,37.43041611],"timestamp":[552,558.8542331270313]},{"passenger_id":12935,"location":[127.11108398,37.39645386],"timestamp":[552,560.5831733939962]},{"passenger_id":10393,"location":[127.12900543,37.41230774],"timestamp":[536,560.1140476880896]},{"passenger_id":8488,"location":[127.12679863,37.44954156],"timestamp":[541,559.0435059252169]},{"passenger_id":21146,"location":[127.10945892,37.39495087],"timestamp":[551,561.2153096532006]},{"passenger_id":3422,"location":[127.11105448,37.39623045],"timestamp":[552,560.988060109894]},{"passenger_id":10414,"location":[127.13285065,37.4731369],"timestamp":[553,563.1183216768953]},{"passenger_id":21209,"location":[127.1116333,37.33872986],"timestamp":[558,571.1945812510194]},{"passenger_id":3442,"location":[127.08026272,37.39100426],"timestamp":[558,560.0718204341792]},{"passenger_id":18084,"location":[127.12611929,37.41073404],"timestamp":[560,560.046486021781]},{"passenger_id":21114,"location":[127.138756230008,37.4428926133888],"timestamp":[546,560.4823888578355]},{"passenger_id":15291,"location":[127.11496735,37.36245346],"timestamp":[550,561.4001058473904]},{"passenger_id":6000,"location":[127.16971588,37.44160843],"timestamp":[553,561.6289545030535]},{"passenger_id":12941,"location":[127.16425467,37.43512276],"timestamp":[554,561.5590580829913]},{"passenger_id":10425,"location":[127.15254974,37.4589386],"timestamp":[557,563.7446261145765]},{"passenger_id":12940,"location":[127.16426184,37.45829301],"timestamp":[558,561.0144251235222]},{"passenger_id":15313,"location":[127.13896942,37.43505096],"timestamp":[560,560.3254253534784]},{"passenger_id":18054,"location":[127.16964722,37.44161606],"timestamp":[560,561.3542382747306]},{"passenger_id":17934,"location":[127.16197204,37.4555109],"timestamp":[533,561.8510069477829]},{"passenger_id":18038,"location":[127.14356502,37.44166158],"timestamp":[540,561.4133143981044]},{"passenger_id":18059,"location":[127.07180055,37.3925748],"timestamp":[546,562.7096115094936]},{"passenger_id":3412,"location":[127.11154738,37.39623295],"timestamp":[548,561.5097395407341]},{"passenger_id":18049,"location":[127.12659829,37.45983729],"timestamp":[548,562.3161625920856]},{"passenger_id":8507,"location":[127.13303521,37.44878823],"timestamp":[552,561.6957769441915]},{"passenger_id":10430,"location":[127.11058044,37.39382172],"timestamp":[555,561.5797866180484]},{"passenger_id":15304,"location":[127.1230074,37.35150788],"timestamp":[559,561.7494701750245]},{"passenger_id":10465,"location":[127.10894048,37.33912999],"timestamp":[559,586.7427273793855]},{"passenger_id":21195,"location":[127.16700745,37.46115112],"timestamp":[559,561.5562445877716]},{"passenger_id":901,"location":[127.10855103,37.4024086],"timestamp":[562,563.2995325073127]},{"passenger_id":8491,"location":[127.116484144915,37.3740152570195],"timestamp":[536,563.1487899594686]},{"passenger_id":3414,"location":[127.12208254,37.38760433],"timestamp":[537,562.231977027884]},{"passenger_id":15261,"location":[127.16411443,37.44598145],"timestamp":[544,562.7536859002079]},{"passenger_id":10413,"location":[127.11089141,37.3959795],"timestamp":[550,564.2637705742743]},{"passenger_id":885,"location":[127.10968018,37.39476776],"timestamp":[552,565.138870881336]},{"passenger_id":21225,"location":[127.10250092,37.35754776],"timestamp":[554,562.6895522366541]},{"passenger_id":12960,"location":[127.12966919,37.36481476],"timestamp":[556,562.8412789167286]},{"passenger_id":15298,"location":[127.14700188,37.44082457],"timestamp":[556,562.2692162067658]},{"passenger_id":18053,"location":[127.17872493,37.43162769],"timestamp":[561,578.545258235758]},{"passenger_id":8524,"location":[127.11103058,37.39603043],"timestamp":[561,563.4665096050202]},{"passenger_id":21185,"location":[127.08293959,37.39107469],"timestamp":[562,563.0863026705858]},{"passenger_id":909,"location":[127.0981416,37.4092774],"timestamp":[562,563.7650272834189]},{"passenger_id":21184,"location":[127.12498474,37.38802719],"timestamp":[563,563.4581675041015]},{"passenger_id":3408,"location":[127.1118711,37.38934578],"timestamp":[539,564.7064395083108]},{"passenger_id":8502,"location":[127.13523102,37.44185638],"timestamp":[541,563.5997384451845]},{"passenger_id":18036,"location":[127.16446207,37.44609491],"timestamp":[547,562.8200496088855]},{"passenger_id":3431,"location":[127.12023163,37.35983658],"timestamp":[550,564.2939159439859]},{"passenger_id":21183,"location":[127.15707932,37.43183676],"timestamp":[555,564.0175498285614]},{"passenger_id":15307,"location":[127.10968412,37.39459762],"timestamp":[562,563.6185455680128]},{"passenger_id":15328,"location":[127.14039236,37.43803444],"timestamp":[563,564.2030655158817]},{"passenger_id":12936,"location":[127.14215329,37.36633468],"timestamp":[541,567.4396860727161]},{"passenger_id":12938,"location":[127.15732517,37.44587795],"timestamp":[557,564.350365052391]},{"passenger_id":903,"location":[127.12218844,37.38491557],"timestamp":[558,564.5063593328015]},{"passenger_id":5992,"location":[127.16605443,37.45032051],"timestamp":[559,564.2719226325379]},{"passenger_id":23694,"location":[127.11144885,37.39623245],"timestamp":[562,564.7796078997753]},{"passenger_id":10464,"location":[127.10475354,37.44773244],"timestamp":[563,572.4037205929721]},{"passenger_id":10505,"location":[127.0747441,37.38713443],"timestamp":[563,565.5298412161994]},{"passenger_id":8573,"location":[127.113992493283,37.3388515832445],"timestamp":[564,568.5243646239447]},{"passenger_id":12973,"location":[127.14148804,37.43796044],"timestamp":[564,564.6079253919651]},{"passenger_id":12902,"location":[127.1295237,37.4123335],"timestamp":[536,565.2658951507419]},{"passenger_id":15263,"location":[127.11435699,37.40659332],"timestamp":[545,566.0495760243388]},{"passenger_id":12949,"location":[127.14969483,37.45390534],"timestamp":[546,565.9114441705949]},{"passenger_id":15379,"location":[127.12299274,37.35150788],"timestamp":[553,565.5099860103414]},{"passenger_id":6013,"location":[127.12893657,37.43235275],"timestamp":[555,565.4436312790517]},{"passenger_id":3441,"location":[127.11394501,37.40052414],"timestamp":[561,567.2049051886966]},{"passenger_id":10453,"location":[127.1583252,37.44766998],"timestamp":[564,565.2851961964802]},{"passenger_id":8532,"location":[127.11392198,37.3899257],"timestamp":[564,565.6396930209563]},{"passenger_id":23681,"location":[127.117228,37.397024],"timestamp":[541,566.6791829754708]},{"passenger_id":15268,"location":[127.11688995,37.39022827],"timestamp":[545,567.401442421115]},{"passenger_id":18039,"location":[127.14533153,37.43985411],"timestamp":[554,566.5211911876996]},{"passenger_id":5999,"location":[127.12104969,37.38625252],"timestamp":[556,566.8139796997334]},{"passenger_id":18092,"location":[127.1661575,37.45002272],"timestamp":[560,566.7665221350702]},{"passenger_id":3465,"location":[127.09751129,37.38953781],"timestamp":[563,567.9694863080588]},{"passenger_id":10514,"location":[127.1750062,37.4389728],"timestamp":[565,566.9372374315836]},{"passenger_id":18090,"location":[127.10746313,37.36686349],"timestamp":[565,566.9372972779844]},{"passenger_id":15399,"location":[127.10893741,37.33926624],"timestamp":[567,571.3460907303775]},{"passenger_id":18131,"location":[127.098195369576,37.4128344640981],"timestamp":[567,567.0940903292396]},{"passenger_id":10367,"location":[127.11099253,37.39597446],"timestamp":[541,569.0753082955005]},{"passenger_id":18006,"location":[127.16049366,37.43331173],"timestamp":[542,567.9845128666137]},{"passenger_id":5980,"location":[127.09968567,37.43026352],"timestamp":[545,568.251050613041]},{"passenger_id":886,"location":[127.11144647,37.39177345],"timestamp":[546,567.1750548482139]},{"passenger_id":8521,"location":[127.13820119,37.43480567],"timestamp":[546,567.4628691268406]},{"passenger_id":12970,"location":[127.13646698,37.43423843],"timestamp":[554,567.6753450731758]},{"passenger_id":15369,"location":[127.1058197,37.36239243],"timestamp":[557,567.9267894442236]},{"passenger_id":18248,"location":[127.12228916,37.38587467],"timestamp":[561,567.7867864273494]},{"passenger_id":18078,"location":[127.14685669,37.44076774],"timestamp":[562,568.2743906282011]},{"passenger_id":8549,"location":[127.09738159,37.40055847],"timestamp":[564,567.6868999894809]},{"passenger_id":15317,"location":[127.12682335,37.44865262],"timestamp":[565,575.4446203576987]},{"passenger_id":15344,"location":[127.10892779,37.3396941],"timestamp":[566,573.4891734155908]},{"passenger_id":21204,"location":[127.11308658,37.40276988],"timestamp":[568,570.1292736788995]},{"passenger_id":21192,"location":[127.10808808,37.36649917],"timestamp":[548,568.765626828947]},{"passenger_id":8497,"location":[127.13383484,37.43643951],"timestamp":[549,568.6610220635453]},{"passenger_id":15279,"location":[127.15751648,37.43237686],"timestamp":[552,568.5540076293498]},{"passenger_id":8529,"location":[127.13486909,37.38510297],"timestamp":[553,568.3256924070976]},{"passenger_id":15281,"location":[127.11606526,37.36875565],"timestamp":[553,568.2719356244043]},{"passenger_id":23686,"location":[127.145418,37.452231],"timestamp":[555,568.9985337216697]},{"passenger_id":8533,"location":[127.11153443,37.39376918],"timestamp":[557,569.0455813507218]},{"passenger_id":18095,"location":[127.10123771,37.41525045],"timestamp":[564,569.367018058452]},{"passenger_id":21196,"location":[127.17949518,37.44496905],"timestamp":[567,569.2307431142605]},{"passenger_id":15352,"location":[127.11109161,37.3960228],"timestamp":[568,570.0707594104313]},{"passenger_id":15275,"location":[127.11063776,37.3937629],"timestamp":[540,569.3782244654146]},{"passenger_id":18026,"location":[127.11258698,37.37319565],"timestamp":[551,570.2577533100841]},{"passenger_id":3444,"location":[127.13270569,37.43362808],"timestamp":[555,570.3215121120727]},{"passenger_id":8526,"location":[127.112078616629,37.3766513520259],"timestamp":[556,569.295242860941]},{"passenger_id":21228,"location":[127.10532978,37.37487416],"timestamp":[557,569.750118587796]},{"passenger_id":21193,"location":[127.155761680371,37.4507092321927],"timestamp":[560,569.6837378020946]},{"passenger_id":10421,"location":[127.12376404,37.38464355],"timestamp":[562,569.1493870164555]},{"passenger_id":21197,"location":[127.11446783,37.36344611],"timestamp":[567,570.0739638316875]},{"passenger_id":18188,"location":[127.12837982,37.45328522],"timestamp":[569,570.1008744149308]},{"passenger_id":15354,"location":[127.12854012,37.43617914],"timestamp":[570,570.36329968605]},{"passenger_id":8581,"location":[127.12740326,37.45061111],"timestamp":[570,578.4794887053089]},{"passenger_id":15378,"location":[127.16717529,37.4510498],"timestamp":[554,571.3474540013252]},{"passenger_id":8516,"location":[127.15762087,37.44503696],"timestamp":[555,570.6589842712867]},{"passenger_id":21201,"location":[127.12211954,37.38254452],"timestamp":[557,570.5289423149208]},{"passenger_id":18062,"location":[127.12814179,37.41232637],"timestamp":[558,570.6255015456378]},{"passenger_id":10426,"location":[127.12360445,37.38349726],"timestamp":[560,571.0743829473809]},{"passenger_id":10456,"location":[127.11666107,37.39313889],"timestamp":[565,571.3058344905492]},{"passenger_id":15345,"location":[127.12209999,37.38762033],"timestamp":[568,570.6662954468131]},{"passenger_id":12992,"location":[127.15429363,37.4476111],"timestamp":[570,571.0903267228904]},{"passenger_id":10467,"location":[127.15575327,37.40538312],"timestamp":[570,570.6018773439403]},{"passenger_id":8506,"location":[127.107900864569,37.3661903049266],"timestamp":[543,571.6545775083264]},{"passenger_id":15364,"location":[127.1077652,37.34686661],"timestamp":[558,575.6986089049888]},{"passenger_id":12996,"location":[127.10891613,37.34056275],"timestamp":[561,571.7335568545985]},{"passenger_id":18151,"location":[127.06804927,37.36718504],"timestamp":[563,596.9122448901715]},{"passenger_id":13038,"location":[127.12298241,37.35150788],"timestamp":[567,571.8176184132714]},{"passenger_id":12987,"location":[127.10784912,37.36629868],"timestamp":[569,572.1714959762278]},{"passenger_id":10459,"location":[127.16751099,37.44604874],"timestamp":[570,571.3999820337065]},{"passenger_id":18141,"location":[127.07467956,37.38695523],"timestamp":[571,586.8524063521844]},{"passenger_id":12957,"location":[127.14573457,37.40749044],"timestamp":[543,572.6000893872327]},{"passenger_id":8501,"location":[127.10132174,37.41870131],"timestamp":[545,573.2063637606973]},{"passenger_id":3411,"location":[127.12373352,37.38436127],"timestamp":[547,572.5482535185374]},{"passenger_id":5976,"location":[127.13143593,37.42906398],"timestamp":[547,572.2836618248699]},{"passenger_id":5974,"location":[127.16617215,37.44646569],"timestamp":[552,573.3150426085058]},{"passenger_id":21253,"location":[127.10707855,37.34817123],"timestamp":[558,590.1506021711557]},{"passenger_id":5994,"location":[127.12241364,37.39467621],"timestamp":[561,573.0109428407925]},{"passenger_id":15395,"location":[127.14058861,37.4435373],"timestamp":[562,572.9091755481279]},{"passenger_id":13053,"location":[127.16858471,37.44005701],"timestamp":[567,573.3014745937685]},{"passenger_id":21232,"location":[127.14003371,37.4433689],"timestamp":[569,573.145905633876]},{"passenger_id":13090,"location":[127.09625191,37.40934201],"timestamp":[570,574.3592974968681]},{"passenger_id":15466,"location":[127.09485201,37.41085929],"timestamp":[572,573.1538696366141]},{"passenger_id":3509,"location":[127.11078409,37.3937641],"timestamp":[572,572.1811949677589]},{"passenger_id":15285,"location":[127.12937106,37.43111917],"timestamp":[551,573.545932205908]},{"passenger_id":15314,"location":[127.13391113,37.44963074],"timestamp":[556,576.448773289557]},{"passenger_id":13001,"location":[127.12023163,37.35997391],"timestamp":[567,573.6321677515151]},{"passenger_id":15393,"location":[127.1632761,37.4113513],"timestamp":[570,581.260771314488]},{"passenger_id":23705,"location":[127.10280766,37.40318821],"timestamp":[571,574.3773602730425]},{"passenger_id":10528,"location":[127.13985663,37.4513782],"timestamp":[572,573.7761000574978]},{"passenger_id":8566,"location":[127.13147838,37.45420788],"timestamp":[572,587.5904448517664]},{"passenger_id":18148,"location":[127.1262331,37.41233385],"timestamp":[573,574.1088020750337]},{"passenger_id":23688,"location":[127.12070412,37.40545906],"timestamp":[546,574.4760007002643]},{"passenger_id":18030,"location":[127.12261999,37.40765102],"timestamp":[546,574.7044101342349]},{"passenger_id":12932,"location":[127.17240678,37.4477865],"timestamp":[554,574.8669346110075]},{"passenger_id":21177,"location":[127.14477226,37.40642213],"timestamp":[557,575.4418491481616]},{"passenger_id":6012,"location":[127.12684631,37.38320923],"timestamp":[561,574.8136464741413]},{"passenger_id":18114,"location":[127.1343879,37.38101358],"timestamp":[563,575.3346749375826]},{"passenger_id":15359,"location":[127.12392426,37.3887291],"timestamp":[564,574.1332085536087]},{"passenger_id":13040,"location":[127.09559631,37.40019989],"timestamp":[569,576.0333799389001]},{"passenger_id":13009,"location":[127.13040688,37.42946592],"timestamp":[572,574.5644703174232]},{"passenger_id":3464,"location":[127.0933075,37.4017334],"timestamp":[573,575.7411919845139]},{"passenger_id":10483,"location":[127.07702656,37.39158527],"timestamp":[574,574.4397412305347]},{"passenger_id":3467,"location":[127.12097168,37.38688278],"timestamp":[575,575.2951788245696]},{"passenger_id":18076,"location":[127.16141655,37.43934933],"timestamp":[546,576.2281821634981]},{"passenger_id":8496,"location":[127.10688848,37.3724434],"timestamp":[547,575.262356166089]},{"passenger_id":10466,"location":[127.118195245249,37.3547875968523],"timestamp":[555,576.1463170743265]},{"passenger_id":12966,"location":[127.15057153,37.41321751],"timestamp":[557,577.3590831142318]},{"passenger_id":18115,"location":[127.12862724,37.41103794],"timestamp":[564,575.6228884613479]},{"passenger_id":15361,"location":[127.11597536,37.35986801],"timestamp":[573,575.838121453348]},{"passenger_id":13055,"location":[127.10977173,37.40174484],"timestamp":[573,577.4945127194152]},{"passenger_id":10472,"location":[127.16596222,37.450634],"timestamp":[573,576.1907435610299]},{"passenger_id":18109,"location":[127.17074381,37.44015625],"timestamp":[574,575.8166292194841]},{"passenger_id":18128,"location":[127.12198639,37.38261032],"timestamp":[575,575.2733931269363]},{"passenger_id":10494,"location":[127.11086535,37.39622949],"timestamp":[576,577.9082393328677]},{"passenger_id":18223,"location":[127.10595337,37.36614314],"timestamp":[571,576.7349690171044]},{"passenger_id":10518,"location":[127.10812436,37.3611545],"timestamp":[573,576.8263496808871]},{"passenger_id":13018,"location":[127.1112442,37.39648819],"timestamp":[575,576.6247029606058]},{"passenger_id":920,"location":[127.11570629,37.40581144],"timestamp":[575,576.0816605412846]},{"passenger_id":10437,"location":[127.16607913,37.44644555],"timestamp":[552,577.994937822327]},{"passenger_id":891,"location":[127.09342957,37.39001465],"timestamp":[552,578.8455585549923]},{"passenger_id":18123,"location":[127.16699982,37.44467545],"timestamp":[561,577.5091037026885]},{"passenger_id":21258,"location":[127.12765771,37.43455991],"timestamp":[571,577.721403947814]},{"passenger_id":18206,"location":[127.17042227,37.44039261],"timestamp":[572,578.1691655971827]},{"passenger_id":21239,"location":[127.15348982,37.44310803],"timestamp":[573,577.2757495193932]},{"passenger_id":21280,"location":[127.10732269,37.34676361],"timestamp":[574,586.9925253331596]},{"passenger_id":15355,"location":[127.13008336,37.44814682],"timestamp":[576,578.1276870531889]},{"passenger_id":15409,"location":[127.1229805,37.35150788],"timestamp":[577,577.3069021466596]},{"passenger_id":18156,"location":[127.13716135,37.44250319],"timestamp":[578,578.1225189344742]},{"passenger_id":15417,"location":[127.11086592,37.3962295],"timestamp":[578,580.3979826643164]},{"passenger_id":13016,"location":[127.13025651,37.44810995],"timestamp":[578,580.6213879853503]},{"passenger_id":18073,"location":[127.1280899,37.41268158],"timestamp":[554,578.7942351737486]},{"passenger_id":3523,"location":[127.10859929,37.38926337],"timestamp":[562,579.7086689700224]},{"passenger_id":21231,"location":[127.1109804,37.39623008],"timestamp":[571,578.7483393850288]},{"passenger_id":3450,"location":[127.11416607,37.34789983],"timestamp":[574,580.5407297151567]},{"passenger_id":21284,"location":[127.08607523,37.40543675],"timestamp":[578,580.8242203277738]},{"passenger_id":5998,"location":[127.13386026,37.41167765],"timestamp":[556,579.546121518198]},{"passenger_id":8527,"location":[127.11088343,37.39182429],"timestamp":[562,579.68602401082]},{"passenger_id":13017,"location":[127.11530279,37.34892472],"timestamp":[566,583.7331214651895]},{"passenger_id":913,"location":[127.1120224,37.37691879],"timestamp":[567,579.6697470916246]},{"passenger_id":18122,"location":[127.1581192,37.43629837],"timestamp":[568,580.2365411185359]},{"passenger_id":18126,"location":[127.07226249,37.43059612],"timestamp":[568,594.6992230357696]},{"passenger_id":13039,"location":[127.10796356,37.34871674],"timestamp":[572,606.9532756508448]},{"passenger_id":13034,"location":[127.12578748,37.38701326],"timestamp":[572,579.7263216249576]},{"passenger_id":6027,"location":[127.11171722,37.39368439],"timestamp":[572,579.9949946504415]},{"passenger_id":10530,"location":[127.12405154,37.38652009],"timestamp":[574,580.1085685827746]},{"passenger_id":23711,"location":[127.1339677,37.3695467],"timestamp":[577,580.5451706463715]},{"passenger_id":10503,"location":[127.14550781,37.44791794],"timestamp":[579,579.3789768668299]},{"passenger_id":13061,"location":[127.10783386,37.37247467],"timestamp":[579,579.4412391114253]},{"passenger_id":23720,"location":[127.1105322,37.33807596],"timestamp":[580,620.4001097169162]},{"passenger_id":8508,"location":[127.12797512,37.43910115],"timestamp":[554,580.2184551595914]},{"passenger_id":12961,"location":[127.16714601,37.46128776],"timestamp":[556,580.8678536230946]},{"passenger_id":906,"location":[127.106987,37.35013962],"timestamp":[561,611.4910764183012]},{"passenger_id":12994,"location":[127.10195923,37.37651443],"timestamp":[569,581.3775141425901]},{"passenger_id":15348,"location":[127.14710999,37.43608856],"timestamp":[570,580.582308278421]},{"passenger_id":914,"location":[127.17853546,37.44267273],"timestamp":[570,581.5096593842633]},{"passenger_id":3466,"location":[127.10596335,37.36426578],"timestamp":[571,580.4453223719725]},{"passenger_id":21226,"location":[127.12361013,37.38350142],"timestamp":[572,581.3815055098299]},{"passenger_id":915,"location":[127.14060974,37.4359436],"timestamp":[573,580.2269579790592]},{"passenger_id":18149,"location":[127.11183929,37.40129852],"timestamp":[579,581.4986379861534]},{"passenger_id":15400,"location":[127.10968714,37.39442396],"timestamp":[580,582.5465109896794]},{"passenger_id":883,"location":[127.12376019,37.41520845],"timestamp":[552,581.6197273287906]},{"passenger_id":3430,"location":[127.13128662,37.38405991],"timestamp":[553,582.0879327697648]},{"passenger_id":892,"location":[127.10979462,37.39424515],"timestamp":[558,583.7462903282161]},{"passenger_id":23713,"location":[127.113555,37.378739],"timestamp":[574,582.0938220412245]},{"passenger_id":3472,"location":[127.12354534,37.3514329],"timestamp":[580,581.9123786390701]},{"passenger_id":21261,"location":[127.15253019,37.43031173],"timestamp":[580,581.8712675120963]},{"passenger_id":6046,"location":[127.11799622,37.35939407],"timestamp":[581,581.6174507518591]},{"passenger_id":21221,"location":[127.11016453,37.39375812],"timestamp":[554,582.2139208275838]},{"passenger_id":5993,"location":[127.11225076,37.37652393],"timestamp":[555,583.2296774995854]},{"passenger_id":15412,"location":[127.11669065,37.4037242],"timestamp":[563,583.6378123765973]},{"passenger_id":13023,"location":[127.13352203,37.44779587],"timestamp":[573,582.9232780748396]},{"passenger_id":911,"location":[127.13271591,37.43889799],"timestamp":[574,582.4105204299937]},{"passenger_id":18155,"location":[127.15587463,37.44296985],"timestamp":[578,582.8534246959388]},{"passenger_id":6042,"location":[127.12340924,37.35148567],"timestamp":[580,582.363372698314]},{"passenger_id":8580,"location":[127.12208288,37.40431809],"timestamp":[580,582.8301281726729]},{"passenger_id":15402,"location":[127.13586207,37.44275275],"timestamp":[581,582.1813228408062]},{"passenger_id":3491,"location":[127.11088946,37.39597961],"timestamp":[583,583.057118087322]},{"passenger_id":18085,"location":[127.1141245,37.37672439],"timestamp":[564,583.554985320221]},{"passenger_id":3477,"location":[127.12236501,37.37492512],"timestamp":[566,583.9099830159167]},{"passenger_id":6060,"location":[127.0607308,37.39363218],"timestamp":[575,659.2807947369747]},{"passenger_id":6029,"location":[127.12364197,37.40507889],"timestamp":[581,583.9758598662428]},{"passenger_id":15427,"location":[127.11214368,37.37750916],"timestamp":[581,583.8074304015488]},{"passenger_id":925,"location":[127.10878754,37.38969421],"timestamp":[581,583.3162628150945]},{"passenger_id":8565,"location":[127.10913849,37.33945847],"timestamp":[582,589.1346270704723]},{"passenger_id":21307,"location":[127.133517373816,37.4731424283769],"timestamp":[583,587.0037680567641]},{"passenger_id":21300,"location":[127.11087799,37.39414215],"timestamp":[583,583.6430641889053]},{"passenger_id":10551,"location":[127.1063385,37.42231369],"timestamp":[580,587.9582152295932]},{"passenger_id":21353,"location":[127.10984039,37.35004425],"timestamp":[559,592.0408060612025]},{"passenger_id":926,"location":[127.10987161,37.39375456],"timestamp":[562,586.674840347672]},{"passenger_id":13020,"location":[127.10808809,37.36635549],"timestamp":[575,585.3010299420241]},{"passenger_id":21279,"location":[127.12271664,37.38769406],"timestamp":[577,586.1413316554166]},{"passenger_id":15385,"location":[127.11070251,37.39405441],"timestamp":[580,585.8638758873245]},{"passenger_id":3480,"location":[127.13388824,37.42903137],"timestamp":[581,585.2219078080011]},{"passenger_id":18240,"location":[127.12753582,37.46295947],"timestamp":[581,586.7441554762765]},{"passenger_id":919,"location":[127.15021501,37.44173444],"timestamp":[581,585.6275134944997]},{"passenger_id":13074,"location":[127.12647007,37.40986049],"timestamp":[582,585.3116499065569]},{"passenger_id":917,"location":[127.16038513,37.45225525],"timestamp":[583,585.9025445782637]},{"passenger_id":18199,"location":[127.1168501,37.40274225],"timestamp":[584,586.8565151235911]},{"passenger_id":10549,"location":[127.11113739,37.39604187],"timestamp":[586,588.23395120095]},{"passenger_id":10540,"location":[127.10590882,37.34397637],"timestamp":[586,605.8148643864905]},{"passenger_id":6007,"location":[127.17289734,37.44918823],"timestamp":[557,586.182661203524]},{"passenger_id":23728,"location":[127.10746317,37.36551977],"timestamp":[576,586.3393432491893]},{"passenger_id":18181,"location":[127.16034913,37.43838287],"timestamp":[583,586.4561304182821]},{"passenger_id":18308,"location":[127.11071014,37.39788055],"timestamp":[587,589.0115351794087]},{"passenger_id":18257,"location":[127.12329927,37.35150788],"timestamp":[587,587.0904972768341]},{"passenger_id":8603,"location":[127.11309052,37.40166092],"timestamp":[587,589.1131236727442]},{"passenger_id":18106,"location":[127.112764723909,37.4151150056289],"timestamp":[572,591.1937253687879]},{"passenger_id":13003,"location":[127.16152191,37.44517517],"timestamp":[574,587.9267871737352]},{"passenger_id":18185,"location":[127.18058939,37.4360598],"timestamp":[575,593.1681837461294]},{"passenger_id":10539,"location":[127.1511777,37.3822597],"timestamp":[578,590.4575363036025]},{"passenger_id":10520,"location":[127.17851375,37.43160032],"timestamp":[578,587.7466444619344]},{"passenger_id":18233,"location":[127.14230005,37.40832729],"timestamp":[585,587.9007596508195]},{"passenger_id":937,"location":[127.10125901,37.42565139],"timestamp":[586,590.4744284202525]},{"passenger_id":18275,"location":[127.14072579,37.4725615],"timestamp":[586,588.8713580675065]},{"passenger_id":18265,"location":[127.09909821,37.42548752],"timestamp":[588,591.2744436445329]},{"passenger_id":935,"location":[127.11156464,37.39584732],"timestamp":[588,590.0661230705163]},{"passenger_id":21234,"location":[127.15814972,37.43638229],"timestamp":[559,588.3484299577577]},{"passenger_id":21278,"location":[127.16706795,37.46123033],"timestamp":[561,588.3870657818479]},{"passenger_id":18105,"location":[127.12292227,37.35150788],"timestamp":[561,589.116675935286]},{"passenger_id":18134,"location":[127.12512132,37.40980358],"timestamp":[563,588.5243051044412]},{"passenger_id":3484,"location":[127.12311103,37.35150788],"timestamp":[583,588.5599709433556]},{"passenger_id":13069,"location":[127.16117096,37.45447159],"timestamp":[586,589.1355095716848]},{"passenger_id":8568,"location":[127.11672336,37.40364667],"timestamp":[586,591.8881741850139]},{"passenger_id":21326,"location":[127.15099116,37.44315146],"timestamp":[586,588.4319026320812]},{"passenger_id":923,"location":[127.10945892,37.39441681],"timestamp":[587,589.528164250402]},{"passenger_id":18250,"location":[127.10861452,37.39981839],"timestamp":[589,590.130770845001]},{"passenger_id":13004,"location":[127.14329776,37.36748963],"timestamp":[566,591.6539445733729]},{"passenger_id":10623,"location":[127.11475221,37.34892471],"timestamp":[574,606.4182937877998]},{"passenger_id":18219,"location":[127.12602398,37.41089593],"timestamp":[576,589.586724526903]},{"passenger_id":15470,"location":[127.12351611,37.35095329],"timestamp":[583,608.9179473951933]},{"passenger_id":21465,"location":[127.11028865,37.33868564],"timestamp":[587,609.1525889986438]},{"passenger_id":15383,"location":[127.12921776,37.4322545],"timestamp":[570,590.5212197242407]},{"passenger_id":15357,"location":[127.12290192,37.35142517],"timestamp":[571,607.8569238250777]},{"passenger_id":21289,"location":[127.162425528045,37.4556786462249],"timestamp":[580,590.3303890532443]},{"passenger_id":15425,"location":[127.12302399,37.3514328],"timestamp":[584,595.3723698283459]},{"passenger_id":3489,"location":[127.09448242,37.43028259],"timestamp":[585,590.5142431062657]},{"passenger_id":6059,"location":[127.10694885,37.35009766],"timestamp":[587,593.2378651049569]},{"passenger_id":3482,"location":[127.10625458,37.36510849],"timestamp":[589,591.0195245893555]},{"passenger_id":15451,"location":[127.11109924,37.39588928],"timestamp":[590,591.7076991788832]},{"passenger_id":6064,"location":[127.14051561,37.46721219],"timestamp":[591,624.891726926571]},{"passenger_id":18142,"location":[127.12825924,37.4123258],"timestamp":[576,591.8581676072314]},{"passenger_id":15416,"location":[127.14541913,37.36876133],"timestamp":[584,595.1751912307576]},{"passenger_id":3481,"location":[127.13786898,37.43903506],"timestamp":[586,591.5014662057764]},{"passenger_id":21361,"location":[127.10793404,37.35002328],"timestamp":[589,608.6940329697313]},{"passenger_id":18200,"location":[127.1319809,37.41016388],"timestamp":[589,591.6932888248454]},{"passenger_id":10570,"location":[127.097553706879,37.4128122420154],"timestamp":[590,593.0682665443326]},{"passenger_id":15443,"location":[127.11564636,37.40348816],"timestamp":[590,591.8680227954823]},{"passenger_id":10642,"location":[127.10879517,37.34076691],"timestamp":[592,597.312852182183]},{"passenger_id":6015,"location":[127.16733551,37.43704224],"timestamp":[567,592.592771390682]},{"passenger_id":13006,"location":[127.10068512,37.42730713],"timestamp":[567,595.9142371871201]},{"passenger_id":6026,"location":[127.10627809,37.36343112],"timestamp":[571,592.3287214939777]},{"passenger_id":924,"location":[127.08960953,37.38795516],"timestamp":[574,593.3737081511574]},{"passenger_id":13110,"location":[127.17149891,37.44121845],"timestamp":[583,593.3496574367982]},{"passenger_id":15419,"location":[127.11489324,37.39620281],"timestamp":[583,594.3740229311837]},{"passenger_id":8578,"location":[127.07239885,37.38967633],"timestamp":[584,642.5287744118873]},{"passenger_id":18237,"location":[127.12862888,37.41088091],"timestamp":[590,592.6354402847566]},{"passenger_id":18238,"location":[127.13197391,37.44096605],"timestamp":[592,592.3017256130414]},{"passenger_id":18235,"location":[127.11141968,37.39582443],"timestamp":[592,592.9127230812493]},{"passenger_id":21267,"location":[127.11620908,37.36758913],"timestamp":[575,593.4055443688732]},{"passenger_id":15398,"location":[127.12606004,37.41240624],"timestamp":[576,593.6954239098493]},{"passenger_id":10525,"location":[127.10686057,37.35991082],"timestamp":[577,593.7161067396258]},{"passenger_id":10513,"location":[127.176342108449,37.4344954424403],"timestamp":[578,605.9594095776243]},{"passenger_id":8594,"location":[127.10026212,37.42759663],"timestamp":[592,596.7848926078009]},{"passenger_id":21365,"location":[127.11556311,37.33967059],"timestamp":[593,595.52943300532]},{"passenger_id":10566,"location":[127.10061685,37.40111316],"timestamp":[594,595.1233915222434]},{"passenger_id":21357,"location":[127.12958466,37.40541323],"timestamp":[594,594.5840446847843]},{"passenger_id":13005,"location":[127.16588119,37.46020404],"timestamp":[566,594.7900129930108]},{"passenger_id":15374,"location":[127.1043103,37.42873646],"timestamp":[567,598.2244738123636]},{"passenger_id":10496,"location":[127.11155362004,37.391859592332],"timestamp":[576,594.817930215752]},{"passenger_id":6030,"location":[127.15353231,37.44344228],"timestamp":[577,594.6733363129033]},{"passenger_id":921,"location":[127.10588837,37.36196518],"timestamp":[583,594.9637579018002]},{"passenger_id":6045,"location":[127.1270752,37.46752548],"timestamp":[592,596.3745714845554]},{"passenger_id":13073,"location":[127.10987549,37.35000915],"timestamp":[592,599.735060376818]},{"passenger_id":10569,"location":[127.1111145,37.39592361],"timestamp":[595,596.5075044710799]},{"passenger_id":10497,"location":[127.12388473,37.3887351],"timestamp":[572,595.4413859663722]},{"passenger_id":10481,"location":[127.137239572701,37.4397037440109],"timestamp":[578,596.1546569093878]},{"passenger_id":6058,"location":[127.14663437,37.45013928],"timestamp":[588,595.9375526758366]},{"passenger_id":13091,"location":[127.11288147,37.39005054],"timestamp":[589,596.0297293341874]},{"passenger_id":18224,"location":[127.11891287,37.40148936],"timestamp":[590,597.1177091860422]},{"passenger_id":18209,"location":[127.12638092,37.45362854],"timestamp":[591,613.6794912558415]},{"passenger_id":21331,"location":[127.10977173,37.39407349],"timestamp":[594,597.891386891941]},{"passenger_id":21339,"location":[127.11075181,37.39376383],"timestamp":[594,598.2435151014004]},{"passenger_id":948,"location":[127.11109924,37.39396286],"timestamp":[595,599.0443750829883]},{"passenger_id":15420,"location":[127.12653089,37.44997742],"timestamp":[579,598.6175107991305]},{"passenger_id":15388,"location":[127.17568207,37.43451309],"timestamp":[580,596.8008768244632]},{"passenger_id":13041,"location":[127.12289429,37.38393784],"timestamp":[580,596.8404927804894]},{"passenger_id":18207,"location":[127.126342417409,37.3864735141023],"timestamp":[582,596.3802349667088]},{"passenger_id":21317,"location":[127.11335503,37.37243654],"timestamp":[584,596.4102245003317]},{"passenger_id":950,"location":[127.07253265,37.38964081],"timestamp":[592,682.11578289141]},{"passenger_id":10605,"location":[127.08292486,37.39251059],"timestamp":[597,599.8578222844525]},{"passenger_id":21291,"location":[127.13615795,37.43168832],"timestamp":[572,598.1364895367751]},{"passenger_id":10564,"location":[127.074903846654,37.3873318424623],"timestamp":[588,617.26381208779]},{"passenger_id":10665,"location":[127.11351887,37.34507502],"timestamp":[596,609.5003191564773]},{"passenger_id":3513,"location":[127.1263781,37.41233385],"timestamp":[596,597.83971440784]},{"passenger_id":3504,"location":[127.10913849,37.34881592],"timestamp":[596,599.3863964010217]},{"passenger_id":8601,"location":[127.11304893,37.39377754],"timestamp":[597,597.9743518340174]},{"passenger_id":18259,"location":[127.10861118,37.39621069],"timestamp":[597,599.06585027714]},{"passenger_id":18277,"location":[127.11109924,37.3959198],"timestamp":[598,599.1036477302666]},{"passenger_id":10545,"location":[127.14607282,37.4642639],"timestamp":[579,599.8506421903011]},{"passenger_id":23726,"location":[127.096451,37.429506],"timestamp":[583,617.0900062476317]},{"passenger_id":21354,"location":[127.12931553,37.43156786],"timestamp":[587,598.3529531247625]},{"passenger_id":21352,"location":[127.10085235,37.42934107],"timestamp":[590,602.256580606844]},{"passenger_id":18204,"location":[127.13149023,37.44151875],"timestamp":[591,598.4644237510224]},{"passenger_id":18264,"location":[127.16967792,37.44155734],"timestamp":[591,599.10752895764]},{"passenger_id":3496,"location":[127.11188507,37.39196014],"timestamp":[593,599.0783947613693]},{"passenger_id":15463,"location":[127.16936218,37.44714287],"timestamp":[596,598.8541301179736]},{"passenger_id":18258,"location":[127.12225479,37.38776223],"timestamp":[596,598.0935944933063]},{"passenger_id":13086,"location":[127.12679839,37.44955],"timestamp":[596,600.3488216745429]},{"passenger_id":21389,"location":[127.09305573,37.39870453],"timestamp":[598,600.3571914418068]}]');const fA=function(){return(0,kv.jsx)(dA,{trip:pA,passengers:mA})},gA=e=>{e&&e instanceof Function&&i.e(453).then(i.bind(i,834)).then(t=>{let{getCLS:i,getFID:n,getFCP:r,getLCP:s,getTTFB:o}=t;i(e),n(e),r(e),s(e),o(e)})};n.createRoot(document.getElementById("root")).render((0,kv.jsx)(e.StrictMode,{children:(0,kv.jsx)(fA,{})})),gA()})()})();
//# sourceMappingURL=main.f8f9d399.js.map